<!DOCTYPE html>
<html>
<head>
<title>DEV LOGS - JavaScript.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="%F0%9F%93%9A-complete-javascript-mastery-guide">📚 Complete JavaScript Mastery Guide</h1>
<blockquote>
<p>A comprehensive JavaScript learning resource from basics to advanced concepts with real-world applications and interview preparation.</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-about-this-guide">🎯 About This Guide</h2>
<p>This guide is designed for learners who want to master JavaScript from the ground up, with a focus on:</p>
<ul>
<li><strong>Deep Understanding</strong>: Not just syntax, but how and why JavaScript works</li>
<li><strong>Real-World Skills</strong>: Practical applications you'll use in actual projects</li>
<li><strong>Interview Readiness</strong>: Common patterns and questions asked in technical interviews</li>
<li><strong>Modern Best Practices</strong>: ES6+ features and current industry standards</li>
</ul>
<h2 id="%F0%9F%93%96-table-of-contents">📖 Table of Contents</h2>
<h3 id="%F0%9F%9F%A2-part-i-fundamentals-refresher">🟢 Part I: Fundamentals Refresher</h3>
<ol>
<li><a href="./01-variables-datatypes.md">Variables &amp; Data Types</a></li>
<li><a href="./02-operators-expressions.md">Operators &amp; Expressions</a></li>
<li><a href="./03-control-flow.md">Control Flow</a></li>
<li><a href="./04-functions.md">Functions Deep Dive</a></li>
<li><a href="./05-scope-hoisting.md">Scope, Hoisting &amp; TDZ</a></li>
</ol>
<h3 id="%F0%9F%9F%A1-part-ii-intermediate-concepts">🟡 Part II: Intermediate Concepts</h3>
<ol start="6">
<li><a href="./06-closures.md">Closures Explained</a></li>
<li><a href="./07-arrays.md">Arrays &amp; Array Methods</a></li>
<li><a href="./08-objects.md">Objects &amp; Object Access</a></li>
<li><a href="./09-prototypes.md">Prototypes &amp; Inheritance</a></li>
<li><a href="./10-async-javascript.md">Asynchronous JavaScript</a></li>
<li><a href="./11-error-handling.md">Error Handling &amp; Debugging</a></li>
<li><a href="./12-es6-features.md">ES6+ Features</a></li>
</ol>
<h3 id="%F0%9F%94%B4-part-iii-advanced--browser-topics">🔴 Part III: Advanced &amp; Browser Topics</h3>
<ol start="13">
<li><a href="./13-dom-manipulation.md">DOM Manipulation</a></li>
<li><a href="./14-event-handling.md">Event Handling</a></li>
<li><a href="./15-browser-apis.md">Browser APIs</a></li>
<li><a href="./16-testing-debugging.md">Testing &amp; Debugging</a></li>
<li><a href="./17-performance-optimization.md">Performance Optimization</a></li>
<li><a href="./18-security-best-practices.md">Security Best Practices</a></li>
<li><a href="./19-modern-frameworks.md">Modern Frameworks</a></li>
<li><a href="./20-nodejs-backend.md">Node.js Backend Development</a></li>
<li><a href="./21-javascript-threading-workers.md">JavaScript Threading Model &amp; Web Workers</a></li>
</ol>
<h2 id="%F0%9F%8E%93-how-to-use-this-guide">🎓 How to Use This Guide</h2>
<ol>
<li><strong>Sequential Learning</strong>: Follow chapters in order for structured learning</li>
<li><strong>Reference Mode</strong>: Jump to specific topics as needed</li>
<li><strong>Practice First</strong>: Try examples before reading explanations</li>
<li><strong>Interview Prep</strong>: Focus on &quot;Interview Notes&quot; sections</li>
</ol>
<h2 id="%F0%9F%93%9D-chapter-structure">📝 Chapter Structure</h2>
<p>Each chapter includes:</p>
<ul>
<li>📖 <strong>Plain English Explanation</strong></li>
<li>💻 <strong>Code Examples with Comments</strong></li>
<li>⚠️ <strong>Common Pitfalls</strong></li>
<li>🎯 <strong>When &amp; Why to Use</strong></li>
<li>🏋️ <strong>Mini Practice Problems</strong></li>
<li>💼 <strong>Interview Notes</strong></li>
<li>📊 <strong>Visual Aids &amp; Diagrams</strong></li>
</ul>
<h2 id="%F0%9F%8F%86-learning-outcomes">🏆 Learning Outcomes</h2>
<p>After completing this guide, you'll be able to:</p>
<ul>
<li>✅ Understand JavaScript's core concepts deeply</li>
<li>✅ Write clean, efficient, and maintainable code</li>
<li>✅ Handle complex scenarios with confidence</li>
<li>✅ Ace JavaScript technical interviews</li>
<li>✅ Build real-world applications</li>
</ul>
<h2 id="%F0%9F%A4%9D-contributing">🤝 Contributing</h2>
<p>Found an error or want to improve something? Feel free to contribute!</p>
<hr>
<p><strong>Happy Learning! 🚀</strong></p>
<p><em>&quot;The best way to learn JavaScript is to understand it, not just memorize it.&quot;</em></p>
<h1 id="%F0%9F%93%9D-chapter-1-variables--data-types">📝 Chapter 1: Variables &amp; Data Types</h1>
<blockquote>
<p>Understanding the foundation of JavaScript: how to store and work with different types of data.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Variables are like labeled boxes where you store information. Data types are the different kinds of information you can store - like numbers, text, true/false values, and more complex structures.</p>
<p>Think of it like organizing your desk:</p>
<ul>
<li><strong>Variables</strong> = labeled drawers</li>
<li><strong>Data Types</strong> = what kind of stuff goes in each drawer (pens, papers, etc.)</li>
</ul>
<h2 id="%F0%9F%94%A7-variable-declarations">🔧 Variable Declarations</h2>
<h3 id="modern-way-es6">Modern Way (ES6+)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// const - for values that won't change</span>
<span class="hljs-keyword">const</span> userName = <span class="hljs-string">"Alice"</span>;
<span class="hljs-keyword">const</span> PI = <span class="hljs-number">3.14159</span>;

<span class="hljs-comment">// let - for values that might change</span>
<span class="hljs-keyword">let</span> age = <span class="hljs-number">25</span>;
<span class="hljs-keyword">let</span> isLoggedIn = <span class="hljs-literal">false</span>;

<span class="hljs-comment">// ❌ Avoid var in modern JavaScript</span>
<span class="hljs-keyword">var</span> oldStyle = <span class="hljs-string">"Don't use this"</span>;
</div></code></pre>
<h3 id="%F0%9F%92%A1-key-differences">💡 Key Differences</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// const - Cannot be reassigned</span>
<span class="hljs-keyword">const</span> name = <span class="hljs-string">"John"</span>;
<span class="hljs-comment">// name = "Jane"; // ❌ TypeError!</span>

<span class="hljs-comment">// let - Can be reassigned</span>
<span class="hljs-keyword">let</span> score = <span class="hljs-number">100</span>;
score = <span class="hljs-number">150</span>; <span class="hljs-comment">// ✅ Works fine</span>

<span class="hljs-comment">// var - Function scoped (causes issues)</span>
<span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>;
  <span class="hljs-keyword">let</span> y = <span class="hljs-number">2</span>;
}
<span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// ✅ 1 (var leaks out)</span>
<span class="hljs-comment">// console.log(y); // ❌ ReferenceError (let is block-scoped)</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-javascript-data-types">🎯 JavaScript Data Types</h2>
<h3 id="primitive-types-7-types">Primitive Types (7 types)</h3>
<h4 id="1-number">1. Number</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> integer = <span class="hljs-number">42</span>;
<span class="hljs-keyword">const</span> decimal = <span class="hljs-number">3.14</span>;
<span class="hljs-keyword">const</span> negative = <span class="hljs-number">-10</span>;
<span class="hljs-keyword">const</span> scientific = <span class="hljs-number">2e3</span>; <span class="hljs-comment">// 2000</span>
<span class="hljs-keyword">const</span> infinity = <span class="hljs-literal">Infinity</span>;
<span class="hljs-keyword">const</span> notANumber = <span class="hljs-literal">NaN</span>;

<span class="hljs-comment">// Type checking</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-number">42</span>); <span class="hljs-comment">// "number"</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Number</span>.isInteger(<span class="hljs-number">42</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Number</span>.isNaN(<span class="hljs-literal">NaN</span>)); <span class="hljs-comment">// true</span>
</div></code></pre>
<h4 id="2-string">2. String</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> singleQuotes = <span class="hljs-string">"Hello"</span>;
<span class="hljs-keyword">const</span> doubleQuotes = <span class="hljs-string">"World"</span>;
<span class="hljs-keyword">const</span> templateLiteral = <span class="hljs-string">`Hello <span class="hljs-subst">${singleQuotes}</span>!`</span>; <span class="hljs-comment">// Template literals</span>

<span class="hljs-comment">// String methods</span>
<span class="hljs-keyword">const</span> text = <span class="hljs-string">"JavaScript"</span>;
<span class="hljs-built_in">console</span>.log(text.length); <span class="hljs-comment">// 10</span>
<span class="hljs-built_in">console</span>.log(text.toUpperCase()); <span class="hljs-comment">// "JAVASCRIPT"</span>
<span class="hljs-built_in">console</span>.log(text.slice(<span class="hljs-number">0</span>, <span class="hljs-number">4</span>)); <span class="hljs-comment">// "Java"</span>
</div></code></pre>
<h4 id="3-boolean">3. Boolean</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> isTrue = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">const</span> isFalse = <span class="hljs-literal">false</span>;

<span class="hljs-comment">// Truthy and Falsy values</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Boolean</span>(<span class="hljs-number">1</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Boolean</span>(<span class="hljs-number">0</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Boolean</span>(<span class="hljs-string">""</span>)); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Boolean</span>(<span class="hljs-string">"hello"</span>)); <span class="hljs-comment">// true</span>
</div></code></pre>
<h4 id="4-undefined">4. Undefined</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> notAssigned;
<span class="hljs-built_in">console</span>.log(notAssigned); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> notAssigned); <span class="hljs-comment">// "undefined"</span>
</div></code></pre>
<h4 id="5-null">5. Null</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> empty = <span class="hljs-literal">null</span>;
<span class="hljs-built_in">console</span>.log(empty); <span class="hljs-comment">// null</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">null</span>); <span class="hljs-comment">// "object" (this is a known bug!)</span>
</div></code></pre>
<h4 id="6-symbol-es6">6. Symbol (ES6)</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> sym1 = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">"description"</span>);
<span class="hljs-keyword">const</span> sym2 = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">"description"</span>);
<span class="hljs-built_in">console</span>.log(sym1 === sym2); <span class="hljs-comment">// false (always unique)</span>
</div></code></pre>
<h4 id="7-bigint-es2020">7. BigInt (ES2020)</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> bigNumber = <span class="hljs-number">123456789012345678901234567890n</span>;
<span class="hljs-keyword">const</span> anotherBig = BigInt(<span class="hljs-string">"123456789012345678901234567890"</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> bigNumber); <span class="hljs-comment">// "bigint"</span>
</div></code></pre>
<h3 id="non-primitive-types-reference-types">Non-Primitive Types (Reference Types)</h3>
<h4 id="object">Object</h4>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">isStudent</span>: <span class="hljs-literal">false</span>,
};

<span class="hljs-comment">// Arrays are objects too!</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> numbers); <span class="hljs-comment">// "object"</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Array</span>.isArray(numbers)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Functions are objects too!</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greet</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello!"</span>;
}
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> greet); <span class="hljs-comment">// "function"</span>
</div></code></pre>
<h2 id="%F0%9F%94%8D-type-checking--conversion">🔍 Type Checking &amp; Conversion</h2>
<h3 id="checking-types">Checking Types</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> value = <span class="hljs-number">42</span>;

<span class="hljs-comment">// typeof operator</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> value); <span class="hljs-comment">// "number"</span>

<span class="hljs-comment">// More specific checks</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Array</span>.isArray([])); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Number</span>.isInteger(<span class="hljs-number">42</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.prototype.toString.call(value)); <span class="hljs-comment">// "[object Number]"</span>
</div></code></pre>
<h3 id="type-conversion">Type Conversion</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Explicit conversion</span>
<span class="hljs-keyword">const</span> str = <span class="hljs-string">"123"</span>;
<span class="hljs-keyword">const</span> num = <span class="hljs-built_in">Number</span>(str); <span class="hljs-comment">// 123</span>
<span class="hljs-keyword">const</span> bool = <span class="hljs-built_in">Boolean</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Implicit conversion (coercion)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5"</span> + <span class="hljs-number">3</span>); <span class="hljs-comment">// "53" (string concatenation)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5"</span> - <span class="hljs-number">3</span>); <span class="hljs-comment">// 2 (numeric subtraction)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5"</span> * <span class="hljs-number">3</span>); <span class="hljs-comment">// 15 (numeric multiplication)</span>
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-typeof-null-bug">1. typeof null Bug</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">null</span>); <span class="hljs-comment">// "object" (not "null"!)</span>

<span class="hljs-comment">// Correct way to check for null</span>
<span class="hljs-keyword">const</span> value = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">if</span> (value === <span class="hljs-literal">null</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"It's null!"</span>);
}
</div></code></pre>
<h3 id="2-nan-comparison">2. NaN Comparison</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> result = <span class="hljs-number">0</span> / <span class="hljs-number">0</span>; <span class="hljs-comment">// NaN</span>
<span class="hljs-built_in">console</span>.log(result === <span class="hljs-literal">NaN</span>); <span class="hljs-comment">// false (NaN is not equal to anything!)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Number</span>.isNaN(result)); <span class="hljs-comment">// true (correct way)</span>
</div></code></pre>
<h3 id="3-floating-point-precision">3. Floating Point Precision</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">console</span>.log(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>); <span class="hljs-comment">// 0.30000000000000004 (not 0.3!)</span>

<span class="hljs-comment">// Solution: use toFixed() or compare with epsilon</span>
<span class="hljs-keyword">const</span> sum = <span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>;
<span class="hljs-built_in">console</span>.log(sum.toFixed(<span class="hljs-number">1</span>)); <span class="hljs-comment">// "0.3"</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Math</span>.abs(sum - <span class="hljs-number">0.3</span>) &lt; <span class="hljs-built_in">Number</span>.EPSILON); <span class="hljs-comment">// true</span>
</div></code></pre>
<h3 id="4-variable-hoisting-with-var">4. Variable Hoisting with var</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// undefined (not error!)</span>
<span class="hljs-keyword">var</span> x = <span class="hljs-number">5</span>;

<span class="hljs-comment">// What actually happens:</span>
<span class="hljs-comment">// var x; // hoisted to top</span>
<span class="hljs-comment">// console.log(x); // undefined</span>
<span class="hljs-comment">// x = 5;</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when--why-to-use">🎯 When &amp; Why to Use</h2>
<h3 id="use-const-by-default">Use <code>const</code> by default</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// For values that won't change</span>
<span class="hljs-keyword">const</span> API_URL = <span class="hljs-string">"https://api.example.com"</span>;
<span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> }; <span class="hljs-comment">// Object reference won't change</span>
</div></code></pre>
<h3 id="use-let-when-you-need-to-reassign">Use <code>let</code> when you need to reassign</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// For counters, flags, etc.</span>
<span class="hljs-keyword">let</span> counter = <span class="hljs-number">0</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
  counter += i;
}
</div></code></pre>
<h3 id="choose-appropriate-data-types">Choose appropriate data types</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Use numbers for calculations</span>
<span class="hljs-keyword">const</span> price = <span class="hljs-number">29.99</span>;
<span class="hljs-keyword">const</span> quantity = <span class="hljs-number">3</span>;
<span class="hljs-keyword">const</span> total = price * quantity;

<span class="hljs-comment">// Use strings for text</span>
<span class="hljs-keyword">const</span> message = <span class="hljs-string">`Total: $<span class="hljs-subst">${total.toFixed(<span class="hljs-number">2</span>)}</span>`</span>;

<span class="hljs-comment">// Use booleans for flags</span>
<span class="hljs-keyword">const</span> isDiscountApplied = total &gt; <span class="hljs-number">50</span>;
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-type-detective">Problem 1: Type Detective</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// What will these log?</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-string">"42"</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-number">42</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">true</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">undefined</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> <span class="hljs-literal">null</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> []);
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> {});

<span class="hljs-comment">// Try to guess before running!</span>
</div></code></pre>
<h3 id="problem-2-fix-the-bug">Problem 2: Fix the Bug</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// This code has issues. Can you fix them?</span>
<span class="hljs-keyword">var</span> name = <span class="hljs-string">"John"</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">var</span> name = <span class="hljs-string">"Jane"</span>;
}
<span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// Should this be "John" or "Jane"?</span>

<span class="hljs-comment">// Rewrite using const/let appropriately</span>
</div></code></pre>
<h3 id="problem-3-type-conversion-challenge">Problem 3: Type Conversion Challenge</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Predict the output</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5"</span> + <span class="hljs-number">3</span> + <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span> + <span class="hljs-number">2</span> + <span class="hljs-string">"5"</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5"</span> - <span class="hljs-number">3</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5"</span> * <span class="hljs-string">"3"</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"hello"</span> - <span class="hljs-number">3</span>);
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between <code>let</code>, <code>const</code>, and <code>var</code>?</strong></p>
<ul>
<li><code>var</code>: Function-scoped, hoisted, can be redeclared</li>
<li><code>let</code>: Block-scoped, hoisted but in TDZ, cannot be redeclared</li>
<li><code>const</code>: Block-scoped, hoisted but in TDZ, cannot be reassigned</li>
</ul>
<p><strong>Q: Why does <code>typeof null</code> return &quot;object&quot;?</strong></p>
<ul>
<li>It's a historical bug in JavaScript that can't be fixed due to backward compatibility</li>
</ul>
<p><strong>Q: What are falsy values in JavaScript?</strong></p>
<ul>
<li><code>false</code>, <code>0</code>, <code>-0</code>, <code>0n</code>, <code>&quot;&quot;</code>, <code>null</code>, <code>undefined</code>, <code>NaN</code></li>
</ul>
<p><strong>Q: How do you check if a variable is an array?</strong></p>
<ul>
<li>Use <code>Array.isArray(variable)</code>, not <code>typeof</code> (which returns &quot;object&quot;)</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Explain type coercion with examples&quot;</li>
<li><strong>Facebook</strong>: &quot;What happens when you add a string and a number?&quot;</li>
<li><strong>Amazon</strong>: &quot;How would you safely check if a variable is null?&quot;</li>
</ul>
<h2 id="%F0%9F%93%8A-visual-memory-aid">📊 Visual Memory Aid</h2>
<pre class="hljs"><code><div>JavaScript Data Types
├── Primitive (Stored by Value)
│   ├── Number (42, 3.14, NaN, Infinity)
│   ├── String (&quot;hello&quot;, 'world', `template`)
│   ├── Boolean (true, false)
│   ├── Undefined (declared but not assigned)
│   ├── Null (intentionally empty)
│   ├── Symbol (unique identifier)
│   └── BigInt (large integers)
└── Non-Primitive (Stored by Reference)
    └── Object (objects, arrays, functions)
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Always use <code>const</code> by default, <code>let</code> when you need to reassign</strong></li>
<li><strong>JavaScript has 7 primitive types + objects</strong></li>
<li><strong><code>typeof</code> has quirks - know them for interviews</strong></li>
<li><strong>Type coercion can be tricky - be explicit when possible</strong></li>
<li><strong>Understand the difference between primitive and reference types</strong></li>
</ol>
<hr>
<p><strong>Next Chapter</strong>: <a href="./02-operators-expressions.md">Operators &amp; Expressions →</a></p>
<p><strong>Practice</strong>: Try the problems above and experiment with different data types in your browser console!</p>
<h1 id="%E2%9A%A1-chapter-2-operators--expressions">⚡ Chapter 2: Operators &amp; Expressions</h1>
<blockquote>
<p>Master JavaScript operators and learn how to build complex expressions that power your applications.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Operators are like tools that perform actions on your data. Think of them as:</p>
<ul>
<li><strong>Arithmetic operators</strong> = calculator buttons (+, -, *, /)</li>
<li><strong>Comparison operators</strong> = judges that compare things (&gt;, &lt;, ===)</li>
<li><strong>Logical operators</strong> = decision makers (&amp;&amp;, ||, !)</li>
<li><strong>Assignment operators</strong> = ways to store results (=, +=, -=)</li>
</ul>
<p>Expressions are combinations of values, variables, and operators that produce a result.</p>
<h2 id="%F0%9F%94%A2-arithmetic-operators">🔢 Arithmetic Operators</h2>
<h3 id="basic-math-operations">Basic Math Operations</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> a = <span class="hljs-number">10</span>;
<span class="hljs-keyword">const</span> b = <span class="hljs-number">3</span>;

<span class="hljs-built_in">console</span>.log(a + b); <span class="hljs-comment">// 13 (Addition)</span>
<span class="hljs-built_in">console</span>.log(a - b); <span class="hljs-comment">// 7  (Subtraction)</span>
<span class="hljs-built_in">console</span>.log(a * b); <span class="hljs-comment">// 30 (Multiplication)</span>
<span class="hljs-built_in">console</span>.log(a / b); <span class="hljs-comment">// 3.333... (Division)</span>
<span class="hljs-built_in">console</span>.log(a % b); <span class="hljs-comment">// 1  (Modulus - remainder)</span>
<span class="hljs-built_in">console</span>.log(a ** b); <span class="hljs-comment">// 1000 (Exponentiation - ES2016)</span>
</div></code></pre>
<h3 id="increment--decrement">Increment &amp; Decrement</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> counter = <span class="hljs-number">5</span>;

<span class="hljs-comment">// Pre-increment (increment first, then use)</span>
<span class="hljs-built_in">console</span>.log(++counter); <span class="hljs-comment">// 6 (counter is now 6)</span>

<span class="hljs-comment">// Post-increment (use first, then increment)</span>
<span class="hljs-built_in">console</span>.log(counter++); <span class="hljs-comment">// 6 (shows 6, but counter becomes 7)</span>
<span class="hljs-built_in">console</span>.log(counter); <span class="hljs-comment">// 7</span>

<span class="hljs-comment">// Pre-decrement</span>
<span class="hljs-built_in">console</span>.log(--counter); <span class="hljs-comment">// 6 (counter is now 6)</span>

<span class="hljs-comment">// Post-decrement</span>
<span class="hljs-built_in">console</span>.log(counter--); <span class="hljs-comment">// 6 (shows 6, but counter becomes 5)</span>
<span class="hljs-built_in">console</span>.log(counter); <span class="hljs-comment">// 5</span>
</div></code></pre>
<h3 id="unary-plus--minus">Unary Plus &amp; Minus</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> str = <span class="hljs-string">"42"</span>;
<span class="hljs-keyword">const</span> num = +str; <span class="hljs-comment">// 42 (converts string to number)</span>
<span class="hljs-keyword">const</span> negative = -num; <span class="hljs-comment">// -42</span>

<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> str); <span class="hljs-comment">// "string"</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> num); <span class="hljs-comment">// "number"</span>
</div></code></pre>
<h2 id="%F0%9F%93%8A-comparison-operators">📊 Comparison Operators</h2>
<h3 id="equality-operators">Equality Operators</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Strict equality (recommended)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span> === <span class="hljs-number">5</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span> === <span class="hljs-string">"5"</span>); <span class="hljs-comment">// false (different types)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">null</span> === <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// Loose equality (avoid in most cases)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span> == <span class="hljs-string">"5"</span>); <span class="hljs-comment">// true (type coercion happens)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">null</span> == <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">0</span> == <span class="hljs-literal">false</span>); <span class="hljs-comment">// true</span>
</div></code></pre>
<h3 id="inequality-operators">Inequality Operators</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span> !== <span class="hljs-string">"5"</span>); <span class="hljs-comment">// true (strict inequality)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">5</span> != <span class="hljs-string">"5"</span>); <span class="hljs-comment">// false (loose inequality)</span>
</div></code></pre>
<h3 id="relational-operators">Relational Operators</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">const</span> y = <span class="hljs-number">5</span>;

<span class="hljs-built_in">console</span>.log(x &gt; y); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(x &lt; y); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(x &gt;= <span class="hljs-number">10</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(y &lt;= <span class="hljs-number">5</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// String comparison (lexicographical)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"apple"</span> &lt; <span class="hljs-string">"banana"</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"10"</span> &lt; <span class="hljs-string">"9"</span>); <span class="hljs-comment">// true (string comparison!)</span>
</div></code></pre>
<h2 id="%F0%9F%A7%A0-logical-operators">🧠 Logical Operators</h2>
<h3 id="and----all-conditions-must-be-true">AND (&amp;&amp;) - All conditions must be true</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> age = <span class="hljs-number">25</span>;
<span class="hljs-keyword">const</span> hasLicense = <span class="hljs-literal">true</span>;

<span class="hljs-comment">// Both conditions must be true</span>
<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span> &amp;&amp; hasLicense) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Can drive!"</span>);
}

<span class="hljs-comment">// Short-circuit evaluation</span>
<span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
user.profile &amp;&amp; <span class="hljs-built_in">console</span>.log(user.profile.bio); <span class="hljs-comment">// Won't error if profile is undefined</span>
</div></code></pre>
<h3 id="or----at-least-one-condition-must-be-true">OR (||) - At least one condition must be true</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> isWeekend = <span class="hljs-literal">false</span>;
<span class="hljs-keyword">const</span> isHoliday = <span class="hljs-literal">true</span>;

<span class="hljs-comment">// Either condition can be true</span>
<span class="hljs-keyword">if</span> (isWeekend || isHoliday) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"No work today!"</span>);
}

<span class="hljs-comment">// Default values using ||</span>
<span class="hljs-keyword">const</span> username = user.name || <span class="hljs-string">"Guest"</span>;
<span class="hljs-keyword">const</span> config = userConfig || defaultConfig;
</div></code></pre>
<h3 id="not----inverts-boolean-value">NOT (!) - Inverts boolean value</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> isLoggedIn = <span class="hljs-literal">false</span>;

<span class="hljs-keyword">if</span> (!isLoggedIn) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Please log in"</span>);
}

<span class="hljs-comment">// Double NOT for boolean conversion</span>
<span class="hljs-built_in">console</span>.log(!!<span class="hljs-string">"hello"</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(!!<span class="hljs-number">0</span>); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(!!<span class="hljs-string">""</span>); <span class="hljs-comment">// false</span>
</div></code></pre>
<h3 id="nullish-coalescing----es2020">Nullish Coalescing (??) - ES2020</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> value1 = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">const</span> value2 = <span class="hljs-literal">undefined</span>;
<span class="hljs-keyword">const</span> value3 = <span class="hljs-number">0</span>;
<span class="hljs-keyword">const</span> value4 = <span class="hljs-string">""</span>;
<span class="hljs-keyword">const</span> fallback = <span class="hljs-string">"default"</span>;

<span class="hljs-comment">// ?? only checks for null/undefined (not other falsy values)</span>
<span class="hljs-built_in">console</span>.log(value1 ?? fallback); <span class="hljs-comment">// "default"</span>
<span class="hljs-built_in">console</span>.log(value2 ?? fallback); <span class="hljs-comment">// "default"</span>
<span class="hljs-built_in">console</span>.log(value3 ?? fallback); <span class="hljs-comment">// 0 (not "default"!)</span>
<span class="hljs-built_in">console</span>.log(value4 ?? fallback); <span class="hljs-comment">// "" (not "default"!)</span>

<span class="hljs-comment">// Compare with ||</span>
<span class="hljs-built_in">console</span>.log(value3 || fallback); <span class="hljs-comment">// "default"</span>
<span class="hljs-built_in">console</span>.log(value4 || fallback); <span class="hljs-comment">// "default"</span>
</div></code></pre>
<h2 id="%F0%9F%93%9D-assignment-operators">📝 Assignment Operators</h2>
<h3 id="basic-assignment">Basic Assignment</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> x = <span class="hljs-number">10</span>;
<span class="hljs-keyword">let</span> y = x; <span class="hljs-comment">// y gets the value of x</span>
</div></code></pre>
<h3 id="compound-assignment">Compound Assignment</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> score = <span class="hljs-number">100</span>;

score += <span class="hljs-number">50</span>; <span class="hljs-comment">// score = score + 50 (150)</span>
score -= <span class="hljs-number">20</span>; <span class="hljs-comment">// score = score - 20 (130)</span>
score *= <span class="hljs-number">2</span>; <span class="hljs-comment">// score = score * 2 (260)</span>
score /= <span class="hljs-number">4</span>; <span class="hljs-comment">// score = score / 4 (65)</span>
score %= <span class="hljs-number">10</span>; <span class="hljs-comment">// score = score % 10 (5)</span>
score **= <span class="hljs-number">2</span>; <span class="hljs-comment">// score = score ** 2 (25)</span>

<span class="hljs-comment">// String concatenation</span>
<span class="hljs-keyword">let</span> message = <span class="hljs-string">"Hello"</span>;
message += <span class="hljs-string">" World"</span>; <span class="hljs-comment">// "Hello World"</span>
</div></code></pre>
<h3 id="logical-assignment-es2021">Logical Assignment (ES2021)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };

<span class="hljs-comment">// Logical AND assignment</span>
user.name &amp;&amp;= user.name.toUpperCase(); <span class="hljs-comment">// Only if name exists</span>

<span class="hljs-comment">// Logical OR assignment</span>
user.email ||= <span class="hljs-string">"default@example.com"</span>; <span class="hljs-comment">// Only if email is falsy</span>

<span class="hljs-comment">// Nullish coalescing assignment</span>
user.age ??= <span class="hljs-number">18</span>; <span class="hljs-comment">// Only if age is null/undefined</span>
</div></code></pre>
<h2 id="%F0%9F%94%80-conditional-ternary-operator">🔀 Conditional (Ternary) Operator</h2>
<h3 id="basic-ternary">Basic Ternary</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> age = <span class="hljs-number">20</span>;
<span class="hljs-keyword">const</span> status = age &gt;= <span class="hljs-number">18</span> ? <span class="hljs-string">"adult"</span> : <span class="hljs-string">"minor"</span>;
<span class="hljs-built_in">console</span>.log(status); <span class="hljs-comment">// "adult"</span>

<span class="hljs-comment">// Equivalent to:</span>
<span class="hljs-keyword">let</span> status2;
<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>) {
  status2 = <span class="hljs-string">"adult"</span>;
} <span class="hljs-keyword">else</span> {
  status2 = <span class="hljs-string">"minor"</span>;
}
</div></code></pre>
<h3 id="nested-ternary-use-sparingly">Nested Ternary (use sparingly)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> score = <span class="hljs-number">85</span>;
<span class="hljs-keyword">const</span> grade =
  score &gt;= <span class="hljs-number">90</span>
    ? <span class="hljs-string">"A"</span>
    : score &gt;= <span class="hljs-number">80</span>
    ? <span class="hljs-string">"B"</span>
    : score &gt;= <span class="hljs-number">70</span>
    ? <span class="hljs-string">"C"</span>
    : score &gt;= <span class="hljs-number">60</span>
    ? <span class="hljs-string">"D"</span>
    : <span class="hljs-string">"F"</span>;
<span class="hljs-built_in">console</span>.log(grade); <span class="hljs-comment">// "B"</span>
</div></code></pre>
<h3 id="ternary-for-function-calls">Ternary for Function Calls</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> isLoggedIn = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">const</span> action = isLoggedIn ? showDashboard() : showLoginForm();

<span class="hljs-comment">// Or for conditional execution</span>
isLoggedIn ? <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Welcome back!"</span>) : <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Please log in"</span>);
</div></code></pre>
<h2 id="%F0%9F%8E%AF-operator-precedence--associativity">🎯 Operator Precedence &amp; Associativity</h2>
<h3 id="precedence-order-of-operations">Precedence (Order of Operations)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Multiplication before addition</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span> + <span class="hljs-number">3</span> * <span class="hljs-number">4</span>); <span class="hljs-comment">// 14 (not 20)</span>

<span class="hljs-comment">// Use parentheses to override</span>
<span class="hljs-built_in">console</span>.log((<span class="hljs-number">2</span> + <span class="hljs-number">3</span>) * <span class="hljs-number">4</span>); <span class="hljs-comment">// 20</span>

<span class="hljs-comment">// Complex expression</span>
<span class="hljs-keyword">const</span> result = <span class="hljs-number">10</span> + (<span class="hljs-number">5</span> * <span class="hljs-number">2</span> ** <span class="hljs-number">3</span>) / <span class="hljs-number">4</span> - <span class="hljs-number">1</span>;
<span class="hljs-comment">// Order: 2**3 = 8, 5*8 = 40, 40/4 = 10, 10+10 = 20, 20-1 = 19</span>
<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// 19</span>
</div></code></pre>
<h3 id="associativity-left-to-right-vs-right-to-left">Associativity (Left-to-Right vs Right-to-Left)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Left-to-right (most operators)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">10</span> - <span class="hljs-number">5</span> - <span class="hljs-number">2</span>); <span class="hljs-comment">// 3 (not 7)</span>
<span class="hljs-comment">// Evaluated as: (10 - 5) - 2 = 5 - 2 = 3</span>

<span class="hljs-comment">// Right-to-left (assignment, exponentiation)</span>
<span class="hljs-keyword">let</span> a, b, c;
a = b = c = <span class="hljs-number">5</span>; <span class="hljs-comment">// All get value 5</span>
<span class="hljs-comment">// Evaluated as: a = (b = (c = 5))</span>

<span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span> ** (<span class="hljs-number">3</span> ** <span class="hljs-number">2</span>)); <span class="hljs-comment">// 512 (not 64)</span>
<span class="hljs-comment">// Evaluated as: 2 ** (3 ** 2) = 2 ** 9 = 512</span>
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-floating-point-arithmetic">1. Floating Point Arithmetic</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">console</span>.log(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>); <span class="hljs-comment">// 0.30000000000000004</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span> === <span class="hljs-number">0.3</span>); <span class="hljs-comment">// false!</span>

<span class="hljs-comment">// Solution: Use epsilon comparison</span>
<span class="hljs-keyword">const</span> epsilon = <span class="hljs-built_in">Number</span>.EPSILON;
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Math</span>.abs(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span> - <span class="hljs-number">0.3</span>) &lt; epsilon); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Or round to specific decimal places</span>
<span class="hljs-built_in">console</span>.log(+(<span class="hljs-number">0.1</span> + <span class="hljs-number">0.2</span>).toFixed(<span class="hljs-number">1</span>)); <span class="hljs-comment">// 0.3</span>
</div></code></pre>
<h3 id="2-type-coercion-with">2. Type Coercion with ==</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Unexpected results with ==</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">""</span> == <span class="hljs-number">0</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">false</span> == <span class="hljs-number">0</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">null</span> == <span class="hljs-number">0</span>); <span class="hljs-comment">// false (but null == undefined is true)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">" "</span> == <span class="hljs-number">0</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Always use === for safety</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">""</span> === <span class="hljs-number">0</span>); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">false</span> === <span class="hljs-number">0</span>); <span class="hljs-comment">// false</span>
</div></code></pre>
<h3 id="3-incrementdecrement-confusion">3. Increment/Decrement Confusion</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> i = <span class="hljs-number">5</span>;
<span class="hljs-keyword">const</span> a = i++; <span class="hljs-comment">// a = 5, i = 6</span>
<span class="hljs-keyword">const</span> b = ++i; <span class="hljs-comment">// i = 7, b = 7</span>

<span class="hljs-built_in">console</span>.log(a, b, i); <span class="hljs-comment">// 5, 7, 7</span>
</div></code></pre>
<h3 id="4-logical-operator-short-circuiting">4. Logical Operator Short-Circuiting</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> user = <span class="hljs-literal">null</span>;

<span class="hljs-comment">// This will throw an error!</span>
<span class="hljs-comment">// console.log(user.name &amp;&amp; user.name.length);</span>

<span class="hljs-comment">// Correct way:</span>
<span class="hljs-built_in">console</span>.log(user &amp;&amp; user.name &amp;&amp; user.name.length);

<span class="hljs-comment">// Or use optional chaining (ES2020)</span>
<span class="hljs-built_in">console</span>.log(user?.name?.length);
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when--why-to-use">🎯 When &amp; Why to Use</h2>
<h3 id="use-strict-equality">Use Strict Equality (===)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Always prefer === over ==</span>
<span class="hljs-keyword">if</span> (userInput === <span class="hljs-string">"admin"</span>) {
  <span class="hljs-comment">// Safe comparison</span>
}
</div></code></pre>
<h3 id="use-logical-operators-for-defaults">Use Logical Operators for Defaults</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Set default values</span>
<span class="hljs-keyword">const</span> theme = userPreference || <span class="hljs-string">"light"</span>;
<span class="hljs-keyword">const</span> timeout = config.timeout ?? <span class="hljs-number">5000</span>;
</div></code></pre>
<h3 id="use-ternary-for-simple-conditions">Use Ternary for Simple Conditions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Good: Simple condition</span>
<span class="hljs-keyword">const</span> message = isOnline ? <span class="hljs-string">"Online"</span> : <span class="hljs-string">"Offline"</span>;

<span class="hljs-comment">// Bad: Complex logic (use if/else instead)</span>
<span class="hljs-keyword">const</span> result = condition1
  ? condition2
    ? value1
    : value2
  : condition3
  ? value3
  : value4;
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-operator-precedence">Problem 1: Operator Precedence</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// What will these expressions evaluate to?</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span> + <span class="hljs-number">3</span> * <span class="hljs-number">4</span>);
<span class="hljs-built_in">console</span>.log((<span class="hljs-number">2</span> + <span class="hljs-number">3</span>) * <span class="hljs-number">4</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span> ** (<span class="hljs-number">3</span> ** <span class="hljs-number">2</span>));
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">10</span> - <span class="hljs-number">5</span> - <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">true</span> + <span class="hljs-literal">false</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5"</span> + <span class="hljs-number">3</span> + <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">3</span> + <span class="hljs-number">2</span> + <span class="hljs-string">"5"</span>);
</div></code></pre>
<h3 id="problem-2-comparison-challenges">Problem 2: Comparison Challenges</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Predict the output</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"10"</span> &gt; <span class="hljs-string">"9"</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"10"</span> &gt; <span class="hljs-number">9</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">null</span> == <span class="hljs-literal">undefined</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">null</span> === <span class="hljs-literal">undefined</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-literal">NaN</span> === <span class="hljs-literal">NaN</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-number">0</span> === <span class="hljs-number">-0</span>);
</div></code></pre>
<h3 id="problem-3-logical-operators">Problem 3: Logical Operators</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// What gets logged?</span>
<span class="hljs-keyword">const</span> a = <span class="hljs-string">"hello"</span>;
<span class="hljs-keyword">const</span> b = <span class="hljs-string">""</span>;
<span class="hljs-keyword">const</span> c = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">const</span> d = <span class="hljs-number">0</span>;

<span class="hljs-built_in">console</span>.log(a || b || c);
<span class="hljs-built_in">console</span>.log(a &amp;&amp; b &amp;&amp; c);
<span class="hljs-built_in">console</span>.log(c ?? d ?? a);
<span class="hljs-built_in">console</span>.log(!a &amp;&amp; !b);
<span class="hljs-built_in">console</span>.log(!!a &amp;&amp; !!b);
</div></code></pre>
<h3 id="problem-4-build-a-grade-calculator">Problem 4: Build a Grade Calculator</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that takes a score and returns a grade</span>
<span class="hljs-comment">// Use ternary operators and comparison operators</span>
<span class="hljs-comment">// 90+ = A, 80-89 = B, 70-79 = C, 60-69 = D, &lt;60 = F</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateGrade</span>(<span class="hljs-params">score</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-comment">// Test cases</span>
<span class="hljs-built_in">console</span>.log(calculateGrade(<span class="hljs-number">95</span>)); <span class="hljs-comment">// "A"</span>
<span class="hljs-built_in">console</span>.log(calculateGrade(<span class="hljs-number">85</span>)); <span class="hljs-comment">// "B"</span>
<span class="hljs-built_in">console</span>.log(calculateGrade(<span class="hljs-number">75</span>)); <span class="hljs-comment">// "C"</span>
<span class="hljs-built_in">console</span>.log(calculateGrade(<span class="hljs-number">65</span>)); <span class="hljs-comment">// "D"</span>
<span class="hljs-built_in">console</span>.log(calculateGrade(<span class="hljs-number">55</span>)); <span class="hljs-comment">// "F"</span>
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between <code>==</code> and <code>===</code>?</strong></p>
<ul>
<li><code>==</code> performs type coercion, <code>===</code> checks both value and type</li>
<li>Always use <code>===</code> unless you specifically need type coercion</li>
</ul>
<p><strong>Q: Explain operator precedence in JavaScript</strong></p>
<ul>
<li>Operators have different priorities (*, / before +, -)</li>
<li>Use parentheses to make intentions clear</li>
<li>Assignment is right-to-left associative</li>
</ul>
<p><strong>Q: What is short-circuit evaluation?</strong></p>
<ul>
<li><code>&amp;&amp;</code> stops at first falsy value</li>
<li><code>||</code> stops at first truthy value</li>
<li>Useful for conditional execution and default values</li>
</ul>
<p><strong>Q: What's the difference between <code>||</code> and <code>??</code>?</strong></p>
<ul>
<li><code>||</code> checks for any falsy value (0, &quot;&quot;, false, null, undefined)</li>
<li><code>??</code> only checks for null and undefined</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Microsoft</strong>: &quot;What does <code>0.1 + 0.2 === 0.3</code> return and why?&quot;</li>
<li><strong>Netflix</strong>: &quot;Explain the difference between <code>++i</code> and <code>i++</code>&quot;</li>
<li><strong>Spotify</strong>: &quot;How would you safely access a nested property?&quot;</li>
</ul>
<h2 id="%F0%9F%93%8A-operator-precedence-table-high-to-low">📊 Operator Precedence Table (High to Low)</h2>
<pre class="hljs"><code><div>1. () [] .           // Grouping, Member access
2. ++ -- ! + -       // Unary operators
3. **                // Exponentiation
4. * / %             // Multiplication, Division, Modulus
5. + -               // Addition, Subtraction
6. &lt; &lt;= &gt; &gt;=         // Relational
7. == != === !==     // Equality
8. &amp;&amp;                // Logical AND
9. ||                // Logical OR
10. ? :              // Conditional (ternary)
11. = += -= *= /=    // Assignment
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Always use <code>===</code> instead of <code>==</code> for comparisons</strong></li>
<li><strong>Understand operator precedence to avoid bugs</strong></li>
<li><strong>Use logical operators for defaults and short-circuiting</strong></li>
<li><strong>Be careful with floating-point arithmetic</strong></li>
<li><strong>Ternary operator is great for simple conditions</strong></li>
<li><strong><code>??</code> is better than <code>||</code> for null/undefined checks</strong></li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./01-variables-datatypes.md">← Variables &amp; Data Types</a><br>
<strong>Next Chapter</strong>: <a href="./03-control-flow.md">Control Flow →</a></p>
<p><strong>Practice</strong>: Try the problems above and experiment with different operator combinations!</p>
<h1 id="%F0%9F%94%80-chapter-3-control-flow">🔀 Chapter 3: Control Flow</h1>
<blockquote>
<p>Master the art of making decisions and repeating actions in your JavaScript programs.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Control flow is how your program makes decisions and repeats actions. Think of it like:</p>
<ul>
<li><strong>Conditional statements</strong> = traffic lights (if green, go; if red, stop)</li>
<li><strong>Loops</strong> = assembly lines (repeat the same action until done)</li>
<li><strong>Switch statements</strong> = elevator buttons (different action for each floor)</li>
</ul>
<p>Your code doesn't just run top to bottom - it can branch, loop, and jump based on conditions!</p>
<h2 id="%F0%9F%9A%A6-conditional-statements">🚦 Conditional Statements</h2>
<h3 id="if-statement">if Statement</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> age = <span class="hljs-number">18</span>;

<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"You can vote!"</span>);
}

<span class="hljs-comment">// Single line (no braces needed, but not recommended)</span>
<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>) <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"You can vote!"</span>);
</div></code></pre>
<h3 id="ifelse-statement">if...else Statement</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> temperature = <span class="hljs-number">25</span>;

<span class="hljs-keyword">if</span> (temperature &gt; <span class="hljs-number">30</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"It's hot outside!"</span>);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"It's not too hot."</span>);
}
</div></code></pre>
<h3 id="ifelse-ifelse-chain">if...else if...else Chain</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> score = <span class="hljs-number">85</span>;

<span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">90</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Grade: A"</span>);
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">80</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Grade: B"</span>);
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">70</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Grade: C"</span>);
} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (score &gt;= <span class="hljs-number">60</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Grade: D"</span>);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Grade: F"</span>);
}
</div></code></pre>
<h3 id="nested-if-statements">Nested if Statements</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> weather = <span class="hljs-string">"sunny"</span>;
<span class="hljs-keyword">const</span> temperature = <span class="hljs-number">25</span>;

<span class="hljs-keyword">if</span> (weather === <span class="hljs-string">"sunny"</span>) {
  <span class="hljs-keyword">if</span> (temperature &gt; <span class="hljs-number">20</span>) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Perfect day for a picnic!"</span>);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Sunny but a bit cold."</span>);
  }
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Maybe stay indoors."</span>);
}
</div></code></pre>
<h2 id="%F0%9F%94%84-switch-statement">🔄 Switch Statement</h2>
<h3 id="basic-switch">Basic Switch</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> day = <span class="hljs-string">"monday"</span>;

<span class="hljs-keyword">switch</span> (day) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">"monday"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Start of the work week"</span>);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"tuesday"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Tuesday blues"</span>);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"wednesday"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Hump day!"</span>);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"thursday"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Almost there"</span>);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"friday"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"TGIF!"</span>);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"saturday"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"sunday"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Weekend!"</span>);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">default</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Invalid day"</span>);
}
</div></code></pre>
<h3 id="switch-with-fall-through">Switch with Fall-through</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> month = <span class="hljs-string">"february"</span>;
<span class="hljs-keyword">let</span> days;

<span class="hljs-keyword">switch</span> (month) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">"january"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"march"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"may"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"july"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"august"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"october"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"december"</span>:
    days = <span class="hljs-number">31</span>;
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"april"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"june"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"september"</span>:
  <span class="hljs-keyword">case</span> <span class="hljs-string">"november"</span>:
    days = <span class="hljs-number">30</span>;
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"february"</span>:
    days = <span class="hljs-number">28</span>; <span class="hljs-comment">// Simplified (not accounting for leap years)</span>
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">default</span>:
    days = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Invalid month"</span>);
}

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${month}</span> has <span class="hljs-subst">${days}</span> days`</span>);
</div></code></pre>
<h3 id="switch-with-expressions-modern-pattern">Switch with Expressions (Modern Pattern)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> getSeasonMessage = <span class="hljs-function">(<span class="hljs-params">month</span>) =&gt;</span> {
  <span class="hljs-keyword">switch</span> (month) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"december"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"january"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"february"</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">"Winter is here! ❄️"</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"march"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"april"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"may"</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">"Spring has arrived! 🌸"</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"june"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"july"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"august"</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">"Summer time! ☀️"</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"september"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"october"</span>:
    <span class="hljs-keyword">case</span> <span class="hljs-string">"november"</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">"Autumn leaves! 🍂"</span>;
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> <span class="hljs-string">"Invalid month"</span>;
  }
};

<span class="hljs-built_in">console</span>.log(getSeasonMessage(<span class="hljs-string">"july"</span>)); <span class="hljs-comment">// "Summer time! ☀️"</span>
</div></code></pre>
<h2 id="%F0%9F%94%81-loops">🔁 Loops</h2>
<h3 id="for-loop">for Loop</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic for loop</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Iteration <span class="hljs-subst">${i}</span>`</span>);
}

<span class="hljs-comment">// Counting backwards</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">10</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Countdown: <span class="hljs-subst">${i}</span>`</span>);
}

<span class="hljs-comment">// Custom increment</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= <span class="hljs-number">20</span>; i += <span class="hljs-number">2</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Even number: <span class="hljs-subst">${i}</span>`</span>);
}

<span class="hljs-comment">// Multiple variables</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>, j = <span class="hljs-number">10</span>; i &lt; <span class="hljs-number">5</span>; i++, j--) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`i: <span class="hljs-subst">${i}</span>, j: <span class="hljs-subst">${j}</span>`</span>);
}
</div></code></pre>
<h3 id="while-loop">while Loop</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;

<span class="hljs-keyword">while</span> (count &lt; <span class="hljs-number">5</span>) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Count is: <span class="hljs-subst">${count}</span>`</span>);
  count++;
}

<span class="hljs-comment">// Reading user input (conceptual)</span>
<span class="hljs-keyword">let</span> userInput = <span class="hljs-string">""</span>;
<span class="hljs-keyword">while</span> (userInput !== <span class="hljs-string">"quit"</span>) {
  <span class="hljs-comment">// userInput = prompt("Enter command (or 'quit' to exit):");</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`You entered: <span class="hljs-subst">${userInput}</span>`</span>);
  <span class="hljs-keyword">break</span>; <span class="hljs-comment">// Prevent infinite loop in this example</span>
}
</div></code></pre>
<h3 id="dowhile-loop">do...while Loop</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">let</span> number;

<span class="hljs-keyword">do</span> {
  <span class="hljs-comment">// This runs at least once</span>
  number = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">10</span>) + <span class="hljs-number">1</span>;
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Generated number: <span class="hljs-subst">${number}</span>`</span>);
} <span class="hljs-keyword">while</span> (number !== <span class="hljs-number">7</span>);

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Found lucky number 7!"</span>);
</div></code></pre>
<h3 id="forin-loop-objects">for...in Loop (Objects)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
};

<span class="hljs-comment">// Iterate over object properties</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> person) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${person[key]}</span>`</span>);
}

<span class="hljs-comment">// With arrays (not recommended - use for...of instead)</span>
<span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> index <span class="hljs-keyword">in</span> colors) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Index <span class="hljs-subst">${index}</span>: <span class="hljs-subst">${colors[index]}</span>`</span>);
}
</div></code></pre>
<h3 id="forof-loop-iterables">for...of Loop (Iterables)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>];

<span class="hljs-comment">// Iterate over array values</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> fruit <span class="hljs-keyword">of</span> fruits) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`I like <span class="hljs-subst">${fruit}</span>`</span>);
}

<span class="hljs-comment">// With strings</span>
<span class="hljs-keyword">const</span> word = <span class="hljs-string">"hello"</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> letter <span class="hljs-keyword">of</span> word) {
  <span class="hljs-built_in">console</span>.log(letter.toUpperCase());
}

<span class="hljs-comment">// With index using entries()</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [index, fruit] <span class="hljs-keyword">of</span> fruits.entries()) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${index}</span>: <span class="hljs-subst">${fruit}</span>`</span>);
}
</div></code></pre>
<h2 id="%F0%9F%9B%91-loop-control-statements">🛑 Loop Control Statements</h2>
<h3 id="break-statement">break Statement</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Exit loop early</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
  <span class="hljs-keyword">if</span> (i === <span class="hljs-number">5</span>) {
    <span class="hljs-keyword">break</span>; <span class="hljs-comment">// Exit the loop when i equals 5</span>
  }
  <span class="hljs-built_in">console</span>.log(i); <span class="hljs-comment">// Prints 0, 1, 2, 3, 4</span>
}

<span class="hljs-comment">// Break from nested loops</span>
<span class="hljs-attr">outer</span>: <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) {
    <span class="hljs-keyword">if</span> (i === <span class="hljs-number">1</span> &amp;&amp; j === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">break</span> outer; <span class="hljs-comment">// Break from outer loop</span>
    }
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`i: <span class="hljs-subst">${i}</span>, j: <span class="hljs-subst">${j}</span>`</span>);
  }
}
</div></code></pre>
<h3 id="continue-statement">continue Statement</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Skip current iteration</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
  <span class="hljs-keyword">if</span> (i % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">continue</span>; <span class="hljs-comment">// Skip even numbers</span>
  }
  <span class="hljs-built_in">console</span>.log(i); <span class="hljs-comment">// Prints 1, 3, 5, 7, 9</span>
}

<span class="hljs-comment">// Continue with labeled loops</span>
<span class="hljs-attr">outer</span>: <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) {
    <span class="hljs-keyword">if</span> (j === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">continue</span> outer; <span class="hljs-comment">// Continue outer loop</span>
    }
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`i: <span class="hljs-subst">${i}</span>, j: <span class="hljs-subst">${j}</span>`</span>);
  }
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-modern-control-flow-patterns">🎯 Modern Control Flow Patterns</h2>
<h3 id="array-methods-for-control-flow">Array Methods for Control Flow</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>];

<span class="hljs-comment">// Instead of for loop with if</span>
<span class="hljs-keyword">const</span> evenNumbers = numbers.filter(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(evenNumbers); <span class="hljs-comment">// [2, 4, 6, 8, 10]</span>

<span class="hljs-comment">// Instead of for loop with transformation</span>
<span class="hljs-keyword">const</span> doubled = numbers.map(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num * <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(doubled); <span class="hljs-comment">// [2, 4, 6, 8, 10, 12, 14, 16, 18, 20]</span>

<span class="hljs-comment">// Instead of for loop with accumulation</span>
<span class="hljs-keyword">const</span> sum = numbers.reduce(<span class="hljs-function">(<span class="hljs-params">acc, num</span>) =&gt;</span> acc + num, <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(sum); <span class="hljs-comment">// 55</span>

<span class="hljs-comment">// Check conditions</span>
<span class="hljs-keyword">const</span> hasEven = numbers.some(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> allPositive = numbers.every(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num &gt; <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(hasEven, allPositive); <span class="hljs-comment">// true, true</span>
</div></code></pre>
<h3 id="optional-chaining--nullish-coalescing">Optional Chaining &amp; Nullish Coalescing</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">profile</span>: {
    <span class="hljs-attr">social</span>: {
      <span class="hljs-attr">twitter</span>: <span class="hljs-string">"@alice"</span>,
    },
  },
};

<span class="hljs-comment">// Old way (verbose)</span>
<span class="hljs-keyword">if</span> (
  user &amp;&amp;
  user.profile &amp;&amp;
  user.profile.social &amp;&amp;
  user.profile.social.twitter
) {
  <span class="hljs-built_in">console</span>.log(user.profile.social.twitter);
}

<span class="hljs-comment">// Modern way (ES2020)</span>
<span class="hljs-built_in">console</span>.log(user?.profile?.social?.twitter ?? <span class="hljs-string">"No Twitter"</span>);

<span class="hljs-comment">// With function calls</span>
user?.getName?.(); <span class="hljs-comment">// Only calls if getName exists</span>
</div></code></pre>
<h3 id="guard-clauses-early-returns">Guard Clauses (Early Returns)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Instead of nested if statements</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUser</span>(<span class="hljs-params">user</span>) </span>{
  <span class="hljs-comment">// Guard clauses</span>
  <span class="hljs-keyword">if</span> (!user) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"No user provided"</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">if</span> (!user.email) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User has no email"</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">if</span> (!user.isActive) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User is not active"</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// Main logic (not nested)</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Processing user: <span class="hljs-subst">${user.email}</span>`</span>);
  <span class="hljs-comment">// ... rest of the function</span>
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-missing-break-in-switch">1. Missing break in Switch</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> grade = <span class="hljs-string">"B"</span>;

<span class="hljs-keyword">switch</span> (grade) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">"A"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Excellent!"</span>);
  <span class="hljs-comment">// Missing break - falls through!</span>
  <span class="hljs-keyword">case</span> <span class="hljs-string">"B"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Good job!"</span>);
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"C"</span>:
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Not bad"</span>);
    <span class="hljs-keyword">break</span>;
}
<span class="hljs-comment">// If grade is "A", both "Excellent!" and "Good job!" will print</span>
</div></code></pre>
<h3 id="2-infinite-loops">2. Infinite Loops</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Infinite loop - forgot to increment</span>
<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>;
<span class="hljs-keyword">while</span> (i &lt; <span class="hljs-number">5</span>) {
  <span class="hljs-built_in">console</span>.log(i);
  <span class="hljs-comment">// i++; // Forgot this!</span>
}

<span class="hljs-comment">// ❌ Wrong condition</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &gt; <span class="hljs-number">-5</span>; i++) {
  <span class="hljs-comment">// Should be i &lt; 5</span>
  <span class="hljs-built_in">console</span>.log(i);
}
</div></code></pre>
<h3 id="3-off-by-one-errors">3. Off-by-One Errors</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// ❌ Goes beyond array length</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= arr.length; i++) {
  <span class="hljs-built_in">console</span>.log(arr[i]); <span class="hljs-comment">// arr[5] is undefined!</span>
}

<span class="hljs-comment">// ✅ Correct</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
  <span class="hljs-built_in">console</span>.log(arr[i]);
}
</div></code></pre>
<h3 id="4-variable-scope-in-loops">4. Variable Scope in Loops</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Common mistake with var</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(i); <span class="hljs-comment">// Prints 3, 3, 3</span>
  }, <span class="hljs-number">100</span>);
}

<span class="hljs-comment">// ✅ Fixed with let</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(i); <span class="hljs-comment">// Prints 0, 1, 2</span>
  }, <span class="hljs-number">100</span>);
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when--why-to-use">🎯 When &amp; Why to Use</h2>
<h3 id="choose-the-right-loop">Choose the Right Loop</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Use for...of for arrays when you need values</span>
<span class="hljs-keyword">const</span> items = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> item <span class="hljs-keyword">of</span> items) {
  <span class="hljs-built_in">console</span>.log(item);
}

<span class="hljs-comment">// Use for...in for objects when you need keys</span>
<span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">x</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> obj) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${obj[key]}</span>`</span>);
}

<span class="hljs-comment">// Use traditional for when you need index control</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${i}</span>: <span class="hljs-subst">${items[i]}</span>`</span>);
}

<span class="hljs-comment">// Use while when you don't know iteration count</span>
<span class="hljs-keyword">while</span> (condition) {
  <span class="hljs-comment">// Do something until condition becomes false</span>
}
</div></code></pre>
<h3 id="choose-if-vs-switch">Choose if vs Switch</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Use if for complex conditions</span>
<span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span> &amp;&amp; hasLicense &amp;&amp; !isSuspended) {
  allowDriving();
}

<span class="hljs-comment">// Use switch for multiple discrete values</span>
<span class="hljs-keyword">switch</span> (userRole) {
  <span class="hljs-keyword">case</span> <span class="hljs-string">"admin"</span>:
    showAdminPanel();
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"user"</span>:
    showUserDashboard();
    <span class="hljs-keyword">break</span>;
  <span class="hljs-keyword">case</span> <span class="hljs-string">"guest"</span>:
    showPublicContent();
    <span class="hljs-keyword">break</span>;
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-fizzbuzz-classic">Problem 1: FizzBuzz Classic</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Print numbers 1-100, but:</span>
<span class="hljs-comment">// - "Fizz" for multiples of 3</span>
<span class="hljs-comment">// - "Buzz" for multiples of 5</span>
<span class="hljs-comment">// - "FizzBuzz" for multiples of both</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fizzBuzz</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

fizzBuzz();
</div></code></pre>
<h3 id="problem-2-grade-calculator">Problem 2: Grade Calculator</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Convert numeric scores to letter grades</span>
<span class="hljs-comment">// Use both if/else and switch approaches</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getGrade</span>(<span class="hljs-params">score</span>) </span>{
  <span class="hljs-comment">// Your code here using if/else</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getGradeSwitch</span>(<span class="hljs-params">score</span>) </span>{
  <span class="hljs-comment">// Your code here using switch</span>
  <span class="hljs-comment">// Hint: Use Math.floor(score/10)</span>
}

<span class="hljs-built_in">console</span>.log(getGrade(<span class="hljs-number">95</span>)); <span class="hljs-comment">// "A"</span>
<span class="hljs-built_in">console</span>.log(getGrade(<span class="hljs-number">85</span>)); <span class="hljs-comment">// "B"</span>
<span class="hljs-built_in">console</span>.log(getGrade(<span class="hljs-number">75</span>)); <span class="hljs-comment">// "C"</span>
</div></code></pre>
<h3 id="problem-3-pattern-printing">Problem 3: Pattern Printing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Print this pattern:</span>
<span class="hljs-comment">// *</span>
<span class="hljs-comment">// **</span>
<span class="hljs-comment">// ***</span>
<span class="hljs-comment">// ****</span>
<span class="hljs-comment">// *****</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">printTriangle</span>(<span class="hljs-params">height</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

printTriangle(<span class="hljs-number">5</span>);
</div></code></pre>
<h3 id="problem-4-find-prime-numbers">Problem 4: Find Prime Numbers</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Find all prime numbers up to n</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findPrimes</span>(<span class="hljs-params">n</span>) </span>{
  <span class="hljs-keyword">const</span> primes = [];
  <span class="hljs-comment">// Your code here</span>
  <span class="hljs-keyword">return</span> primes;
}

<span class="hljs-built_in">console</span>.log(findPrimes(<span class="hljs-number">20</span>)); <span class="hljs-comment">// [2, 3, 5, 7, 11, 13, 17, 19]</span>
</div></code></pre>
<h3 id="problem-5-nested-loop-challenge">Problem 5: Nested Loop Challenge</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a multiplication table</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">multiplicationTable</span>(<span class="hljs-params">size</span>) </span>{
  <span class="hljs-comment">// Print a size x size multiplication table</span>
  <span class="hljs-comment">// Example for size 3:</span>
  <span class="hljs-comment">// 1  2  3</span>
  <span class="hljs-comment">// 2  4  6</span>
  <span class="hljs-comment">// 3  6  9</span>
}

multiplicationTable(<span class="hljs-number">5</span>);
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between <code>for...in</code> and <code>for...of</code>?</strong></p>
<ul>
<li><code>for...in</code> iterates over enumerable properties (keys)</li>
<li><code>for...of</code> iterates over iterable values</li>
<li>Use <code>for...in</code> for objects, <code>for...of</code> for arrays</li>
</ul>
<p><strong>Q: When would you use a <code>while</code> loop vs a <code>for</code> loop?</strong></p>
<ul>
<li><code>for</code> loop: when you know the number of iterations</li>
<li><code>while</code> loop: when you iterate until a condition is met</li>
</ul>
<p><strong>Q: What happens if you forget <code>break</code> in a switch statement?</strong></p>
<ul>
<li>Fall-through behavior - execution continues to next case</li>
<li>Sometimes intentional, but usually a bug</li>
</ul>
<p><strong>Q: How do you break out of nested loops?</strong></p>
<ul>
<li>Use labeled statements with <code>break labelName</code></li>
<li>Or use a function and <code>return</code></li>
<li>Or use a flag variable</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement FizzBuzz without using if statements&quot;</li>
<li><strong>Amazon</strong>: &quot;Find the first duplicate in an array using loops&quot;</li>
<li><strong>Facebook</strong>: &quot;Explain the difference between <code>break</code> and <code>continue</code>&quot;</li>
<li><strong>Microsoft</strong>: &quot;How would you avoid infinite loops?&quot;</li>
</ul>
<h2 id="%F0%9F%93%8A-control-flow-decision-tree">📊 Control Flow Decision Tree</h2>
<pre class="hljs"><code><div>Need to make decisions?
├── Simple condition → if/else
├── Multiple discrete values → switch
└── Complex conditions → if/else if/else

Need to repeat actions?
├── Known iterations → for loop
├── Unknown iterations → while loop
├── At least once → do...while
├── Array values → for...of
└── Object properties → for...in
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Use <code>===</code> in conditions, not <code>==</code></strong></li>
<li><strong>Always include <code>break</code> in switch cases (unless fall-through is intended)</strong></li>
<li><strong>Prefer <code>for...of</code> for arrays, <code>for...in</code> for objects</strong></li>
<li><strong>Use guard clauses to reduce nesting</strong></li>
<li><strong>Consider array methods instead of manual loops</strong></li>
<li><strong>Be careful with loop conditions to avoid infinite loops</strong></li>
<li><strong>Use <code>let</code> instead of <code>var</code> in loops</strong></li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./02-operators-expressions.md">← Operators &amp; Expressions</a><br>
<strong>Next Chapter</strong>: <a href="./04-functions.md">Functions Deep Dive →</a></p>
<p><strong>Practice</strong>: Try the FizzBuzz problem and experiment with different loop types!</p>
<h1 id="%F0%9F%94%A7-chapter-4-functions-deep-dive">🔧 Chapter 4: Functions Deep Dive</h1>
<blockquote>
<p>Master JavaScript functions: the building blocks of reusable, modular code.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Functions are like recipes or machines:</p>
<ul>
<li><strong>Input</strong> = ingredients (parameters)</li>
<li><strong>Process</strong> = cooking steps (function body)</li>
<li><strong>Output</strong> = finished dish (return value)</li>
</ul>
<p>They let you write code once and use it many times, making your programs organized and efficient.</p>
<h2 id="%F0%9F%8F%97%EF%B8%8F-function-declaration">🏗️ Function Declaration</h2>
<h3 id="basic-function-declaration">Basic Function Declaration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Function declaration - hoisted to top</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greet</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>;
}

<span class="hljs-comment">// Can be called before declaration due to hoisting</span>
<span class="hljs-built_in">console</span>.log(sayHi(<span class="hljs-string">"Alice"</span>)); <span class="hljs-comment">// Works!</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sayHi</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hi there, <span class="hljs-subst">${name}</span>!`</span>;
}
</div></code></pre>
<h3 id="function-with-multiple-parameters">Function with Multiple Parameters</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateArea</span>(<span class="hljs-params">length, width</span>) </span>{
  <span class="hljs-keyword">return</span> length * width;
}

<span class="hljs-keyword">const</span> area = calculateArea(<span class="hljs-number">10</span>, <span class="hljs-number">5</span>);
<span class="hljs-built_in">console</span>.log(area); <span class="hljs-comment">// 50</span>
</div></code></pre>
<h3 id="function-with-default-parameters-es6">Function with Default Parameters (ES6)</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greetUser</span>(<span class="hljs-params">name = <span class="hljs-string">"Guest"</span>, greeting = <span class="hljs-string">"Hello"</span></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${greeting}</span>, <span class="hljs-subst">${name}</span>!`</span>;
}

<span class="hljs-built_in">console</span>.log(greetUser()); <span class="hljs-comment">// "Hello, Guest!"</span>
<span class="hljs-built_in">console</span>.log(greetUser(<span class="hljs-string">"Alice"</span>)); <span class="hljs-comment">// "Hello, Alice!"</span>
<span class="hljs-built_in">console</span>.log(greetUser(<span class="hljs-string">"Bob"</span>, <span class="hljs-string">"Hi"</span>)); <span class="hljs-comment">// "Hi, Bob!"</span>
</div></code></pre>
<h3 id="rest-parameters-args">Rest Parameters (...args)</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sum</span>(<span class="hljs-params">...numbers</span>) </span>{
  <span class="hljs-keyword">return</span> numbers.reduce(<span class="hljs-function">(<span class="hljs-params">total, num</span>) =&gt;</span> total + num, <span class="hljs-number">0</span>);
}

<span class="hljs-built_in">console</span>.log(sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// 6</span>
<span class="hljs-built_in">console</span>.log(sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// 15</span>

<span class="hljs-comment">// Mix regular params with rest</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">introduce</span>(<span class="hljs-params">firstName, lastName, ...hobbies</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`I'm <span class="hljs-subst">${firstName}</span> <span class="hljs-subst">${lastName}</span>`</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`My hobbies: <span class="hljs-subst">${hobbies.join(<span class="hljs-string">", "</span>)}</span>`</span>);
}

introduce(<span class="hljs-string">"John"</span>, <span class="hljs-string">"Doe"</span>, <span class="hljs-string">"reading"</span>, <span class="hljs-string">"coding"</span>, <span class="hljs-string">"gaming"</span>);
</div></code></pre>
<h2 id="%F0%9F%93%9D-function-expressions">📝 Function Expressions</h2>
<h3 id="anonymous-function-expression">Anonymous Function Expression</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Function expression - not hoisted</span>
<span class="hljs-keyword">const</span> multiply = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a * b;
};

<span class="hljs-built_in">console</span>.log(multiply(<span class="hljs-number">4</span>, <span class="hljs-number">5</span>)); <span class="hljs-comment">// 20</span>

<span class="hljs-comment">// This would cause an error:</span>
<span class="hljs-comment">// console.log(divide(10, 2)); // ReferenceError!</span>

<span class="hljs-keyword">const</span> divide = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a / b;
};
</div></code></pre>
<h3 id="named-function-expression">Named Function Expression</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> factorial = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fact</span>(<span class="hljs-params">n</span>) </span>{
  <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
  <span class="hljs-keyword">return</span> n * fact(n - <span class="hljs-number">1</span>); <span class="hljs-comment">// Can reference itself by name</span>
};

<span class="hljs-built_in">console</span>.log(factorial(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 120</span>
<span class="hljs-comment">// console.log(fact(5)); // ReferenceError - name only available inside</span>
</div></code></pre>
<h3 id="immediately-invoked-function-expression-iife">Immediately Invoked Function Expression (IIFE)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// IIFE - runs immediately</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"This runs right away!"</span>);
})();

<span class="hljs-comment">// IIFE with parameters</span>
(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>);
})(<span class="hljs-string">"World"</span>);

<span class="hljs-comment">// IIFE with return value</span>
<span class="hljs-keyword">const</span> result = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a + b;
})(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);

<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// 8</span>
</div></code></pre>
<h2 id="%F0%9F%8F%B9-arrow-functions-es6">🏹 Arrow Functions (ES6)</h2>
<h3 id="basic-arrow-function-syntax">Basic Arrow Function Syntax</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Traditional function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// Arrow function - concise</span>
<span class="hljs-keyword">const</span> addArrow = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b;

<span class="hljs-comment">// Both work the same</span>
<span class="hljs-built_in">console</span>.log(add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// 5</span>
<span class="hljs-built_in">console</span>.log(addArrow(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// 5</span>
</div></code></pre>
<h3 id="arrow-function-variations">Arrow Function Variations</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// No parameters</span>
<span class="hljs-keyword">const</span> sayHello = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">"Hello!"</span>;

<span class="hljs-comment">// One parameter (parentheses optional)</span>
<span class="hljs-keyword">const</span> square = <span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x * x;
<span class="hljs-keyword">const</span> squareExplicit = <span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x * x; <span class="hljs-comment">// Same thing</span>

<span class="hljs-comment">// Multiple parameters</span>
<span class="hljs-keyword">const</span> multiply = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a * b;

<span class="hljs-comment">// Block body (need explicit return)</span>
<span class="hljs-keyword">const</span> complexFunction = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> sum = x + y;
  <span class="hljs-keyword">const</span> product = x * y;
  <span class="hljs-keyword">return</span> { sum, product };
};

<span class="hljs-built_in">console</span>.log(complexFunction(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>)); <span class="hljs-comment">// { sum: 7, product: 12 }</span>
</div></code></pre>
<h3 id="arrow-functions-with-arrays">Arrow Functions with Arrays</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// Traditional way</span>
<span class="hljs-keyword">const</span> doubled = numbers.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) </span>{
  <span class="hljs-keyword">return</span> num * <span class="hljs-number">2</span>;
});

<span class="hljs-comment">// Arrow function way</span>
<span class="hljs-keyword">const</span> doubledArrow = numbers.map(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num * <span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> evens = numbers.filter(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> sum = numbers.reduce(<span class="hljs-function">(<span class="hljs-params">acc, num</span>) =&gt;</span> acc + num, <span class="hljs-number">0</span>);

<span class="hljs-built_in">console</span>.log(doubledArrow); <span class="hljs-comment">// [2, 4, 6, 8, 10]</span>
<span class="hljs-built_in">console</span>.log(evens); <span class="hljs-comment">// [2, 4]</span>
<span class="hljs-built_in">console</span>.log(sum); <span class="hljs-comment">// 15</span>
</div></code></pre>
<h2 id="%F0%9F%94%84-function-scope--closures-preview">🔄 Function Scope &amp; Closures Preview</h2>
<h3 id="local-vs-global-scope">Local vs Global Scope</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> globalVar = <span class="hljs-string">"I'm global"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testScope</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> localVar = <span class="hljs-string">"I'm local"</span>;
  <span class="hljs-built_in">console</span>.log(globalVar); <span class="hljs-comment">// Can access global</span>
  <span class="hljs-built_in">console</span>.log(localVar); <span class="hljs-comment">// Can access local</span>
}

testScope();
<span class="hljs-built_in">console</span>.log(globalVar); <span class="hljs-comment">// Works</span>
<span class="hljs-comment">// console.log(localVar); // ReferenceError!</span>
</div></code></pre>
<h3 id="function-parameters-shadow-global-variables">Function Parameters Shadow Global Variables</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> name = <span class="hljs-string">"Global Alice"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greet</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>); <span class="hljs-comment">// Uses parameter, not global</span>
}

greet(<span class="hljs-string">"Local Bob"</span>); <span class="hljs-comment">// "Hello, Local Bob!"</span>
<span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// Still "Global Alice"</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-advanced-function-concepts">🎯 Advanced Function Concepts</h2>
<h3 id="functions-as-first-class-citizens">Functions as First-Class Citizens</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Functions can be assigned to variables</span>
<span class="hljs-keyword">const</span> myFunc = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello!"</span>;
};

<span class="hljs-comment">// Functions can be passed as arguments</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">executeFunction</span>(<span class="hljs-params">fn</span>) </span>{
  <span class="hljs-keyword">return</span> fn();
}

<span class="hljs-built_in">console</span>.log(executeFunction(myFunc)); <span class="hljs-comment">// "Hello!"</span>

<span class="hljs-comment">// Functions can be returned from other functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createMultiplier</span>(<span class="hljs-params">factor</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">number</span>) </span>{
    <span class="hljs-keyword">return</span> number * factor;
  };
}

<span class="hljs-keyword">const</span> double = createMultiplier(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> triple = createMultiplier(<span class="hljs-number">3</span>);

<span class="hljs-built_in">console</span>.log(double(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 10</span>
<span class="hljs-built_in">console</span>.log(triple(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 15</span>
</div></code></pre>
<h3 id="higher-order-functions">Higher-Order Functions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Function that takes other functions as arguments</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processArray</span>(<span class="hljs-params">arr, callback</span>) </span>{
  <span class="hljs-keyword">const</span> result = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; arr.length; i++) {
    result.push(callback(arr[i], i));
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// Different callbacks for different behaviors</span>
<span class="hljs-keyword">const</span> squared = processArray(numbers, (x) =&gt; x * x);
<span class="hljs-keyword">const</span> withIndex = processArray(numbers, (x, i) =&gt; <span class="hljs-string">`<span class="hljs-subst">${i}</span>: <span class="hljs-subst">${x}</span>`</span>);

<span class="hljs-built_in">console</span>.log(squared); <span class="hljs-comment">// [1, 4, 9, 16, 25]</span>
<span class="hljs-built_in">console</span>.log(withIndex); <span class="hljs-comment">// ["0: 1", "1: 2", "2: 3", "3: 4", "4: 5"]</span>
</div></code></pre>
<h3 id="callback-functions">Callback Functions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Simulating asynchronous operation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchData</span>(<span class="hljs-params">callback</span>) </span>{
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> data = { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
    callback(data);
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">// Using the callback</span>
fetchData(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Received data:"</span>, data);
});

<span class="hljs-comment">// Arrow function callback</span>
fetchData(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Data:"</span>, data));
</div></code></pre>
<h2 id="%F0%9F%94%A7-function-methods">🔧 Function Methods</h2>
<h3 id="call-method">call() Method</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">introduce</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hi, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> and I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span> years old.`</span>;
}

<span class="hljs-keyword">const</span> person1 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> };
<span class="hljs-keyword">const</span> person2 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };

<span class="hljs-comment">// Call function with different 'this' context</span>
<span class="hljs-built_in">console</span>.log(introduce.call(person1)); <span class="hljs-comment">// "Hi, I'm Alice and I'm 25 years old."</span>
<span class="hljs-built_in">console</span>.log(introduce.call(person2)); <span class="hljs-comment">// "Hi, I'm Bob and I'm 30 years old."</span>

<span class="hljs-comment">// call() with arguments</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greetWithTitle</span>(<span class="hljs-params">title</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${title}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
}

<span class="hljs-built_in">console</span>.log(greetWithTitle.call(person1, <span class="hljs-string">"Dr."</span>)); <span class="hljs-comment">// "Dr. Alice"</span>
</div></code></pre>
<h3 id="apply-method">apply() Method</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sum</span>(<span class="hljs-params">a, b, c</span>) </span>{
  <span class="hljs-keyword">return</span> a + b + c;
}

<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-comment">// apply() takes array of arguments</span>
<span class="hljs-built_in">console</span>.log(sum.apply(<span class="hljs-literal">null</span>, numbers)); <span class="hljs-comment">// 6</span>

<span class="hljs-comment">// Equivalent to:</span>
<span class="hljs-built_in">console</span>.log(sum.call(<span class="hljs-literal">null</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// 6</span>

<span class="hljs-comment">// Modern way with spread operator</span>
<span class="hljs-built_in">console</span>.log(sum(...numbers)); <span class="hljs-comment">// 6</span>
</div></code></pre>
<h3 id="bind-method">bind() Method</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">greet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">greeting</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${greeting}</span>, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>!`</span>;
  },
};

<span class="hljs-comment">// bind() creates new function with fixed 'this'</span>
<span class="hljs-keyword">const</span> boundGreet = person.greet.bind(person);
<span class="hljs-built_in">console</span>.log(boundGreet(<span class="hljs-string">"Hello"</span>)); <span class="hljs-comment">// "Hello, I'm Alice!"</span>

<span class="hljs-comment">// Partial application with bind()</span>
<span class="hljs-keyword">const</span> sayHello = person.greet.bind(person, <span class="hljs-string">"Hello"</span>);
<span class="hljs-built_in">console</span>.log(sayHello()); <span class="hljs-comment">// "Hello, I'm Alice!"</span>
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-arrow-functions-and-this">1. Arrow Functions and 'this'</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,

  <span class="hljs-comment">// Regular function - 'this' refers to obj</span>
  <span class="hljs-attr">regularMethod</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.name); <span class="hljs-comment">// "Alice"</span>
  },

  <span class="hljs-comment">// Arrow function - 'this' refers to outer scope</span>
  <span class="hljs-attr">arrowMethod</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.name); <span class="hljs-comment">// undefined (or global)</span>
  },
};

obj.regularMethod(); <span class="hljs-comment">// "Alice"</span>
obj.arrowMethod(); <span class="hljs-comment">// undefined</span>
</div></code></pre>
<h3 id="2-hoisting-differences">2. Hoisting Differences</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Function declarations are fully hoisted</span>
<span class="hljs-built_in">console</span>.log(declared()); <span class="hljs-comment">// "Works!"</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">declared</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"Works!"</span>;
}

<span class="hljs-comment">// Function expressions are not hoisted</span>
<span class="hljs-comment">// console.log(expressed()); // TypeError!</span>

<span class="hljs-keyword">const</span> expressed = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"Works!"</span>;
};
</div></code></pre>
<h3 id="3-modifying-parameters">3. Modifying Parameters</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Primitive parameters are passed by value</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeNumber</span>(<span class="hljs-params">num</span>) </span>{
  num = <span class="hljs-number">100</span>;
}

<span class="hljs-keyword">let</span> x = <span class="hljs-number">5</span>;
changeNumber(x);
<span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// Still 5</span>

<span class="hljs-comment">// Object parameters are passed by reference</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">changeObject</span>(<span class="hljs-params">obj</span>) </span>{
  obj.name = <span class="hljs-string">"Changed"</span>;
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
changeObject(person);
<span class="hljs-built_in">console</span>.log(person.name); <span class="hljs-comment">// "Changed"</span>
</div></code></pre>
<h3 id="4-closure-memory-leaks">4. Closure Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Potential memory leak</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createHandler</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> largeData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>).fill(<span class="hljs-string">"data"</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// Even if we don't use largeData, it's kept in memory</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Handler called"</span>);
  };
}

<span class="hljs-comment">// Better: only close over what you need</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createHandlerBetter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> largeData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>).fill(<span class="hljs-string">"data"</span>);
  <span class="hljs-keyword">const</span> needed = largeData.length; <span class="hljs-comment">// Extract only what's needed</span>

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Handler called, data size: <span class="hljs-subst">${needed}</span>`</span>);
  };
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when--why-to-use">🎯 When &amp; Why to Use</h2>
<h3 id="function-declaration-vs-expression-vs-arrow">Function Declaration vs Expression vs Arrow</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Use function declarations for main functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateTax</span>(<span class="hljs-params">amount, rate</span>) </span>{
  <span class="hljs-keyword">return</span> amount * rate;
}

<span class="hljs-comment">// Use function expressions when assigning conditionally</span>
<span class="hljs-keyword">const</span> operation = isAddition
  ? <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{
      <span class="hljs-keyword">return</span> a + b;
    }
  : <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">a, b</span>) </span>{
      <span class="hljs-keyword">return</span> a - b;
    };

<span class="hljs-comment">// Use arrow functions for short callbacks</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> doubled = numbers.map(<span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n * <span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> evens = numbers.filter(<span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);

<span class="hljs-comment">// Use regular functions when you need 'this' binding</span>
<span class="hljs-keyword">const</span> button = {
  <span class="hljs-attr">text</span>: <span class="hljs-string">"Click me"</span>,
  <span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.text); <span class="hljs-comment">// Need 'this' to refer to button</span>
  },
};
</div></code></pre>
<h3 id="when-to-use-each-pattern">When to Use Each Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Pure functions (no side effects) - preferred</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a + b; <span class="hljs-comment">// Only depends on inputs</span>
}

<span class="hljs-comment">// Functions with side effects - be careful</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logAndAdd</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Adding <span class="hljs-subst">${a}</span> + <span class="hljs-subst">${b}</span>`</span>); <span class="hljs-comment">// Side effect</span>
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// Higher-order functions for reusability</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createValidator</span>(<span class="hljs-params">rule</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>{
    <span class="hljs-keyword">return</span> rule(value);
  };
}

<span class="hljs-keyword">const</span> isEmail = createValidator(<span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> val.includes(<span class="hljs-string">"@"</span>));
<span class="hljs-keyword">const</span> isLongEnough = createValidator(<span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> val.length &gt;= <span class="hljs-number">8</span>);
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-function-variations">Problem 1: Function Variations</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create the same function using all three methods:</span>
<span class="hljs-comment">// 1. Function declaration</span>
<span class="hljs-comment">// 2. Function expression</span>
<span class="hljs-comment">// 3. Arrow function</span>
<span class="hljs-comment">// Function should calculate compound interest</span>

<span class="hljs-comment">// Formula: A = P(1 + r/n)^(nt)</span>
<span class="hljs-comment">// P = principal, r = rate, n = compounds per year, t = time</span>

<span class="hljs-comment">// Your implementations here:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateInterest1</span>(<span class="hljs-params">principal, rate, compounds, time</span>) </span>{
  <span class="hljs-comment">// Function declaration</span>
}

<span class="hljs-keyword">const</span> calculateInterest2 = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">principal, rate, compounds, time</span>) </span>{
  <span class="hljs-comment">// Function expression</span>
};

<span class="hljs-keyword">const</span> calculateInterest3 = <span class="hljs-function">(<span class="hljs-params">principal, rate, compounds, time</span>) =&gt;</span> {
  <span class="hljs-comment">// Arrow function</span>
};
</div></code></pre>
<h3 id="problem-2-higher-order-function">Problem 2: Higher-Order Function</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that takes an array and a callback</span>
<span class="hljs-comment">// and returns a new array with the callback applied to each element</span>
<span class="hljs-comment">// but only if the element passes a test function</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapIf</span>(<span class="hljs-params">array, testFn, mapFn</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-comment">// Test it:</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>];
<span class="hljs-keyword">const</span> result = mapIf(
  numbers,
  (n) =&gt; n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>, <span class="hljs-comment">// test: only even numbers</span>
  (n) =&gt; n * n <span class="hljs-comment">// map: square them</span>
);
<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// Should output: [4, 16, 36]</span>
</div></code></pre>
<h3 id="problem-3-function-factory">Problem 3: Function Factory</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that returns customized greeting functions</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createGreeter</span>(<span class="hljs-params">greeting, punctuation = <span class="hljs-string">"!"</span></span>) </span>{
  <span class="hljs-comment">// Return a function that greets with the given style</span>
}

<span class="hljs-comment">// Test it:</span>
<span class="hljs-keyword">const</span> casualGreet = createGreeter(<span class="hljs-string">"Hey"</span>);
<span class="hljs-keyword">const</span> formalGreet = createGreeter(<span class="hljs-string">"Good morning"</span>, <span class="hljs-string">"."</span>);
<span class="hljs-keyword">const</span> excitedGreet = createGreeter(<span class="hljs-string">"Wow"</span>, <span class="hljs-string">"!!!"</span>);

<span class="hljs-built_in">console</span>.log(casualGreet(<span class="hljs-string">"Alice"</span>)); <span class="hljs-comment">// "Hey, Alice!"</span>
<span class="hljs-built_in">console</span>.log(formalGreet(<span class="hljs-string">"Mr. Smith"</span>)); <span class="hljs-comment">// "Good morning, Mr. Smith."</span>
<span class="hljs-built_in">console</span>.log(excitedGreet(<span class="hljs-string">"everyone"</span>)); <span class="hljs-comment">// "Wow, everyone!!!"</span>
</div></code></pre>
<h3 id="problem-4-callback-pattern">Problem 4: Callback Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that processes an array with different strategies</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processNumbers</span>(<span class="hljs-params">numbers, strategy</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-comment">// Test with different strategies:</span>
<span class="hljs-keyword">const</span> nums = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-keyword">const</span> sum = processNumbers(nums, (acc, curr) =&gt; acc + curr);
<span class="hljs-keyword">const</span> product = processNumbers(nums, (acc, curr) =&gt; acc * curr);
<span class="hljs-keyword">const</span> max = processNumbers(nums, (acc, curr) =&gt; <span class="hljs-built_in">Math</span>.max(acc, curr));

<span class="hljs-built_in">console</span>.log(sum, product, max); <span class="hljs-comment">// 15, 120, 5</span>
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between function declaration and function expression?</strong></p>
<ul>
<li>Function declarations are hoisted completely</li>
<li>Function expressions are not hoisted</li>
<li>Function declarations create a named function in the current scope</li>
</ul>
<p><strong>Q: When should you use arrow functions vs regular functions?</strong></p>
<ul>
<li>Arrow functions: short callbacks, when you don't need <code>this</code> binding</li>
<li>Regular functions: methods, constructors, when you need <code>this</code> context</li>
</ul>
<p><strong>Q: What is a closure?</strong></p>
<ul>
<li>A function that has access to variables from its outer scope</li>
<li>Even after the outer function has returned</li>
<li>Creates a &quot;persistent scope&quot;</li>
</ul>
<p><strong>Q: Explain call(), apply(), and bind()</strong></p>
<ul>
<li><code>call()</code>: invokes function with specific <code>this</code> and individual arguments</li>
<li><code>apply()</code>: invokes function with specific <code>this</code> and array of arguments</li>
<li><code>bind()</code>: creates new function with specific <code>this</code> (doesn't invoke)</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement a function that can be called with any number of arguments&quot;</li>
<li><strong>Facebook</strong>: &quot;What's the difference between <code>function</code> and <code>=&gt;</code>?&quot;</li>
<li><strong>Amazon</strong>: &quot;Create a function that remembers its previous calls&quot;</li>
<li><strong>Netflix</strong>: &quot;Explain function hoisting with examples&quot;</li>
</ul>
<h2 id="%F0%9F%93%8A-function-types-summary">📊 Function Types Summary</h2>
<pre class="hljs"><code><div>Function Types
├── Declaration
│   ├── Hoisted ✅
│   ├── Named ✅
│   └── Block scoped (in strict mode)
├── Expression
│   ├── Not hoisted ❌
│   ├── Can be anonymous
│   └── Can be assigned conditionally
└── Arrow
    ├── Concise syntax ✅
    ├── No 'this' binding ❌
    ├── No 'arguments' object ❌
    └── Cannot be constructor ❌
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Use function declarations for main functions (hoisting benefit)</strong></li>
<li><strong>Use arrow functions for short callbacks and array methods</strong></li>
<li><strong>Regular functions when you need <code>this</code> context</strong></li>
<li><strong>Functions are first-class citizens - can be passed around</strong></li>
<li><strong>Understand the difference between call, apply, and bind</strong></li>
<li><strong>Be careful with arrow functions and <code>this</code> binding</strong></li>
<li><strong>Use default parameters instead of checking for undefined</strong></li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./03-control-flow.md">← Control Flow</a><br>
<strong>Next Chapter</strong>: <a href="./05-scope-hoisting.md">Scope, Hoisting &amp; TDZ →</a></p>
<p><strong>Practice</strong>: Try creating functions using all three methods and experiment with callbacks!</p>
<h1 id="%F0%9F%94%8D-chapter-5-scope-hoisting--tdz">🔍 Chapter 5: Scope, Hoisting &amp; TDZ</h1>
<blockquote>
<p>Understand how JavaScript manages variable access, memory, and execution context.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Think of scope like rooms in a house:</p>
<ul>
<li><strong>Global scope</strong> = the main living area (everyone can access)</li>
<li><strong>Function scope</strong> = private bedrooms (only family members can enter)</li>
<li><strong>Block scope</strong> = closets (only the person in that room can access)</li>
</ul>
<p>Hoisting is like JavaScript &quot;reading ahead&quot; - it sees all your variable declarations before running your code, but not their values.</p>
<h2 id="%F0%9F%8F%A0-understanding-scope">🏠 Understanding Scope</h2>
<h3 id="global-scope">Global Scope</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Global scope - accessible everywhere</span>
<span class="hljs-keyword">const</span> globalVar = <span class="hljs-string">"I'm global!"</span>;
<span class="hljs-keyword">var</span> alsoGlobal = <span class="hljs-string">"Me too!"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">testGlobal</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(globalVar); <span class="hljs-comment">// ✅ Can access global variables</span>
  <span class="hljs-built_in">console</span>.log(alsoGlobal); <span class="hljs-comment">// ✅ Can access global variables</span>
}

testGlobal();
<span class="hljs-built_in">console</span>.log(globalVar); <span class="hljs-comment">// ✅ Accessible outside functions</span>

<span class="hljs-comment">// Be careful - implicit globals (avoid!)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createImplicitGlobal</span>(<span class="hljs-params"></span>) </span>{
  implicitGlobal = <span class="hljs-string">"Oops, I'm global!"</span>; <span class="hljs-comment">// No var/let/const = global!</span>
}

createImplicitGlobal();
<span class="hljs-built_in">console</span>.log(implicitGlobal); <span class="hljs-comment">// "Oops, I'm global!"</span>
</div></code></pre>
<h3 id="function-scope">Function Scope</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outerFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> outerVar = <span class="hljs-string">"I'm in outer function"</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">innerFunction</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> innerVar = <span class="hljs-string">"I'm in inner function"</span>;
    <span class="hljs-built_in">console</span>.log(outerVar); <span class="hljs-comment">// ✅ Can access outer scope</span>
    <span class="hljs-built_in">console</span>.log(innerVar); <span class="hljs-comment">// ✅ Can access own scope</span>
  }

  innerFunction();
  <span class="hljs-built_in">console</span>.log(outerVar); <span class="hljs-comment">// ✅ Can access own scope</span>
  <span class="hljs-comment">// console.log(innerVar); // ❌ ReferenceError!</span>
}

outerFunction();
<span class="hljs-comment">// console.log(outerVar); // ❌ ReferenceError!</span>
</div></code></pre>
<h3 id="block-scope-es6">Block Scope (ES6+)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// let and const are block-scoped</span>
<span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">let</span> blockScoped = <span class="hljs-string">"I'm block scoped"</span>;
  <span class="hljs-keyword">const</span> alsoBlockScoped = <span class="hljs-string">"Me too!"</span>;
  <span class="hljs-keyword">var</span> functionScoped = <span class="hljs-string">"I'm function scoped"</span>;

  <span class="hljs-built_in">console</span>.log(blockScoped); <span class="hljs-comment">// ✅ Works inside block</span>
}

<span class="hljs-comment">// console.log(blockScoped); // ❌ ReferenceError!</span>
<span class="hljs-comment">// console.log(alsoBlockScoped); // ❌ ReferenceError!</span>
<span class="hljs-built_in">console</span>.log(functionScoped); <span class="hljs-comment">// ✅ var leaks out of blocks!</span>

<span class="hljs-comment">// Same with loops</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  <span class="hljs-comment">// i is only accessible here</span>
}
<span class="hljs-comment">// console.log(i); // ❌ ReferenceError!</span>

<span class="hljs-comment">// But var leaks:</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) {
  <span class="hljs-comment">// j will be accessible outside</span>
}
<span class="hljs-built_in">console</span>.log(j); <span class="hljs-comment">// ✅ 3 (leaked out!)</span>
</div></code></pre>
<h3 id="lexical-scope-static-scope">Lexical Scope (Static Scope)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> globalName = <span class="hljs-string">"Global Alice"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> outerName = <span class="hljs-string">"Outer Bob"</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inner</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> innerName = <span class="hljs-string">"Inner Charlie"</span>;

    <span class="hljs-comment">// Scope chain: inner → outer → global</span>
    <span class="hljs-built_in">console</span>.log(innerName); <span class="hljs-comment">// "Inner Charlie"</span>
    <span class="hljs-built_in">console</span>.log(outerName); <span class="hljs-comment">// "Outer Bob"</span>
    <span class="hljs-built_in">console</span>.log(globalName); <span class="hljs-comment">// "Global Alice"</span>
  }

  <span class="hljs-keyword">return</span> inner;
}

<span class="hljs-keyword">const</span> innerFunc = outer();
innerFunc(); <span class="hljs-comment">// Still has access to outer scope!</span>
</div></code></pre>
<h2 id="%F0%9F%8E%88-hoisting-explained">🎈 Hoisting Explained</h2>
<h3 id="variable-hoisting-with-var">Variable Hoisting with var</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// What you write:</span>
<span class="hljs-built_in">console</span>.log(myVar); <span class="hljs-comment">// undefined (not error!)</span>
<span class="hljs-keyword">var</span> myVar = <span class="hljs-string">"Hello"</span>;
<span class="hljs-built_in">console</span>.log(myVar); <span class="hljs-comment">// "Hello"</span>

<span class="hljs-comment">// What JavaScript actually does:</span>
<span class="hljs-comment">// var myVar; // Declaration hoisted to top</span>
<span class="hljs-comment">// console.log(myVar); // undefined</span>
<span class="hljs-comment">// myVar = "Hello"; // Assignment stays in place</span>
<span class="hljs-comment">// console.log(myVar); // "Hello"</span>
</div></code></pre>
<h3 id="function-hoisting">Function Hoisting</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Function declarations are fully hoisted</span>
<span class="hljs-built_in">console</span>.log(hoistedFunction()); <span class="hljs-comment">// "I'm hoisted!"</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hoistedFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"I'm hoisted!"</span>;
}

<span class="hljs-comment">// Function expressions are NOT hoisted</span>
<span class="hljs-comment">// console.log(notHoisted()); // TypeError!</span>

<span class="hljs-keyword">var</span> notHoisted = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"I'm not hoisted!"</span>;
};
</div></code></pre>
<h3 id="let-and-const-hoisting-temporal-dead-zone">let and const Hoisting (Temporal Dead Zone)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// let and const are hoisted but in "Temporal Dead Zone"</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> myVar); <span class="hljs-comment">// "undefined"</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> myLet); <span class="hljs-comment">// ReferenceError!</span>

<span class="hljs-keyword">var</span> myVar = <span class="hljs-string">"var variable"</span>;
<span class="hljs-keyword">let</span> myLet = <span class="hljs-string">"let variable"</span>;

<span class="hljs-comment">// Example of TDZ</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">demonstrateTDZ</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// ReferenceError! (TDZ)</span>

  <span class="hljs-keyword">let</span> x = <span class="hljs-string">"I'm in TDZ until this line"</span>;
  <span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// "I'm in TDZ until this line"</span>
}
</div></code></pre>
<h2 id="%E2%9A%A1-temporal-dead-zone-tdz">⚡ Temporal Dead Zone (TDZ)</h2>
<h3 id="what-is-tdz">What is TDZ?</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// TDZ exists from start of scope until declaration</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showTDZ</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// TDZ starts here for 'temporal'</span>

  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> temporal); <span class="hljs-comment">// ReferenceError!</span>

  <span class="hljs-comment">// Still in TDZ</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> temporal); <span class="hljs-comment">// ReferenceError!</span>

    <span class="hljs-keyword">let</span> temporal = <span class="hljs-string">"Now I exist!"</span>; <span class="hljs-comment">// TDZ ends here</span>
    <span class="hljs-built_in">console</span>.log(temporal); <span class="hljs-comment">// "Now I exist!"</span>
  }
}

showTDZ();
</div></code></pre>
<h3 id="tdz-with-const">TDZ with const</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// const must be initialized when declared</span>
<span class="hljs-comment">// const uninitializedConst; // SyntaxError!</span>

<span class="hljs-keyword">const</span> properConst = <span class="hljs-string">"I'm properly initialized"</span>;

<span class="hljs-comment">// const cannot be reassigned</span>
<span class="hljs-comment">// properConst = "New value"; // TypeError!</span>
</div></code></pre>
<h3 id="tdz-in-loops">TDZ in Loops</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Classic var problem</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"var:"</span>, i); <span class="hljs-comment">// 3, 3, 3 (all reference same i)</span>
  }, <span class="hljs-number">100</span>);
}

<span class="hljs-comment">// let creates new binding each iteration</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; <span class="hljs-number">3</span>; j++) {
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"let:"</span>, j); <span class="hljs-comment">// 0, 1, 2 (each has own j)</span>
  }, <span class="hljs-number">100</span>);
}
</div></code></pre>
<h2 id="%F0%9F%94%97-scope-chain">🔗 Scope Chain</h2>
<h3 id="how-scope-chain-works">How Scope Chain Works</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> global = <span class="hljs-string">"global"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">level1</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> level1Var = <span class="hljs-string">"level1"</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">level2</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> level2Var = <span class="hljs-string">"level2"</span>;

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">level3</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">const</span> level3Var = <span class="hljs-string">"level3"</span>;

      <span class="hljs-comment">// Scope chain: level3 → level2 → level1 → global</span>
      <span class="hljs-built_in">console</span>.log(level3Var); <span class="hljs-comment">// Found in level3</span>
      <span class="hljs-built_in">console</span>.log(level2Var); <span class="hljs-comment">// Found in level2</span>
      <span class="hljs-built_in">console</span>.log(level1Var); <span class="hljs-comment">// Found in level1</span>
      <span class="hljs-built_in">console</span>.log(global); <span class="hljs-comment">// Found in global</span>
      <span class="hljs-comment">// console.log(nonExistent); // ReferenceError!</span>
    }

    level3();
  }

  level2();
}

level1();
</div></code></pre>
<h3 id="variable-shadowing">Variable Shadowing</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> name = <span class="hljs-string">"Global"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> name = <span class="hljs-string">"Outer"</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inner</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> name = <span class="hljs-string">"Inner"</span>;
    <span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// "Inner" (shadows outer scopes)</span>
  }

  inner();
  <span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// "Outer" (shadows global)</span>
}

outer();
<span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// "Global"</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-practical-examples">🎯 Practical Examples</h2>
<h3 id="module-pattern-with-scope">Module Pattern with Scope</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Using IIFE to create private scope</span>
<span class="hljs-keyword">const</span> calculator = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Private variables</span>
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// Private function</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">operation, value</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${operation}</span>: <span class="hljs-subst">${value}</span>, result: <span class="hljs-subst">${result}</span>`</span>);
  }

  <span class="hljs-comment">// Public API</span>
  <span class="hljs-keyword">return</span> {
    add(value) {
      result += value;
      log(<span class="hljs-string">"add"</span>, value);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>; <span class="hljs-comment">// For chaining</span>
    },

    subtract(value) {
      result -= value;
      log(<span class="hljs-string">"subtract"</span>, value);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },

    getResult() {
      <span class="hljs-keyword">return</span> result;
    },

    reset() {
      result = <span class="hljs-number">0</span>;
      log(<span class="hljs-string">"reset"</span>, <span class="hljs-number">0</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },
  };
})();

<span class="hljs-comment">// Usage</span>
calculator.add(<span class="hljs-number">10</span>).subtract(<span class="hljs-number">3</span>).add(<span class="hljs-number">5</span>);
<span class="hljs-built_in">console</span>.log(calculator.getResult()); <span class="hljs-comment">// 12</span>

<span class="hljs-comment">// Private variables are not accessible</span>
<span class="hljs-comment">// console.log(calculator.result); // undefined</span>
</div></code></pre>
<h3 id="closure-with-scope">Closure with Scope</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createCounter</span>(<span class="hljs-params">initialValue = <span class="hljs-number">0</span></span>) </span>{
  <span class="hljs-keyword">let</span> count = initialValue;

  <span class="hljs-keyword">return</span> {
    increment() {
      <span class="hljs-keyword">return</span> ++count;
    },

    decrement() {
      <span class="hljs-keyword">return</span> --count;
    },

    getValue() {
      <span class="hljs-keyword">return</span> count;
    },

    reset() {
      count = initialValue;
      <span class="hljs-keyword">return</span> count;
    },
  };
}

<span class="hljs-keyword">const</span> counter1 = createCounter(<span class="hljs-number">5</span>);
<span class="hljs-keyword">const</span> counter2 = createCounter(<span class="hljs-number">10</span>);

<span class="hljs-built_in">console</span>.log(counter1.increment()); <span class="hljs-comment">// 6</span>
<span class="hljs-built_in">console</span>.log(counter2.increment()); <span class="hljs-comment">// 11</span>
<span class="hljs-built_in">console</span>.log(counter1.getValue()); <span class="hljs-comment">// 6</span>
<span class="hljs-built_in">console</span>.log(counter2.getValue()); <span class="hljs-comment">// 11</span>
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-var-in-loops">1. var in Loops</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Problem: All callbacks reference same variable</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"var i:"</span>, i); <span class="hljs-comment">// 3, 3, 3</span>
  }, <span class="hljs-number">100</span>);
}

<span class="hljs-comment">// Solution 1: Use let</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"let i:"</span>, i); <span class="hljs-comment">// 0, 1, 2</span>
  }, <span class="hljs-number">100</span>);
}

<span class="hljs-comment">// Solution 2: IIFE with var</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index</span>) </span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"IIFE i:"</span>, index); <span class="hljs-comment">// 0, 1, 2</span>
    }, <span class="hljs-number">100</span>);
  })(i);
}
</div></code></pre>
<h3 id="2-hoisting-confusion">2. Hoisting Confusion</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Confusing hoisting behavior</span>
<span class="hljs-keyword">var</span> x = <span class="hljs-number">1</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">confusing</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// undefined (not 1!)</span>

  <span class="hljs-keyword">if</span> (<span class="hljs-literal">false</span>) {
    <span class="hljs-keyword">var</span> x = <span class="hljs-number">2</span>; <span class="hljs-comment">// This declaration is hoisted!</span>
  }
}

confusing();

<span class="hljs-comment">// What actually happens:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">confusing</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> x; <span class="hljs-comment">// Hoisted declaration</span>
  <span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// undefined</span>

  <span class="hljs-keyword">if</span> (<span class="hljs-literal">false</span>) {
    x = <span class="hljs-number">2</span>; <span class="hljs-comment">// Assignment (never executed)</span>
  }
}
</div></code></pre>
<h3 id="3-tdz-gotchas">3. TDZ Gotchas</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// TDZ with default parameters</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tdz</span>(<span class="hljs-params">a = b, b = <span class="hljs-number">2</span></span>) </span>{
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// tdz(); // ReferenceError! b is in TDZ when a is initialized</span>

<span class="hljs-comment">// Correct order</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fixed</span>(<span class="hljs-params">b = <span class="hljs-number">2</span>, a = b</span>) </span>{
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-built_in">console</span>.log(fixed()); <span class="hljs-comment">// 4</span>
</div></code></pre>
<h3 id="4-block-scope-confusion">4. Block Scope Confusion</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Mixing let and var</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixedScope</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">var</span> varVariable = <span class="hljs-string">"var"</span>;
    <span class="hljs-keyword">let</span> letVariable = <span class="hljs-string">"let"</span>;
  }

  <span class="hljs-built_in">console</span>.log(varVariable); <span class="hljs-comment">// "var" (function scoped)</span>
  <span class="hljs-comment">// console.log(letVariable); // ReferenceError! (block scoped)</span>
}

mixedScope();
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when--why-to-use">🎯 When &amp; Why to Use</h2>
<h3 id="choose-the-right-declaration">Choose the Right Declaration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Use const by default</span>
<span class="hljs-keyword">const</span> API_URL = <span class="hljs-string">"https://api.example.com"</span>;
<span class="hljs-keyword">const</span> users = []; <span class="hljs-comment">// Reference won't change</span>

<span class="hljs-comment">// Use let when you need to reassign</span>
<span class="hljs-keyword">let</span> currentUser = <span class="hljs-literal">null</span>;
<span class="hljs-keyword">let</span> counter = <span class="hljs-number">0</span>;

<span class="hljs-comment">// Avoid var in modern JavaScript</span>
<span class="hljs-comment">// var oldStyle = "Don't use this";</span>
</div></code></pre>
<h3 id="scope-best-practices">Scope Best Practices</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Keep variables in smallest possible scope</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processData</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-comment">// Don't declare everything at the top</span>

  <span class="hljs-keyword">if</span> (data.length === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> [];
  }

  <span class="hljs-comment">// Declare variables when needed</span>
  <span class="hljs-keyword">const</span> processed = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">const</span> item = data[i]; <span class="hljs-comment">// Block scoped</span>

    <span class="hljs-keyword">if</span> (item.isValid) {
      <span class="hljs-keyword">const</span> transformed = transform(item); <span class="hljs-comment">// Even smaller scope</span>
      processed.push(transformed);
    }
  }

  <span class="hljs-keyword">return</span> processed;
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-hoisting-quiz">Problem 1: Hoisting Quiz</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Predict the output of each console.log</span>

<span class="hljs-built_in">console</span>.log(a); <span class="hljs-comment">// ?</span>
<span class="hljs-built_in">console</span>.log(b); <span class="hljs-comment">// ?</span>
<span class="hljs-comment">// console.log(c); // ?</span>

<span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> b = <span class="hljs-number">2</span>;
<span class="hljs-keyword">const</span> c = <span class="hljs-number">3</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hoistingTest</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(a); <span class="hljs-comment">// ?</span>
  <span class="hljs-built_in">console</span>.log(b); <span class="hljs-comment">// ?</span>

  <span class="hljs-keyword">var</span> a = <span class="hljs-number">10</span>;
  <span class="hljs-keyword">let</span> b = <span class="hljs-number">20</span>;
}

hoistingTest();
</div></code></pre>
<h3 id="problem-2-scope-chain-challenge">Problem 2: Scope Chain Challenge</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// What will this output?</span>
<span class="hljs-keyword">const</span> x = <span class="hljs-string">"global"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> x = <span class="hljs-string">"outer"</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inner</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// ?</span>
  }

  <span class="hljs-keyword">return</span> inner;
}

<span class="hljs-keyword">const</span> fn = outer();
fn();
</div></code></pre>
<h3 id="problem-3-loop-scope-fix">Problem 3: Loop Scope Fix</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Fix this code so it prints 0, 1, 2 instead of 3, 3, 3</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(i);
  }, <span class="hljs-number">100</span>);
}

<span class="hljs-comment">// Provide at least 2 different solutions</span>
</div></code></pre>
<h3 id="problem-4-create-a-private-counter">Problem 4: Create a Private Counter</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that returns an object with methods</span>
<span class="hljs-comment">// to increment, decrement, and get the current count</span>
<span class="hljs-comment">// The count should be private (not accessible from outside)</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPrivateCounter</span>(<span class="hljs-params">start = <span class="hljs-number">0</span></span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-keyword">const</span> counter = createPrivateCounter(<span class="hljs-number">5</span>);
<span class="hljs-built_in">console</span>.log(counter.increment()); <span class="hljs-comment">// 6</span>
<span class="hljs-built_in">console</span>.log(counter.increment()); <span class="hljs-comment">// 7</span>
<span class="hljs-built_in">console</span>.log(counter.decrement()); <span class="hljs-comment">// 6</span>
<span class="hljs-built_in">console</span>.log(counter.getCount()); <span class="hljs-comment">// 6</span>
<span class="hljs-comment">// console.log(counter.count); // Should be undefined</span>
</div></code></pre>
<h3 id="problem-5-tdz-understanding">Problem 5: TDZ Understanding</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Explain why this code throws an error and how to fix it</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">example</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> myVar); <span class="hljs-comment">// Works</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> myLet); <span class="hljs-comment">// ReferenceError - why?</span>

  <span class="hljs-keyword">var</span> myVar = <span class="hljs-string">"var"</span>;
  <span class="hljs-keyword">let</span> myLet = <span class="hljs-string">"let"</span>;
}

example();
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What is hoisting?</strong></p>
<ul>
<li>JavaScript moves variable and function declarations to the top of their scope</li>
<li>Only declarations are hoisted, not initializations</li>
<li><code>var</code> is hoisted and initialized with <code>undefined</code></li>
<li><code>let</code>/<code>const</code> are hoisted but in Temporal Dead Zone</li>
</ul>
<p><strong>Q: What is the Temporal Dead Zone?</strong></p>
<ul>
<li>Period between entering scope and variable declaration</li>
<li>Accessing variable in TDZ throws ReferenceError</li>
<li>Exists for <code>let</code>, <code>const</code>, and <code>class</code> declarations</li>
</ul>
<p><strong>Q: Difference between function and block scope?</strong></p>
<ul>
<li>Function scope: variables accessible throughout entire function</li>
<li>Block scope: variables accessible only within <code>{}</code> block</li>
<li><code>var</code> is function-scoped, <code>let</code>/<code>const</code> are block-scoped</li>
</ul>
<p><strong>Q: What is the scope chain?</strong></p>
<ul>
<li>JavaScript looks for variables starting from current scope</li>
<li>If not found, looks in outer scope, then outer's outer, etc.</li>
<li>Continues until global scope or ReferenceError</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Explain what happens when you declare a variable with <code>var</code> vs <code>let</code>&quot;</li>
<li><strong>Facebook</strong>: &quot;What is the Temporal Dead Zone and why does it exist?&quot;</li>
<li><strong>Amazon</strong>: &quot;Fix this loop so each timeout prints a different number&quot;</li>
<li><strong>Microsoft</strong>: &quot;Explain the difference between function and block scope&quot;</li>
<li><strong>Netflix</strong>: &quot;What is hoisting and how does it work with functions?&quot;</li>
</ul>
<h2 id="%F0%9F%93%8A-scope--hoisting-summary">📊 Scope &amp; Hoisting Summary</h2>
<pre class="hljs"><code><div>Variable Declarations
├── var
│   ├── Function scoped
│   ├── Hoisted with undefined
│   ├── Can be redeclared
│   └── Can be reassigned
├── let
│   ├── Block scoped
│   ├── Hoisted but in TDZ
│   ├── Cannot be redeclared
│   └── Can be reassigned
└── const
    ├── Block scoped
    ├── Hoisted but in TDZ
    ├── Cannot be redeclared
    ├── Cannot be reassigned
    └── Must be initialized
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Use <code>const</code> by default, <code>let</code> when you need to reassign</strong></li>
<li><strong>Avoid <code>var</code> in modern JavaScript</strong></li>
<li><strong>Understand hoisting to avoid bugs</strong></li>
<li><strong>Be aware of Temporal Dead Zone with <code>let</code>/<code>const</code></strong></li>
<li><strong>Keep variables in the smallest possible scope</strong></li>
<li><strong>Use block scope to prevent variable leaking</strong></li>
<li><strong>Understand scope chain for debugging</strong></li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./04-functions.md">← Functions Deep Dive</a><br>
<strong>Next Chapter</strong>: <a href="./06-closures.md">Closures Explained →</a></p>
<p><strong>Practice</strong>: Try the hoisting quiz and experiment with different scoping scenarios!</p>
<h1 id="%F0%9F%94%92-chapter-6-closures-explained">🔒 Chapter 6: Closures Explained</h1>
<blockquote>
<p>Master one of JavaScript's most powerful and misunderstood features: closures.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>A closure is like a backpack that a function carries around. When a function is created inside another function, it &quot;packs&quot; all the variables from its parent scope into this backpack. Even when the function travels far from home (gets called elsewhere), it still has access to everything in its backpack.</p>
<p>Think of it like:</p>
<ul>
<li><strong>Function</strong> = a person</li>
<li><strong>Closure</strong> = their backpack with memories/tools</li>
<li><strong>Outer variables</strong> = items packed in the backpack</li>
<li><strong>Inner function</strong> = the person who can always access their backpack</li>
</ul>
<h2 id="%F0%9F%8E%AF-what-is-a-closure">🎯 What is a Closure?</h2>
<h3 id="basic-closure-example">Basic Closure Example</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outerFunction</span>(<span class="hljs-params">x</span>) </span>{
  <span class="hljs-comment">// This is the outer function's scope</span>

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">innerFunction</span>(<span class="hljs-params">y</span>) </span>{
    <span class="hljs-comment">// Inner function has access to outer function's variables</span>
    <span class="hljs-keyword">return</span> x + y; <span class="hljs-comment">// x is from outer scope!</span>
  }

  <span class="hljs-keyword">return</span> innerFunction;
}

<span class="hljs-keyword">const</span> addFive = outerFunction(<span class="hljs-number">5</span>);
<span class="hljs-built_in">console</span>.log(addFive(<span class="hljs-number">3</span>)); <span class="hljs-comment">// 8</span>

<span class="hljs-comment">// Even though outerFunction has finished executing,</span>
<span class="hljs-comment">// innerFunction still remembers x = 5!</span>
</div></code></pre>
<h3 id="closure-visualization">Closure Visualization</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createGreeting</span>(<span class="hljs-params">greeting</span>) </span>{
  <span class="hljs-comment">// Outer scope variable</span>
  <span class="hljs-keyword">const</span> message = greeting;

  <span class="hljs-comment">// Inner function "closes over" the message variable</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${message}</span>, <span class="hljs-subst">${name}</span>!`</span>;
  };
}

<span class="hljs-keyword">const</span> sayHello = createGreeting(<span class="hljs-string">"Hello"</span>);
<span class="hljs-keyword">const</span> sayHi = createGreeting(<span class="hljs-string">"Hi"</span>);

<span class="hljs-built_in">console</span>.log(sayHello(<span class="hljs-string">"Alice"</span>)); <span class="hljs-comment">// "Hello, Alice!"</span>
<span class="hljs-built_in">console</span>.log(sayHi(<span class="hljs-string">"Bob"</span>)); <span class="hljs-comment">// "Hi, Bob!"</span>

<span class="hljs-comment">// Each closure maintains its own copy of the outer variables</span>
</div></code></pre>
<h2 id="%F0%9F%94%A7-practical-closure-patterns">🔧 Practical Closure Patterns</h2>
<h3 id="1-private-variables-data-encapsulation">1. Private Variables (Data Encapsulation)</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createBankAccount</span>(<span class="hljs-params">initialBalance</span>) </span>{
  <span class="hljs-keyword">let</span> balance = initialBalance; <span class="hljs-comment">// Private variable</span>

  <span class="hljs-keyword">return</span> {
    deposit(amount) {
      <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span>) {
        balance += amount;
        <span class="hljs-keyword">return</span> balance;
      }
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Deposit amount must be positive"</span>);
    },

    withdraw(amount) {
      <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span> &amp;&amp; amount &lt;= balance) {
        balance -= amount;
        <span class="hljs-keyword">return</span> balance;
      }
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid withdrawal amount"</span>);
    },

    getBalance() {
      <span class="hljs-keyword">return</span> balance;
    },
  };
}

<span class="hljs-keyword">const</span> account = createBankAccount(<span class="hljs-number">100</span>);
<span class="hljs-built_in">console</span>.log(account.deposit(<span class="hljs-number">50</span>)); <span class="hljs-comment">// 150</span>
<span class="hljs-built_in">console</span>.log(account.withdraw(<span class="hljs-number">30</span>)); <span class="hljs-comment">// 120</span>
<span class="hljs-built_in">console</span>.log(account.getBalance()); <span class="hljs-comment">// 120</span>

<span class="hljs-comment">// balance is private - cannot be accessed directly</span>
<span class="hljs-comment">// console.log(account.balance); // undefined</span>
</div></code></pre>
<h3 id="2-function-factories">2. Function Factories</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createMultiplier</span>(<span class="hljs-params">multiplier</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">number</span>) </span>{
    <span class="hljs-keyword">return</span> number * multiplier;
  };
}

<span class="hljs-keyword">const</span> double = createMultiplier(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> triple = createMultiplier(<span class="hljs-number">3</span>);
<span class="hljs-keyword">const</span> quadruple = createMultiplier(<span class="hljs-number">4</span>);

<span class="hljs-built_in">console</span>.log(double(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 10</span>
<span class="hljs-built_in">console</span>.log(triple(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 15</span>
<span class="hljs-built_in">console</span>.log(quadruple(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 20</span>

<span class="hljs-comment">// Each function remembers its own multiplier value</span>
</div></code></pre>
<h3 id="3-event-handlers-with-state">3. Event Handlers with State</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createClickCounter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    count++;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Button clicked <span class="hljs-subst">${count}</span> times`</span>);
    <span class="hljs-keyword">return</span> count;
  };
}

<span class="hljs-keyword">const</span> buttonHandler = createClickCounter();

<span class="hljs-comment">// Simulate button clicks</span>
buttonHandler(); <span class="hljs-comment">// "Button clicked 1 times"</span>
buttonHandler(); <span class="hljs-comment">// "Button clicked 2 times"</span>
buttonHandler(); <span class="hljs-comment">// "Button clicked 3 times"</span>

<span class="hljs-comment">// Each button can have its own counter</span>
<span class="hljs-keyword">const</span> anotherButton = createClickCounter();
anotherButton(); <span class="hljs-comment">// "Button clicked 1 times" (separate counter)</span>
</div></code></pre>
<h3 id="4-module-pattern">4. Module Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> calculator = (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Private variables and functions</span>
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">operation, value</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${operation}</span>(<span class="hljs-subst">${value}</span>) = <span class="hljs-subst">${result}</span>`</span>);
  }

  <span class="hljs-comment">// Public API (returned object)</span>
  <span class="hljs-keyword">return</span> {
    add(value) {
      result += value;
      log(<span class="hljs-string">"add"</span>, value);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>; <span class="hljs-comment">// For method chaining</span>
    },

    subtract(value) {
      result -= value;
      log(<span class="hljs-string">"subtract"</span>, value);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },

    multiply(value) {
      result *= value;
      log(<span class="hljs-string">"multiply"</span>, value);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },

    divide(value) {
      <span class="hljs-keyword">if</span> (value !== <span class="hljs-number">0</span>) {
        result /= value;
        log(<span class="hljs-string">"divide"</span>, value);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Cannot divide by zero!"</span>);
      }
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },

    getResult() {
      <span class="hljs-keyword">return</span> result;
    },

    clear() {
      result = <span class="hljs-number">0</span>;
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculator cleared"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    },
  };
})();

<span class="hljs-comment">// Usage</span>
calculator.add(<span class="hljs-number">10</span>).multiply(<span class="hljs-number">2</span>).subtract(<span class="hljs-number">5</span>);
<span class="hljs-built_in">console</span>.log(calculator.getResult()); <span class="hljs-comment">// 15</span>
</div></code></pre>
<h2 id="%F0%9F%94%84-closures-in-loops">🔄 Closures in Loops</h2>
<h3 id="the-classic-loop-problem">The Classic Loop Problem</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Common mistake with var</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"var i:"</span>, i); <span class="hljs-comment">// 3, 3, 3 (all reference same i)</span>
  }, <span class="hljs-number">100</span>);
}

<span class="hljs-comment">// ✅ Solution 1: Use let (block scope)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"let i:"</span>, i); <span class="hljs-comment">// 0, 1, 2 (each has own i)</span>
  }, <span class="hljs-number">100</span>);
}

<span class="hljs-comment">// ✅ Solution 2: IIFE to create closure</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  (<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index</span>) </span>{
    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"IIFE i:"</span>, index); <span class="hljs-comment">// 0, 1, 2</span>
    }, <span class="hljs-number">100</span>);
  })(i);
}

<span class="hljs-comment">// ✅ Solution 3: bind method</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(
    <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">index</span>) </span>{
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"bind i:"</span>, index); <span class="hljs-comment">// 0, 1, 2</span>
    }.bind(<span class="hljs-literal">null</span>, i),
    <span class="hljs-number">100</span>
  );
}
</div></code></pre>
<h3 id="creating-multiple-closures-in-loops">Creating Multiple Closures in Loops</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFunctions</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> functions = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
    functions.push(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> i * i; <span class="hljs-comment">// Each function closes over its own i</span>
    });
  }

  <span class="hljs-keyword">return</span> functions;
}

<span class="hljs-keyword">const</span> funcs = createFunctions();
<span class="hljs-built_in">console</span>.log(funcs[<span class="hljs-number">0</span>]()); <span class="hljs-comment">// 0</span>
<span class="hljs-built_in">console</span>.log(funcs[<span class="hljs-number">1</span>]()); <span class="hljs-comment">// 1</span>
<span class="hljs-built_in">console</span>.log(funcs[<span class="hljs-number">2</span>]()); <span class="hljs-comment">// 4</span>
</div></code></pre>
<h2 id="%F0%9F%A7%A0-advanced-closure-concepts">🧠 Advanced Closure Concepts</h2>
<h3 id="closure-with-multiple-nested-functions">Closure with Multiple Nested Functions</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">grandparent</span>(<span class="hljs-params">g</span>) </span>{
  <span class="hljs-keyword">const</span> grandparentVar = g;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parent</span>(<span class="hljs-params">p</span>) </span>{
    <span class="hljs-keyword">const</span> parentVar = p;

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">child</span>(<span class="hljs-params">c</span>) </span>{
      <span class="hljs-keyword">const</span> childVar = c;

      <span class="hljs-comment">// Child has access to all ancestor scopes</span>
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">grandparent</span>: grandparentVar,
        <span class="hljs-attr">parent</span>: parentVar,
        <span class="hljs-attr">child</span>: childVar,
        <span class="hljs-attr">sum</span>: grandparentVar + parentVar + childVar,
      };
    };
  };
}

<span class="hljs-keyword">const</span> family = grandparent(<span class="hljs-number">1</span>)(<span class="hljs-number">2</span>)(<span class="hljs-number">3</span>);
<span class="hljs-built_in">console</span>.log(family); <span class="hljs-comment">// { grandparent: 1, parent: 2, child: 3, sum: 6 }</span>
</div></code></pre>
<h3 id="closure-with-shared-state">Closure with Shared State</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSharedCounter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> count = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">return</span> {
    increment() {
      <span class="hljs-keyword">return</span> ++count;
    },

    decrement() {
      <span class="hljs-keyword">return</span> --count;
    },

    getCount() {
      <span class="hljs-keyword">return</span> count;
    },

    <span class="hljs-comment">// Create a new function that shares the same count</span>
    createIncrementer() {
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ++count;
    },
  };
}

<span class="hljs-keyword">const</span> counter = createSharedCounter();
<span class="hljs-keyword">const</span> incrementer = counter.createIncrementer();

<span class="hljs-built_in">console</span>.log(counter.increment()); <span class="hljs-comment">// 1</span>
<span class="hljs-built_in">console</span>.log(incrementer()); <span class="hljs-comment">// 2 (shares same count!)</span>
<span class="hljs-built_in">console</span>.log(counter.getCount()); <span class="hljs-comment">// 2</span>
</div></code></pre>
<h3 id="closure-with-dynamic-behavior">Closure with Dynamic Behavior</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createConfigurableFunction</span>(<span class="hljs-params">config</span>) </span>{
  <span class="hljs-keyword">const</span> { prefix, suffix, transform } = config;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">input</span>) </span>{
    <span class="hljs-keyword">let</span> result = input;

    <span class="hljs-keyword">if</span> (transform) {
      result = transform(result);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${prefix || <span class="hljs-string">""</span>}</span><span class="hljs-subst">${result}</span><span class="hljs-subst">${suffix || <span class="hljs-string">""</span>}</span>`</span>;
  };
}

<span class="hljs-keyword">const</span> upperCaseFormatter = createConfigurableFunction({
  <span class="hljs-attr">prefix</span>: <span class="hljs-string">"["</span>,
  <span class="hljs-attr">suffix</span>: <span class="hljs-string">"]"</span>,
  <span class="hljs-attr">transform</span>: <span class="hljs-function">(<span class="hljs-params">str</span>) =&gt;</span> str.toUpperCase(),
});

<span class="hljs-keyword">const</span> numberFormatter = createConfigurableFunction({
  <span class="hljs-attr">prefix</span>: <span class="hljs-string">"$"</span>,
  <span class="hljs-attr">transform</span>: <span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num.toFixed(<span class="hljs-number">2</span>),
});

<span class="hljs-built_in">console</span>.log(upperCaseFormatter(<span class="hljs-string">"hello"</span>)); <span class="hljs-comment">// "[HELLO]"</span>
<span class="hljs-built_in">console</span>.log(numberFormatter(<span class="hljs-number">42.567</span>)); <span class="hljs-comment">// "$42.57"</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-real-world-applications">🎯 Real-World Applications</h2>
<h3 id="1-debounce-function">1. Debounce Function</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>(<span class="hljs-params">func, delay</span>) </span>{
  <span class="hljs-keyword">let</span> timeoutId;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-comment">// Clear previous timeout</span>
    clearTimeout(timeoutId);

    <span class="hljs-comment">// Set new timeout</span>
    timeoutId = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      func.apply(<span class="hljs-keyword">this</span>, args);
    }, delay);
  };
}

<span class="hljs-comment">// Usage: Debounce search input</span>
<span class="hljs-keyword">const</span> searchInput = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"search"</span>);
<span class="hljs-keyword">const</span> debouncedSearch = debounce(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Searching for:"</span>, event.target.value);
  <span class="hljs-comment">// Perform search...</span>
}, <span class="hljs-number">300</span>);

<span class="hljs-comment">// searchInput.addEventListener('input', debouncedSearch);</span>
</div></code></pre>
<h3 id="2-throttle-function">2. Throttle Function</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">func, limit</span>) </span>{
  <span class="hljs-keyword">let</span> inThrottle;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-keyword">if</span> (!inThrottle) {
      func.apply(<span class="hljs-keyword">this</span>, args);
      inThrottle = <span class="hljs-literal">true</span>;

      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        inThrottle = <span class="hljs-literal">false</span>;
      }, limit);
    }
  };
}

<span class="hljs-comment">// Usage: Throttle scroll events</span>
<span class="hljs-keyword">const</span> throttledScroll = throttle(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Scroll event fired"</span>);
}, <span class="hljs-number">100</span>);

<span class="hljs-comment">// window.addEventListener('scroll', throttledScroll);</span>
</div></code></pre>
<h3 id="3-memoization">3. Memoization</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">memoize</span>(<span class="hljs-params">fn</span>) </span>{
  <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-keyword">const</span> key = <span class="hljs-built_in">JSON</span>.stringify(args);

    <span class="hljs-keyword">if</span> (cache.has(key)) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Cache hit!"</span>);
      <span class="hljs-keyword">return</span> cache.get(key);
    }

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Computing result..."</span>);
    <span class="hljs-keyword">const</span> result = fn.apply(<span class="hljs-keyword">this</span>, args);
    cache.set(key, result);

    <span class="hljs-keyword">return</span> result;
  };
}

<span class="hljs-comment">// Expensive function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fibonacci</span>(<span class="hljs-params">n</span>) </span>{
  <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> n;
  <span class="hljs-keyword">return</span> fibonacci(n - <span class="hljs-number">1</span>) + fibonacci(n - <span class="hljs-number">2</span>);
}

<span class="hljs-keyword">const</span> memoizedFib = memoize(fibonacci);

<span class="hljs-built_in">console</span>.log(memoizedFib(<span class="hljs-number">10</span>)); <span class="hljs-comment">// Computing result... 55</span>
<span class="hljs-built_in">console</span>.log(memoizedFib(<span class="hljs-number">10</span>)); <span class="hljs-comment">// Cache hit! 55</span>
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-memory-leaks">1. Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Potential memory leak</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createLeakyFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> largeData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>).fill(<span class="hljs-string">"data"</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-comment">// Even if we don't use largeData, it's kept in memory!</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Function called"</span>);
  };
}

<span class="hljs-comment">// ✅ Better: only close over what you need</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createEfficientFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> largeData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>).fill(<span class="hljs-string">"data"</span>);
  <span class="hljs-keyword">const</span> dataLength = largeData.length; <span class="hljs-comment">// Extract only what's needed</span>

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Function called, data size: <span class="hljs-subst">${dataLength}</span>`</span>);
  };
}
</div></code></pre>
<h3 id="2-unexpected-behavior-with-loops">2. Unexpected Behavior with Loops</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ All functions will alert 3</span>
<span class="hljs-keyword">const</span> functions = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  functions.push(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    alert(i); <span class="hljs-comment">// All reference the same i</span>
  });
}

<span class="hljs-comment">// ✅ Each function gets its own copy</span>
<span class="hljs-keyword">const</span> functionsFixed = [];
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  functionsFixed.push(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    alert(i); <span class="hljs-comment">// Each has its own i</span>
  });
}
</div></code></pre>
<h3 id="3-closure-performance">3. Closure Performance</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Creating closure in every call</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inefficient</span>(<span class="hljs-params">arr</span>) </span>{
  <span class="hljs-keyword">return</span> arr.map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">item</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">return</span> item * <span class="hljs-number">2</span>; <span class="hljs-comment">// New closure for each item</span>
    };
  });
}

<span class="hljs-comment">// ✅ Reuse function when possible</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDoubler</span>(<span class="hljs-params">item</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> item * <span class="hljs-number">2</span>;
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">efficient</span>(<span class="hljs-params">arr</span>) </span>{
  <span class="hljs-keyword">return</span> arr.map(createDoubler);
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-counter-factory">Problem 1: Counter Factory</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that returns an object with increment, decrement, and value methods</span>
<span class="hljs-comment">// Each counter should be independent</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createCounter</span>(<span class="hljs-params">initialValue = <span class="hljs-number">0</span></span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-keyword">const</span> counter1 = createCounter(<span class="hljs-number">5</span>);
<span class="hljs-keyword">const</span> counter2 = createCounter(<span class="hljs-number">10</span>);

<span class="hljs-built_in">console</span>.log(counter1.increment()); <span class="hljs-comment">// 6</span>
<span class="hljs-built_in">console</span>.log(counter2.increment()); <span class="hljs-comment">// 11</span>
<span class="hljs-built_in">console</span>.log(counter1.value()); <span class="hljs-comment">// 6</span>
<span class="hljs-built_in">console</span>.log(counter2.value()); <span class="hljs-comment">// 11</span>
</div></code></pre>
<h3 id="problem-2-function-multiplier">Problem 2: Function Multiplier</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that returns a new function that multiplies its input by a factor</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createMultiplier</span>(<span class="hljs-params">factor</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-keyword">const</span> double = createMultiplier(<span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> triple = createMultiplier(<span class="hljs-number">3</span>);

<span class="hljs-built_in">console</span>.log(double(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 10</span>
<span class="hljs-built_in">console</span>.log(triple(<span class="hljs-number">4</span>)); <span class="hljs-comment">// 12</span>
</div></code></pre>
<h3 id="problem-3-private-variable-challenge">Problem 3: Private Variable Challenge</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that manages a private array</span>
<span class="hljs-comment">// Return methods to add, remove, and get items</span>
<span class="hljs-comment">// The array should not be directly accessible</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPrivateArray</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-keyword">const</span> arr = createPrivateArray();
arr.add(<span class="hljs-string">"apple"</span>);
arr.add(<span class="hljs-string">"banana"</span>);
<span class="hljs-built_in">console</span>.log(arr.getItems()); <span class="hljs-comment">// ['apple', 'banana']</span>
arr.remove(<span class="hljs-string">"apple"</span>);
<span class="hljs-built_in">console</span>.log(arr.getItems()); <span class="hljs-comment">// ['banana']</span>
<span class="hljs-comment">// console.log(arr.items); // Should be undefined</span>
</div></code></pre>
<h3 id="problem-4-loop-closure-fix">Problem 4: Loop Closure Fix</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Fix this code so it prints 0, 1, 2 after 1 second</span>
<span class="hljs-comment">// Provide multiple solutions</span>

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(i);
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">// Currently prints: 3, 3, 3</span>
<span class="hljs-comment">// Should print: 0, 1, 2</span>
</div></code></pre>
<h3 id="problem-5-advanced-closure">Problem 5: Advanced Closure</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that returns an object with methods to:</span>
<span class="hljs-comment">// 1. Set a value</span>
<span class="hljs-comment">// 2. Get the value</span>
<span class="hljs-comment">// 3. Get the history of all values that were set</span>
<span class="hljs-comment">// 4. Reset to initial value</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createValueTracker</span>(<span class="hljs-params">initialValue</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-keyword">const</span> tracker = createValueTracker(<span class="hljs-number">0</span>);
tracker.setValue(<span class="hljs-number">5</span>);
tracker.setValue(<span class="hljs-number">10</span>);
<span class="hljs-built_in">console</span>.log(tracker.getValue()); <span class="hljs-comment">// 10</span>
<span class="hljs-built_in">console</span>.log(tracker.getHistory()); <span class="hljs-comment">// [0, 5, 10]</span>
tracker.reset();
<span class="hljs-built_in">console</span>.log(tracker.getValue()); <span class="hljs-comment">// 0</span>
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What is a closure?</strong></p>
<ul>
<li>A function that has access to variables from its outer (enclosing) scope</li>
<li>Even after the outer function has returned</li>
<li>Creates a &quot;persistent scope&quot; that the inner function can access</li>
</ul>
<p><strong>Q: How do closures work in JavaScript?</strong></p>
<ul>
<li>When a function is created, it &quot;closes over&quot; variables from its lexical scope</li>
<li>JavaScript engine keeps these variables alive as long as the closure exists</li>
<li>Each closure maintains its own copy of the outer variables</li>
</ul>
<p><strong>Q: What are practical uses of closures?</strong></p>
<ul>
<li>Data privacy/encapsulation</li>
<li>Function factories</li>
<li>Callbacks with state</li>
<li>Module pattern</li>
<li>Debouncing/throttling</li>
</ul>
<p><strong>Q: What are potential issues with closures?</strong></p>
<ul>
<li>Memory leaks if large objects are unnecessarily closed over</li>
<li>Performance impact if overused</li>
<li>Can make debugging more difficult</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement a function that can only be called once using closures&quot;</li>
<li><strong>Facebook</strong>: &quot;Fix this loop so each timeout prints a different number&quot;</li>
<li><strong>Amazon</strong>: &quot;Create a private counter using closures&quot;</li>
<li><strong>Microsoft</strong>: &quot;Explain how closures can cause memory leaks&quot;</li>
<li><strong>Netflix</strong>: &quot;Implement debounce function using closures&quot;</li>
</ul>
<h2 id="%F0%9F%93%8A-closure-mental-model">📊 Closure Mental Model</h2>
<pre class="hljs"><code><div>Closure Components:
├── Function Definition
│   ├── Inner function code
│   └── Reference to outer scope
├── Lexical Environment
│   ├── Local variables
│   ├── Parameters
│   └── Reference to parent environment
└── Scope Chain
    ├── Current scope
    ├── Outer scope(s)
    └── Global scope
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Closures give functions access to their outer scope</strong></li>
<li><strong>Use closures for data privacy and encapsulation</strong></li>
<li><strong>Each closure maintains its own copy of outer variables</strong></li>
<li><strong>Be careful with memory leaks - don't close over unnecessary data</strong></li>
<li><strong>Closures are created every time a function is created</strong></li>
<li><strong>Understanding closures is crucial for advanced JavaScript patterns</strong></li>
<li><strong>Use <code>let</code> instead of <code>var</code> in loops to avoid closure issues</strong></li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./05-scope-hoisting.md">← Scope, Hoisting &amp; TDZ</a><br>
<strong>Next Chapter</strong>: <a href="./07-arrays.md">Arrays &amp; Array Methods →</a></p>
<p><strong>Practice</strong>: Try creating your own closure examples and experiment with the loop problems!</p>
<h1 id="%F0%9F%93%9A-chapter-7-arrays--array-methods">📚 Chapter 7: Arrays &amp; Array Methods</h1>
<blockquote>
<p>Master JavaScript arrays and their powerful built-in methods for data manipulation.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Arrays are like organized lists or containers that hold multiple items in order. Think of them as:</p>
<ul>
<li><strong>Shopping list</strong> = array of items to buy</li>
<li><strong>Playlist</strong> = array of songs in order</li>
<li><strong>Photo album</strong> = array of pictures</li>
<li><strong>To-do list</strong> = array of tasks</li>
</ul>
<p>Array methods are like tools that help you work with these lists - adding items, removing items, finding items, transforming items, etc.</p>
<h2 id="%F0%9F%8F%97%EF%B8%8F-creating-arrays">🏗️ Creating Arrays</h2>
<h3 id="array-literal-preferred">Array Literal (Preferred)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Empty array</span>
<span class="hljs-keyword">const</span> emptyArray = [];

<span class="hljs-comment">// Array with initial values</span>
<span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>];
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> mixed = [<span class="hljs-string">"hello"</span>, <span class="hljs-number">42</span>, <span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> }];

<span class="hljs-comment">// Multi-line for readability</span>
<span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>];
</div></code></pre>
<h3 id="array-constructor">Array Constructor</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Empty array</span>
<span class="hljs-keyword">const</span> arr1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();

<span class="hljs-comment">// Array with specific length (filled with undefined)</span>
<span class="hljs-keyword">const</span> arr2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">5</span>); <span class="hljs-comment">// [undefined, undefined, undefined, undefined, undefined]</span>

<span class="hljs-comment">// Array with initial values</span>
<span class="hljs-keyword">const</span> arr3 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>); <span class="hljs-comment">// ['a', 'b', 'c']</span>

<span class="hljs-comment">// ⚠️ Gotcha: Single number creates array with that length</span>
<span class="hljs-keyword">const</span> arr4 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">3</span>); <span class="hljs-comment">// [undefined, undefined, undefined]</span>
<span class="hljs-keyword">const</span> arr5 = [<span class="hljs-number">3</span>]; <span class="hljs-comment">// [3]</span>
</div></code></pre>
<h3 id="arrayfrom-and-arrayof">Array.from() and Array.of()</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Array.from() - creates array from iterable</span>
<span class="hljs-keyword">const</span> str = <span class="hljs-string">"hello"</span>;
<span class="hljs-keyword">const</span> charArray = <span class="hljs-built_in">Array</span>.from(str); <span class="hljs-comment">// ['h', 'e', 'l', 'l', 'o']</span>

<span class="hljs-comment">// Array.from() with mapping function</span>
<span class="hljs-keyword">const</span> numbers = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">5</span> }, (_, i) =&gt; i + <span class="hljs-number">1</span>); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span>

<span class="hljs-comment">// Array.of() - creates array from arguments</span>
<span class="hljs-keyword">const</span> arr6 = <span class="hljs-built_in">Array</span>.of(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// [1, 2, 3]</span>
<span class="hljs-keyword">const</span> arr7 = <span class="hljs-built_in">Array</span>.of(<span class="hljs-number">3</span>); <span class="hljs-comment">// [3] (not array with length 3!)</span>
</div></code></pre>
<h2 id="%F0%9F%94%8D-accessing-array-elements">🔍 Accessing Array Elements</h2>
<h3 id="basic-access">Basic Access</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"grape"</span>];

<span class="hljs-comment">// Access by index (0-based)</span>
<span class="hljs-built_in">console</span>.log(fruits[<span class="hljs-number">0</span>]); <span class="hljs-comment">// 'apple'</span>
<span class="hljs-built_in">console</span>.log(fruits[<span class="hljs-number">1</span>]); <span class="hljs-comment">// 'banana'</span>
<span class="hljs-built_in">console</span>.log(fruits[<span class="hljs-number">-1</span>]); <span class="hljs-comment">// undefined (no negative indexing)</span>

<span class="hljs-comment">// Get last element</span>
<span class="hljs-built_in">console</span>.log(fruits[fruits.length - <span class="hljs-number">1</span>]); <span class="hljs-comment">// 'grape'</span>

<span class="hljs-comment">// Array length</span>
<span class="hljs-built_in">console</span>.log(fruits.length); <span class="hljs-comment">// 4</span>

<span class="hljs-comment">// Check if index exists</span>
<span class="hljs-keyword">if</span> (fruits[<span class="hljs-number">10</span>] !== <span class="hljs-literal">undefined</span>) {
  <span class="hljs-built_in">console</span>.log(fruits[<span class="hljs-number">10</span>]);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Index 10 does not exist"</span>);
}
</div></code></pre>
<h3 id="destructuring-assignment">Destructuring Assignment</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>];

<span class="hljs-comment">// Basic destructuring</span>
<span class="hljs-keyword">const</span> [first, second] = colors;
<span class="hljs-built_in">console</span>.log(first, second); <span class="hljs-comment">// 'red', 'green'</span>

<span class="hljs-comment">// Skip elements</span>
<span class="hljs-keyword">const</span> [, , third] = colors;
<span class="hljs-built_in">console</span>.log(third); <span class="hljs-comment">// 'blue'</span>

<span class="hljs-comment">// Rest operator</span>
<span class="hljs-keyword">const</span> [primary, ...secondary] = colors;
<span class="hljs-built_in">console</span>.log(primary); <span class="hljs-comment">// 'red'</span>
<span class="hljs-built_in">console</span>.log(secondary); <span class="hljs-comment">// ['green', 'blue', 'yellow']</span>

<span class="hljs-comment">// Default values</span>
<span class="hljs-keyword">const</span> [a, b, c, d, e = <span class="hljs-string">"default"</span>] = colors;
<span class="hljs-built_in">console</span>.log(e); <span class="hljs-comment">// 'default'</span>
</div></code></pre>
<h2 id="%E2%9E%95-adding-elements">➕ Adding Elements</h2>
<h3 id="push---add-to-end">push() - Add to End</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>];

<span class="hljs-comment">// Add single element</span>
fruits.push(<span class="hljs-string">"orange"</span>);
<span class="hljs-built_in">console</span>.log(fruits); <span class="hljs-comment">// ['apple', 'banana', 'orange']</span>

<span class="hljs-comment">// Add multiple elements</span>
fruits.push(<span class="hljs-string">"grape"</span>, <span class="hljs-string">"kiwi"</span>);
<span class="hljs-built_in">console</span>.log(fruits); <span class="hljs-comment">// ['apple', 'banana', 'orange', 'grape', 'kiwi']</span>

<span class="hljs-comment">// push() returns new length</span>
<span class="hljs-keyword">const</span> newLength = fruits.push(<span class="hljs-string">"mango"</span>);
<span class="hljs-built_in">console</span>.log(newLength); <span class="hljs-comment">// 6</span>
</div></code></pre>
<h3 id="unshift---add-to-beginning">unshift() - Add to Beginning</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];

<span class="hljs-comment">// Add to beginning</span>
numbers.unshift(<span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(numbers); <span class="hljs-comment">// [1, 2, 3, 4]</span>

<span class="hljs-comment">// Add multiple to beginning</span>
numbers.unshift(<span class="hljs-number">-1</span>, <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(numbers); <span class="hljs-comment">// [-1, 0, 1, 2, 3, 4]</span>
</div></code></pre>
<h3 id="splice---add-at-specific-position">splice() - Add at Specific Position</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> letters = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"c"</span>, <span class="hljs-string">"d"</span>];

<span class="hljs-comment">// Insert 'b' at index 1</span>
letters.splice(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-string">"b"</span>);
<span class="hljs-built_in">console</span>.log(letters); <span class="hljs-comment">// ['a', 'b', 'c', 'd']</span>

<span class="hljs-comment">// Insert multiple elements</span>
letters.splice(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-string">"x"</span>, <span class="hljs-string">"y"</span>);
<span class="hljs-built_in">console</span>.log(letters); <span class="hljs-comment">// ['a', 'b', 'x', 'y', 'c', 'd']</span>
</div></code></pre>
<h2 id="%E2%9E%96-removing-elements">➖ Removing Elements</h2>
<h3 id="pop---remove-from-end">pop() - Remove from End</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>];

<span class="hljs-comment">// Remove and return last element</span>
<span class="hljs-keyword">const</span> removed = fruits.pop();
<span class="hljs-built_in">console</span>.log(removed); <span class="hljs-comment">// 'orange'</span>
<span class="hljs-built_in">console</span>.log(fruits); <span class="hljs-comment">// ['apple', 'banana']</span>
</div></code></pre>
<h3 id="shift---remove-from-beginning">shift() - Remove from Beginning</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];

<span class="hljs-comment">// Remove and return first element</span>
<span class="hljs-keyword">const</span> removed = numbers.shift();
<span class="hljs-built_in">console</span>.log(removed); <span class="hljs-comment">// 1</span>
<span class="hljs-built_in">console</span>.log(numbers); <span class="hljs-comment">// [2, 3, 4]</span>
</div></code></pre>
<h3 id="splice---remove-from-specific-position">splice() - Remove from Specific Position</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>, <span class="hljs-string">"yellow"</span>];

<span class="hljs-comment">// Remove 1 element at index 1</span>
<span class="hljs-keyword">const</span> removed = colors.splice(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(removed); <span class="hljs-comment">// ['green']</span>
<span class="hljs-built_in">console</span>.log(colors); <span class="hljs-comment">// ['red', 'blue', 'yellow']</span>

<span class="hljs-comment">// Remove multiple elements</span>
<span class="hljs-keyword">const</span> moreRemoved = colors.splice(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(moreRemoved); <span class="hljs-comment">// ['blue', 'yellow']</span>
<span class="hljs-built_in">console</span>.log(colors); <span class="hljs-comment">// ['red']</span>
</div></code></pre>
<h3 id="delete-operator-not-recommended">delete Operator (Not Recommended)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// delete creates "holes" in array</span>
<span class="hljs-keyword">delete</span> arr[<span class="hljs-number">2</span>];
<span class="hljs-built_in">console</span>.log(arr); <span class="hljs-comment">// [1, 2, undefined, 4, 5]</span>
<span class="hljs-built_in">console</span>.log(arr.length); <span class="hljs-comment">// 5 (length unchanged!)</span>

<span class="hljs-comment">// Use splice() instead</span>
<span class="hljs-keyword">const</span> arr2 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
arr2.splice(<span class="hljs-number">2</span>, <span class="hljs-number">1</span>);
<span class="hljs-built_in">console</span>.log(arr2); <span class="hljs-comment">// [1, 2, 4, 5]</span>
<span class="hljs-built_in">console</span>.log(arr2.length); <span class="hljs-comment">// 4</span>
</div></code></pre>
<h2 id="%F0%9F%94%84-iteration-methods">🔄 Iteration Methods</h2>
<h3 id="foreach---execute-function-for-each-element">forEach() - Execute Function for Each Element</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// Basic forEach</span>
numbers.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">number</span>) </span>{
  <span class="hljs-built_in">console</span>.log(number * <span class="hljs-number">2</span>);
});

<span class="hljs-comment">// Arrow function with index</span>
numbers.forEach(<span class="hljs-function">(<span class="hljs-params">number, index</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Index <span class="hljs-subst">${index}</span>: <span class="hljs-subst">${number}</span>`</span>);
});

<span class="hljs-comment">// With array parameter</span>
numbers.forEach(<span class="hljs-function">(<span class="hljs-params">number, index, array</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(
    <span class="hljs-string">`<span class="hljs-subst">${number}</span> is at index <span class="hljs-subst">${index}</span> of array with length <span class="hljs-subst">${array.length}</span>`</span>
  );
});
</div></code></pre>
<h3 id="map---transform-each-element">map() - Transform Each Element</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// Double each number</span>
<span class="hljs-keyword">const</span> doubled = numbers.map(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num * <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(doubled); <span class="hljs-comment">// [2, 4, 6, 8, 10]</span>

<span class="hljs-comment">// Transform objects</span>
<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span> },
];

<span class="hljs-keyword">const</span> names = users.map(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.name);
<span class="hljs-built_in">console</span>.log(names); <span class="hljs-comment">// ['Alice', 'Bob', 'Charlie']</span>

<span class="hljs-comment">// More complex transformation</span>
<span class="hljs-keyword">const</span> userInfo = users.map(<span class="hljs-function">(<span class="hljs-params">user, index</span>) =&gt;</span> ({
  <span class="hljs-attr">id</span>: index + <span class="hljs-number">1</span>,
  <span class="hljs-attr">displayName</span>: <span class="hljs-string">`<span class="hljs-subst">${user.name}</span> (<span class="hljs-subst">${user.age}</span> years old)`</span>,
  <span class="hljs-attr">isAdult</span>: user.age &gt;= <span class="hljs-number">18</span>,
}));
<span class="hljs-built_in">console</span>.log(userInfo);
</div></code></pre>
<h3 id="filter---filter-elements">filter() - Filter Elements</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>];

<span class="hljs-comment">// Filter even numbers</span>
<span class="hljs-keyword">const</span> evens = numbers.filter(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(evens); <span class="hljs-comment">// [2, 4, 6, 8, 10]</span>

<span class="hljs-comment">// Filter objects</span>
<span class="hljs-keyword">const</span> products = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Laptop"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">1000</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Phone"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">500</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Tablet"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">300</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span> },
];

<span class="hljs-keyword">const</span> availableProducts = products.filter(<span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> product.inStock);
<span class="hljs-keyword">const</span> expensiveProducts = products.filter(<span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> product.price &gt; <span class="hljs-number">400</span>);

<span class="hljs-built_in">console</span>.log(availableProducts);
<span class="hljs-built_in">console</span>.log(expensiveProducts);
</div></code></pre>
<h3 id="reduce---reduce-to-single-value">reduce() - Reduce to Single Value</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// Sum all numbers</span>
<span class="hljs-keyword">const</span> sum = numbers.reduce(<span class="hljs-function">(<span class="hljs-params">accumulator, current</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> accumulator + current;
}, <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(sum); <span class="hljs-comment">// 15</span>

<span class="hljs-comment">// Find maximum</span>
<span class="hljs-keyword">const</span> max = numbers.reduce(<span class="hljs-function">(<span class="hljs-params">max, current</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> current &gt; max ? current : max;
});
<span class="hljs-built_in">console</span>.log(max); <span class="hljs-comment">// 5</span>

<span class="hljs-comment">// Count occurrences</span>
<span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>];
<span class="hljs-keyword">const</span> count = fruits.reduce(<span class="hljs-function">(<span class="hljs-params">acc, fruit</span>) =&gt;</span> {
  acc[fruit] = (acc[fruit] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;
  <span class="hljs-keyword">return</span> acc;
}, {});
<span class="hljs-built_in">console</span>.log(count); <span class="hljs-comment">// { apple: 3, banana: 2, orange: 1 }</span>

<span class="hljs-comment">// Group by property</span>
<span class="hljs-keyword">const</span> people = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">city</span>: <span class="hljs-string">"London"</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span>, <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span> },
];

<span class="hljs-keyword">const</span> groupedByCity = people.reduce(<span class="hljs-function">(<span class="hljs-params">acc, person</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> city = person.city;
  <span class="hljs-keyword">if</span> (!acc[city]) {
    acc[city] = [];
  }
  acc[city].push(person);
  <span class="hljs-keyword">return</span> acc;
}, {});
<span class="hljs-built_in">console</span>.log(groupedByCity);
</div></code></pre>
<h2 id="%F0%9F%94%8D-search-methods">🔍 Search Methods</h2>
<h3 id="find---find-first-matching-element">find() - Find First Matching Element</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> },
];

<span class="hljs-comment">// Find first active user</span>
<span class="hljs-keyword">const</span> activeUser = users.find(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.active);
<span class="hljs-built_in">console</span>.log(activeUser); <span class="hljs-comment">// { id: 1, name: 'Alice', active: true }</span>

<span class="hljs-comment">// Find by ID</span>
<span class="hljs-keyword">const</span> userById = users.find(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id === <span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(userById); <span class="hljs-comment">// { id: 2, name: 'Bob', active: false }</span>

<span class="hljs-comment">// Returns undefined if not found</span>
<span class="hljs-keyword">const</span> notFound = users.find(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id === <span class="hljs-number">999</span>);
<span class="hljs-built_in">console</span>.log(notFound); <span class="hljs-comment">// undefined</span>
</div></code></pre>
<h3 id="findindex---find-index-of-first-match">findIndex() - Find Index of First Match</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">30</span>, <span class="hljs-number">40</span>, <span class="hljs-number">50</span>];

<span class="hljs-comment">// Find index of first number &gt; 25</span>
<span class="hljs-keyword">const</span> index = numbers.findIndex(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num &gt; <span class="hljs-number">25</span>);
<span class="hljs-built_in">console</span>.log(index); <span class="hljs-comment">// 2 (index of 30)</span>

<span class="hljs-comment">// Returns -1 if not found</span>
<span class="hljs-keyword">const</span> notFoundIndex = numbers.findIndex(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num &gt; <span class="hljs-number">100</span>);
<span class="hljs-built_in">console</span>.log(notFoundIndex); <span class="hljs-comment">// -1</span>
</div></code></pre>
<h3 id="indexof-and-lastindexof">indexOf() and lastIndexOf()</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"grape"</span>];

<span class="hljs-comment">// Find first occurrence</span>
<span class="hljs-built_in">console</span>.log(fruits.indexOf(<span class="hljs-string">"banana"</span>)); <span class="hljs-comment">// 1</span>
<span class="hljs-built_in">console</span>.log(fruits.indexOf(<span class="hljs-string">"kiwi"</span>)); <span class="hljs-comment">// -1 (not found)</span>

<span class="hljs-comment">// Find last occurrence</span>
<span class="hljs-built_in">console</span>.log(fruits.lastIndexOf(<span class="hljs-string">"banana"</span>)); <span class="hljs-comment">// 3</span>

<span class="hljs-comment">// With start position</span>
<span class="hljs-built_in">console</span>.log(fruits.indexOf(<span class="hljs-string">"banana"</span>, <span class="hljs-number">2</span>)); <span class="hljs-comment">// 3 (start searching from index 2)</span>
</div></code></pre>
<h3 id="includes---check-if-element-exists">includes() - Check if Element Exists</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>];

<span class="hljs-built_in">console</span>.log(colors.includes(<span class="hljs-string">"red"</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(colors.includes(<span class="hljs-string">"yellow"</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// Case sensitive</span>
<span class="hljs-built_in">console</span>.log(colors.includes(<span class="hljs-string">"Red"</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// With start position</span>
<span class="hljs-built_in">console</span>.log(colors.includes(<span class="hljs-string">"green"</span>, <span class="hljs-number">2</span>)); <span class="hljs-comment">// false (start from index 2)</span>
</div></code></pre>
<h2 id="%E2%9C%85-testing-methods">✅ Testing Methods</h2>
<h3 id="some---test-if-any-element-passes">some() - Test if Any Element Passes</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>];

<span class="hljs-comment">// Check if any number is even</span>
<span class="hljs-keyword">const</span> hasEven = numbers.some(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(hasEven); <span class="hljs-comment">// true (8 is even)</span>

<span class="hljs-comment">// Check if any number is &gt; 10</span>
<span class="hljs-keyword">const</span> hasLarge = numbers.some(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num &gt; <span class="hljs-number">10</span>);
<span class="hljs-built_in">console</span>.log(hasLarge); <span class="hljs-comment">// false</span>
</div></code></pre>
<h3 id="every---test-if-all-elements-pass">every() - Test if All Elements Pass</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>];

<span class="hljs-comment">// Check if all numbers are even</span>
<span class="hljs-keyword">const</span> allEven = numbers.every(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
<span class="hljs-built_in">console</span>.log(allEven); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Check if all numbers are &gt; 5</span>
<span class="hljs-keyword">const</span> allLarge = numbers.every(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num &gt; <span class="hljs-number">5</span>);
<span class="hljs-built_in">console</span>.log(allLarge); <span class="hljs-comment">// false (2 and 4 are not &gt; 5)</span>
</div></code></pre>
<h2 id="%F0%9F%94%A7-utility-methods">🔧 Utility Methods</h2>
<h3 id="join---convert-to-string">join() - Convert to String</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>];

<span class="hljs-comment">// Default separator (comma)</span>
<span class="hljs-built_in">console</span>.log(fruits.join()); <span class="hljs-comment">// "apple,banana,orange"</span>

<span class="hljs-comment">// Custom separator</span>
<span class="hljs-built_in">console</span>.log(fruits.join(<span class="hljs-string">" - "</span>)); <span class="hljs-comment">// "apple - banana - orange"</span>
<span class="hljs-built_in">console</span>.log(fruits.join(<span class="hljs-string">""</span>)); <span class="hljs-comment">// "applebananaorange"</span>
<span class="hljs-built_in">console</span>.log(fruits.join(<span class="hljs-string">" and "</span>)); <span class="hljs-comment">// "apple and banana and orange"</span>
</div></code></pre>
<h3 id="reverse---reverse-array-mutates-original">reverse() - Reverse Array (Mutates Original)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// Reverse in place</span>
numbers.reverse();
<span class="hljs-built_in">console</span>.log(numbers); <span class="hljs-comment">// [5, 4, 3, 2, 1]</span>

<span class="hljs-comment">// To avoid mutation, create copy first</span>
<span class="hljs-keyword">const</span> original = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> reversed = [...original].reverse();
<span class="hljs-built_in">console</span>.log(original); <span class="hljs-comment">// [1, 2, 3, 4, 5] (unchanged)</span>
<span class="hljs-built_in">console</span>.log(reversed); <span class="hljs-comment">// [5, 4, 3, 2, 1]</span>
</div></code></pre>
<h3 id="sort---sort-array-mutates-original">sort() - Sort Array (Mutates Original)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"banana"</span>, <span class="hljs-string">"apple"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"grape"</span>];

<span class="hljs-comment">// Default sort (alphabetical)</span>
fruits.sort();
<span class="hljs-built_in">console</span>.log(fruits); <span class="hljs-comment">// ['apple', 'banana', 'grape', 'orange']</span>

<span class="hljs-comment">// Numbers need custom compare function</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">40</span>, <span class="hljs-number">25</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">1</span>];

<span class="hljs-comment">// ❌ Wrong - converts to strings first</span>
numbers.sort();
<span class="hljs-built_in">console</span>.log(numbers); <span class="hljs-comment">// [1, 10, 1000, 25, 40, 5]</span>

<span class="hljs-comment">// ✅ Correct - numeric sort</span>
<span class="hljs-keyword">const</span> nums = [<span class="hljs-number">10</span>, <span class="hljs-number">5</span>, <span class="hljs-number">40</span>, <span class="hljs-number">25</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">1</span>];
nums.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b); <span class="hljs-comment">// Ascending</span>
<span class="hljs-built_in">console</span>.log(nums); <span class="hljs-comment">// [1, 5, 10, 25, 40, 1000]</span>

<span class="hljs-comment">// Descending</span>
nums.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b - a);
<span class="hljs-built_in">console</span>.log(nums); <span class="hljs-comment">// [1000, 40, 25, 10, 5, 1]</span>

<span class="hljs-comment">// Sort objects</span>
<span class="hljs-keyword">const</span> people = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span> },
];

<span class="hljs-comment">// Sort by age</span>
people.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.age - b.age);
<span class="hljs-built_in">console</span>.log(people);

<span class="hljs-comment">// Sort by name</span>
people.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.name.localeCompare(b.name));
<span class="hljs-built_in">console</span>.log(people);
</div></code></pre>
<h3 id="slice---extract-portion-non-mutating">slice() - Extract Portion (Non-Mutating)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"grape"</span>, <span class="hljs-string">"kiwi"</span>];

<span class="hljs-comment">// Extract from index 1 to 3 (exclusive)</span>
<span class="hljs-keyword">const</span> sliced = fruits.slice(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>);
<span class="hljs-built_in">console</span>.log(sliced); <span class="hljs-comment">// ['banana', 'orange']</span>
<span class="hljs-built_in">console</span>.log(fruits); <span class="hljs-comment">// Original unchanged</span>

<span class="hljs-comment">// From index to end</span>
<span class="hljs-keyword">const</span> fromIndex = fruits.slice(<span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(fromIndex); <span class="hljs-comment">// ['orange', 'grape', 'kiwi']</span>

<span class="hljs-comment">// Negative indices (from end)</span>
<span class="hljs-keyword">const</span> lastTwo = fruits.slice(<span class="hljs-number">-2</span>);
<span class="hljs-built_in">console</span>.log(lastTwo); <span class="hljs-comment">// ['grape', 'kiwi']</span>

<span class="hljs-comment">// Copy entire array</span>
<span class="hljs-keyword">const</span> copy = fruits.slice();
<span class="hljs-built_in">console</span>.log(copy); <span class="hljs-comment">// ['apple', 'banana', 'orange', 'grape', 'kiwi']</span>
</div></code></pre>
<h2 id="%F0%9F%94%97-chaining-methods">🔗 Chaining Methods</h2>
<h3 id="method-chaining-examples">Method Chaining Examples</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>];

<span class="hljs-comment">// Chain multiple operations</span>
<span class="hljs-keyword">const</span> result = numbers
  .filter(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>) <span class="hljs-comment">// Get even numbers: [2, 4, 6, 8, 10]</span>
  .map(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> num * num) <span class="hljs-comment">// Square them: [4, 16, 36, 64, 100]</span>
  .reduce(<span class="hljs-function">(<span class="hljs-params">sum, num</span>) =&gt;</span> sum + num, <span class="hljs-number">0</span>); <span class="hljs-comment">// Sum them: 220</span>

<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// 220</span>

<span class="hljs-comment">// More complex example</span>
<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">score</span>: <span class="hljs-number">85</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">score</span>: <span class="hljs-number">92</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">score</span>: <span class="hljs-number">78</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Diana"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">28</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">score</span>: <span class="hljs-number">95</span> },
];

<span class="hljs-keyword">const</span> topActiveUsers = users
  .filter(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.active) <span class="hljs-comment">// Only active users</span>
  .filter(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.score &gt; <span class="hljs-number">80</span>) <span class="hljs-comment">// High scores only</span>
  .sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.score - a.score) <span class="hljs-comment">// Sort by score (descending)</span>
  .map(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> ({
    <span class="hljs-comment">// Transform to simpler object</span>
    <span class="hljs-attr">name</span>: user.name,
    <span class="hljs-attr">score</span>: user.score,
    <span class="hljs-attr">grade</span>: user.score &gt;= <span class="hljs-number">90</span> ? <span class="hljs-string">"A"</span> : <span class="hljs-string">"B"</span>,
  }));

<span class="hljs-built_in">console</span>.log(topActiveUsers);
<span class="hljs-comment">// [{ name: 'Diana', score: 95, grade: 'A' }, { name: 'Alice', score: 85, grade: 'B' }]</span>
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-mutating-vs-non-mutating-methods">1. Mutating vs Non-Mutating Methods</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> original = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-comment">// ❌ These methods mutate the original array</span>
original.push(<span class="hljs-number">4</span>); <span class="hljs-comment">// [1, 2, 3, 4]</span>
original.pop(); <span class="hljs-comment">// [1, 2, 3]</span>
original.reverse(); <span class="hljs-comment">// [3, 2, 1]</span>
original.sort(); <span class="hljs-comment">// [1, 2, 3]</span>
original.splice(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>); <span class="hljs-comment">// [1, 3]</span>

<span class="hljs-comment">// ✅ These methods return new arrays</span>
<span class="hljs-keyword">const</span> arr = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">const</span> mapped = arr.map(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x * <span class="hljs-number">2</span>); <span class="hljs-comment">// [2, 4, 6], arr unchanged</span>
<span class="hljs-keyword">const</span> filtered = arr.filter(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x &gt; <span class="hljs-number">1</span>); <span class="hljs-comment">// [2, 3], arr unchanged</span>
<span class="hljs-keyword">const</span> sliced = arr.slice(<span class="hljs-number">1</span>); <span class="hljs-comment">// [2, 3], arr unchanged</span>
</div></code></pre>
<h3 id="2-array-reference-vs-copy">2. Array Reference vs Copy</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> original = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];

<span class="hljs-comment">// ❌ This creates a reference, not a copy</span>
<span class="hljs-keyword">const</span> reference = original;
reference.push(<span class="hljs-number">4</span>);
<span class="hljs-built_in">console</span>.log(original); <span class="hljs-comment">// [1, 2, 3, 4] - original is modified!</span>

<span class="hljs-comment">// ✅ Create actual copies</span>
<span class="hljs-keyword">const</span> copy1 = [...original]; <span class="hljs-comment">// Spread operator</span>
<span class="hljs-keyword">const</span> copy2 = <span class="hljs-built_in">Array</span>.from(original); <span class="hljs-comment">// Array.from()</span>
<span class="hljs-keyword">const</span> copy3 = original.slice(); <span class="hljs-comment">// slice() with no arguments</span>
</div></code></pre>
<h3 id="3-sparse-arrays">3. Sparse Arrays</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Creating sparse arrays</span>
<span class="hljs-keyword">const</span> sparse = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">3</span>); <span class="hljs-comment">// [undefined, undefined, undefined]</span>
<span class="hljs-keyword">const</span> sparse2 = [<span class="hljs-number">1</span>, , <span class="hljs-number">3</span>]; <span class="hljs-comment">// [1, undefined, 3]</span>

<span class="hljs-comment">// Some methods skip holes</span>
<span class="hljs-built_in">console</span>.log(sparse2.map(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x * <span class="hljs-number">2</span>)); <span class="hljs-comment">// [2, undefined, 6]</span>

<span class="hljs-comment">// Others don't</span>
<span class="hljs-built_in">console</span>.log(sparse2.forEach(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(x))); <span class="hljs-comment">// Only logs 1 and 3</span>
</div></code></pre>
<h3 id="4-sort-gotchas">4. Sort Gotchas</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Default sort converts to strings</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>, <span class="hljs-number">20</span>];
numbers.sort();
<span class="hljs-built_in">console</span>.log(numbers); <span class="hljs-comment">// [1, 10, 2, 20] - Wrong!</span>

<span class="hljs-comment">// ✅ Use compare function for numbers</span>
numbers.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b);
<span class="hljs-built_in">console</span>.log(numbers); <span class="hljs-comment">// [1, 2, 10, 20] - Correct!</span>
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-array-manipulation">Problem 1: Array Manipulation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Given an array of numbers, create a new array with:</span>
<span class="hljs-comment">// 1. Only even numbers</span>
<span class="hljs-comment">// 2. Each number squared</span>
<span class="hljs-comment">// 3. Sorted in descending order</span>

<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>, <span class="hljs-number">10</span>];

<span class="hljs-comment">// Your solution here</span>
<span class="hljs-keyword">const</span> result = numbers;
<span class="hljs-comment">// Your code here</span>

<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// Should output: [100, 64, 36, 16, 4]</span>
</div></code></pre>
<h3 id="problem-2-object-array-processing">Problem 2: Object Array Processing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Given an array of products, find:</span>
<span class="hljs-comment">// 1. Total value of all products in stock</span>
<span class="hljs-comment">// 2. Names of products under $50</span>
<span class="hljs-comment">// 3. Most expensive product</span>

<span class="hljs-keyword">const</span> products = [
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Laptop'</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">1000</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Phone'</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">500</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Tablet'</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">300</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Watch'</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Headphones'</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">false</span> }
];

<span class="hljs-comment">// Your solutions here</span>
<span class="hljs-keyword">const</span> totalValue = <span class="hljs-comment">// ?</span>
<span class="hljs-keyword">const</span> cheapProducts = <span class="hljs-comment">// ?</span>
<span class="hljs-keyword">const</span> mostExpensive = <span class="hljs-comment">// ?</span>
</div></code></pre>
<h3 id="problem-3-custom-array-methods">Problem 3: Custom Array Methods</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement these array methods from scratch:</span>

<span class="hljs-comment">// 1. Custom map</span>
<span class="hljs-built_in">Array</span>.prototype.myMap = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) </span>{
  <span class="hljs-comment">// Your implementation</span>
};

<span class="hljs-comment">// 2. Custom filter</span>
<span class="hljs-built_in">Array</span>.prototype.myFilter = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback</span>) </span>{
  <span class="hljs-comment">// Your implementation</span>
};

<span class="hljs-comment">// 3. Custom reduce</span>
<span class="hljs-built_in">Array</span>.prototype.myReduce = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">callback, initialValue</span>) </span>{
  <span class="hljs-comment">// Your implementation</span>
};

<span class="hljs-comment">// Test your implementations</span>
<span class="hljs-keyword">const</span> nums = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-built_in">console</span>.log(nums.myMap(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x * <span class="hljs-number">2</span>)); <span class="hljs-comment">// [2, 4, 6, 8, 10]</span>
<span class="hljs-built_in">console</span>.log(nums.myFilter(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>)); <span class="hljs-comment">// [2, 4]</span>
<span class="hljs-built_in">console</span>.log(nums.myReduce(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b, <span class="hljs-number">0</span>)); <span class="hljs-comment">// 15</span>
</div></code></pre>
<h3 id="problem-4-array-flattening">Problem 4: Array Flattening</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Flatten a nested array (one level deep)</span>
<span class="hljs-keyword">const</span> nested = [<span class="hljs-number">1</span>, [<span class="hljs-number">2</span>, <span class="hljs-number">3</span>], [<span class="hljs-number">4</span>, [<span class="hljs-number">5</span>, <span class="hljs-number">6</span>]], <span class="hljs-number">7</span>];

<span class="hljs-comment">// Your solution here (don't use flat())</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">flattenArray</span>(<span class="hljs-params">arr</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-built_in">console</span>.log(flattenArray(nested)); <span class="hljs-comment">// [1, 2, 3, 4, [5, 6], 7]</span>
</div></code></pre>
<h3 id="problem-5-remove-duplicates">Problem 5: Remove Duplicates</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Remove duplicates from an array while preserving order</span>
<span class="hljs-keyword">const</span> withDuplicates = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">1</span>];

<span class="hljs-comment">// Provide multiple solutions:</span>
<span class="hljs-comment">// 1. Using Set</span>
<span class="hljs-comment">// 2. Using filter + indexOf</span>
<span class="hljs-comment">// 3. Using reduce</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeDuplicates1</span>(<span class="hljs-params">arr</span>) </span>{
  <span class="hljs-comment">// Using Set</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeDuplicates2</span>(<span class="hljs-params">arr</span>) </span>{
  <span class="hljs-comment">// Using filter + indexOf</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeDuplicates3</span>(<span class="hljs-params">arr</span>) </span>{
  <span class="hljs-comment">// Using reduce</span>
}

<span class="hljs-built_in">console</span>.log(removeDuplicates1(withDuplicates)); <span class="hljs-comment">// [1, 2, 3, 4, 5]</span>
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between <code>map()</code> and <code>forEach()</code>?</strong></p>
<ul>
<li><code>map()</code> returns a new array with transformed elements</li>
<li><code>forEach()</code> executes a function for each element but returns undefined</li>
<li>Use <code>map()</code> when you need to transform data, <code>forEach()</code> for side effects</li>
</ul>
<p><strong>Q: How do you remove duplicates from an array?</strong></p>
<ul>
<li><code>[...new Set(array)]</code> - using Set (ES6)</li>
<li><code>array.filter((item, index) =&gt; array.indexOf(item) === index)</code></li>
<li>Using <code>reduce()</code> to build unique array</li>
</ul>
<p><strong>Q: What's the difference between <code>slice()</code> and <code>splice()</code>?</strong></p>
<ul>
<li><code>slice()</code> returns a new array (non-mutating)</li>
<li><code>splice()</code> modifies the original array (mutating)</li>
<li><code>slice()</code> for extraction, <code>splice()</code> for insertion/deletion</li>
</ul>
<p><strong>Q: How do you flatten an array?</strong></p>
<ul>
<li><code>array.flat()</code> - ES2019 method</li>
<li><code>[].concat(...array)</code> - spread with concat</li>
<li><code>array.reduce((acc, val) =&gt; acc.concat(val), [])</code></li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement array methods from scratch (map, filter, reduce)&quot;</li>
<li><strong>Facebook</strong>: &quot;Find the intersection of two arrays&quot;</li>
<li><strong>Amazon</strong>: &quot;Remove duplicates from an array without using Set&quot;</li>
<li><strong>Microsoft</strong>: &quot;Sort an array of objects by multiple properties&quot;</li>
<li><strong>Netflix</strong>: &quot;Implement a function to group array elements by a property&quot;</li>
</ul>
<h2 id="%F0%9F%93%8A-array-methods-cheat-sheet">📊 Array Methods Cheat Sheet</h2>
<pre class="hljs"><code><div>Mutating Methods (Change Original):
├── push(), pop(), shift(), unshift()
├── splice(), reverse(), sort()
└── fill(), copyWithin()

Non-Mutating Methods (Return New Array):
├── map(), filter(), reduce(), reduceRight()
├── slice(), concat(), flat(), flatMap()
├── find(), findIndex(), some(), every()
└── includes(), indexOf(), lastIndexOf()

Iteration Methods:
├── forEach() - Execute function for each
├── map() - Transform each element
├── filter() - Select elements
├── reduce() - Reduce to single value
├── find() - Find first match
└── some()/every() - Test elements
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Understand mutating vs non-mutating methods</strong></li>
<li><strong>Use method chaining for readable data transformations</strong></li>
<li><strong>Choose the right method for the task (map vs forEach)</strong></li>
<li><strong>Be careful with array references vs copies</strong></li>
<li><strong>Use spread operator for array copying and concatenation</strong></li>
<li><strong>Remember that sort() converts to strings by default</strong></li>
<li><strong>Practice implementing array methods from scratch</strong></li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./06-closures.md">← Closures Explained</a><br>
<strong>Next Chapter</strong>: <a href="./08-objects.md">Objects &amp; Object Access →</a></p>
<p><strong>Practice</strong>: Try the array manipulation problems and experiment with method chaining!</p>
<h1 id="%F0%9F%93%9A-chapter-8-objects--object-access">📚 Chapter 8: Objects &amp; Object Access</h1>
<blockquote>
<p>Master JavaScript objects, the foundation of everything in JavaScript.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Objects are like containers that hold related information and actions together. Think of them as:</p>
<ul>
<li><strong>Person</strong> = object with properties (name, age, height) and actions (walk, talk, eat)</li>
<li><strong>Car</strong> = object with properties (color, model, year) and actions (start, stop, accelerate)</li>
<li><strong>Book</strong> = object with properties (title, author, pages) and actions (open, close, bookmark)</li>
<li><strong>Bank Account</strong> = object with properties (balance, owner) and actions (deposit, withdraw)</li>
</ul>
<p>In JavaScript, almost everything is an object (except primitives), and objects are the building blocks of complex applications.</p>
<h2 id="%F0%9F%8F%97%EF%B8%8F-creating-objects">🏗️ Creating Objects</h2>
<h3 id="object-literal-most-common">Object Literal (Most Common)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Empty object</span>
<span class="hljs-keyword">const</span> emptyObj = {};

<span class="hljs-comment">// Object with properties</span>
<span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
  <span class="hljs-attr">isEmployed</span>: <span class="hljs-literal">true</span>,
};

<span class="hljs-comment">// Object with methods</span>
<span class="hljs-keyword">const</span> calculator = {
  <span class="hljs-attr">result</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">add</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) </span>{
    <span class="hljs-keyword">this</span>.result += num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  <span class="hljs-attr">subtract</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">num</span>) </span>{
    <span class="hljs-keyword">this</span>.result -= num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.result;
  },
};

<span class="hljs-comment">// ES6 method shorthand</span>
<span class="hljs-keyword">const</span> modernCalculator = {
  <span class="hljs-attr">result</span>: <span class="hljs-number">0</span>,
  add(num) {
    <span class="hljs-keyword">this</span>.result += num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  subtract(num) {
    <span class="hljs-keyword">this</span>.result -= num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
  getValue() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.result;
  },
};
</div></code></pre>
<h3 id="object-constructor">Object Constructor</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Using Object constructor</span>
<span class="hljs-keyword">const</span> obj1 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Object</span>();
obj1.name = <span class="hljs-string">"Alice"</span>;
obj1.age = <span class="hljs-number">30</span>;

<span class="hljs-comment">// Equivalent to object literal</span>
<span class="hljs-keyword">const</span> obj2 = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
};
</div></code></pre>
<h3 id="objectcreate">Object.create()</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create object with specific prototype</span>
<span class="hljs-keyword">const</span> personPrototype = {
  <span class="hljs-attr">greet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  },
};

<span class="hljs-keyword">const</span> alice = <span class="hljs-built_in">Object</span>.create(personPrototype);
alice.name = <span class="hljs-string">"Alice"</span>;
alice.age = <span class="hljs-number">30</span>;

<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>

<span class="hljs-comment">// Create object with null prototype (no inherited properties)</span>
<span class="hljs-keyword">const</span> pureObject = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
pureObject.name = <span class="hljs-string">"Pure"</span>;
<span class="hljs-built_in">console</span>.log(pureObject.toString); <span class="hljs-comment">// undefined (no inherited methods)</span>
</div></code></pre>
<h3 id="constructor-functions">Constructor Functions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Constructor function (before ES6 classes)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name, age, city</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.age = age;
  <span class="hljs-keyword">this</span>.city = city;

  <span class="hljs-keyword">this</span>.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> from <span class="hljs-subst">${<span class="hljs-keyword">this</span>.city}</span>`</span>;
  };
}

<span class="hljs-comment">// Create instances</span>
<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>, <span class="hljs-string">"New York"</span>);
<span class="hljs-keyword">const</span> bob = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">25</span>, <span class="hljs-string">"London"</span>);

<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hello, I'm Alice from New York"</span>
<span class="hljs-built_in">console</span>.log(bob.greet()); <span class="hljs-comment">// "Hello, I'm Bob from London"</span>
</div></code></pre>
<h3 id="es6-classes">ES6 Classes</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, age, city) {
    <span class="hljs-keyword">this</span>.name = name;
    <span class="hljs-keyword">this</span>.age = age;
    <span class="hljs-keyword">this</span>.city = city;
  }

  greet() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> from <span class="hljs-subst">${<span class="hljs-keyword">this</span>.city}</span>`</span>;
  }

  getAge() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age;
  }

  <span class="hljs-comment">// Static method</span>
  <span class="hljs-keyword">static</span> createAnonymous() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Anonymous"</span>, <span class="hljs-number">0</span>, <span class="hljs-string">"Unknown"</span>);
  }
}

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>, <span class="hljs-string">"New York"</span>);
<span class="hljs-built_in">console</span>.log(alice.greet());

<span class="hljs-keyword">const</span> anon = Person.createAnonymous();
<span class="hljs-built_in">console</span>.log(anon.name); <span class="hljs-comment">// 'Anonymous'</span>
</div></code></pre>
<h2 id="%F0%9F%94%8D-accessing-object-properties">🔍 Accessing Object Properties</h2>
<h3 id="dot-notation">Dot Notation</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">street</span>: <span class="hljs-string">"123 Main St"</span>,
    <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
    <span class="hljs-attr">zipCode</span>: <span class="hljs-string">"10001"</span>,
  },
};

<span class="hljs-comment">// Reading properties</span>
<span class="hljs-built_in">console</span>.log(person.name); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(person.age); <span class="hljs-comment">// 30</span>
<span class="hljs-built_in">console</span>.log(person.address.city); <span class="hljs-comment">// 'New York'</span>

<span class="hljs-comment">// Setting properties</span>
person.name = <span class="hljs-string">"Alice Smith"</span>;
person.email = <span class="hljs-string">"alice@example.com"</span>; <span class="hljs-comment">// Adding new property</span>
person.address.country = <span class="hljs-string">"USA"</span>; <span class="hljs-comment">// Adding nested property</span>

<span class="hljs-built_in">console</span>.log(person.email); <span class="hljs-comment">// 'alice@example.com'</span>
</div></code></pre>
<h3 id="bracket-notation">Bracket Notation</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-string">"favorite color"</span>: <span class="hljs-string">"blue"</span>, <span class="hljs-comment">// Property with space</span>
  <span class="hljs-number">123</span>: <span class="hljs-string">"numeric key"</span>, <span class="hljs-comment">// Numeric string key</span>
};

<span class="hljs-comment">// Reading with bracket notation</span>
<span class="hljs-built_in">console</span>.log(person[<span class="hljs-string">"name"</span>]); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(person[<span class="hljs-string">"favorite color"</span>]); <span class="hljs-comment">// 'blue'</span>
<span class="hljs-built_in">console</span>.log(person[<span class="hljs-string">"123"</span>]); <span class="hljs-comment">// 'numeric key'</span>

<span class="hljs-comment">// Dynamic property access</span>
<span class="hljs-keyword">const</span> propertyName = <span class="hljs-string">"age"</span>;
<span class="hljs-built_in">console</span>.log(person[propertyName]); <span class="hljs-comment">// 30</span>

<span class="hljs-comment">// Setting with bracket notation</span>
person[<span class="hljs-string">"last name"</span>] = <span class="hljs-string">"Smith"</span>;
person[propertyName] = <span class="hljs-number">31</span>;

<span class="hljs-comment">// Computed property names</span>
<span class="hljs-keyword">const</span> prefix = <span class="hljs-string">"user"</span>;
<span class="hljs-keyword">const</span> obj = {
  [prefix + <span class="hljs-string">"Name"</span>]: <span class="hljs-string">"Alice"</span>, <span class="hljs-comment">// userName: 'Alice'</span>
  [prefix + <span class="hljs-string">"Age"</span>]: <span class="hljs-number">30</span>, <span class="hljs-comment">// userAge: 30</span>
  [<span class="hljs-string">`<span class="hljs-subst">${prefix}</span>Email`</span>]: <span class="hljs-string">"alice@example.com"</span>, <span class="hljs-comment">// userEmail: 'alice@example.com'</span>
};

<span class="hljs-built_in">console</span>.log(obj.userName); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(obj.userAge); <span class="hljs-comment">// 30</span>
<span class="hljs-built_in">console</span>.log(obj.userEmail); <span class="hljs-comment">// 'alice@example.com'</span>
</div></code></pre>
<h3 id="when-to-use-dot-vs-bracket-notation">When to Use Dot vs Bracket Notation</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-string">"first-name"</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-number">123</span>: <span class="hljs-string">"number"</span>,
  <span class="hljs-string">"user name"</span>: <span class="hljs-string">"alice123"</span>,
};

<span class="hljs-comment">// ✅ Use dot notation when:</span>
<span class="hljs-comment">// - Property name is a valid identifier</span>
<span class="hljs-comment">// - Property name is known at write time</span>
<span class="hljs-built_in">console</span>.log(obj.name);

<span class="hljs-comment">// ✅ Use bracket notation when:</span>
<span class="hljs-comment">// - Property name has spaces, hyphens, or special characters</span>
<span class="hljs-built_in">console</span>.log(obj[<span class="hljs-string">"first-name"</span>]);
<span class="hljs-built_in">console</span>.log(obj[<span class="hljs-string">"user name"</span>]);

<span class="hljs-comment">// - Property name starts with a number</span>
<span class="hljs-built_in">console</span>.log(obj[<span class="hljs-string">"123"</span>]);

<span class="hljs-comment">// - Property name is dynamic/computed</span>
<span class="hljs-keyword">const</span> propName = <span class="hljs-string">"name"</span>;
<span class="hljs-built_in">console</span>.log(obj[propName]);

<span class="hljs-comment">// - Property name comes from a variable</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getValue</span>(<span class="hljs-params">object, key</span>) </span>{
  <span class="hljs-keyword">return</span> object[key];
}

<span class="hljs-built_in">console</span>.log(getValue(obj, <span class="hljs-string">"name"</span>)); <span class="hljs-comment">// 'Alice'</span>
</div></code></pre>
<h2 id="%F0%9F%94%A7-object-methods-and-this">🔧 Object Methods and <code>this</code></h2>
<h3 id="method-definition">Method Definition</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,

  <span class="hljs-comment">// Method using function keyword</span>
  <span class="hljs-attr">greet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  },

  <span class="hljs-comment">// ES6 method shorthand</span>
  introduce() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> and I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span> years old`</span>;
  },

  <span class="hljs-comment">// Arrow function (be careful with 'this'!)</span>
  <span class="hljs-attr">arrowMethod</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// 'this' doesn't refer to the object!</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello from <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>; <span class="hljs-comment">// undefined</span>
  },

  <span class="hljs-comment">// Method that modifies object</span>
  haveBirthday() {
    <span class="hljs-keyword">this</span>.age++;
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Happy birthday! Now I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span>`</span>;
  },
};

<span class="hljs-built_in">console</span>.log(person.greet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>
<span class="hljs-built_in">console</span>.log(person.introduce()); <span class="hljs-comment">// "I'm Alice and I'm 30 years old"</span>
<span class="hljs-built_in">console</span>.log(person.arrowMethod()); <span class="hljs-comment">// "Hello from undefined"</span>
<span class="hljs-built_in">console</span>.log(person.haveBirthday()); <span class="hljs-comment">// "Happy birthday! Now I'm 31"</span>
</div></code></pre>
<h3 id="understanding-this-context">Understanding <code>this</code> Context</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  greet() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  },
};

<span class="hljs-comment">// Method called on object - 'this' refers to person</span>
<span class="hljs-built_in">console</span>.log(person.greet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>

<span class="hljs-comment">// Method assigned to variable - 'this' context lost</span>
<span class="hljs-keyword">const</span> greetFunction = person.greet;
<span class="hljs-built_in">console</span>.log(greetFunction()); <span class="hljs-comment">// "Hello, I'm undefined"</span>

<span class="hljs-comment">// Binding 'this' context</span>
<span class="hljs-keyword">const</span> boundGreet = person.greet.bind(person);
<span class="hljs-built_in">console</span>.log(boundGreet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>

<span class="hljs-comment">// Using call() and apply()</span>
<span class="hljs-keyword">const</span> anotherPerson = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span> };
<span class="hljs-built_in">console</span>.log(person.greet.call(anotherPerson)); <span class="hljs-comment">// "Hello, I'm Bob"</span>
<span class="hljs-built_in">console</span>.log(person.greet.apply(anotherPerson)); <span class="hljs-comment">// "Hello, I'm Bob"</span>
</div></code></pre>
<h3 id="method-chaining">Method Chaining</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> calculator = {
  <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,

  add(num) {
    <span class="hljs-keyword">this</span>.value += num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>; <span class="hljs-comment">// Return 'this' for chaining</span>
  },

  subtract(num) {
    <span class="hljs-keyword">this</span>.value -= num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },

  multiply(num) {
    <span class="hljs-keyword">this</span>.value *= num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },

  divide(num) {
    <span class="hljs-keyword">if</span> (num !== <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.value /= num;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },

  getValue() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;
  },

  reset() {
    <span class="hljs-keyword">this</span>.value = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },
};

<span class="hljs-comment">// Method chaining</span>
<span class="hljs-keyword">const</span> result = calculator.add(<span class="hljs-number">10</span>).multiply(<span class="hljs-number">2</span>).subtract(<span class="hljs-number">5</span>).divide(<span class="hljs-number">3</span>).getValue();

<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// 5</span>

<span class="hljs-comment">// Reset and chain again</span>
calculator.reset().add(<span class="hljs-number">100</span>).subtract(<span class="hljs-number">50</span>).multiply(<span class="hljs-number">2</span>);
<span class="hljs-built_in">console</span>.log(calculator.getValue()); <span class="hljs-comment">// 100</span>
</div></code></pre>
<h2 id="%F0%9F%94%8D-object-property-descriptors">🔍 Object Property Descriptors</h2>
<h3 id="property-descriptors">Property Descriptors</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
};

<span class="hljs-comment">// Get property descriptor</span>
<span class="hljs-keyword">const</span> nameDescriptor = <span class="hljs-built_in">Object</span>.getOwnPropertyDescriptor(person, <span class="hljs-string">"name"</span>);
<span class="hljs-built_in">console</span>.log(nameDescriptor);
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   value: 'Alice',</span>
<span class="hljs-comment">//   writable: true,</span>
<span class="hljs-comment">//   enumerable: true,</span>
<span class="hljs-comment">//   configurable: true</span>
<span class="hljs-comment">// }</span>

<span class="hljs-comment">// Define property with custom descriptor</span>
<span class="hljs-built_in">Object</span>.defineProperty(person, <span class="hljs-string">"id"</span>, {
  <span class="hljs-attr">value</span>: <span class="hljs-number">12345</span>,
  <span class="hljs-attr">writable</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Cannot be changed</span>
  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Won't show in for...in or Object.keys()</span>
  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Cannot be deleted or reconfigured</span>
});

<span class="hljs-built_in">console</span>.log(person.id); <span class="hljs-comment">// 12345</span>
person.id = <span class="hljs-number">54321</span>; <span class="hljs-comment">// Silently fails (or throws in strict mode)</span>
<span class="hljs-built_in">console</span>.log(person.id); <span class="hljs-comment">// 12345 (unchanged)</span>

<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.keys(person)); <span class="hljs-comment">// ['name', 'age'] (id not enumerable)</span>

<span class="hljs-comment">// Define multiple properties</span>
<span class="hljs-built_in">Object</span>.defineProperties(person, {
  <span class="hljs-attr">firstName</span>: {
    <span class="hljs-attr">value</span>: <span class="hljs-string">"Alice"</span>,
    <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
  },
  <span class="hljs-attr">lastName</span>: {
    <span class="hljs-attr">value</span>: <span class="hljs-string">"Smith"</span>,
    <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
  },
});
</div></code></pre>
<h3 id="getters-and-setters">Getters and Setters</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">firstName</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">lastName</span>: <span class="hljs-string">"Smith"</span>,

  <span class="hljs-comment">// Getter - computed property</span>
  <span class="hljs-keyword">get</span> fullName() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.firstName}</span> <span class="hljs-subst">${<span class="hljs-keyword">this</span>.lastName}</span>`</span>;
  },

  <span class="hljs-comment">// Setter - validates and sets value</span>
  <span class="hljs-keyword">set</span> fullName(value) {
    <span class="hljs-keyword">const</span> parts = value.split(<span class="hljs-string">" "</span>);
    <span class="hljs-keyword">if</span> (parts.length === <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">this</span>.firstName = parts[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">this</span>.lastName = parts[<span class="hljs-number">1</span>];
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Full name must be in format "First Last"'</span>);
    }
  },

  <span class="hljs-comment">// Private-like property with getter/setter</span>
  <span class="hljs-attr">_age</span>: <span class="hljs-number">30</span>,

  <span class="hljs-keyword">get</span> age() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._age;
  },

  <span class="hljs-keyword">set</span> age(value) {
    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">0</span> || value &gt; <span class="hljs-number">150</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Age must be between 0 and 150"</span>);
    }
    <span class="hljs-keyword">this</span>._age = value;
  },
};

<span class="hljs-comment">// Using getters and setters</span>
<span class="hljs-built_in">console</span>.log(person.fullName); <span class="hljs-comment">// "Alice Smith"</span>
person.fullName = <span class="hljs-string">"Bob Johnson"</span>;
<span class="hljs-built_in">console</span>.log(person.firstName); <span class="hljs-comment">// "Bob"</span>
<span class="hljs-built_in">console</span>.log(person.lastName); <span class="hljs-comment">// "Johnson"</span>

<span class="hljs-built_in">console</span>.log(person.age); <span class="hljs-comment">// 30</span>
person.age = <span class="hljs-number">25</span>;
<span class="hljs-built_in">console</span>.log(person.age); <span class="hljs-comment">// 25</span>

<span class="hljs-comment">// This will throw an error</span>
<span class="hljs-comment">// person.age = -5; // Error: Age must be between 0 and 150</span>

<span class="hljs-comment">// Define getter/setter with Object.defineProperty</span>
<span class="hljs-keyword">const</span> obj = {};
<span class="hljs-built_in">Object</span>.defineProperty(obj, <span class="hljs-string">"temperature"</span>, {
  <span class="hljs-keyword">get</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._celsius;
  },
  <span class="hljs-keyword">set</span>(celsius) {
    <span class="hljs-keyword">this</span>._celsius = celsius;
    <span class="hljs-keyword">this</span>._fahrenheit = (celsius * <span class="hljs-number">9</span>) / <span class="hljs-number">5</span> + <span class="hljs-number">32</span>;
  },
  <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
});

obj.temperature = <span class="hljs-number">25</span>;
<span class="hljs-built_in">console</span>.log(obj.temperature); <span class="hljs-comment">// 25</span>
<span class="hljs-built_in">console</span>.log(obj._fahrenheit); <span class="hljs-comment">// 77</span>
</div></code></pre>
<h2 id="%F0%9F%94%84-object-iteration">🔄 Object Iteration</h2>
<h3 id="forin-loop">for...in Loop</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
};

<span class="hljs-comment">// Iterate over enumerable properties</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> person) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${person[key]}</span>`</span>);
}
<span class="hljs-comment">// Output:</span>
<span class="hljs-comment">// name: Alice</span>
<span class="hljs-comment">// age: 30</span>
<span class="hljs-comment">// city: New York</span>

<span class="hljs-comment">// Check if property belongs to object (not inherited)</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> key <span class="hljs-keyword">in</span> person) {
  <span class="hljs-keyword">if</span> (person.hasOwnProperty(key)) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${person[key]}</span>`</span>);
  }
}
</div></code></pre>
<h3 id="objectkeys-objectvalues-objectentries">Object.keys(), Object.values(), Object.entries()</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
};

<span class="hljs-comment">// Get all keys</span>
<span class="hljs-keyword">const</span> keys = <span class="hljs-built_in">Object</span>.keys(person);
<span class="hljs-built_in">console</span>.log(keys); <span class="hljs-comment">// ['name', 'age', 'city']</span>

<span class="hljs-comment">// Get all values</span>
<span class="hljs-keyword">const</span> values = <span class="hljs-built_in">Object</span>.values(person);
<span class="hljs-built_in">console</span>.log(values); <span class="hljs-comment">// ['Alice', 30, 'New York']</span>

<span class="hljs-comment">// Get key-value pairs</span>
<span class="hljs-keyword">const</span> entries = <span class="hljs-built_in">Object</span>.entries(person);
<span class="hljs-built_in">console</span>.log(entries); <span class="hljs-comment">// [['name', 'Alice'], ['age', 30], ['city', 'New York']]</span>

<span class="hljs-comment">// Iterate using these methods</span>
<span class="hljs-built_in">Object</span>.keys(person).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${person[key]}</span>`</span>);
});

<span class="hljs-built_in">Object</span>.entries(person).forEach(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${value}</span>`</span>);
});

<span class="hljs-comment">// Convert back to object</span>
<span class="hljs-keyword">const</span> newObj = <span class="hljs-built_in">Object</span>.fromEntries(entries);
<span class="hljs-built_in">console</span>.log(newObj); <span class="hljs-comment">// { name: 'Alice', age: 30, city: 'New York' }</span>
</div></code></pre>
<h2 id="%F0%9F%9B%A0%EF%B8%8F-object-utility-methods">🛠️ Object Utility Methods</h2>
<h3 id="objectassign---copying-and-merging">Object.assign() - Copying and Merging</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> target = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">const</span> source1 = { <span class="hljs-attr">b</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">4</span> };
<span class="hljs-keyword">const</span> source2 = { <span class="hljs-attr">c</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">6</span> };

<span class="hljs-comment">// Merge objects (modifies target)</span>
<span class="hljs-built_in">Object</span>.assign(target, source1, source2);
<span class="hljs-built_in">console</span>.log(target); <span class="hljs-comment">// { a: 1, b: 3, c: 5, d: 6 }</span>

<span class="hljs-comment">// Create new object without modifying original</span>
<span class="hljs-keyword">const</span> original = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-keyword">const</span> copy = <span class="hljs-built_in">Object</span>.assign({}, original, { <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span> });
<span class="hljs-built_in">console</span>.log(copy); <span class="hljs-comment">// { name: 'Alice', age: 30, city: 'New York' }</span>
<span class="hljs-built_in">console</span>.log(original); <span class="hljs-comment">// { name: 'Alice', age: 30 } (unchanged)</span>

<span class="hljs-comment">// Shallow copy limitation</span>
<span class="hljs-keyword">const</span> obj1 = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">address</span>: { <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>, <span class="hljs-attr">zip</span>: <span class="hljs-string">"10001"</span> },
};

<span class="hljs-keyword">const</span> obj2 = <span class="hljs-built_in">Object</span>.assign({}, obj1);
obj2.address.city = <span class="hljs-string">"Boston"</span>; <span class="hljs-comment">// Modifies original!</span>
<span class="hljs-built_in">console</span>.log(obj1.address.city); <span class="hljs-comment">// 'Boston' (not 'New York'!)</span>
</div></code></pre>
<h3 id="spread-operator-es6">Spread Operator (ES6)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> obj1 = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> };
<span class="hljs-keyword">const</span> obj2 = { <span class="hljs-attr">b</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">c</span>: <span class="hljs-number">4</span> };
<span class="hljs-keyword">const</span> obj3 = { <span class="hljs-attr">c</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">d</span>: <span class="hljs-number">6</span> };

<span class="hljs-comment">// Merge objects with spread</span>
<span class="hljs-keyword">const</span> merged = { ...obj1, ...obj2, ...obj3 };
<span class="hljs-built_in">console</span>.log(merged); <span class="hljs-comment">// { a: 1, b: 3, c: 5, d: 6 }</span>

<span class="hljs-comment">// Add properties while copying</span>
<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-keyword">const</span> employee = {
  ...person,
  <span class="hljs-attr">id</span>: <span class="hljs-number">12345</span>,
  <span class="hljs-attr">department</span>: <span class="hljs-string">"Engineering"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">31</span>, <span class="hljs-comment">// Override existing property</span>
};
<span class="hljs-built_in">console</span>.log(employee); <span class="hljs-comment">// { name: 'Alice', age: 31, id: 12345, department: 'Engineering' }</span>

<span class="hljs-comment">// Conditional properties</span>
<span class="hljs-keyword">const</span> includeEmail = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  ...(includeEmail &amp;&amp; { <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span> }),
};
<span class="hljs-built_in">console</span>.log(user); <span class="hljs-comment">// { name: 'Alice', age: 30, email: 'alice@example.com' }</span>
</div></code></pre>
<h3 id="objectfreeze-objectseal-objectpreventextensions">Object.freeze(), Object.seal(), Object.preventExtensions()</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> obj = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };

<span class="hljs-comment">// Object.freeze() - completely immutable</span>
<span class="hljs-keyword">const</span> frozen = <span class="hljs-built_in">Object</span>.freeze({ ...obj });
frozen.name = <span class="hljs-string">"Bob"</span>; <span class="hljs-comment">// Silently fails</span>
frozen.city = <span class="hljs-string">"New York"</span>; <span class="hljs-comment">// Silently fails</span>
<span class="hljs-keyword">delete</span> frozen.age; <span class="hljs-comment">// Silently fails</span>
<span class="hljs-built_in">console</span>.log(frozen); <span class="hljs-comment">// { name: 'Alice', age: 30 } (unchanged)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.isFrozen(frozen)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Object.seal() - can modify existing properties, but can't add/delete</span>
<span class="hljs-keyword">const</span> sealed = <span class="hljs-built_in">Object</span>.seal({ ...obj });
sealed.name = <span class="hljs-string">"Bob"</span>; <span class="hljs-comment">// ✅ Works</span>
sealed.city = <span class="hljs-string">"New York"</span>; <span class="hljs-comment">// ❌ Silently fails</span>
<span class="hljs-keyword">delete</span> sealed.age; <span class="hljs-comment">// ❌ Silently fails</span>
<span class="hljs-built_in">console</span>.log(sealed); <span class="hljs-comment">// { name: 'Bob', age: 30 }</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.isSealed(sealed)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Object.preventExtensions() - can modify and delete, but can't add</span>
<span class="hljs-keyword">const</span> nonExtensible = <span class="hljs-built_in">Object</span>.preventExtensions({ ...obj });
nonExtensible.name = <span class="hljs-string">"Bob"</span>; <span class="hljs-comment">// ✅ Works</span>
nonExtensible.city = <span class="hljs-string">"New York"</span>; <span class="hljs-comment">// ❌ Silently fails</span>
<span class="hljs-keyword">delete</span> nonExtensible.age; <span class="hljs-comment">// ✅ Works</span>
<span class="hljs-built_in">console</span>.log(nonExtensible); <span class="hljs-comment">// { name: 'Bob' }</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.isExtensible(nonExtensible)); <span class="hljs-comment">// false</span>
</div></code></pre>
<h2 id="%F0%9F%94%8D-object-comparison-and-checking">🔍 Object Comparison and Checking</h2>
<h3 id="checking-properties">Checking Properties</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
  },
};

<span class="hljs-comment">// Check if property exists</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"name"</span> <span class="hljs-keyword">in</span> person); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"email"</span> <span class="hljs-keyword">in</span> person); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"toString"</span> <span class="hljs-keyword">in</span> person); <span class="hljs-comment">// true (inherited)</span>

<span class="hljs-comment">// Check own property (not inherited)</span>
<span class="hljs-built_in">console</span>.log(person.hasOwnProperty(<span class="hljs-string">"name"</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(person.hasOwnProperty(<span class="hljs-string">"toString"</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// Modern alternative to hasOwnProperty</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.hasOwn(person, <span class="hljs-string">"name"</span>)); <span class="hljs-comment">// true (ES2022)</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.hasOwn(person, <span class="hljs-string">"toString"</span>)); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// Check if property is undefined</span>
<span class="hljs-built_in">console</span>.log(person.name !== <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(person.email !== <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// false</span>

<span class="hljs-comment">// Nested property checking</span>
<span class="hljs-built_in">console</span>.log(person.address &amp;&amp; person.address.city); <span class="hljs-comment">// 'New York'</span>
<span class="hljs-built_in">console</span>.log(person.address &amp;&amp; person.address.zip); <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// Optional chaining (ES2020)</span>
<span class="hljs-built_in">console</span>.log(person.address?.city); <span class="hljs-comment">// 'New York'</span>
<span class="hljs-built_in">console</span>.log(person.address?.zip); <span class="hljs-comment">// undefined</span>
<span class="hljs-built_in">console</span>.log(person.contact?.email); <span class="hljs-comment">// undefined (no error)</span>
</div></code></pre>
<h3 id="object-comparison">Object Comparison</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Objects are compared by reference, not value</span>
<span class="hljs-keyword">const</span> obj1 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
<span class="hljs-keyword">const</span> obj2 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
<span class="hljs-keyword">const</span> obj3 = obj1;

<span class="hljs-built_in">console</span>.log(obj1 === obj2); <span class="hljs-comment">// false (different objects)</span>
<span class="hljs-built_in">console</span>.log(obj1 === obj3); <span class="hljs-comment">// true (same reference)</span>

<span class="hljs-comment">// Shallow equality check</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shallowEqual</span>(<span class="hljs-params">obj1, obj2</span>) </span>{
  <span class="hljs-keyword">const</span> keys1 = <span class="hljs-built_in">Object</span>.keys(obj1);
  <span class="hljs-keyword">const</span> keys2 = <span class="hljs-built_in">Object</span>.keys(obj2);

  <span class="hljs-keyword">if</span> (keys1.length !== keys2.length) {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> keys1) {
    <span class="hljs-keyword">if</span> (obj1[key] !== obj2[key]) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-built_in">console</span>.log(shallowEqual(obj1, obj2)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Deep equality check (simplified)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepEqual</span>(<span class="hljs-params">obj1, obj2</span>) </span>{
  <span class="hljs-keyword">if</span> (obj1 === obj2) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

  <span class="hljs-keyword">if</span> (obj1 == <span class="hljs-literal">null</span> || obj2 == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj1 !== <span class="hljs-string">"object"</span> || <span class="hljs-keyword">typeof</span> obj2 !== <span class="hljs-string">"object"</span>) {
    <span class="hljs-keyword">return</span> obj1 === obj2;
  }

  <span class="hljs-keyword">const</span> keys1 = <span class="hljs-built_in">Object</span>.keys(obj1);
  <span class="hljs-keyword">const</span> keys2 = <span class="hljs-built_in">Object</span>.keys(obj2);

  <span class="hljs-keyword">if</span> (keys1.length !== keys2.length) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> keys1) {
    <span class="hljs-keyword">if</span> (!keys2.includes(key)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!deepEqual(obj1[key], obj2[key])) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-keyword">const</span> deep1 = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> } };
<span class="hljs-keyword">const</span> deep2 = { <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: { <span class="hljs-attr">c</span>: <span class="hljs-number">2</span> } };
<span class="hljs-built_in">console</span>.log(deepEqual(deep1, deep2)); <span class="hljs-comment">// true</span>
</div></code></pre>
<h2 id="%F0%9F%94%84-destructuring-objects">🔄 Destructuring Objects</h2>
<h3 id="basic-destructuring">Basic Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
  <span class="hljs-attr">country</span>: <span class="hljs-string">"USA"</span>,
};

<span class="hljs-comment">// Basic destructuring</span>
<span class="hljs-keyword">const</span> { name, age } = person;
<span class="hljs-built_in">console</span>.log(name, age); <span class="hljs-comment">// 'Alice', 30</span>

<span class="hljs-comment">// Rename variables</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">name</span>: fullName, <span class="hljs-attr">age</span>: years } = person;
<span class="hljs-built_in">console</span>.log(fullName, years); <span class="hljs-comment">// 'Alice', 30</span>

<span class="hljs-comment">// Default values</span>
<span class="hljs-keyword">const</span> { name, email = <span class="hljs-string">"No email"</span> } = person;
<span class="hljs-built_in">console</span>.log(name, email); <span class="hljs-comment">// 'Alice', 'No email'</span>

<span class="hljs-comment">// Rest operator</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">name</span>: personName, ...rest } = person;
<span class="hljs-built_in">console</span>.log(personName); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(rest); <span class="hljs-comment">// { age: 30, city: 'New York', country: 'USA' }</span>
</div></code></pre>
<h3 id="nested-destructuring">Nested Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">street</span>: <span class="hljs-string">"123 Main St"</span>,
    <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
    <span class="hljs-attr">coordinates</span>: {
      <span class="hljs-attr">lat</span>: <span class="hljs-number">40.7128</span>,
      <span class="hljs-attr">lng</span>: <span class="hljs-number">-74.006</span>,
    },
  },
  <span class="hljs-attr">preferences</span>: {
    <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
    <span class="hljs-attr">language</span>: <span class="hljs-string">"en"</span>,
  },
};

<span class="hljs-comment">// Nested destructuring</span>
<span class="hljs-keyword">const</span> {
  name,
  <span class="hljs-attr">address</span>: {
    city,
    <span class="hljs-attr">coordinates</span>: { lat, lng },
  },
  <span class="hljs-attr">preferences</span>: { theme },
} = user;

<span class="hljs-built_in">console</span>.log(name, city, lat, lng, theme);
<span class="hljs-comment">// 'Alice', 'New York', 40.7128, -74.0060, 'dark'</span>

<span class="hljs-comment">// Destructuring with default values for nested properties</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">address</span>: { zipCode = <span class="hljs-string">"Unknown"</span> } = {} } = user;

<span class="hljs-built_in">console</span>.log(zipCode); <span class="hljs-comment">// 'Unknown'</span>
</div></code></pre>
<h3 id="function-parameter-destructuring">Function Parameter Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Function with object parameter</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greetUser</span>(<span class="hljs-params">{ name, age, city = <span class="hljs-string">"Unknown"</span> }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>, age <span class="hljs-subst">${age}</span> from <span class="hljs-subst">${city}</span>`</span>;
}

<span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-built_in">console</span>.log(greetUser(user)); <span class="hljs-comment">// "Hello Alice, age 30 from Unknown"</span>

<span class="hljs-comment">// Nested destructuring in parameters</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processOrder</span>(<span class="hljs-params">{
  id,
  customer: { name, email },
  items = [],
  shipping: { address, method = <span class="hljs-string">"standard"</span> } = {},
}</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">orderId</span>: id,
    <span class="hljs-attr">customerName</span>: name,
    <span class="hljs-attr">customerEmail</span>: email,
    <span class="hljs-attr">itemCount</span>: items.length,
    <span class="hljs-attr">shippingAddress</span>: address,
    <span class="hljs-attr">shippingMethod</span>: method,
  };
}

<span class="hljs-keyword">const</span> order = {
  <span class="hljs-attr">id</span>: <span class="hljs-string">"ORD-123"</span>,
  <span class="hljs-attr">customer</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
  },
  <span class="hljs-attr">items</span>: [<span class="hljs-string">"item1"</span>, <span class="hljs-string">"item2"</span>],
  <span class="hljs-attr">shipping</span>: {
    <span class="hljs-attr">address</span>: <span class="hljs-string">"123 Main St"</span>,
  },
};

<span class="hljs-built_in">console</span>.log(processOrder(order));
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-reference-vs-value">1. Reference vs Value</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Objects are passed by reference</span>
<span class="hljs-keyword">const</span> original = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-keyword">const</span> reference = original;

reference.age = <span class="hljs-number">31</span>;
<span class="hljs-built_in">console</span>.log(original.age); <span class="hljs-comment">// 31 (original is modified!)</span>

<span class="hljs-comment">// Create actual copy</span>
<span class="hljs-keyword">const</span> copy = { ...original };
copy.age = <span class="hljs-number">32</span>;
<span class="hljs-built_in">console</span>.log(original.age); <span class="hljs-comment">// 31 (original unchanged)</span>

<span class="hljs-comment">// Shallow copy limitation</span>
<span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"reading"</span>, <span class="hljs-string">"swimming"</span>],
};

<span class="hljs-keyword">const</span> shallowCopy = { ...obj };
shallowCopy.hobbies.push(<span class="hljs-string">"cooking"</span>);
<span class="hljs-built_in">console</span>.log(obj.hobbies); <span class="hljs-comment">// ['reading', 'swimming', 'cooking'] (modified!)</span>

<span class="hljs-comment">// Deep copy (simple approach)</span>
<span class="hljs-keyword">const</span> deepCopy = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-built_in">JSON</span>.stringify(obj));
<span class="hljs-comment">// Note: This doesn't work with functions, dates, undefined, etc.</span>
</div></code></pre>
<h3 id="2-this-context-issues">2. <code>this</code> Context Issues</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">greet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  },
  <span class="hljs-attr">arrowGreet</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>; <span class="hljs-comment">// 'this' is not the object!</span>
  },
};

<span class="hljs-built_in">console</span>.log(person.greet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>
<span class="hljs-built_in">console</span>.log(person.arrowGreet()); <span class="hljs-comment">// "Hello, I'm undefined"</span>

<span class="hljs-comment">// Method assignment loses context</span>
<span class="hljs-keyword">const</span> greetFunc = person.greet;
<span class="hljs-built_in">console</span>.log(greetFunc()); <span class="hljs-comment">// "Hello, I'm undefined"</span>

<span class="hljs-comment">// Solutions:</span>
<span class="hljs-comment">// 1. Bind the method</span>
<span class="hljs-keyword">const</span> boundGreet = person.greet.bind(person);
<span class="hljs-built_in">console</span>.log(boundGreet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>

<span class="hljs-comment">// 2. Use arrow function wrapper</span>
<span class="hljs-keyword">const</span> wrappedGreet = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> person.greet();
<span class="hljs-built_in">console</span>.log(wrappedGreet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>
</div></code></pre>
<h3 id="3-property-existence-checking">3. Property Existence Checking</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>,
};

<span class="hljs-comment">// ❌ Wrong ways to check property existence</span>
<span class="hljs-keyword">if</span> (obj.age) {
  <span class="hljs-comment">/* Won't execute because 0 is falsy */</span>
}
<span class="hljs-keyword">if</span> (obj.active) {
  <span class="hljs-comment">/* Won't execute because false is falsy */</span>
}
<span class="hljs-keyword">if</span> (obj.data) {
  <span class="hljs-comment">/* Won't execute because null is falsy */</span>
}

<span class="hljs-comment">// ✅ Correct ways</span>
<span class="hljs-keyword">if</span> (<span class="hljs-string">"age"</span> <span class="hljs-keyword">in</span> obj) {
  <span class="hljs-comment">/* Correct */</span>
}
<span class="hljs-keyword">if</span> (obj.hasOwnProperty(<span class="hljs-string">"age"</span>)) {
  <span class="hljs-comment">/* Correct */</span>
}
<span class="hljs-keyword">if</span> (obj.age !== <span class="hljs-literal">undefined</span>) {
  <span class="hljs-comment">/* Correct */</span>
}
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj.age !== <span class="hljs-string">"undefined"</span>) {
  <span class="hljs-comment">/* Correct */</span>
}
</div></code></pre>
<h3 id="4-deleting-properties">4. Deleting Properties</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> obj = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">temp</span>: <span class="hljs-string">"delete me"</span>,
};

<span class="hljs-comment">// ✅ Correct way to delete</span>
<span class="hljs-keyword">delete</span> obj.temp;
<span class="hljs-built_in">console</span>.log(obj); <span class="hljs-comment">// { name: 'Alice', age: 30 }</span>

<span class="hljs-comment">// ❌ Wrong ways</span>
obj.temp = <span class="hljs-literal">undefined</span>; <span class="hljs-comment">// Property still exists!</span>
obj.temp = <span class="hljs-literal">null</span>; <span class="hljs-comment">// Property still exists!</span>

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"temp"</span> <span class="hljs-keyword">in</span> obj); <span class="hljs-comment">// true (still exists)</span>

<span class="hljs-comment">// ✅ Alternative: destructuring to exclude</span>
<span class="hljs-keyword">const</span> { temp, ...newObj } = obj;
<span class="hljs-built_in">console</span>.log(newObj); <span class="hljs-comment">// { name: 'Alice', age: 30 }</span>
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-object-manipulation">Problem 1: Object Manipulation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that takes an array of objects and returns</span>
<span class="hljs-comment">// a new object with specific transformations</span>

<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span> },
];

<span class="hljs-comment">// Your function should return:</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   activeUsers: ['Alice', 'Charlie'],</span>
<span class="hljs-comment">//   averageAge: 30,</span>
<span class="hljs-comment">//   userById: { 1: 'Alice', 2: 'Bob', 3: 'Charlie' }</span>
<span class="hljs-comment">// }</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUsers</span>(<span class="hljs-params">users</span>) </span>{
  <span class="hljs-comment">// Your code here</span>
}

<span class="hljs-built_in">console</span>.log(processUsers(users));
</div></code></pre>
<h3 id="problem-2-deep-object-merging">Problem 2: Deep Object Merging</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement a deep merge function that combines objects recursively</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepMerge</span>(<span class="hljs-params">target, source</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
}

<span class="hljs-keyword">const</span> obj1 = {
  <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">b</span>: {
    <span class="hljs-attr">c</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">d</span>: <span class="hljs-number">3</span>,
  },
  <span class="hljs-attr">e</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
};

<span class="hljs-keyword">const</span> obj2 = {
  <span class="hljs-attr">b</span>: {
    <span class="hljs-attr">d</span>: <span class="hljs-number">4</span>,
    <span class="hljs-attr">f</span>: <span class="hljs-number">5</span>,
  },
  <span class="hljs-attr">e</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>],
  <span class="hljs-attr">g</span>: <span class="hljs-number">6</span>,
};

<span class="hljs-comment">// Should result in:</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   a: 1,</span>
<span class="hljs-comment">//   b: { c: 2, d: 4, f: 5 },</span>
<span class="hljs-comment">//   e: [3, 4],</span>
<span class="hljs-comment">//   g: 6</span>
<span class="hljs-comment">// }</span>

<span class="hljs-built_in">console</span>.log(deepMerge(obj1, obj2));
</div></code></pre>
<h3 id="problem-3-object-path-access">Problem 3: Object Path Access</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that safely accesses nested object properties</span>
<span class="hljs-comment">// using a string path like 'user.address.city'</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNestedValue</span>(<span class="hljs-params">obj, path, defaultValue = undefined</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
}

<span class="hljs-keyword">const</span> data = {
  <span class="hljs-attr">user</span>: {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
    <span class="hljs-attr">address</span>: {
      <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
      <span class="hljs-attr">coordinates</span>: {
        <span class="hljs-attr">lat</span>: <span class="hljs-number">40.7128</span>,
      },
    },
  },
};

<span class="hljs-built_in">console</span>.log(getNestedValue(data, <span class="hljs-string">"user.name"</span>)); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(getNestedValue(data, <span class="hljs-string">"user.address.city"</span>)); <span class="hljs-comment">// 'New York'</span>
<span class="hljs-built_in">console</span>.log(getNestedValue(data, <span class="hljs-string">"user.address.coordinates.lat"</span>)); <span class="hljs-comment">// 40.7128</span>
<span class="hljs-built_in">console</span>.log(getNestedValue(data, <span class="hljs-string">"user.email"</span>, <span class="hljs-string">"No email"</span>)); <span class="hljs-comment">// 'No email'</span>
<span class="hljs-built_in">console</span>.log(getNestedValue(data, <span class="hljs-string">"user.address.zip"</span>)); <span class="hljs-comment">// undefined</span>
</div></code></pre>
<h3 id="problem-4-object-validation">Problem 4: Object Validation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a validation system for objects</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ObjectValidator</span> </span>{
  <span class="hljs-keyword">constructor</span>(schema) {
    <span class="hljs-keyword">this</span>.schema = schema;
  }

  validate(obj) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Return { valid: boolean, errors: string[] }</span>
  }
}

<span class="hljs-comment">// Usage example:</span>
<span class="hljs-keyword">const</span> userSchema = {
  <span class="hljs-attr">name</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">age</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"number"</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">150</span> },
  <span class="hljs-attr">email</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">pattern</span>: <span class="hljs-regexp">/^[^@]+@[^@]+\.[^@]+$/</span> },
};

<span class="hljs-keyword">const</span> validator = <span class="hljs-keyword">new</span> ObjectValidator(userSchema);

<span class="hljs-keyword">const</span> validUser = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span> };
<span class="hljs-keyword">const</span> invalidUser = { <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">-5</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"invalid-email"</span> };

<span class="hljs-built_in">console</span>.log(validator.validate(validUser)); <span class="hljs-comment">// { valid: true, errors: [] }</span>
<span class="hljs-built_in">console</span>.log(validator.validate(invalidUser)); <span class="hljs-comment">// { valid: false, errors: [...] }</span>
</div></code></pre>
<h3 id="problem-5-object-proxy">Problem 5: Object Proxy</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a proxy that logs all property access and modifications</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createLoggingProxy</span>(<span class="hljs-params">obj, logFunction = console.log</span>) </span>{
  <span class="hljs-comment">// Your implementation using Proxy</span>
}

<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-keyword">const</span> loggedPerson = createLoggingProxy(person);

<span class="hljs-comment">// These operations should log to console:</span>
loggedPerson.name; <span class="hljs-comment">// "GET: name = Alice"</span>
loggedPerson.age = <span class="hljs-number">31</span>; <span class="hljs-comment">// "SET: age = 31"</span>
loggedPerson.city = <span class="hljs-string">"NYC"</span>; <span class="hljs-comment">// "SET: city = NYC"</span>
<span class="hljs-keyword">delete</span> loggedPerson.age; <span class="hljs-comment">// "DELETE: age"</span>
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between dot notation and bracket notation?</strong></p>
<ul>
<li>Dot notation: <code>obj.property</code> - for valid identifiers, known at write time</li>
<li>Bracket notation: <code>obj['property']</code> - for dynamic access, special characters, computed properties</li>
</ul>
<p><strong>Q: How do you check if a property exists in an object?</strong></p>
<ul>
<li><code>'property' in obj</code> - checks own and inherited properties</li>
<li><code>obj.hasOwnProperty('property')</code> - checks only own properties</li>
<li><code>Object.hasOwn(obj, 'property')</code> - modern alternative (ES2022)</li>
<li><code>obj.property !== undefined</code> - checks if value is not undefined</li>
</ul>
<p><strong>Q: What's the difference between <code>Object.assign()</code> and spread operator?</strong></p>
<ul>
<li>Both perform shallow copying/merging</li>
<li>Spread operator is more concise and readable</li>
<li><code>Object.assign()</code> modifies the target object, spread creates new object</li>
<li>Spread operator doesn't work with getters/setters the same way</li>
</ul>
<p><strong>Q: How do you deep copy an object?</strong></p>
<ul>
<li><code>JSON.parse(JSON.stringify(obj))</code> - simple but limited (no functions, dates, etc.)</li>
<li>Lodash <code>cloneDeep()</code> - robust library solution</li>
<li>Custom recursive function - for specific needs</li>
<li><code>structuredClone()</code> - new native method (limited browser support)</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement Object.assign() from scratch&quot;</li>
<li><strong>Facebook</strong>: &quot;Create a function to flatten nested objects&quot;</li>
<li><strong>Amazon</strong>: &quot;Implement deep equality comparison for objects&quot;</li>
<li><strong>Microsoft</strong>: &quot;Design a system for object validation and transformation&quot;</li>
<li><strong>Netflix</strong>: &quot;Create a proxy that tracks object property access patterns&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Objects are reference types</strong> - understand copying vs referencing</li>
<li><strong>Use appropriate property access method</strong> - dot vs bracket notation</li>
<li><strong>Be careful with <code>this</code> context</strong> - especially with arrow functions</li>
<li><strong>Understand property descriptors</strong> - writable, enumerable, configurable</li>
<li><strong>Master object iteration methods</strong> - for...in, Object.keys(), Object.entries()</li>
<li><strong>Use destructuring for cleaner code</strong> - especially in function parameters</li>
<li><strong>Know the difference between shallow and deep operations</strong></li>
<li><strong>Practice object manipulation patterns</strong> - merging, filtering, transforming</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./07-arrays.md">← Arrays &amp; Array Methods</a><br>
<strong>Next Chapter</strong>: <a href="./09-prototypes.md">Prototypes &amp; Inheritance →</a></p>
<p><strong>Practice</strong>: Try the object manipulation problems and experiment with different property access patterns!</p>
<h1 id="%F0%9F%93%9A-chapter-9-prototypes--inheritance">📚 Chapter 9: Prototypes &amp; Inheritance</h1>
<blockquote>
<p>Master JavaScript's prototype-based inheritance system and understand how objects inherit from other objects.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Prototypes are like &quot;blueprints&quot; or &quot;templates&quot; that objects can inherit properties and methods from. Think of them as:</p>
<ul>
<li><strong>Family traits</strong> = children inherit characteristics from parents</li>
<li><strong>Recipe templates</strong> = specific recipes inherit basic cooking methods</li>
<li><strong>Car models</strong> = all Honda Civics share common features from the Civic &quot;prototype&quot;</li>
<li><strong>Employee types</strong> = all managers inherit basic employee properties plus management-specific ones</li>
</ul>
<p>Unlike class-based languages, JavaScript uses prototype-based inheritance where objects can directly inherit from other objects.</p>
<h2 id="%F0%9F%A7%AC-understanding-prototypes">🧬 Understanding Prototypes</h2>
<h3 id="the-prototype-chain">The Prototype Chain</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Every object has a prototype (except Object.prototype)</span>
<span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
};

<span class="hljs-comment">// Check the prototype</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getPrototypeOf(person)); <span class="hljs-comment">// Object.prototype</span>
<span class="hljs-built_in">console</span>.log(person.__proto__); <span class="hljs-comment">// Object.prototype (deprecated way)</span>

<span class="hljs-comment">// The prototype chain</span>
<span class="hljs-built_in">console</span>.log(person.toString); <span class="hljs-comment">// Inherited from Object.prototype</span>
<span class="hljs-built_in">console</span>.log(person.hasOwnProperty); <span class="hljs-comment">// Inherited from Object.prototype</span>

<span class="hljs-comment">// Prototype chain visualization:</span>
<span class="hljs-comment">// person -&gt; Object.prototype -&gt; null</span>

<span class="hljs-comment">// Arrays have their own prototype chain</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getPrototypeOf(numbers)); <span class="hljs-comment">// Array.prototype</span>
<span class="hljs-built_in">console</span>.log(numbers.push); <span class="hljs-comment">// Inherited from Array.prototype</span>
<span class="hljs-built_in">console</span>.log(numbers.toString); <span class="hljs-comment">// Inherited from Object.prototype</span>

<span class="hljs-comment">// Array prototype chain:</span>
<span class="hljs-comment">// numbers -&gt; Array.prototype -&gt; Object.prototype -&gt; null</span>
</div></code></pre>
<h3 id="creating-objects-with-specific-prototypes">Creating Objects with Specific Prototypes</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Method 1: Object.create()</span>
<span class="hljs-keyword">const</span> animalPrototype = {
  <span class="hljs-attr">makeSound</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> makes a sound`</span>;
  },
  <span class="hljs-attr">eat</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is eating`</span>;
  },
};

<span class="hljs-keyword">const</span> dog = <span class="hljs-built_in">Object</span>.create(animalPrototype);
dog.name = <span class="hljs-string">"Buddy"</span>;
dog.breed = <span class="hljs-string">"Golden Retriever"</span>;

<span class="hljs-built_in">console</span>.log(dog.makeSound()); <span class="hljs-comment">// "Buddy makes a sound"</span>
<span class="hljs-built_in">console</span>.log(dog.eat()); <span class="hljs-comment">// "Buddy is eating"</span>

<span class="hljs-comment">// Check prototype relationship</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getPrototypeOf(dog) === animalPrototype); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(animalPrototype.isPrototypeOf(dog)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Method 2: Constructor functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

Animal.prototype.makeSound = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> makes a sound`</span>;
};

Animal.prototype.eat = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is eating`</span>;
};

<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> Animal(<span class="hljs-string">"Whiskers"</span>);
<span class="hljs-built_in">console</span>.log(cat.makeSound()); <span class="hljs-comment">// "Whiskers makes a sound"</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getPrototypeOf(cat) === Animal.prototype); <span class="hljs-comment">// true</span>
</div></code></pre>
<h3 id="prototype-property-vs-proto">Prototype Property vs <strong>proto</strong></h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

Person.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
};

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>);

<span class="hljs-comment">// Constructor function has 'prototype' property</span>
<span class="hljs-built_in">console</span>.log(Person.prototype); <span class="hljs-comment">// { greet: function, constructor: Person }</span>

<span class="hljs-comment">// Instance has '__proto__' (or use Object.getPrototypeOf)</span>
<span class="hljs-built_in">console</span>.log(alice.__proto__ === Person.prototype); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getPrototypeOf(alice) === Person.prototype); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// The relationship:</span>
<span class="hljs-comment">// Person.prototype === alice.__proto__</span>
<span class="hljs-comment">// alice inherits from Person.prototype</span>
</div></code></pre>
<h2 id="%F0%9F%8F%97%EF%B8%8F-constructor-functions">🏗️ Constructor Functions</h2>
<h3 id="basic-constructor-pattern">Basic Constructor Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Constructor function (capitalized by convention)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name, age, city</span>) </span>{
  <span class="hljs-comment">// Instance properties</span>
  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.age = age;
  <span class="hljs-keyword">this</span>.city = city;
}

<span class="hljs-comment">// Methods on prototype (shared by all instances)</span>
Person.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> from <span class="hljs-subst">${<span class="hljs-keyword">this</span>.city}</span>`</span>;
};

Person.prototype.getAge = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age;
};

Person.prototype.haveBirthday = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.age++;
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Happy birthday! Now I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span>`</span>;
};

<span class="hljs-comment">// Create instances</span>
<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>, <span class="hljs-string">"New York"</span>);
<span class="hljs-keyword">const</span> bob = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">25</span>, <span class="hljs-string">"London"</span>);

<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hello, I'm Alice from New York"</span>
<span class="hljs-built_in">console</span>.log(bob.greet()); <span class="hljs-comment">// "Hello, I'm Bob from London"</span>

<span class="hljs-comment">// Methods are shared (same reference)</span>
<span class="hljs-built_in">console</span>.log(alice.greet === bob.greet); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// But instance properties are separate</span>
<span class="hljs-built_in">console</span>.log(alice.name === bob.name); <span class="hljs-comment">// false</span>
</div></code></pre>
<h3 id="constructor-function-patterns">Constructor Function Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Pattern 1: All methods in constructor (not recommended)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadPerson</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;

  <span class="hljs-comment">// ❌ Each instance gets its own copy of this method</span>
  <span class="hljs-keyword">this</span>.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  };
}

<span class="hljs-comment">// Pattern 2: Methods on prototype (recommended)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodPerson</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

<span class="hljs-comment">// ✅ All instances share this method</span>
GoodPerson.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
};

<span class="hljs-comment">// Pattern 3: Prototype object replacement</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BestPerson</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

BestPerson.prototype = {
  <span class="hljs-attr">constructor</span>: BestPerson, <span class="hljs-comment">// Important: restore constructor reference</span>

  <span class="hljs-attr">greet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  },

  <span class="hljs-attr">introduce</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`My name is <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  },
};

<span class="hljs-comment">// Test memory efficiency</span>
<span class="hljs-keyword">const</span> bad1 = <span class="hljs-keyword">new</span> BadPerson(<span class="hljs-string">"Alice"</span>);
<span class="hljs-keyword">const</span> bad2 = <span class="hljs-keyword">new</span> BadPerson(<span class="hljs-string">"Bob"</span>);
<span class="hljs-built_in">console</span>.log(bad1.greet === bad2.greet); <span class="hljs-comment">// false (different functions)</span>

<span class="hljs-keyword">const</span> good1 = <span class="hljs-keyword">new</span> GoodPerson(<span class="hljs-string">"Alice"</span>);
<span class="hljs-keyword">const</span> good2 = <span class="hljs-keyword">new</span> GoodPerson(<span class="hljs-string">"Bob"</span>);
<span class="hljs-built_in">console</span>.log(good1.greet === good2.greet); <span class="hljs-comment">// true (same function)</span>
</div></code></pre>
<h3 id="the-new-operator">The <code>new</code> Operator</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name, age</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.age = age;
}

Person.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
};

<span class="hljs-comment">// What happens when you use 'new':</span>
<span class="hljs-comment">// 1. Create a new empty object</span>
<span class="hljs-comment">// 2. Set the object's prototype to the constructor's prototype</span>
<span class="hljs-comment">// 3. Call the constructor with 'this' bound to the new object</span>
<span class="hljs-comment">// 4. Return the new object (unless constructor returns an object)</span>

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>);

<span class="hljs-comment">// Manual simulation of 'new' operator</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPerson</span>(<span class="hljs-params">name, age</span>) </span>{
  <span class="hljs-comment">// Step 1: Create new object</span>
  <span class="hljs-keyword">const</span> obj = {};

  <span class="hljs-comment">// Step 2: Set prototype</span>
  <span class="hljs-built_in">Object</span>.setPrototypeOf(obj, Person.prototype);

  <span class="hljs-comment">// Step 3: Call constructor</span>
  Person.call(obj, name, age);

  <span class="hljs-comment">// Step 4: Return object</span>
  <span class="hljs-keyword">return</span> obj;
}

<span class="hljs-keyword">const</span> bob = createPerson(<span class="hljs-string">"Bob"</span>, <span class="hljs-number">25</span>);
<span class="hljs-built_in">console</span>.log(bob.greet()); <span class="hljs-comment">// "Hello, I'm Bob"</span>

<span class="hljs-comment">// Forgetting 'new' keyword</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SafePerson</span>(<span class="hljs-params">name, age</span>) </span>{
  <span class="hljs-comment">// Guard against missing 'new'</span>
  <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> SafePerson)) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> SafePerson(name, age);
  }

  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.age = age;
}

<span class="hljs-keyword">const</span> charlie1 = <span class="hljs-keyword">new</span> SafePerson(<span class="hljs-string">"Charlie"</span>, <span class="hljs-number">35</span>); <span class="hljs-comment">// With 'new'</span>
<span class="hljs-keyword">const</span> charlie2 = SafePerson(<span class="hljs-string">"Charlie"</span>, <span class="hljs-number">35</span>); <span class="hljs-comment">// Without 'new'</span>
<span class="hljs-built_in">console</span>.log(charlie1 <span class="hljs-keyword">instanceof</span> SafePerson); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(charlie2 <span class="hljs-keyword">instanceof</span> SafePerson); <span class="hljs-comment">// true</span>
</div></code></pre>
<h2 id="%F0%9F%A7%AC-prototype-based-inheritance">🧬 Prototype-Based Inheritance</h2>
<h3 id="basic-inheritance-pattern">Basic Inheritance Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Parent constructor</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name, species</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.species = species;
}

Animal.prototype.makeSound = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> makes a sound`</span>;
};

Animal.prototype.eat = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is eating`</span>;
};

Animal.prototype.sleep = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is sleeping`</span>;
};

<span class="hljs-comment">// Child constructor</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Dog</span>(<span class="hljs-params">name, breed</span>) </span>{
  <span class="hljs-comment">// Call parent constructor</span>
  Animal.call(<span class="hljs-keyword">this</span>, name, <span class="hljs-string">"Canine"</span>);
  <span class="hljs-keyword">this</span>.breed = breed;
}

<span class="hljs-comment">// Set up inheritance</span>
Dog.prototype = <span class="hljs-built_in">Object</span>.create(Animal.prototype);
Dog.prototype.constructor = Dog; <span class="hljs-comment">// Restore constructor reference</span>

<span class="hljs-comment">// Add child-specific methods</span>
Dog.prototype.bark = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> barks: Woof!`</span>;
};

<span class="hljs-comment">// Override parent method</span>
Dog.prototype.makeSound = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> barks loudly`</span>;
};

<span class="hljs-comment">// Create instance</span>
<span class="hljs-keyword">const</span> buddy = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Buddy"</span>, <span class="hljs-string">"Golden Retriever"</span>);

<span class="hljs-built_in">console</span>.log(buddy.name); <span class="hljs-comment">// 'Buddy'</span>
<span class="hljs-built_in">console</span>.log(buddy.species); <span class="hljs-comment">// 'Canine'</span>
<span class="hljs-built_in">console</span>.log(buddy.breed); <span class="hljs-comment">// 'Golden Retriever'</span>
<span class="hljs-built_in">console</span>.log(buddy.eat()); <span class="hljs-comment">// "Buddy is eating" (inherited)</span>
<span class="hljs-built_in">console</span>.log(buddy.bark()); <span class="hljs-comment">// "Buddy barks: Woof!" (own method)</span>
<span class="hljs-built_in">console</span>.log(buddy.makeSound()); <span class="hljs-comment">// "Buddy barks loudly" (overridden)</span>

<span class="hljs-comment">// Check inheritance chain</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> Dog); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> Animal); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Prototype chain: buddy -&gt; Dog.prototype -&gt; Animal.prototype -&gt; Object.prototype -&gt; null</span>
</div></code></pre>
<h3 id="multiple-levels-of-inheritance">Multiple Levels of Inheritance</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Grandparent</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LivingBeing</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.alive = <span class="hljs-literal">true</span>;
}

LivingBeing.prototype.breathe = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is breathing`</span>;
};

<span class="hljs-comment">// Parent</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name, species</span>) </span>{
  LivingBeing.call(<span class="hljs-keyword">this</span>, name);
  <span class="hljs-keyword">this</span>.species = species;
}

Animal.prototype = <span class="hljs-built_in">Object</span>.create(LivingBeing.prototype);
Animal.prototype.constructor = Animal;

Animal.prototype.move = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is moving`</span>;
};

<span class="hljs-comment">// Child</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Mammal</span>(<span class="hljs-params">name, species, furColor</span>) </span>{
  Animal.call(<span class="hljs-keyword">this</span>, name, species);
  <span class="hljs-keyword">this</span>.furColor = furColor;
  <span class="hljs-keyword">this</span>.warmBlooded = <span class="hljs-literal">true</span>;
}

Mammal.prototype = <span class="hljs-built_in">Object</span>.create(Animal.prototype);
Mammal.prototype.constructor = Mammal;

Mammal.prototype.produceMilk = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> produces milk`</span>;
};

<span class="hljs-comment">// Grandchild</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Dog</span>(<span class="hljs-params">name, breed, furColor</span>) </span>{
  Mammal.call(<span class="hljs-keyword">this</span>, name, <span class="hljs-string">"Canine"</span>, furColor);
  <span class="hljs-keyword">this</span>.breed = breed;
}

Dog.prototype = <span class="hljs-built_in">Object</span>.create(Mammal.prototype);
Dog.prototype.constructor = Dog;

Dog.prototype.bark = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> barks`</span>;
};

<span class="hljs-comment">// Create instance</span>
<span class="hljs-keyword">const</span> max = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Max"</span>, <span class="hljs-string">"German Shepherd"</span>, <span class="hljs-string">"brown"</span>);

<span class="hljs-built_in">console</span>.log(max.breathe()); <span class="hljs-comment">// "Max is breathing" (from LivingBeing)</span>
<span class="hljs-built_in">console</span>.log(max.move()); <span class="hljs-comment">// "Max is moving" (from Animal)</span>
<span class="hljs-built_in">console</span>.log(max.produceMilk()); <span class="hljs-comment">// "Max produces milk" (from Mammal)</span>
<span class="hljs-built_in">console</span>.log(max.bark()); <span class="hljs-comment">// "Max barks" (from Dog)</span>

<span class="hljs-comment">// Complex inheritance chain:</span>
<span class="hljs-comment">// max -&gt; Dog.prototype -&gt; Mammal.prototype -&gt; Animal.prototype -&gt; LivingBeing.prototype -&gt; Object.prototype -&gt; null</span>
</div></code></pre>
<h3 id="mixin-pattern">Mixin Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Mixins for adding functionality</span>
<span class="hljs-keyword">const</span> Flyable = {
  <span class="hljs-attr">fly</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is flying`</span>;
  },
  <span class="hljs-attr">land</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> has landed`</span>;
  },
};

<span class="hljs-keyword">const</span> Swimmable = {
  <span class="hljs-attr">swim</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is swimming`</span>;
  },
  <span class="hljs-attr">dive</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is diving`</span>;
  },
};

<span class="hljs-comment">// Mixin function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixin</span>(<span class="hljs-params">target, ...sources</span>) </span>{
  sources.forEach(<span class="hljs-function">(<span class="hljs-params">source</span>) =&gt;</span> {
    <span class="hljs-built_in">Object</span>.getOwnPropertyNames(source).forEach(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (name !== <span class="hljs-string">"constructor"</span>) {
        target[name] = source[name];
      }
    });
  });
  <span class="hljs-keyword">return</span> target;
}

<span class="hljs-comment">// Base class</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Bird</span>(<span class="hljs-params">name, species</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.species = species;
}

Bird.prototype.chirp = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> chirps`</span>;
};

<span class="hljs-comment">// Add flying ability</span>
mixin(Bird.prototype, Flyable);

<span class="hljs-comment">// Duck can fly and swim</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Duck</span>(<span class="hljs-params">name</span>) </span>{
  Bird.call(<span class="hljs-keyword">this</span>, name, <span class="hljs-string">"Duck"</span>);
}

Duck.prototype = <span class="hljs-built_in">Object</span>.create(Bird.prototype);
Duck.prototype.constructor = Duck;

<span class="hljs-comment">// Add swimming ability to Duck</span>
mixin(Duck.prototype, Swimmable);

Duck.prototype.quack = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> quacks`</span>;
};

<span class="hljs-comment">// Create duck instance</span>
<span class="hljs-keyword">const</span> donald = <span class="hljs-keyword">new</span> Duck(<span class="hljs-string">"Donald"</span>);

<span class="hljs-built_in">console</span>.log(donald.chirp()); <span class="hljs-comment">// "Donald chirps" (from Bird)</span>
<span class="hljs-built_in">console</span>.log(donald.fly()); <span class="hljs-comment">// "Donald is flying" (from Flyable mixin)</span>
<span class="hljs-built_in">console</span>.log(donald.swim()); <span class="hljs-comment">// "Donald is swimming" (from Swimmable mixin)</span>
<span class="hljs-built_in">console</span>.log(donald.quack()); <span class="hljs-comment">// "Donald quacks" (own method)</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-es6-classes-syntactic-sugar">🎯 ES6 Classes (Syntactic Sugar)</h2>
<h3 id="basic-class-syntax">Basic Class Syntax</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ES6 class (syntactic sugar over prototypes)</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, age) {
    <span class="hljs-keyword">this</span>.name = name;
    <span class="hljs-keyword">this</span>.age = age;
  }

  greet() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
  }

  getAge() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.age;
  }

  haveBirthday() {
    <span class="hljs-keyword">this</span>.age++;
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Happy birthday! Now I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span>`</span>;
  }

  <span class="hljs-comment">// Static method</span>
  <span class="hljs-keyword">static</span> createAnonymous() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Anonymous"</span>, <span class="hljs-number">0</span>);
  }
}

<span class="hljs-comment">// Equivalent to constructor function approach</span>
<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>);
<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>

<span class="hljs-comment">// Static method usage</span>
<span class="hljs-keyword">const</span> anon = Person.createAnonymous();
<span class="hljs-built_in">console</span>.log(anon.name); <span class="hljs-comment">// 'Anonymous'</span>

<span class="hljs-comment">// Classes are still functions under the hood</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">typeof</span> Person); <span class="hljs-comment">// 'function'</span>
<span class="hljs-built_in">console</span>.log(Person.prototype.greet); <span class="hljs-comment">// function</span>
</div></code></pre>
<h3 id="class-inheritance-with-extends">Class Inheritance with <code>extends</code></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Parent class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, species) {
    <span class="hljs-keyword">this</span>.name = name;
    <span class="hljs-keyword">this</span>.species = species;
  }

  makeSound() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> makes a sound`</span>;
  }

  eat() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is eating`</span>;
  }

  <span class="hljs-keyword">static</span> getKingdom() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Animalia"</span>;
  }
}

<span class="hljs-comment">// Child class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, breed) {
    <span class="hljs-keyword">super</span>(name, <span class="hljs-string">"Canine"</span>); <span class="hljs-comment">// Call parent constructor</span>
    <span class="hljs-keyword">this</span>.breed = breed;
  }

  <span class="hljs-comment">// Override parent method</span>
  makeSound() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> barks: Woof!`</span>;
  }

  <span class="hljs-comment">// New method</span>
  fetch() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> fetches the ball`</span>;
  }

  <span class="hljs-comment">// Call parent method from child</span>
  describe() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">super</span>.eat()}</span> and <span class="hljs-subst">${<span class="hljs-keyword">this</span>.makeSound()}</span>`</span>;
  }

  <span class="hljs-comment">// Static method</span>
  <span class="hljs-keyword">static</span> getSpecies() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Canis lupus"</span>;
  }
}

<span class="hljs-comment">// Create instance</span>
<span class="hljs-keyword">const</span> buddy = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Buddy"</span>, <span class="hljs-string">"Golden Retriever"</span>);

<span class="hljs-built_in">console</span>.log(buddy.name); <span class="hljs-comment">// 'Buddy'</span>
<span class="hljs-built_in">console</span>.log(buddy.species); <span class="hljs-comment">// 'Canine'</span>
<span class="hljs-built_in">console</span>.log(buddy.breed); <span class="hljs-comment">// 'Golden Retriever'</span>
<span class="hljs-built_in">console</span>.log(buddy.makeSound()); <span class="hljs-comment">// "Buddy barks: Woof!"</span>
<span class="hljs-built_in">console</span>.log(buddy.fetch()); <span class="hljs-comment">// "Buddy fetches the ball"</span>
<span class="hljs-built_in">console</span>.log(buddy.describe()); <span class="hljs-comment">// "Buddy is eating and Buddy barks: Woof!"</span>

<span class="hljs-comment">// Static methods</span>
<span class="hljs-built_in">console</span>.log(Animal.getKingdom()); <span class="hljs-comment">// 'Animalia'</span>
<span class="hljs-built_in">console</span>.log(Dog.getSpecies()); <span class="hljs-comment">// 'Canis lupus'</span>

<span class="hljs-comment">// Inheritance check</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> Dog); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> Animal); <span class="hljs-comment">// true</span>
</div></code></pre>
<h3 id="private-fields-and-methods-es2022">Private Fields and Methods (ES2022)</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BankAccount</span> </span>{
  <span class="hljs-comment">// Private fields (start with #)</span>
  #balance = <span class="hljs-number">0</span>;
  #accountNumber;

  <span class="hljs-keyword">constructor</span>(accountNumber, initialBalance = 0) {
    <span class="hljs-keyword">this</span>.#accountNumber = accountNumber;
    <span class="hljs-keyword">this</span>.#balance = initialBalance;
  }

  <span class="hljs-comment">// Public methods</span>
  deposit(amount) {
    <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.#balance += amount;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#formatTransaction(<span class="hljs-string">"deposit"</span>, amount);
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Deposit amount must be positive"</span>);
  }

  withdraw(amount) {
    <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-number">0</span> &amp;&amp; amount &lt;= <span class="hljs-keyword">this</span>.#balance) {
      <span class="hljs-keyword">this</span>.#balance -= amount;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#formatTransaction(<span class="hljs-string">"withdrawal"</span>, amount);
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid withdrawal amount"</span>);
  }

  getBalance() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#balance;
  }

  <span class="hljs-comment">// Private method</span>
  #formatTransaction(type, amount) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${type.toUpperCase()}</span>: $<span class="hljs-subst">${amount}</span>. New balance: $<span class="hljs-subst">${<span class="hljs-keyword">this</span>.#balance}</span>`</span>;
  }

  <span class="hljs-comment">// Getter</span>
  <span class="hljs-keyword">get</span> accountInfo() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Account <span class="hljs-subst">${<span class="hljs-keyword">this</span>.#accountNumber}</span>: $<span class="hljs-subst">${<span class="hljs-keyword">this</span>.#balance}</span>`</span>;
  }
}

<span class="hljs-keyword">const</span> account = <span class="hljs-keyword">new</span> BankAccount(<span class="hljs-string">"12345"</span>, <span class="hljs-number">1000</span>);

<span class="hljs-built_in">console</span>.log(account.deposit(<span class="hljs-number">500</span>)); <span class="hljs-comment">// "DEPOSIT: $500. New balance: $1500"</span>
<span class="hljs-built_in">console</span>.log(account.withdraw(<span class="hljs-number">200</span>)); <span class="hljs-comment">// "WITHDRAWAL: $200. New balance: $1300"</span>
<span class="hljs-built_in">console</span>.log(account.accountInfo); <span class="hljs-comment">// "Account 12345: $1300"</span>

<span class="hljs-comment">// Private fields are not accessible</span>
<span class="hljs-comment">// console.log(account.#balance); // SyntaxError</span>
<span class="hljs-comment">// account.#formatTransaction();  // SyntaxError</span>
</div></code></pre>
<h3 id="getters-and-setters-in-classes">Getters and Setters in Classes</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Temperature</span> </span>{
  <span class="hljs-keyword">constructor</span>(celsius = 0) {
    <span class="hljs-keyword">this</span>._celsius = celsius;
  }

  <span class="hljs-comment">// Getter for Fahrenheit</span>
  <span class="hljs-keyword">get</span> fahrenheit() {
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>._celsius * <span class="hljs-number">9</span>) / <span class="hljs-number">5</span> + <span class="hljs-number">32</span>;
  }

  <span class="hljs-comment">// Setter for Fahrenheit</span>
  <span class="hljs-keyword">set</span> fahrenheit(value) {
    <span class="hljs-keyword">this</span>._celsius = ((value - <span class="hljs-number">32</span>) * <span class="hljs-number">5</span>) / <span class="hljs-number">9</span>;
  }

  <span class="hljs-comment">// Getter for Celsius</span>
  <span class="hljs-keyword">get</span> celsius() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._celsius;
  }

  <span class="hljs-comment">// Setter for Celsius with validation</span>
  <span class="hljs-keyword">set</span> celsius(value) {
    <span class="hljs-keyword">if</span> (value &lt; <span class="hljs-number">-273.15</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Temperature cannot be below absolute zero"</span>);
    }
    <span class="hljs-keyword">this</span>._celsius = value;
  }

  <span class="hljs-comment">// Getter for Kelvin</span>
  <span class="hljs-keyword">get</span> kelvin() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._celsius + <span class="hljs-number">273.15</span>;
  }

  <span class="hljs-comment">// Setter for Kelvin</span>
  <span class="hljs-keyword">set</span> kelvin(value) {
    <span class="hljs-keyword">this</span>.celsius = value - <span class="hljs-number">273.15</span>; <span class="hljs-comment">// Uses the celsius setter for validation</span>
  }
}

<span class="hljs-keyword">const</span> temp = <span class="hljs-keyword">new</span> Temperature(<span class="hljs-number">25</span>);

<span class="hljs-built_in">console</span>.log(temp.celsius); <span class="hljs-comment">// 25</span>
<span class="hljs-built_in">console</span>.log(temp.fahrenheit); <span class="hljs-comment">// 77</span>
<span class="hljs-built_in">console</span>.log(temp.kelvin); <span class="hljs-comment">// 298.15</span>

<span class="hljs-comment">// Set temperature using different scales</span>
temp.fahrenheit = <span class="hljs-number">86</span>;
<span class="hljs-built_in">console</span>.log(temp.celsius); <span class="hljs-comment">// 30</span>

temp.kelvin = <span class="hljs-number">300</span>;
<span class="hljs-built_in">console</span>.log(temp.celsius); <span class="hljs-comment">// 26.85</span>

<span class="hljs-comment">// Validation works</span>
<span class="hljs-comment">// temp.celsius = -300; // Error: Temperature cannot be below absolute zero</span>
</div></code></pre>
<h2 id="%F0%9F%94%8D-prototype-manipulation">🔍 Prototype Manipulation</h2>
<h3 id="checking-prototypes">Checking Prototypes</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

Animal.prototype.speak = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> makes a sound`</span>;
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Dog</span>(<span class="hljs-params">name, breed</span>) </span>{
  Animal.call(<span class="hljs-keyword">this</span>, name);
  <span class="hljs-keyword">this</span>.breed = breed;
}

Dog.prototype = <span class="hljs-built_in">Object</span>.create(Animal.prototype);
Dog.prototype.constructor = Dog;

<span class="hljs-keyword">const</span> buddy = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Buddy"</span>, <span class="hljs-string">"Labrador"</span>);

<span class="hljs-comment">// Check prototype relationships</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.getPrototypeOf(buddy) === Dog.prototype); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(Dog.prototype.isPrototypeOf(buddy)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(Animal.prototype.isPrototypeOf(buddy)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Object</span>.prototype.isPrototypeOf(buddy)); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Check constructor</span>
<span class="hljs-built_in">console</span>.log(buddy.constructor === Dog); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> Dog); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> Animal); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(buddy <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Object</span>); <span class="hljs-comment">// true</span>

<span class="hljs-comment">// Get prototype chain</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPrototypeChain</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">const</span> chain = [];
  <span class="hljs-keyword">let</span> current = obj;

  <span class="hljs-keyword">while</span> (current) {
    chain.push(current.constructor?.name || <span class="hljs-string">"Object"</span>);
    current = <span class="hljs-built_in">Object</span>.getPrototypeOf(current);
    <span class="hljs-keyword">if</span> (current === <span class="hljs-built_in">Object</span>.prototype) {
      chain.push(<span class="hljs-string">"Object.prototype"</span>);
      <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-keyword">return</span> chain;
}

<span class="hljs-built_in">console</span>.log(getPrototypeChain(buddy)); <span class="hljs-comment">// ['Dog', 'Animal', 'Object.prototype']</span>
</div></code></pre>
<h3 id="dynamic-prototype-modification">Dynamic Prototype Modification</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

Person.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
};

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>);
<span class="hljs-keyword">const</span> bob = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Bob"</span>);

<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>

<span class="hljs-comment">// Add method to prototype after instances are created</span>
Person.prototype.introduce = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`My name is <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
};

<span class="hljs-comment">// All instances get the new method</span>
<span class="hljs-built_in">console</span>.log(alice.introduce()); <span class="hljs-comment">// "My name is Alice"</span>
<span class="hljs-built_in">console</span>.log(bob.introduce()); <span class="hljs-comment">// "My name is Bob"</span>

<span class="hljs-comment">// Modify existing method</span>
Person.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hi there, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>!`</span>;
};

<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hi there, I'm Alice!"</span>

<span class="hljs-comment">// Add property to prototype</span>
Person.prototype.species = <span class="hljs-string">"Homo sapiens"</span>;
<span class="hljs-built_in">console</span>.log(alice.species); <span class="hljs-comment">// 'Homo sapiens'</span>
<span class="hljs-built_in">console</span>.log(bob.species); <span class="hljs-comment">// 'Homo sapiens'</span>

<span class="hljs-comment">// Instance property shadows prototype property</span>
alice.species = <span class="hljs-string">"Human"</span>;
<span class="hljs-built_in">console</span>.log(alice.species); <span class="hljs-comment">// 'Human' (own property)</span>
<span class="hljs-built_in">console</span>.log(bob.species); <span class="hljs-comment">// 'Homo sapiens' (prototype property)</span>

<span class="hljs-comment">// Delete instance property to reveal prototype property</span>
<span class="hljs-keyword">delete</span> alice.species;
<span class="hljs-built_in">console</span>.log(alice.species); <span class="hljs-comment">// 'Homo sapiens' (prototype property again)</span>
</div></code></pre>
<h3 id="prototype-pollution-security-concern">Prototype Pollution (Security Concern)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ⚠️ Prototype pollution example (DON'T DO THIS)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">vulnerableFunction</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-comment">// Dangerous: modifying Object.prototype</span>
  <span class="hljs-keyword">if</span> (obj.constructor &amp;&amp; obj.constructor.prototype) {
    obj.constructor.prototype.isAdmin = <span class="hljs-literal">true</span>;
  }
}

<span class="hljs-comment">// This affects ALL objects</span>
<span class="hljs-keyword">const</span> user = {};
vulnerableFunction({ <span class="hljs-attr">constructor</span>: <span class="hljs-built_in">Object</span> });

<span class="hljs-built_in">console</span>.log(user.isAdmin); <span class="hljs-comment">// true (BAD!)</span>
<span class="hljs-built_in">console</span>.log({}.isAdmin); <span class="hljs-comment">// true (BAD!)</span>

<span class="hljs-comment">// ✅ Safe alternatives:</span>
<span class="hljs-comment">// 1. Use Object.create(null) for data objects</span>
<span class="hljs-keyword">const</span> safeData = <span class="hljs-built_in">Object</span>.create(<span class="hljs-literal">null</span>);
safeData.name = <span class="hljs-string">"Alice"</span>;
<span class="hljs-built_in">console</span>.log(safeData.toString); <span class="hljs-comment">// undefined (no inherited methods)</span>

<span class="hljs-comment">// 2. Use Map for key-value storage</span>
<span class="hljs-keyword">const</span> dataMap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
dataMap.set(<span class="hljs-string">"name"</span>, <span class="hljs-string">"Alice"</span>);
dataMap.set(<span class="hljs-string">"age"</span>, <span class="hljs-number">30</span>);

<span class="hljs-comment">// 3. Validate input and use Object.hasOwnProperty</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeFunction</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-keyword">if</span> (obj &amp;&amp; <span class="hljs-keyword">typeof</span> obj === <span class="hljs-string">"object"</span> &amp;&amp; obj.hasOwnProperty(<span class="hljs-string">"name"</span>)) {
    <span class="hljs-keyword">return</span> obj.name;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-forgetting-to-set-constructor">1. Forgetting to Set Constructor</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Dog</span>(<span class="hljs-params">name, breed</span>) </span>{
  Animal.call(<span class="hljs-keyword">this</span>, name);
  <span class="hljs-keyword">this</span>.breed = breed;
}

<span class="hljs-comment">// ❌ Wrong: constructor reference is lost</span>
Dog.prototype = <span class="hljs-built_in">Object</span>.create(Animal.prototype);

<span class="hljs-keyword">const</span> buddy = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Buddy"</span>, <span class="hljs-string">"Labrador"</span>);
<span class="hljs-built_in">console</span>.log(buddy.constructor === Dog); <span class="hljs-comment">// false</span>
<span class="hljs-built_in">console</span>.log(buddy.constructor === Animal); <span class="hljs-comment">// true (wrong!)</span>

<span class="hljs-comment">// ✅ Correct: restore constructor reference</span>
Dog.prototype = <span class="hljs-built_in">Object</span>.create(Animal.prototype);
Dog.prototype.constructor = Dog;

<span class="hljs-keyword">const</span> max = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Max"</span>, <span class="hljs-string">"German Shepherd"</span>);
<span class="hljs-built_in">console</span>.log(max.constructor === Dog); <span class="hljs-comment">// true</span>
</div></code></pre>
<h3 id="2-modifying-built-in-prototypes">2. Modifying Built-in Prototypes</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Don't modify built-in prototypes (can break other code)</span>
<span class="hljs-built_in">Array</span>.prototype.last = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.length - <span class="hljs-number">1</span>];
};

<span class="hljs-comment">// This affects ALL arrays in your application</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-built_in">console</span>.log(numbers.last()); <span class="hljs-comment">// 3</span>

<span class="hljs-comment">// ✅ Better: create utility functions or extend in your own classes</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ExtendedArray</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Array</span> </span>{
  last() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-keyword">this</span>.length - <span class="hljs-number">1</span>];
  }

  first() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>[<span class="hljs-number">0</span>];
  }
}

<span class="hljs-keyword">const</span> extNumbers = <span class="hljs-keyword">new</span> ExtendedArray(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
<span class="hljs-built_in">console</span>.log(extNumbers.last()); <span class="hljs-comment">// 3</span>
</div></code></pre>
<h3 id="3-prototype-vs-instance-properties">3. Prototype vs Instance Properties</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

<span class="hljs-comment">// ❌ Wrong: array is shared among all instances</span>
Person.prototype.hobbies = [];

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>);
<span class="hljs-keyword">const</span> bob = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Bob"</span>);

alice.hobbies.push(<span class="hljs-string">"reading"</span>);
<span class="hljs-built_in">console</span>.log(bob.hobbies); <span class="hljs-comment">// ['reading'] (shared!)</span>

<span class="hljs-comment">// ✅ Correct: initialize arrays in constructor</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BetterPerson</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
  <span class="hljs-keyword">this</span>.hobbies = []; <span class="hljs-comment">// Each instance gets its own array</span>
}

BetterPerson.prototype.addHobby = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">hobby</span>) </span>{
  <span class="hljs-keyword">this</span>.hobbies.push(hobby);
};

<span class="hljs-keyword">const</span> charlie = <span class="hljs-keyword">new</span> BetterPerson(<span class="hljs-string">"Charlie"</span>);
<span class="hljs-keyword">const</span> diana = <span class="hljs-keyword">new</span> BetterPerson(<span class="hljs-string">"Diana"</span>);

charlie.addHobby(<span class="hljs-string">"swimming"</span>);
<span class="hljs-built_in">console</span>.log(diana.hobbies); <span class="hljs-comment">// [] (separate arrays)</span>
</div></code></pre>
<h3 id="4-arrow-functions-and-this">4. Arrow Functions and <code>this</code></h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

<span class="hljs-comment">// ❌ Wrong: arrow function doesn't bind 'this'</span>
Person.prototype.greet = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>; <span class="hljs-comment">// 'this' is not the instance!</span>
};

<span class="hljs-keyword">const</span> alice = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>);
<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hello, I'm undefined"</span>

<span class="hljs-comment">// ✅ Correct: use regular function</span>
Person.prototype.greet = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
};

<span class="hljs-built_in">console</span>.log(alice.greet()); <span class="hljs-comment">// "Hello, I'm Alice"</span>
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-shape-hierarchy">Problem 1: Shape Hierarchy</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a shape hierarchy with inheritance</span>
<span class="hljs-comment">// Base Shape class with area() and perimeter() methods</span>
<span class="hljs-comment">// Rectangle and Circle classes that extend Shape</span>
<span class="hljs-comment">// Square class that extends Rectangle</span>

<span class="hljs-comment">// Your implementation here:</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Shape</span> </span>{
  <span class="hljs-comment">// Base implementation</span>
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Rectangle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Shape</span> </span>{
  <span class="hljs-comment">// Rectangle implementation</span>
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Circle</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Shape</span> </span>{
  <span class="hljs-comment">// Circle implementation</span>
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Square</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Rectangle</span> </span>{
  <span class="hljs-comment">// Square implementation</span>
}

<span class="hljs-comment">// Test your implementation:</span>
<span class="hljs-keyword">const</span> rect = <span class="hljs-keyword">new</span> Rectangle(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>);
<span class="hljs-keyword">const</span> circle = <span class="hljs-keyword">new</span> Circle(<span class="hljs-number">4</span>);
<span class="hljs-keyword">const</span> square = <span class="hljs-keyword">new</span> Square(<span class="hljs-number">4</span>);

<span class="hljs-built_in">console</span>.log(rect.area()); <span class="hljs-comment">// 15</span>
<span class="hljs-built_in">console</span>.log(circle.area()); <span class="hljs-comment">// ~50.27</span>
<span class="hljs-built_in">console</span>.log(square.area()); <span class="hljs-comment">// 16</span>
<span class="hljs-built_in">console</span>.log(square.perimeter()); <span class="hljs-comment">// 16</span>
</div></code></pre>
<h3 id="problem-2-mixin-implementation">Problem 2: Mixin Implementation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement a mixin system that allows multiple inheritance</span>

<span class="hljs-keyword">const</span> Flyable = {
  fly() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is flying`</span>;
  },
  land() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> has landed`</span>;
  },
};

<span class="hljs-keyword">const</span> Swimmable = {
  swim() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is swimming`</span>;
  },
  dive() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is diving`</span>;
  },
};

<span class="hljs-keyword">const</span> Walkable = {
  walk() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is walking`</span>;
  },
  run() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is running`</span>;
  },
};

<span class="hljs-comment">// Implement mixin function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixin</span>(<span class="hljs-params">target, ...sources</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
}

<span class="hljs-comment">// Base class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
  }
}

<span class="hljs-comment">// Create Duck class that can fly, swim, and walk</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Duck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">super</span>(name);
  }
}

<span class="hljs-comment">// Apply mixins</span>
mixin(Duck.prototype, Flyable, Swimmable, Walkable);

<span class="hljs-keyword">const</span> donald = <span class="hljs-keyword">new</span> Duck(<span class="hljs-string">"Donald"</span>);
<span class="hljs-built_in">console</span>.log(donald.fly()); <span class="hljs-comment">// "Donald is flying"</span>
<span class="hljs-built_in">console</span>.log(donald.swim()); <span class="hljs-comment">// "Donald is swimming"</span>
<span class="hljs-built_in">console</span>.log(donald.walk()); <span class="hljs-comment">// "Donald is walking"</span>
</div></code></pre>
<h3 id="problem-3-custom-instanceof">Problem 3: Custom instanceof</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement your own version of instanceof operator</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">myInstanceof</span>(<span class="hljs-params">obj, constructor</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Should return true if obj is an instance of constructor</span>
  <span class="hljs-comment">// Should work with inheritance chain</span>
}

<span class="hljs-comment">// Test cases:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Animal</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Dog</span>(<span class="hljs-params">name, breed</span>) </span>{
  Animal.call(<span class="hljs-keyword">this</span>, name);
  <span class="hljs-keyword">this</span>.breed = breed;
}

Dog.prototype = <span class="hljs-built_in">Object</span>.create(Animal.prototype);
Dog.prototype.constructor = Dog;

<span class="hljs-keyword">const</span> buddy = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Buddy"</span>, <span class="hljs-string">"Labrador"</span>);

<span class="hljs-built_in">console</span>.log(myInstanceof(buddy, Dog)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(myInstanceof(buddy, Animal)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(myInstanceof(buddy, <span class="hljs-built_in">Object</span>)); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(myInstanceof(buddy, <span class="hljs-built_in">Array</span>)); <span class="hljs-comment">// false</span>
</div></code></pre>
<h3 id="problem-4-prototype-chain-visualizer">Problem 4: Prototype Chain Visualizer</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that visualizes the prototype chain</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">visualizePrototypeChain</span>(<span class="hljs-params">obj</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Should return an array of constructor names in the chain</span>
  <span class="hljs-comment">// Example: ['Dog', 'Animal', 'Object']</span>
}

<span class="hljs-comment">// Test with complex inheritance</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LivingBeing</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">LivingBeing</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, species) {
    <span class="hljs-keyword">super</span>(name);
    <span class="hljs-keyword">this</span>.species = species;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mammal</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, species, furColor) {
    <span class="hljs-keyword">super</span>(name, species);
    <span class="hljs-keyword">this</span>.furColor = furColor;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Mammal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, breed) {
    <span class="hljs-keyword">super</span>(name, <span class="hljs-string">"Canine"</span>, <span class="hljs-string">"brown"</span>);
    <span class="hljs-keyword">this</span>.breed = breed;
  }
}

<span class="hljs-keyword">const</span> max = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Max"</span>, <span class="hljs-string">"German Shepherd"</span>);
<span class="hljs-built_in">console</span>.log(visualizePrototypeChain(max));
<span class="hljs-comment">// Should output: ['Dog', 'Mammal', 'Animal', 'LivingBeing', 'Object']</span>
</div></code></pre>
<h3 id="problem-5-safe-object-creation">Problem 5: Safe Object Creation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a factory function that creates objects with safe prototypes</span>
<span class="hljs-comment">// to prevent prototype pollution</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSafeObject</span>(<span class="hljs-params">properties = {}</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Should create object without inheriting from Object.prototype</span>
  <span class="hljs-comment">// Should still allow setting and getting properties</span>
  <span class="hljs-comment">// Should prevent prototype pollution</span>
}

<span class="hljs-comment">// Test your implementation:</span>
<span class="hljs-keyword">const</span> safeObj = createSafeObject({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });

<span class="hljs-built_in">console</span>.log(safeObj.name); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(safeObj.age); <span class="hljs-comment">// 30</span>
<span class="hljs-built_in">console</span>.log(safeObj.toString); <span class="hljs-comment">// undefined (no inherited methods)</span>
<span class="hljs-built_in">console</span>.log(safeObj.hasOwnProperty); <span class="hljs-comment">// undefined</span>

<span class="hljs-comment">// Should not affect other objects</span>
<span class="hljs-keyword">const</span> normalObj = {};
<span class="hljs-built_in">console</span>.log(normalObj.toString); <span class="hljs-comment">// function (should still work)</span>
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What is the prototype chain?</strong></p>
<ul>
<li>Chain of objects linked through their prototypes</li>
<li>When property is accessed, JavaScript looks up the chain</li>
<li>Ends at Object.prototype (which has null prototype)</li>
<li>Enables inheritance in JavaScript</li>
</ul>
<p><strong>Q: Difference between <code>__proto__</code> and <code>prototype</code>?</strong></p>
<ul>
<li><code>__proto__</code>: property of instances, points to constructor's prototype</li>
<li><code>prototype</code>: property of constructor functions, template for instances</li>
<li><code>obj.__proto__ === Constructor.prototype</code></li>
</ul>
<p><strong>Q: How does <code>new</code> operator work?</strong></p>
<ol>
<li>Creates new empty object</li>
<li>Sets object's prototype to constructor's prototype</li>
<li>Calls constructor with <code>this</code> bound to new object</li>
<li>Returns the object (unless constructor returns object)</li>
</ol>
<p><strong>Q: What's the difference between classical and prototypal inheritance?</strong></p>
<ul>
<li>Classical: classes inherit from classes (Java, C++)</li>
<li>Prototypal: objects inherit from objects (JavaScript)</li>
<li>JavaScript ES6 classes are syntactic sugar over prototypes</li>
</ul>
<p><strong>Q: How do you implement inheritance in JavaScript?</strong></p>
<ul>
<li>Constructor functions + Object.create()</li>
<li>ES6 classes with extends</li>
<li>Object.create() for direct object inheritance</li>
<li>Mixins for multiple inheritance</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement your own version of Object.create()&quot;</li>
<li><strong>Facebook</strong>: &quot;Explain prototype pollution and how to prevent it&quot;</li>
<li><strong>Amazon</strong>: &quot;Create a mixin system for multiple inheritance&quot;</li>
<li><strong>Microsoft</strong>: &quot;Implement classical inheritance using prototypes&quot;</li>
<li><strong>Netflix</strong>: &quot;Design a safe object creation system&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Understand the prototype chain</strong> - foundation of JavaScript inheritance</li>
<li><strong>Know constructor functions vs ES6 classes</strong> - classes are syntactic sugar</li>
<li><strong>Master inheritance patterns</strong> - Object.create(), extends, mixins</li>
<li><strong>Be aware of prototype pollution</strong> - security and stability concerns</li>
<li><strong>Use appropriate inheritance method</strong> - composition over inheritance when possible</li>
<li><strong>Understand <code>this</code> binding</strong> - especially with arrow functions</li>
<li><strong>Know when to use prototypes vs instances</strong> - shared vs individual properties</li>
<li><strong>Practice inheritance hierarchies</strong> - real-world object modeling</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./08-objects.md">← Objects &amp; Object Access</a><br>
<strong>Next Chapter</strong>: <a href="./10-async-javascript.md">Asynchronous JavaScript →</a></p>
<p><strong>Practice</strong>: Try implementing the inheritance problems and experiment with different prototype patterns!</p>
<h1 id="%F0%9F%93%9A-chapter-10-asynchronous-javascript">📚 Chapter 10: Asynchronous JavaScript</h1>
<blockquote>
<p>Master asynchronous programming with callbacks, promises, async/await, and event handling.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Asynchronous programming is like ordering food at a restaurant:</p>
<ul>
<li><strong>Synchronous</strong> = You wait at the counter until your order is ready (blocking)</li>
<li><strong>Asynchronous</strong> = You get a number, sit down, and they call you when ready (non-blocking)</li>
</ul>
<p>In JavaScript, asynchronous operations allow your code to continue running while waiting for:</p>
<ul>
<li><strong>Network requests</strong> (fetching data from APIs)</li>
<li><strong>File operations</strong> (reading/writing files)</li>
<li><strong>Timers</strong> (setTimeout, setInterval)</li>
<li><strong>User interactions</strong> (clicks, form submissions)</li>
<li><strong>Database operations</strong> (queries, updates)</li>
</ul>
<h2 id="%F0%9F%94%84-understanding-synchronous-vs-asynchronous">🔄 Understanding Synchronous vs Asynchronous</h2>
<h3 id="synchronous-code-blocking">Synchronous Code (Blocking)</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Start"</span>);

<span class="hljs-comment">// This blocks execution for 3 seconds</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">blockingOperation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> start = <span class="hljs-built_in">Date</span>.now();
  <span class="hljs-keyword">while</span> (<span class="hljs-built_in">Date</span>.now() - start &lt; <span class="hljs-number">3000</span>) {
    <span class="hljs-comment">// Busy waiting - blocks everything!</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">"Done waiting"</span>;
}

<span class="hljs-keyword">const</span> result = blockingOperation();
<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// After 3 seconds</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"End"</span>); <span class="hljs-comment">// After 3 seconds</span>

<span class="hljs-comment">// Output (with 3-second delay):</span>
<span class="hljs-comment">// Start</span>
<span class="hljs-comment">// Done waiting</span>
<span class="hljs-comment">// End</span>
</div></code></pre>
<h3 id="asynchronous-code-non-blocking">Asynchronous Code (Non-blocking)</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Start"</span>);

<span class="hljs-comment">// This doesn't block execution</span>
setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Async operation completed"</span>);
}, <span class="hljs-number">3000</span>);

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"End"</span>);

<span class="hljs-comment">// Output (immediate):</span>
<span class="hljs-comment">// Start</span>
<span class="hljs-comment">// End</span>
<span class="hljs-comment">// Async operation completed (after 3 seconds)</span>
</div></code></pre>
<h3 id="the-event-loop">The Event Loop</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Understanding execution order</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"1: Synchronous"</span>);

setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"4: Timeout (macrotask)"</span>);
}, <span class="hljs-number">0</span>);

<span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"3: Promise (microtask)"</span>);
});

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"2: Synchronous"</span>);

<span class="hljs-comment">// Output:</span>
<span class="hljs-comment">// 1: Synchronous</span>
<span class="hljs-comment">// 2: Synchronous</span>
<span class="hljs-comment">// 3: Promise (microtask)</span>
<span class="hljs-comment">// 4: Timeout (macrotask)</span>

<span class="hljs-comment">// Execution order:</span>
<span class="hljs-comment">// 1. Synchronous code runs first</span>
<span class="hljs-comment">// 2. Microtasks (Promises) run next</span>
<span class="hljs-comment">// 3. Macrotasks (setTimeout) run last</span>
</div></code></pre>
<h2 id="%F0%9F%93%9E-callbacks">📞 Callbacks</h2>
<h3 id="basic-callback-pattern">Basic Callback Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Simple callback example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greetUser</span>(<span class="hljs-params">name, callback</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hello, <span class="hljs-subst">${name}</span>!`</span>);
  callback();
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">afterGreeting</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Nice to meet you!"</span>);
}

greetUser(<span class="hljs-string">"Alice"</span>, afterGreeting);
<span class="hljs-comment">// Output:</span>
<span class="hljs-comment">// Hello, Alice!</span>
<span class="hljs-comment">// Nice to meet you!</span>

<span class="hljs-comment">// Inline callback</span>
greetUser(<span class="hljs-string">"Bob"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"How are you doing?"</span>);
});

<span class="hljs-comment">// Arrow function callback</span>
greetUser(<span class="hljs-string">"Charlie"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Have a great day!"</span>);
});
</div></code></pre>
<h3 id="asynchronous-callbacks">Asynchronous Callbacks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Simulating async operation with callback</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserData</span>(<span class="hljs-params">userId, callback</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Fetching user <span class="hljs-subst">${userId}</span>...`</span>);

  <span class="hljs-comment">// Simulate network delay</span>
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> userData = {
      <span class="hljs-attr">id</span>: userId,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
      <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
    };

    callback(<span class="hljs-literal">null</span>, userData); <span class="hljs-comment">// null = no error</span>
  }, <span class="hljs-number">2000</span>);
}

<span class="hljs-comment">// Using the async function</span>
fetchUserData(<span class="hljs-number">123</span>, (error, user) =&gt; {
  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User data:"</span>, user);
  }
});

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"This runs immediately"</span>);

<span class="hljs-comment">// Output:</span>
<span class="hljs-comment">// Fetching user 123...</span>
<span class="hljs-comment">// This runs immediately</span>
<span class="hljs-comment">// User data: { id: 123, name: 'Alice', email: 'alice@example.com' } (after 2 seconds)</span>
</div></code></pre>
<h3 id="error-handling-with-callbacks">Error Handling with Callbacks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Error-first callback pattern (Node.js style)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">riskyOperation</span>(<span class="hljs-params">shouldFail, callback</span>) </span>{
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (shouldFail) {
      callback(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Something went wrong!"</span>), <span class="hljs-literal">null</span>);
    } <span class="hljs-keyword">else</span> {
      callback(<span class="hljs-literal">null</span>, <span class="hljs-string">"Success!"</span>);
    }
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">// Success case</span>
riskyOperation(<span class="hljs-literal">false</span>, (error, result) =&gt; {
  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error.message);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Result:"</span>, result); <span class="hljs-comment">// "Result: Success!"</span>
  }
});

<span class="hljs-comment">// Error case</span>
riskyOperation(<span class="hljs-literal">true</span>, (error, result) =&gt; {
  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error.message); <span class="hljs-comment">// "Error: Something went wrong!"</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Result:"</span>, result);
  }
});
</div></code></pre>
<h3 id="callback-hell">Callback Hell</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Callback hell - hard to read and maintain</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserProfile</span>(<span class="hljs-params">userId</span>) </span>{
  fetchUser(userId, (userError, user) =&gt; {
    <span class="hljs-keyword">if</span> (userError) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"User error:"</span>, userError);
      <span class="hljs-keyword">return</span>;
    }

    fetchUserPosts(user.id, (postsError, posts) =&gt; {
      <span class="hljs-keyword">if</span> (postsError) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Posts error:"</span>, postsError);
        <span class="hljs-keyword">return</span>;
      }

      fetchPostComments(posts[<span class="hljs-number">0</span>].id, (commentsError, comments) =&gt; {
        <span class="hljs-keyword">if</span> (commentsError) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Comments error:"</span>, commentsError);
          <span class="hljs-keyword">return</span>;
        }

        fetchUserFriends(user.id, (friendsError, friends) =&gt; {
          <span class="hljs-keyword">if</span> (friendsError) {
            <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Friends error:"</span>, friendsError);
            <span class="hljs-keyword">return</span>;
          }

          <span class="hljs-comment">// Finally, we have all the data!</span>
          <span class="hljs-keyword">const</span> profile = {
            user,
            posts,
            comments,
            friends,
          };

          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Complete profile:"</span>, profile);
        });
      });
    });
  });
}

<span class="hljs-comment">// Solutions to callback hell:</span>
<span class="hljs-comment">// 1. Named functions</span>
<span class="hljs-comment">// 2. Promises</span>
<span class="hljs-comment">// 3. Async/await</span>
</div></code></pre>
<h2 id="%F0%9F%A4%9D-promises">🤝 Promises</h2>
<h3 id="creating-promises">Creating Promises</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic Promise creation</span>
<span class="hljs-keyword">const</span> myPromise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
  <span class="hljs-comment">// Async operation</span>
  <span class="hljs-keyword">const</span> success = <span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.5</span>;

  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (success) {
      resolve(<span class="hljs-string">"Operation successful!"</span>); <span class="hljs-comment">// Promise fulfilled</span>
    } <span class="hljs-keyword">else</span> {
      reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Operation failed!"</span>)); <span class="hljs-comment">// Promise rejected</span>
    }
  }, <span class="hljs-number">1000</span>);
});

<span class="hljs-comment">// Using the Promise</span>
myPromise
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Success:"</span>, result);
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error.message);
  });
</div></code></pre>
<h3 id="promise-states">Promise States</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Promise has three states:</span>
<span class="hljs-comment">// 1. Pending - initial state</span>
<span class="hljs-comment">// 2. Fulfilled - operation completed successfully</span>
<span class="hljs-comment">// 3. Rejected - operation failed</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPromise</span>(<span class="hljs-params">delay, shouldResolve</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Promise is pending..."</span>);

    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (shouldResolve) {
        resolve(<span class="hljs-string">`Resolved after <span class="hljs-subst">${delay}</span>ms`</span>);
      } <span class="hljs-keyword">else</span> {
        reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Rejected after <span class="hljs-subst">${delay}</span>ms`</span>));
      }
    }, delay);
  });
}

<span class="hljs-comment">// Fulfilled promise</span>
createPromise(<span class="hljs-number">1000</span>, <span class="hljs-literal">true</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"✅"</span>, result))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"❌"</span>, error.message));

<span class="hljs-comment">// Rejected promise</span>
createPromise(<span class="hljs-number">1500</span>, <span class="hljs-literal">false</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"✅"</span>, result))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"❌"</span>, error.message));
</div></code></pre>
<h3 id="promise-chaining">Promise Chaining</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Chaining promises to avoid callback hell</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUser</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      resolve({ <span class="hljs-attr">id</span>: userId, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span> });
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserPosts</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      resolve([
        { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"First Post"</span>, userId },
        { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Second Post"</span>, userId },
      ]);
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchPostComments</span>(<span class="hljs-params">postId</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      resolve([
        { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Great post!"</span>, postId },
        { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Thanks for sharing!"</span>, postId },
      ]);
    }, <span class="hljs-number">1000</span>);
  });
}

<span class="hljs-comment">// ✅ Clean promise chaining</span>
fetchUser(<span class="hljs-number">123</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User:"</span>, user);
    <span class="hljs-keyword">return</span> fetchUserPosts(user.id); <span class="hljs-comment">// Return promise for chaining</span>
  })
  .then(<span class="hljs-function">(<span class="hljs-params">posts</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Posts:"</span>, posts);
    <span class="hljs-keyword">return</span> fetchPostComments(posts[<span class="hljs-number">0</span>].id);
  })
  .then(<span class="hljs-function">(<span class="hljs-params">comments</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Comments:"</span>, comments);
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error in chain:"</span>, error);
  });
</div></code></pre>
<h3 id="promise-utility-methods">Promise Utility Methods</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Promise.all() - wait for all promises to resolve</span>
<span class="hljs-keyword">const</span> promise1 = <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-number">3</span>);
<span class="hljs-keyword">const</span> promise2 = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span>
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(<span class="hljs-string">"foo"</span>), <span class="hljs-number">1000</span>)
);
<span class="hljs-keyword">const</span> promise3 = <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-number">42</span>);

<span class="hljs-built_in">Promise</span>.all([promise1, promise2, promise3])
  .then(<span class="hljs-function">(<span class="hljs-params">values</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"All resolved:"</span>, values); <span class="hljs-comment">// [3, 'foo', 42]</span>
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"One failed:"</span>, error);
  });

<span class="hljs-comment">// Promise.allSettled() - wait for all promises to settle (resolve or reject)</span>
<span class="hljs-keyword">const</span> promises = [
  <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">"Success 1"</span>),
  <span class="hljs-built_in">Promise</span>.reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Error 1"</span>)),
  <span class="hljs-built_in">Promise</span>.resolve(<span class="hljs-string">"Success 2"</span>),
];

<span class="hljs-built_in">Promise</span>.allSettled(promises).then(<span class="hljs-function">(<span class="hljs-params">results</span>) =&gt;</span> {
  results.forEach(<span class="hljs-function">(<span class="hljs-params">result, index</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (result.status === <span class="hljs-string">"fulfilled"</span>) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Promise <span class="hljs-subst">${index}</span> fulfilled:`</span>, result.value);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Promise <span class="hljs-subst">${index}</span> rejected:`</span>, result.reason.message);
    }
  });
});

<span class="hljs-comment">// Promise.race() - resolve with the first promise that settles</span>
<span class="hljs-keyword">const</span> fastPromise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span>
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(<span class="hljs-string">"Fast"</span>), <span class="hljs-number">100</span>)
);
<span class="hljs-keyword">const</span> slowPromise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span>
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(<span class="hljs-string">"Slow"</span>), <span class="hljs-number">1000</span>)
);

<span class="hljs-built_in">Promise</span>.race([fastPromise, slowPromise]).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"First to finish:"</span>, result); <span class="hljs-comment">// 'Fast'</span>
});

<span class="hljs-comment">// Promise.any() - resolve with the first promise that fulfills</span>
<span class="hljs-keyword">const</span> failingPromise = <span class="hljs-built_in">Promise</span>.reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed"</span>));
<span class="hljs-keyword">const</span> succeedingPromise = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span>
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(<span class="hljs-string">"Success"</span>), <span class="hljs-number">500</span>)
);

<span class="hljs-built_in">Promise</span>.any([failingPromise, succeedingPromise])
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"First success:"</span>, result); <span class="hljs-comment">// 'Success'</span>
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"All failed:"</span>, error);
  });
</div></code></pre>
<h3 id="converting-callbacks-to-promises">Converting Callbacks to Promises</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Promisify a callback-based function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">promisify</span>(<span class="hljs-params">callbackFunction</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      callbackFunction(...args, (error, result) =&gt; {
        <span class="hljs-keyword">if</span> (error) {
          reject(error);
        } <span class="hljs-keyword">else</span> {
          resolve(result);
        }
      });
    });
  };
}

<span class="hljs-comment">// Original callback-based function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">oldAsyncFunction</span>(<span class="hljs-params">data, callback</span>) </span>{
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (data) {
      callback(<span class="hljs-literal">null</span>, <span class="hljs-string">`Processed: <span class="hljs-subst">${data}</span>`</span>);
    } <span class="hljs-keyword">else</span> {
      callback(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"No data provided"</span>));
    }
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">// Promisified version</span>
<span class="hljs-keyword">const</span> newAsyncFunction = promisify(oldAsyncFunction);

<span class="hljs-comment">// Now we can use it with promises</span>
newAsyncFunction(<span class="hljs-string">"Hello"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(result)) <span class="hljs-comment">// "Processed: Hello"</span>
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(error));

<span class="hljs-comment">// Or with async/await</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">usePromisified</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> newAsyncFunction(<span class="hljs-string">"World"</span>);
    <span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// "Processed: World"</span>
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(error);
  }
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-asyncawait">🎯 Async/Await</h2>
<h3 id="basic-asyncawait">Basic Async/Await</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Async function always returns a Promise</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchData</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello, World!"</span>; <span class="hljs-comment">// Automatically wrapped in Promise.resolve()</span>
}

fetchData().then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(result)); <span class="hljs-comment">// "Hello, World!"</span>

<span class="hljs-comment">// Await can only be used inside async functions</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getData</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> fetchData();
  <span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// "Hello, World!"</span>
  <span class="hljs-keyword">return</span> result;
}

getData();
</div></code></pre>
<h3 id="converting-promises-to-asyncawait">Converting Promises to Async/Await</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Promise-based code</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserWithPromises</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-keyword">return</span> fetchUser(userId)
    .then(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User:"</span>, user);
      <span class="hljs-keyword">return</span> fetchUserPosts(user.id);
    })
    .then(<span class="hljs-function">(<span class="hljs-params">posts</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Posts:"</span>, posts);
      <span class="hljs-keyword">return</span> fetchPostComments(posts[<span class="hljs-number">0</span>].id);
    })
    .then(<span class="hljs-function">(<span class="hljs-params">comments</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Comments:"</span>, comments);
      <span class="hljs-keyword">return</span> { user, posts, comments };
    })
    .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error);
      <span class="hljs-keyword">throw</span> error;
    });
}

<span class="hljs-comment">// ✅ Equivalent async/await code (much cleaner!)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserWithAsync</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(userId);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User:"</span>, user);

    <span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> fetchUserPosts(user.id);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Posts:"</span>, posts);

    <span class="hljs-keyword">const</span> comments = <span class="hljs-keyword">await</span> fetchPostComments(posts[<span class="hljs-number">0</span>].id);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Comments:"</span>, comments);

    <span class="hljs-keyword">return</span> { user, posts, comments };
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}
</div></code></pre>
<h3 id="error-handling-with-asyncawait">Error Handling with Async/Await</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Multiple try-catch blocks for granular error handling</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complexOperation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> user, posts, comments;

  <span class="hljs-keyword">try</span> {
    user = <span class="hljs-keyword">await</span> fetchUser(<span class="hljs-number">123</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"✅ User fetched successfully"</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"❌ Failed to fetch user:"</span>, error.message);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>; <span class="hljs-comment">// Early return on critical error</span>
  }

  <span class="hljs-keyword">try</span> {
    posts = <span class="hljs-keyword">await</span> fetchUserPosts(user.id);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"✅ Posts fetched successfully"</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"❌ Failed to fetch posts:"</span>, error.message);
    posts = []; <span class="hljs-comment">// Continue with empty posts</span>
  }

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">if</span> (posts.length &gt; <span class="hljs-number">0</span>) {
      comments = <span class="hljs-keyword">await</span> fetchPostComments(posts[<span class="hljs-number">0</span>].id);
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"✅ Comments fetched successfully"</span>);
    } <span class="hljs-keyword">else</span> {
      comments = [];
    }
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"❌ Failed to fetch comments:"</span>, error.message);
    comments = []; <span class="hljs-comment">// Continue with empty comments</span>
  }

  <span class="hljs-keyword">return</span> { user, posts, comments };
}

<span class="hljs-comment">// Using the function</span>
complexOperation()
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (result) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Final result:"</span>, result);
    }
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Unexpected error:"</span>, error);
  });
</div></code></pre>
<h3 id="parallel-vs-sequential-execution">Parallel vs Sequential Execution</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Sequential execution (slower)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sequentialFetch</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Sequential"</span>);

  <span class="hljs-keyword">const</span> user1 = <span class="hljs-keyword">await</span> fetchUser(<span class="hljs-number">1</span>); <span class="hljs-comment">// Wait 1 second</span>
  <span class="hljs-keyword">const</span> user2 = <span class="hljs-keyword">await</span> fetchUser(<span class="hljs-number">2</span>); <span class="hljs-comment">// Wait another 1 second</span>
  <span class="hljs-keyword">const</span> user3 = <span class="hljs-keyword">await</span> fetchUser(<span class="hljs-number">3</span>); <span class="hljs-comment">// Wait another 1 second</span>

  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Sequential"</span>); <span class="hljs-comment">// ~3 seconds</span>
  <span class="hljs-keyword">return</span> [user1, user2, user3];
}

<span class="hljs-comment">// ✅ Parallel execution (faster)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parallelFetch</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Parallel"</span>);

  <span class="hljs-comment">// Start all requests simultaneously</span>
  <span class="hljs-keyword">const</span> userPromises = [fetchUser(<span class="hljs-number">1</span>), fetchUser(<span class="hljs-number">2</span>), fetchUser(<span class="hljs-number">3</span>)];

  <span class="hljs-comment">// Wait for all to complete</span>
  <span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(userPromises);

  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Parallel"</span>); <span class="hljs-comment">// ~1 second</span>
  <span class="hljs-keyword">return</span> users;
}

<span class="hljs-comment">// Mixed approach - some sequential, some parallel</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixedFetch</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// First, get user data</span>
  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(<span class="hljs-number">123</span>);

  <span class="hljs-comment">// Then, fetch posts and friends in parallel</span>
  <span class="hljs-keyword">const</span> [posts, friends] = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all([
    fetchUserPosts(user.id),
    fetchUserFriends(user.id),
  ]);

  <span class="hljs-comment">// Finally, get comments for the first post</span>
  <span class="hljs-keyword">const</span> comments = posts.length &gt; <span class="hljs-number">0</span> ? <span class="hljs-keyword">await</span> fetchPostComments(posts[<span class="hljs-number">0</span>].id) : [];

  <span class="hljs-keyword">return</span> { user, posts, friends, comments };
}
</div></code></pre>
<h3 id="async-iteration">Async Iteration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Processing arrays with async operations</span>
<span class="hljs-keyword">const</span> userIds = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];

<span class="hljs-comment">// ❌ Wrong - doesn't wait for async operations</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wrongAsyncMap</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> userIds.map(<span class="hljs-keyword">async</span> (id) =&gt; {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(id);
    <span class="hljs-keyword">return</span> user.name;
  });
  <span class="hljs-comment">// Returns array of Promises, not resolved values!</span>
}

<span class="hljs-comment">// ✅ Correct - sequential processing</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sequentialAsyncMap</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> names = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> id <span class="hljs-keyword">of</span> userIds) {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(id);
    names.push(user.name);
  }
  <span class="hljs-keyword">return</span> names;
}

<span class="hljs-comment">// ✅ Correct - parallel processing</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parallelAsyncMap</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> userPromises = userIds.map(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> fetchUser(id));
  <span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(userPromises);
  <span class="hljs-keyword">return</span> users.map(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.name);
}

<span class="hljs-comment">// ✅ Correct - using Promise.all with map</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">promiseAllMap</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> names = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(
    userIds.map(<span class="hljs-keyword">async</span> (id) =&gt; {
      <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(id);
      <span class="hljs-keyword">return</span> user.name;
    })
  );
  <span class="hljs-keyword">return</span> names;
}

<span class="hljs-comment">// For-await-of loop (for async iterables)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>* <span class="hljs-title">asyncGenerator</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">3</span>; i++) {
    <span class="hljs-keyword">yield</span> <span class="hljs-keyword">await</span> fetchUser(i);
  }
}

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAsyncIterator</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> (<span class="hljs-keyword">const</span> user <span class="hljs-keyword">of</span> asyncGenerator()) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User:"</span>, user.name);
  }
}
</div></code></pre>
<h2 id="%F0%9F%8E%AA-event-handling">🎪 Event Handling</h2>
<h3 id="dom-events">DOM Events</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic event handling</span>
<span class="hljs-keyword">const</span> button = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"myButton"</span>);

<span class="hljs-comment">// Method 1: addEventListener (recommended)</span>
button.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked!"</span>, event);
});

<span class="hljs-comment">// Method 2: Arrow function</span>
button.addEventListener(<span class="hljs-string">"click"</span>, (event) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked with arrow function!"</span>);
});

<span class="hljs-comment">// Method 3: Named function (for removal)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleClick</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Named function handler"</span>);
}

button.addEventListener(<span class="hljs-string">"click"</span>, handleClick);

<span class="hljs-comment">// Remove event listener</span>
button.removeEventListener(<span class="hljs-string">"click"</span>, handleClick);

<span class="hljs-comment">// Event options</span>
button.addEventListener(<span class="hljs-string">"click"</span>, handleClick, {
  <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Run only once</span>
  <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Never calls preventDefault()</span>
  <span class="hljs-attr">capture</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Capture phase instead of bubble</span>
});
</div></code></pre>
<h3 id="event-delegation">Event Delegation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Instead of adding listeners to many elements</span>
<span class="hljs-keyword">const</span> items = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".item"</span>);
items.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
  item.addEventListener(<span class="hljs-string">"click"</span>, handleItemClick); <span class="hljs-comment">// Many listeners</span>
});

<span class="hljs-comment">// ✅ Use event delegation (one listener on parent)</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"container"</span>);
container.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
  <span class="hljs-comment">// Check if clicked element has the class we want</span>
  <span class="hljs-keyword">if</span> (event.target.classList.contains(<span class="hljs-string">"item"</span>)) {
    handleItemClick(event);
  }
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleItemClick</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Item clicked:"</span>, event.target.textContent);
}

<span class="hljs-comment">// Advanced event delegation with closest()</span>
container.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
  <span class="hljs-keyword">const</span> item = event.target.closest(<span class="hljs-string">".item"</span>);
  <span class="hljs-keyword">if</span> (item) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Item or its child clicked:"</span>, item.dataset.id);
  }
});
</div></code></pre>
<h3 id="custom-events">Custom Events</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Creating custom events</span>
<span class="hljs-keyword">const</span> customEvent = <span class="hljs-keyword">new</span> CustomEvent(<span class="hljs-string">"userLogin"</span>, {
  <span class="hljs-attr">detail</span>: {
    <span class="hljs-attr">userId</span>: <span class="hljs-number">123</span>,
    <span class="hljs-attr">username</span>: <span class="hljs-string">"alice"</span>,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
  },
  <span class="hljs-attr">bubbles</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">cancelable</span>: <span class="hljs-literal">true</span>,
});

<span class="hljs-comment">// Listen for custom event</span>
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"userLogin"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User logged in:"</span>, event.detail);
});

<span class="hljs-comment">// Dispatch custom event</span>
<span class="hljs-built_in">document</span>.dispatchEvent(customEvent);

<span class="hljs-comment">// Event emitter pattern</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventEmitter</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.events = {};
  }

  on(event, callback) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.events[event]) {
      <span class="hljs-keyword">this</span>.events[event] = [];
    }
    <span class="hljs-keyword">this</span>.events[event].push(callback);
  }

  off(event, callback) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.events[event]) {
      <span class="hljs-keyword">this</span>.events[event] = <span class="hljs-keyword">this</span>.events[event].filter(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> cb !== callback);
    }
  }

  emit(event, data) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.events[event]) {
      <span class="hljs-keyword">this</span>.events[event].forEach(<span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> callback(data));
    }
  }

  once(event, callback) {
    <span class="hljs-keyword">const</span> onceCallback = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      callback(data);
      <span class="hljs-keyword">this</span>.off(event, onceCallback);
    };
    <span class="hljs-keyword">this</span>.on(event, onceCallback);
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> EventEmitter();

emitter.on(<span class="hljs-string">"data"</span>, (data) =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Data received:"</span>, data));
emitter.once(<span class="hljs-string">"error"</span>, (error) =&gt; <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error));

emitter.emit(<span class="hljs-string">"data"</span>, { <span class="hljs-attr">message</span>: <span class="hljs-string">"Hello"</span> });
emitter.emit(<span class="hljs-string">"error"</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Something went wrong"</span>));
</div></code></pre>
<h2 id="%F0%9F%8C%90-fetch-api">🌐 Fetch API</h2>
<h3 id="basic-fetch-usage">Basic Fetch Usage</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic GET request</span>
fetch(<span class="hljs-string">"https://jsonplaceholder.typicode.com/users/1"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }
    <span class="hljs-keyword">return</span> response.json();
  })
  .then(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User:"</span>, user);
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Fetch error:"</span>, error);
  });

<span class="hljs-comment">// ✅ With async/await (cleaner)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUser</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(
      <span class="hljs-string">`https://jsonplaceholder.typicode.com/users/<span class="hljs-subst">${userId}</span>`</span>
    );

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> response.json();
    <span class="hljs-keyword">return</span> user;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Fetch error:"</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}
</div></code></pre>
<h3 id="advanced-fetch-options">Advanced Fetch Options</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// POST request with JSON data</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createUser</span>(<span class="hljs-params">userData</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"https://jsonplaceholder.typicode.com/users"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        <span class="hljs-attr">Authorization</span>: <span class="hljs-string">"Bearer your-token-here"</span>,
      },
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(userData),
    });

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> newUser = <span class="hljs-keyword">await</span> response.json();
    <span class="hljs-keyword">return</span> newUser;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Create user error:"</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> newUser = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
  <span class="hljs-attr">username</span>: <span class="hljs-string">"johndoe"</span>,
};

createUser(newUser)
  .then(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Created user:"</span>, user))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to create user:"</span>, error));

<span class="hljs-comment">// File upload</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">uploadFile</span>(<span class="hljs-params">file</span>) </span>{
  <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData();
  formData.append(<span class="hljs-string">"file"</span>, file);
  formData.append(<span class="hljs-string">"description"</span>, <span class="hljs-string">"My uploaded file"</span>);

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/upload"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">body</span>: formData, <span class="hljs-comment">// Don't set Content-Type header for FormData</span>
    });

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Upload failed: <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
    <span class="hljs-keyword">return</span> result;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Upload error:"</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}

<span class="hljs-comment">// Request with timeout</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchWithTimeout</span>(<span class="hljs-params">url, timeout = <span class="hljs-number">5000</span></span>) </span>{
  <span class="hljs-keyword">const</span> controller = <span class="hljs-keyword">new</span> AbortController();
  <span class="hljs-keyword">const</span> timeoutId = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> controller.abort(), timeout);

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, {
      <span class="hljs-attr">signal</span>: controller.signal,
    });

    clearTimeout(timeoutId);
    <span class="hljs-keyword">return</span> response;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">if</span> (error.name === <span class="hljs-string">"AbortError"</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Request timed out"</span>);
    }
    <span class="hljs-keyword">throw</span> error;
  }
}
</div></code></pre>
<h3 id="error-handling-and-retry-logic">Error Handling and Retry Logic</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Robust fetch with retry logic</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchWithRetry</span>(<span class="hljs-params">url, options = {}, maxRetries = <span class="hljs-number">3</span></span>) </span>{
  <span class="hljs-keyword">const</span> { retryDelay = <span class="hljs-number">1000</span>, ...fetchOptions } = options;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> attempt = <span class="hljs-number">1</span>; attempt &lt;= maxRetries; attempt++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, fetchOptions);

      <span class="hljs-keyword">if</span> (response.ok) {
        <span class="hljs-keyword">return</span> response;
      }

      <span class="hljs-comment">// Don't retry on client errors (4xx)</span>
      <span class="hljs-keyword">if</span> (response.status &gt;= <span class="hljs-number">400</span> &amp;&amp; response.status &lt; <span class="hljs-number">500</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Client error: <span class="hljs-subst">${response.status}</span>`</span>);
      }

      <span class="hljs-comment">// Retry on server errors (5xx)</span>
      <span class="hljs-keyword">if</span> (attempt === maxRetries) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
          <span class="hljs-string">`Server error after <span class="hljs-subst">${maxRetries}</span> attempts: <span class="hljs-subst">${response.status}</span>`</span>
        );
      }

      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Attempt <span class="hljs-subst">${attempt}</span> failed, retrying in <span class="hljs-subst">${retryDelay}</span>ms...`</span>);
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, retryDelay));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">if</span> (attempt === maxRetries) {
        <span class="hljs-keyword">throw</span> error;
      }

      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Attempt <span class="hljs-subst">${attempt}</span> failed:`</span>, error.message);
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, retryDelay));
    }
  }
}

<span class="hljs-comment">// Usage</span>
fetchWithRetry(
  <span class="hljs-string">"https://api.example.com/data"</span>,
  {
    <span class="hljs-attr">method</span>: <span class="hljs-string">"GET"</span>,
    <span class="hljs-attr">headers</span>: { <span class="hljs-attr">Authorization</span>: <span class="hljs-string">"Bearer token"</span> },
    <span class="hljs-attr">retryDelay</span>: <span class="hljs-number">2000</span>,
  },
  <span class="hljs-number">3</span>
)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json())
  .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Data:"</span>, data))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Final error:"</span>, error));
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-forgetting-to-handle-errors">1. Forgetting to Handle Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ No error handling</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">badFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>);
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json(); <span class="hljs-comment">// Could throw if response is not JSON</span>
  <span class="hljs-keyword">return</span> data;
}

<span class="hljs-comment">// ✅ Proper error handling</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goodFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>);

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
    <span class="hljs-keyword">return</span> data;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error fetching data:"</span>, error);
    <span class="hljs-keyword">throw</span> error; <span class="hljs-comment">// Re-throw if caller should handle it</span>
  }
}
</div></code></pre>
<h3 id="2-not-understanding-promise-resolution">2. Not Understanding Promise Resolution</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Wrong - returns Promise, not the value</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wrongAsyncFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">"/api/data"</span>).then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json());
}

<span class="hljs-keyword">const</span> result = wrongAsyncFunction();
<span class="hljs-built_in">console</span>.log(result); <span class="hljs-comment">// Promise object, not the data!</span>

<span class="hljs-comment">// ✅ Correct ways</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">correctAsyncFunction</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>);
  <span class="hljs-keyword">return</span> response.json();
}

<span class="hljs-comment">// Or use the Promise properly</span>
wrongAsyncFunction().then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(data); <span class="hljs-comment">// Now we have the actual data</span>
});
</div></code></pre>
<h3 id="3-mixing-async-patterns">3. Mixing Async Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Mixing async/await with .then() (confusing)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixedPattern</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>);
  <span class="hljs-keyword">return</span> response.json().then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> data.users;
  });
}

<span class="hljs-comment">// ✅ Consistent async/await</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consistentPattern</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>);
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
  <span class="hljs-keyword">return</span> data.users;
}

<span class="hljs-comment">// ✅ Consistent Promise chain</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">consistentPromises</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">"/api/data"</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json())
    .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> data.users);
}
</div></code></pre>
<h3 id="4-not-handling-parallel-vs-sequential">4. Not Handling Parallel vs Sequential</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Unnecessary sequential execution</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inefficient</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> posts = <span class="hljs-keyword">await</span> fetchPosts(); <span class="hljs-comment">// Doesn't depend on user!</span>
  <span class="hljs-keyword">const</span> comments = <span class="hljs-keyword">await</span> fetchComments(); <span class="hljs-comment">// Doesn't depend on user or posts!</span>

  <span class="hljs-keyword">return</span> { user, posts, comments };
}

<span class="hljs-comment">// ✅ Parallel execution when possible</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">efficient</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, posts, comments] = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all([
    fetchUser(<span class="hljs-number">1</span>),
    fetchPosts(),
    fetchComments(),
  ]);

  <span class="hljs-keyword">return</span> { user, posts, comments };
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-promise-based-timer">Problem 1: Promise-based Timer</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a promise-based delay function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delay</span>(<span class="hljs-params">ms</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Should return a Promise that resolves after ms milliseconds</span>
}

<span class="hljs-comment">// Usage:</span>
delay(<span class="hljs-number">2000</span>).then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"2 seconds passed"</span>));

<span class="hljs-comment">// With async/await:</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">example</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Starting..."</span>);
  <span class="hljs-keyword">await</span> delay(<span class="hljs-number">1000</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"1 second later"</span>);
  <span class="hljs-keyword">await</span> delay(<span class="hljs-number">1000</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"2 seconds later"</span>);
}
</div></code></pre>
<h3 id="problem-2-parallel-api-calls">Problem 2: Parallel API Calls</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Fetch multiple users in parallel and return their names</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserNames</span>(<span class="hljs-params">userIds</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Should fetch all users in parallel and return array of names</span>
  <span class="hljs-comment">// Handle errors gracefully (skip failed requests)</span>
}

<span class="hljs-comment">// Test:</span>
fetchUserNames([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">999</span>]) <span class="hljs-comment">// 999 might not exist</span>
  .then(<span class="hljs-function">(<span class="hljs-params">names</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Names:"</span>, names))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error));
</div></code></pre>
<h3 id="problem-3-rate-limited-api-client">Problem 3: Rate-Limited API Client</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create an API client that limits requests to avoid rate limiting</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RateLimitedClient</span> </span>{
  <span class="hljs-keyword">constructor</span>(requestsPerSecond = 5) {
    <span class="hljs-keyword">this</span>.requestsPerSecond = requestsPerSecond;
    <span class="hljs-comment">// Your implementation here</span>
  }

  <span class="hljs-keyword">async</span> request(url, options = {}) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should ensure no more than requestsPerSecond requests per second</span>
    <span class="hljs-comment">// Should queue requests if rate limit would be exceeded</span>
  }
}

<span class="hljs-comment">// Test:</span>
<span class="hljs-keyword">const</span> client = <span class="hljs-keyword">new</span> RateLimitedClient(<span class="hljs-number">2</span>); <span class="hljs-comment">// 2 requests per second</span>

<span class="hljs-comment">// These should be spaced out automatically</span>
client.request(<span class="hljs-string">"/api/user/1"</span>).then(<span class="hljs-built_in">console</span>.log);
client.request(<span class="hljs-string">"/api/user/2"</span>).then(<span class="hljs-built_in">console</span>.log);
client.request(<span class="hljs-string">"/api/user/3"</span>).then(<span class="hljs-built_in">console</span>.log);
client.request(<span class="hljs-string">"/api/user/4"</span>).then(<span class="hljs-built_in">console</span>.log);
</div></code></pre>
<h3 id="problem-4-event-based-data-loader">Problem 4: Event-based Data Loader</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a data loader that emits events during loading</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataLoader</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">EventEmitter</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">super</span>();
    <span class="hljs-comment">// Your implementation here</span>
  }

  <span class="hljs-keyword">async</span> loadData(urls) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should emit 'start', 'progress', 'complete', and 'error' events</span>
    <span class="hljs-comment">// Progress should include percentage and current item</span>
  }
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> loader = <span class="hljs-keyword">new</span> DataLoader();

loader.on(<span class="hljs-string">"start"</span>, () =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Loading started"</span>));
loader.on(<span class="hljs-string">"progress"</span>, (data) =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Progress: <span class="hljs-subst">${data.percentage}</span>%`</span>));
loader.on(<span class="hljs-string">"complete"</span>, (results) =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"All data loaded:"</span>, results));
loader.on(<span class="hljs-string">"error"</span>, (error) =&gt; <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Loading error:"</span>, error));

loader.loadData([<span class="hljs-string">"/api/users"</span>, <span class="hljs-string">"/api/posts"</span>, <span class="hljs-string">"/api/comments"</span>]);
</div></code></pre>
<h3 id="problem-5-async-queue">Problem 5: Async Queue</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement an async queue that processes tasks with concurrency limit</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AsyncQueue</span> </span>{
  <span class="hljs-keyword">constructor</span>(concurrency = 3) {
    <span class="hljs-keyword">this</span>.concurrency = concurrency;
    <span class="hljs-comment">// Your implementation here</span>
  }

  add(asyncTask) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should return a Promise that resolves when task completes</span>
    <span class="hljs-comment">// Should respect concurrency limit</span>
  }

  <span class="hljs-keyword">async</span> drain() {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should wait for all queued tasks to complete</span>
  }
}

<span class="hljs-comment">// Test:</span>
<span class="hljs-keyword">const</span> queue = <span class="hljs-keyword">new</span> AsyncQueue(<span class="hljs-number">2</span>); <span class="hljs-comment">// Max 2 concurrent tasks</span>

<span class="hljs-comment">// Add tasks</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">10</span>; i++) {
  queue
    .add(<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Task <span class="hljs-subst">${i}</span> started`</span>);
      <span class="hljs-keyword">await</span> delay(<span class="hljs-number">1000</span>);
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Task <span class="hljs-subst">${i}</span> completed`</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-string">`Result <span class="hljs-subst">${i}</span>`</span>;
    })
    .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Got:"</span>, result));
}

queue.drain().then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"All tasks completed"</span>));
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between callbacks, promises, and async/await?</strong></p>
<ul>
<li>Callbacks: Functions passed as arguments, can lead to callback hell</li>
<li>Promises: Objects representing eventual completion, chainable with .then()</li>
<li>Async/await: Syntactic sugar over promises, makes async code look synchronous</li>
</ul>
<p><strong>Q: How does the event loop work?</strong></p>
<ul>
<li>Call stack executes synchronous code</li>
<li>Web APIs handle async operations</li>
<li>Callback queue holds completed async callbacks</li>
<li>Event loop moves callbacks from queue to stack when stack is empty</li>
<li>Microtasks (Promises) have higher priority than macrotasks (setTimeout)</li>
</ul>
<p><strong>Q: What's the difference between Promise.all() and Promise.allSettled()?</strong></p>
<ul>
<li>Promise.all(): Fails fast - rejects if any promise rejects</li>
<li>Promise.allSettled(): Waits for all promises to settle (resolve or reject)</li>
</ul>
<p><strong>Q: How do you handle errors in async/await?</strong></p>
<ul>
<li>Use try-catch blocks</li>
<li>Can have multiple try-catch for granular error handling</li>
<li>Unhandled promise rejections should be caught</li>
</ul>
<p><strong>Q: What's the difference between parallel and sequential execution?</strong></p>
<ul>
<li>Sequential: await each operation one by one (slower)</li>
<li>Parallel: start all operations, then await Promise.all() (faster)</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement Promise.all() from scratch&quot;</li>
<li><strong>Facebook</strong>: &quot;Design a rate-limited API client&quot;</li>
<li><strong>Amazon</strong>: &quot;Explain the event loop and microtask queue&quot;</li>
<li><strong>Microsoft</strong>: &quot;Implement async retry logic with exponential backoff&quot;</li>
<li><strong>Netflix</strong>: &quot;Create an async data pipeline with error handling&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Understand the event loop</strong> - foundation of async JavaScript</li>
<li><strong>Master Promise patterns</strong> - chaining, error handling, utility methods</li>
<li><strong>Use async/await for readability</strong> - but understand the underlying promises</li>
<li><strong>Handle errors properly</strong> - always have error handling strategies</li>
<li><strong>Choose parallel vs sequential</strong> - based on dependencies between operations</li>
<li><strong>Avoid callback hell</strong> - use promises or async/await instead</li>
<li><strong>Practice with real APIs</strong> - fetch, error handling, retry logic</li>
<li><strong>Understand event-driven programming</strong> - DOM events, custom events, event emitters</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./09-prototypes.md">← Prototypes &amp; Inheritance</a><br>
<strong>Next Chapter</strong>: <a href="./11-error-handling.md">Error Handling &amp; Debugging →</a></p>
<p><strong>Practice</strong>: Try the async problems and experiment with different async patterns!</p>
<h1 id="%F0%9F%93%9A-chapter-11-error-handling--debugging">📚 Chapter 11: Error Handling &amp; Debugging</h1>
<blockquote>
<p>Master error handling, debugging techniques, and building robust JavaScript applications.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Error handling is like having safety nets and emergency procedures:</p>
<ul>
<li><strong>Smoke detectors</strong> = catching errors before they cause damage</li>
<li><strong>First aid kit</strong> = having tools ready to handle problems</li>
<li><strong>Emergency exits</strong> = graceful ways to handle failures</li>
<li><strong>Security cameras</strong> = logging and monitoring to understand what went wrong</li>
<li><strong>Building codes</strong> = following best practices to prevent errors</li>
</ul>
<p>In programming, errors are inevitable. Good error handling makes your applications resilient, user-friendly, and easier to debug.</p>
<h2 id="%F0%9F%9A%A8-types-of-errors">🚨 Types of Errors</h2>
<h3 id="syntax-errors">Syntax Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Syntax errors - code won't run at all</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">badSyntax</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Hello World'</span>; <span class="hljs-comment">// Missing closing parenthesis</span>

    <span class="hljs-keyword">if</span> (<span class="hljs-literal">true</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Missing closing parenthesis'</span>);
    }

    <span class="hljs-keyword">const</span> obj = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>
        <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> <span class="hljs-comment">// Missing comma</span>
    };
}

<span class="hljs-comment">// These are caught by the JavaScript parser before execution</span>
</div></code></pre>
<h3 id="reference-errors">Reference Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ ReferenceError - using undefined variables</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">referenceErrors</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(undefinedVariable); <span class="hljs-comment">// ReferenceError: undefinedVariable is not defined</span>

  someFunction(); <span class="hljs-comment">// ReferenceError: someFunction is not defined</span>

  <span class="hljs-comment">// Accessing variables before declaration (temporal dead zone)</span>
  <span class="hljs-built_in">console</span>.log(myLet); <span class="hljs-comment">// ReferenceError</span>
  <span class="hljs-keyword">let</span> myLet = <span class="hljs-string">"Hello"</span>;
}

<span class="hljs-comment">// ✅ How to avoid</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">avoidReferenceErrors</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Check if variable exists</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> someVariable !== <span class="hljs-string">"undefined"</span>) {
    <span class="hljs-built_in">console</span>.log(someVariable);
  }

  <span class="hljs-comment">// Or use optional chaining for object properties</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">window</span>.someProperty?.value);

  <span class="hljs-comment">// Declare variables before use</span>
  <span class="hljs-keyword">let</span> myVar = <span class="hljs-string">"Hello"</span>;
  <span class="hljs-built_in">console</span>.log(myVar);
}
</div></code></pre>
<h3 id="type-errors">Type Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ TypeError - wrong type operations</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">typeErrors</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> num = <span class="hljs-number">42</span>;
  num.toUpperCase(); <span class="hljs-comment">// TypeError: num.toUpperCase is not a function</span>

  <span class="hljs-keyword">const</span> str = <span class="hljs-string">"Hello"</span>;
  str.push(<span class="hljs-string">"World"</span>); <span class="hljs-comment">// TypeError: str.push is not a function</span>

  <span class="hljs-literal">null</span>.property; <span class="hljs-comment">// TypeError: Cannot read property 'property' of null</span>

  <span class="hljs-keyword">const</span> obj = {};
  obj.method(); <span class="hljs-comment">// TypeError: obj.method is not a function</span>
}

<span class="hljs-comment">// ✅ How to avoid</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">avoidTypeErrors</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> num = <span class="hljs-number">42</span>;

  <span class="hljs-comment">// Check type before operation</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> num === <span class="hljs-string">"string"</span>) {
    <span class="hljs-built_in">console</span>.log(num.toUpperCase());
  }

  <span class="hljs-comment">// Check if method exists</span>
  <span class="hljs-keyword">const</span> obj = {};
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj.method === <span class="hljs-string">"function"</span>) {
    obj.method();
  }

  <span class="hljs-comment">// Use optional chaining</span>
  <span class="hljs-keyword">const</span> user = <span class="hljs-literal">null</span>;
  <span class="hljs-built_in">console</span>.log(user?.name?.toUpperCase?.()); <span class="hljs-comment">// undefined, no error</span>

  <span class="hljs-comment">// Type checking with instanceof</span>
  <span class="hljs-keyword">const</span> arr = [];
  <span class="hljs-keyword">if</span> (arr <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>) {
    arr.push(<span class="hljs-string">"item"</span>);
  }
}
</div></code></pre>
<h3 id="range-errors">Range Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ RangeError - values outside valid range</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">rangeErrors</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Array with invalid length</span>
  <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">-1</span>); <span class="hljs-comment">// RangeError: Invalid array length</span>

  <span class="hljs-comment">// Number methods with invalid parameters</span>
  <span class="hljs-keyword">const</span> num = <span class="hljs-number">123.456</span>;
  num.toFixed(<span class="hljs-number">-1</span>); <span class="hljs-comment">// RangeError: toFixed() digits argument must be between 0 and 100</span>

  <span class="hljs-comment">// Stack overflow (infinite recursion)</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">infiniteRecursion</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> infiniteRecursion(); <span class="hljs-comment">// RangeError: Maximum call stack size exceeded</span>
  }
  infiniteRecursion();
}

<span class="hljs-comment">// ✅ How to avoid</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">avoidRangeErrors</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Validate array length</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createArray</span>(<span class="hljs-params">length</span>) </span>{
    <span class="hljs-keyword">if</span> (length &lt; <span class="hljs-number">0</span> || length &gt; <span class="hljs-built_in">Number</span>.MAX_SAFE_INTEGER) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid array length"</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(length);
  }

  <span class="hljs-comment">// Validate number method parameters</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeToFixed</span>(<span class="hljs-params">num, digits</span>) </span>{
    <span class="hljs-keyword">if</span> (digits &lt; <span class="hljs-number">0</span> || digits &gt; <span class="hljs-number">100</span>) {
      digits = <span class="hljs-number">2</span>; <span class="hljs-comment">// Default value</span>
    }
    <span class="hljs-keyword">return</span> num.toFixed(digits);
  }

  <span class="hljs-comment">// Prevent infinite recursion</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeRecursion</span>(<span class="hljs-params">n, depth = <span class="hljs-number">0</span></span>) </span>{
    <span class="hljs-keyword">if</span> (depth &gt; <span class="hljs-number">1000</span>) {
      <span class="hljs-comment">// Safety limit</span>
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Maximum recursion depth exceeded"</span>);
    }

    <span class="hljs-keyword">if</span> (n &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    <span class="hljs-keyword">return</span> n * safeRecursion(n - <span class="hljs-number">1</span>, depth + <span class="hljs-number">1</span>);
  }
}
</div></code></pre>
<h3 id="custom-errors">Custom Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Creating custom error types</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidationError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>{
  <span class="hljs-keyword">constructor</span>(message, field) {
    <span class="hljs-keyword">super</span>(message);
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">"ValidationError"</span>;
    <span class="hljs-keyword">this</span>.field = field;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NetworkError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>{
  <span class="hljs-keyword">constructor</span>(message, statusCode) {
    <span class="hljs-keyword">super</span>(message);
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">"NetworkError"</span>;
    <span class="hljs-keyword">this</span>.statusCode = statusCode;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BusinessLogicError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>{
  <span class="hljs-keyword">constructor</span>(message, code) {
    <span class="hljs-keyword">super</span>(message);
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">"BusinessLogicError"</span>;
    <span class="hljs-keyword">this</span>.code = code;
  }
}

<span class="hljs-comment">// Using custom errors</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateUser</span>(<span class="hljs-params">user</span>) </span>{
  <span class="hljs-keyword">if</span> (!user.email) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ValidationError(<span class="hljs-string">"Email is required"</span>, <span class="hljs-string">"email"</span>);
  }

  <span class="hljs-keyword">if</span> (!user.email.includes(<span class="hljs-string">"@"</span>)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ValidationError(<span class="hljs-string">"Invalid email format"</span>, <span class="hljs-string">"email"</span>);
  }

  <span class="hljs-keyword">if</span> (user.age &lt; <span class="hljs-number">0</span> || user.age &gt; <span class="hljs-number">150</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ValidationError(<span class="hljs-string">"Age must be between 0 and 150"</span>, <span class="hljs-string">"age"</span>);
  }
}

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserData</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NetworkError(
        <span class="hljs-string">`Failed to fetch user: <span class="hljs-subst">${response.statusText}</span>`</span>,
        response.status
      );
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.json();
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">instanceof</span> NetworkError) {
      <span class="hljs-keyword">throw</span> error; <span class="hljs-comment">// Re-throw network errors</span>
    }
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NetworkError(<span class="hljs-string">"Network request failed"</span>, <span class="hljs-number">0</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processPayment</span>(<span class="hljs-params">amount, balance</span>) </span>{
  <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BusinessLogicError(
      <span class="hljs-string">"Payment amount must be positive"</span>,
      <span class="hljs-string">"INVALID_AMOUNT"</span>
    );
  }

  <span class="hljs-keyword">if</span> (amount &gt; balance) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BusinessLogicError(<span class="hljs-string">"Insufficient funds"</span>, <span class="hljs-string">"INSUFFICIENT_FUNDS"</span>);
  }

  <span class="hljs-comment">// Process payment...</span>
}
</div></code></pre>
<h2 id="%F0%9F%9B%A1%EF%B8%8F-try-catch-finally">🛡️ Try-Catch-Finally</h2>
<h3 id="basic-try-catch">Basic Try-Catch</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">basicTryCatch</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// Code that might throw an error</span>
    <span class="hljs-keyword">const</span> result = riskyOperation();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Success:"</span>, result);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Handle the error</span>
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error occurred:"</span>, error.message);
  }
}

<span class="hljs-comment">// Catching specific error types</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">specificErrorHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> };
    validateUser(user);
    processUser(user);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">instanceof</span> ValidationError) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Validation failed for <span class="hljs-subst">${error.field}</span>: <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-comment">// Show user-friendly validation message</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">instanceof</span> NetworkError) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Network error (<span class="hljs-subst">${error.statusCode}</span>): <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-comment">// Show network error message, maybe retry</span>
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">instanceof</span> BusinessLogicError) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Business logic error (<span class="hljs-subst">${error.code}</span>): <span class="hljs-subst">${error.message}</span>`</span>);
      <span class="hljs-comment">// Handle business logic errors</span>
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Unexpected error:"</span>, error);
      <span class="hljs-comment">// Log unexpected errors for debugging</span>
    }
  }
}
</div></code></pre>
<h3 id="finally-block">Finally Block</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Finally block always executes</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tryFinallyExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">let</span> resource = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">try</span> {
    resource = acquireResource();
    processResource(resource);
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Success"</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error processing resource:"</span>, error);
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Error"</span>;
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-comment">// This always runs, regardless of success or error</span>
    <span class="hljs-keyword">if</span> (resource) {
      releaseResource(resource);
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Resource cleaned up"</span>);
    }
  }
}

<span class="hljs-comment">// Practical example: File handling</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processFile</span>(<span class="hljs-params">filename</span>) </span>{
  <span class="hljs-keyword">let</span> fileHandle = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">try</span> {
    fileHandle = <span class="hljs-keyword">await</span> openFile(filename);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> readFile(fileHandle);
    <span class="hljs-keyword">const</span> processed = processData(data);
    <span class="hljs-keyword">await</span> writeFile(fileHandle, processed);
    <span class="hljs-keyword">return</span> processed;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Error processing file <span class="hljs-subst">${filename}</span>:`</span>, error);
    <span class="hljs-keyword">throw</span> error;
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-comment">// Always close the file, even if an error occurred</span>
    <span class="hljs-keyword">if</span> (fileHandle) {
      <span class="hljs-keyword">await</span> closeFile(fileHandle);
    }
  }
}

<span class="hljs-comment">// Database transaction example</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">transferMoney</span>(<span class="hljs-params">fromAccount, toAccount, amount</span>) </span>{
  <span class="hljs-keyword">const</span> transaction = <span class="hljs-keyword">await</span> db.beginTransaction();

  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">await</span> db.debit(fromAccount, amount);
    <span class="hljs-keyword">await</span> db.credit(toAccount, amount);
    <span class="hljs-keyword">await</span> transaction.commit();
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">transactionId</span>: transaction.id };
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">await</span> transaction.rollback();
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Transfer failed:"</span>, error);
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BusinessLogicError(<span class="hljs-string">"Transfer failed"</span>, <span class="hljs-string">"TRANSFER_ERROR"</span>);
  } <span class="hljs-keyword">finally</span> {
    <span class="hljs-comment">// Clean up transaction resources</span>
    <span class="hljs-keyword">await</span> transaction.close();
  }
}
</div></code></pre>
<h3 id="nested-try-catch">Nested Try-Catch</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Multiple levels of error handling</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complexOperation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// Outer try-catch for general errors</span>
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Inner try-catch for specific operation</span>
      <span class="hljs-keyword">const</span> preferences = <span class="hljs-keyword">await</span> fetchUserPreferences(user.id);
      <span class="hljs-keyword">return</span> { user, preferences };
    } <span class="hljs-keyword">catch</span> (prefError) {
      <span class="hljs-comment">// Handle preference errors gracefully</span>
      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Could not load preferences:"</span>, prefError.message);
      <span class="hljs-keyword">return</span> { user, <span class="hljs-attr">preferences</span>: getDefaultPreferences() };
    }
  } <span class="hljs-keyword">catch</span> (userError) {
    <span class="hljs-comment">// Handle user fetch errors</span>
    <span class="hljs-keyword">if</span> (userError <span class="hljs-keyword">instanceof</span> NetworkError &amp;&amp; userError.statusCode === <span class="hljs-number">404</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BusinessLogicError(<span class="hljs-string">"User not found"</span>, <span class="hljs-string">"USER_NOT_FOUND"</span>);
    }
    <span class="hljs-keyword">throw</span> userError; <span class="hljs-comment">// Re-throw other errors</span>
  }
}

<span class="hljs-comment">// Error recovery with fallbacks</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">robustDataFetch</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> sources = [
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> fetchFromPrimaryAPI(),
    () =&gt; fetchFromSecondaryAPI(),
    () =&gt; fetchFromCache(),
    () =&gt; getDefaultData(),
  ];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; sources.length; i++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> sources[i]();
      <span class="hljs-keyword">if</span> (i &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`Used fallback source <span class="hljs-subst">${i}</span>`</span>);
      }
      <span class="hljs-keyword">return</span> data;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Source <span class="hljs-subst">${i}</span> failed:`</span>, error.message);

      <span class="hljs-keyword">if</span> (i === sources.length - <span class="hljs-number">1</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"All data sources failed"</span>);
      }
      <span class="hljs-comment">// Continue to next source</span>
    }
  }
}
</div></code></pre>
<h2 id="%F0%9F%94%8D-debugging-techniques">🔍 Debugging Techniques</h2>
<h3 id="console-methods">Console Methods</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Different console methods for debugging</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debuggingWithConsole</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"reading"</span>, <span class="hljs-string">"swimming"</span>] };

  <span class="hljs-comment">// Basic logging</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User data:"</span>, user);

  <span class="hljs-comment">// Different log levels</span>
  <span class="hljs-built_in">console</span>.info(<span class="hljs-string">"Information message"</span>);
  <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Warning message"</span>);
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error message"</span>);

  <span class="hljs-comment">// Formatted output</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User %s is %d years old"</span>, user.name, user.age);

  <span class="hljs-comment">// Table format for arrays/objects</span>
  <span class="hljs-built_in">console</span>.table(user.hobbies);
  <span class="hljs-built_in">console</span>.table([user]);

  <span class="hljs-comment">// Grouping related logs</span>
  <span class="hljs-built_in">console</span>.group(<span class="hljs-string">"User Processing"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Validating user..."</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User is valid"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Processing complete"</span>);
  <span class="hljs-built_in">console</span>.groupEnd();

  <span class="hljs-comment">// Timing operations</span>
  <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Operation"</span>);
  <span class="hljs-comment">// ... some operation</span>
  <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Operation"</span>);

  <span class="hljs-comment">// Counting occurrences</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">5</span>; i++) {
    <span class="hljs-built_in">console</span>.count(<span class="hljs-string">"Loop iteration"</span>);
  }

  <span class="hljs-comment">// Stack trace</span>
  <span class="hljs-built_in">console</span>.trace(<span class="hljs-string">"Execution path"</span>);

  <span class="hljs-comment">// Conditional logging</span>
  <span class="hljs-built_in">console</span>.assert(user.age &gt; <span class="hljs-number">0</span>, <span class="hljs-string">"Age should be positive"</span>);

  <span class="hljs-comment">// Clear console</span>
  <span class="hljs-comment">// console.clear();</span>
}
</div></code></pre>
<h3 id="debugger-statement">Debugger Statement</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Using debugger statement</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debuggerExample</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Starting processing..."</span>);

  <span class="hljs-comment">// Execution will pause here when dev tools are open</span>
  <span class="hljs-keyword">debugger</span>;

  <span class="hljs-keyword">const</span> processed = data.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-comment">// Another breakpoint</span>
    <span class="hljs-keyword">debugger</span>;
    <span class="hljs-keyword">return</span> item * <span class="hljs-number">2</span>;
  });

  <span class="hljs-keyword">return</span> processed;
}

<span class="hljs-comment">// Conditional debugging</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">conditionalDebugging</span>(<span class="hljs-params">items</span>) </span>{
  items.forEach(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
    <span class="hljs-comment">// Only break on specific conditions</span>
    <span class="hljs-keyword">if</span> (item.error &amp;&amp; process.env.NODE_ENV === <span class="hljs-string">"development"</span>) {
      <span class="hljs-keyword">debugger</span>;
    }

    processItem(item);
  });
}
</div></code></pre>
<h3 id="error-boundaries-react-style-pattern">Error Boundaries (React-style pattern)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Error boundary pattern for JavaScript</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorBoundary</span> </span>{
  <span class="hljs-keyword">constructor</span>(fallbackUI) {
    <span class="hljs-keyword">this</span>.fallbackUI = fallbackUI;
    <span class="hljs-keyword">this</span>.hasError = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.error = <span class="hljs-literal">null</span>;
  }

  wrap(fn) {
    <span class="hljs-keyword">return</span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>.hasError = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.error = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">return</span> fn(...args);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">this</span>.hasError = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.error = error;
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error caught by boundary:"</span>, error);

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fallbackUI) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fallbackUI(error);
        }

        <span class="hljs-keyword">throw</span> error;
      }
    };
  }

  wrapAsync(fn) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> (...args) =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>.hasError = <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">this</span>.error = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> fn(...args);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">this</span>.hasError = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.error = error;
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Async error caught by boundary:"</span>, error);

        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.fallbackUI) {
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.fallbackUI(error);
        }

        <span class="hljs-keyword">throw</span> error;
      }
    };
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> errorBoundary = <span class="hljs-keyword">new</span> ErrorBoundary(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">error</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Something went wrong"</span> };
});

<span class="hljs-keyword">const</span> safeFunction = errorBoundary.wrap(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-comment">// This function is now protected</span>
  <span class="hljs-keyword">return</span> riskyOperation(data);
});

<span class="hljs-keyword">const</span> safeAsyncFunction = errorBoundary.wrapAsync(<span class="hljs-keyword">async</span> (url) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url);
  <span class="hljs-keyword">return</span> response.json();
});
</div></code></pre>
<h3 id="logging-and-monitoring">Logging and Monitoring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Advanced logging system</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Logger</span> </span>{
  <span class="hljs-keyword">constructor</span>(level = "info") {
    <span class="hljs-keyword">this</span>.level = level;
    <span class="hljs-keyword">this</span>.levels = {
      <span class="hljs-attr">error</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">warn</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">info</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">debug</span>: <span class="hljs-number">3</span>,
    };
  }

  log(level, message, data = {}) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.levels[level] &lt;= <span class="hljs-keyword">this</span>.levels[<span class="hljs-keyword">this</span>.level]) {
      <span class="hljs-keyword">const</span> timestamp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString();
      <span class="hljs-keyword">const</span> logEntry = {
        timestamp,
        <span class="hljs-attr">level</span>: level.toUpperCase(),
        message,
        data,
        <span class="hljs-attr">stack</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>().stack,
      };

      <span class="hljs-comment">// In production, send to logging service</span>
      <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"production"</span>) {
        <span class="hljs-keyword">this</span>.sendToLoggingService(logEntry);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>[level](logEntry);
      }
    }
  }

  error(message, data) {
    <span class="hljs-keyword">this</span>.log(<span class="hljs-string">"error"</span>, message, data);
  }

  warn(message, data) {
    <span class="hljs-keyword">this</span>.log(<span class="hljs-string">"warn"</span>, message, data);
  }

  info(message, data) {
    <span class="hljs-keyword">this</span>.log(<span class="hljs-string">"info"</span>, message, data);
  }

  debug(message, data) {
    <span class="hljs-keyword">this</span>.log(<span class="hljs-string">"debug"</span>, message, data);
  }

  sendToLoggingService(logEntry) {
    <span class="hljs-comment">// Send to external logging service</span>
    <span class="hljs-comment">// fetch('/api/logs', {</span>
    <span class="hljs-comment">//     method: 'POST',</span>
    <span class="hljs-comment">//     headers: { 'Content-Type': 'application/json' },</span>
    <span class="hljs-comment">//     body: JSON.stringify(logEntry)</span>
    <span class="hljs-comment">// });</span>
  }
}

<span class="hljs-keyword">const</span> logger = <span class="hljs-keyword">new</span> Logger(<span class="hljs-string">"debug"</span>);

<span class="hljs-comment">// Usage throughout application</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUser</span>(<span class="hljs-params">user</span>) </span>{
  logger.info(<span class="hljs-string">"Processing user"</span>, { <span class="hljs-attr">userId</span>: user.id });

  <span class="hljs-keyword">try</span> {
    validateUser(user);
    logger.debug(<span class="hljs-string">"User validation passed"</span>, { <span class="hljs-attr">userId</span>: user.id });

    <span class="hljs-keyword">const</span> result = performComplexOperation(user);
    logger.info(<span class="hljs-string">"User processing completed"</span>, {
      <span class="hljs-attr">userId</span>: user.id,
      <span class="hljs-attr">result</span>: result.id,
    });

    <span class="hljs-keyword">return</span> result;
  } <span class="hljs-keyword">catch</span> (error) {
    logger.error(<span class="hljs-string">"User processing failed"</span>, {
      <span class="hljs-attr">userId</span>: user.id,
      <span class="hljs-attr">error</span>: error.message,
      <span class="hljs-attr">stack</span>: error.stack,
    });
    <span class="hljs-keyword">throw</span> error;
  }
}
</div></code></pre>
<h2 id="%F0%9F%94%A7-error-handling-patterns">🔧 Error Handling Patterns</h2>
<h3 id="result-pattern">Result Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Result pattern for explicit error handling</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Result</span> </span>{
  <span class="hljs-keyword">constructor</span>(success, value, error) {
    <span class="hljs-keyword">this</span>.success = success;
    <span class="hljs-keyword">this</span>.value = value;
    <span class="hljs-keyword">this</span>.error = error;
  }

  <span class="hljs-keyword">static</span> ok(value) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Result(<span class="hljs-literal">true</span>, value, <span class="hljs-literal">null</span>);
  }

  <span class="hljs-keyword">static</span> error(error) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Result(<span class="hljs-literal">false</span>, <span class="hljs-literal">null</span>, error);
  }

  isOk() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.success;
  }

  isError() {
    <span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.success;
  }

  map(fn) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isOk()) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> Result.ok(fn(<span class="hljs-keyword">this</span>.value));
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">return</span> Result.error(error);
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }

  flatMap(fn) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isOk()) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> fn(<span class="hljs-keyword">this</span>.value);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">return</span> Result.error(error);
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }

  getOrElse(defaultValue) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isOk() ? <span class="hljs-keyword">this</span>.value : defaultValue;
  }
}

<span class="hljs-comment">// Using Result pattern</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeParseJSON</span>(<span class="hljs-params">jsonString</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> parsed = <span class="hljs-built_in">JSON</span>.parse(jsonString);
    <span class="hljs-keyword">return</span> Result.ok(parsed);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">return</span> Result.error(error);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUserData</span>(<span class="hljs-params">jsonString</span>) </span>{
  <span class="hljs-keyword">return</span> safeParseJSON(jsonString)
    .map(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> data.user)
    .map(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> ({ ...user, <span class="hljs-attr">processed</span>: <span class="hljs-literal">true</span> }))
    .flatMap(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!user.email) {
        <span class="hljs-keyword">return</span> Result.error(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Email is required"</span>));
      }
      <span class="hljs-keyword">return</span> Result.ok(user);
    });
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> result = processUserData(
  <span class="hljs-string">'{"user": {"name": "Alice", "email": "alice@example.com"}}'</span>
);

<span class="hljs-keyword">if</span> (result.isOk()) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Processed user:"</span>, result.value);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Processing failed:"</span>, result.error.message);
}
</div></code></pre>
<h3 id="circuit-breaker-pattern">Circuit Breaker Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Circuit breaker for handling repeated failures</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CircuitBreaker</span> </span>{
  <span class="hljs-keyword">constructor</span>(threshold = 5, timeout = 60000) {
    <span class="hljs-keyword">this</span>.threshold = threshold;
    <span class="hljs-keyword">this</span>.timeout = timeout;
    <span class="hljs-keyword">this</span>.failureCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.lastFailureTime = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.state = <span class="hljs-string">"CLOSED"</span>; <span class="hljs-comment">// CLOSED, OPEN, HALF_OPEN</span>
  }

  <span class="hljs-keyword">async</span> call(fn, ...args) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.state === <span class="hljs-string">"OPEN"</span>) {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Date</span>.now() - <span class="hljs-keyword">this</span>.lastFailureTime &gt; <span class="hljs-keyword">this</span>.timeout) {
        <span class="hljs-keyword">this</span>.state = <span class="hljs-string">"HALF_OPEN"</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Circuit breaker is OPEN"</span>);
      }
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> fn(...args);
      <span class="hljs-keyword">this</span>.onSuccess();
      <span class="hljs-keyword">return</span> result;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">this</span>.onFailure();
      <span class="hljs-keyword">throw</span> error;
    }
  }

  onSuccess() {
    <span class="hljs-keyword">this</span>.failureCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.state = <span class="hljs-string">"CLOSED"</span>;
  }

  onFailure() {
    <span class="hljs-keyword">this</span>.failureCount++;
    <span class="hljs-keyword">this</span>.lastFailureTime = <span class="hljs-built_in">Date</span>.now();

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.failureCount &gt;= <span class="hljs-keyword">this</span>.threshold) {
      <span class="hljs-keyword">this</span>.state = <span class="hljs-string">"OPEN"</span>;
    }
  }

  getState() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.state;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> apiCircuitBreaker = <span class="hljs-keyword">new</span> CircuitBreaker(<span class="hljs-number">3</span>, <span class="hljs-number">30000</span>); <span class="hljs-comment">// 3 failures, 30s timeout</span>

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">callAPI</span>(<span class="hljs-params">endpoint</span>) </span>{
  <span class="hljs-keyword">return</span> apiCircuitBreaker.call(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(endpoint);
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`API call failed: <span class="hljs-subst">${response.status}</span>`</span>);
    }
    <span class="hljs-keyword">return</span> response.json();
  });
}

<span class="hljs-comment">// The circuit breaker will prevent calls after 3 failures</span>
<span class="hljs-comment">// and allow them again after 30 seconds</span>
</div></code></pre>
<h3 id="retry-pattern">Retry Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Retry pattern with exponential backoff</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RetryHandler</span> </span>{
  <span class="hljs-keyword">constructor</span>(maxRetries = 3, baseDelay = 1000, maxDelay = 10000) {
    <span class="hljs-keyword">this</span>.maxRetries = maxRetries;
    <span class="hljs-keyword">this</span>.baseDelay = baseDelay;
    <span class="hljs-keyword">this</span>.maxDelay = maxDelay;
  }

  <span class="hljs-keyword">async</span> retry(fn, ...args) {
    <span class="hljs-keyword">let</span> lastError;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> attempt = <span class="hljs-number">1</span>; attempt &lt;= <span class="hljs-keyword">this</span>.maxRetries; attempt++) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> fn(...args);
      } <span class="hljs-keyword">catch</span> (error) {
        lastError = error;

        <span class="hljs-keyword">if</span> (attempt === <span class="hljs-keyword">this</span>.maxRetries) {
          <span class="hljs-keyword">break</span>;
        }

        <span class="hljs-comment">// Don't retry on certain errors</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.shouldNotRetry(error)) {
          <span class="hljs-keyword">break</span>;
        }

        <span class="hljs-keyword">const</span> delay = <span class="hljs-keyword">this</span>.calculateDelay(attempt);
        <span class="hljs-built_in">console</span>.warn(
          <span class="hljs-string">`Attempt <span class="hljs-subst">${attempt}</span> failed, retrying in <span class="hljs-subst">${delay}</span>ms:`</span>,
          error.message
        );

        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.sleep(delay);
      }
    }

    <span class="hljs-keyword">throw</span> lastError;
  }

  shouldNotRetry(error) {
    <span class="hljs-comment">// Don't retry on client errors (4xx)</span>
    <span class="hljs-keyword">if</span> (
      error <span class="hljs-keyword">instanceof</span> NetworkError &amp;&amp;
      error.statusCode &gt;= <span class="hljs-number">400</span> &amp;&amp;
      error.statusCode &lt; <span class="hljs-number">500</span>
    ) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-comment">// Don't retry on validation errors</span>
    <span class="hljs-keyword">if</span> (error <span class="hljs-keyword">instanceof</span> ValidationError) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  calculateDelay(attempt) {
    <span class="hljs-comment">// Exponential backoff with jitter</span>
    <span class="hljs-keyword">const</span> exponentialDelay = <span class="hljs-keyword">this</span>.baseDelay * <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, attempt - <span class="hljs-number">1</span>);
    <span class="hljs-keyword">const</span> jitter = <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">0.1</span> * exponentialDelay;
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.min(exponentialDelay + jitter, <span class="hljs-keyword">this</span>.maxDelay);
  }

  sleep(ms) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, ms));
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> retryHandler = <span class="hljs-keyword">new</span> RetryHandler(<span class="hljs-number">3</span>, <span class="hljs-number">1000</span>, <span class="hljs-number">10000</span>);

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">reliableAPICall</span>(<span class="hljs-params">endpoint</span>) </span>{
  <span class="hljs-keyword">return</span> retryHandler.retry(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(endpoint);

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> NetworkError(
        <span class="hljs-string">`API call failed: <span class="hljs-subst">${response.statusText}</span>`</span>,
        response.status
      );
    }

    <span class="hljs-keyword">return</span> response.json();
  });
}
</div></code></pre>
<h2 id="%F0%9F%94%8D-performance-debugging">🔍 Performance Debugging</h2>
<h3 id="memory-leak-detection">Memory Leak Detection</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Memory leak detection utilities</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryMonitor</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.snapshots = [];
    <span class="hljs-keyword">this</span>.listeners = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();
  }

  takeSnapshot(label) {
    <span class="hljs-keyword">if</span> (performance.memory) {
      <span class="hljs-keyword">const</span> snapshot = {
        label,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
        <span class="hljs-attr">usedJSHeapSize</span>: performance.memory.usedJSHeapSize,
        <span class="hljs-attr">totalJSHeapSize</span>: performance.memory.totalJSHeapSize,
        <span class="hljs-attr">jsHeapSizeLimit</span>: performance.memory.jsHeapSizeLimit,
      };

      <span class="hljs-keyword">this</span>.snapshots.push(snapshot);
      <span class="hljs-keyword">return</span> snapshot;
    }

    <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"performance.memory not available"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  compareSnapshots(label1, label2) {
    <span class="hljs-keyword">const</span> snap1 = <span class="hljs-keyword">this</span>.snapshots.find(<span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> s.label === label1);
    <span class="hljs-keyword">const</span> snap2 = <span class="hljs-keyword">this</span>.snapshots.find(<span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> s.label === label2);

    <span class="hljs-keyword">if</span> (!snap1 || !snap2) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Snapshots not found"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">const</span> diff = {
      <span class="hljs-attr">timeDiff</span>: snap2.timestamp - snap1.timestamp,
      <span class="hljs-attr">memoryDiff</span>: snap2.usedJSHeapSize - snap1.usedJSHeapSize,
      <span class="hljs-attr">percentageIncrease</span>:
        ((snap2.usedJSHeapSize - snap1.usedJSHeapSize) / snap1.usedJSHeapSize) *
        <span class="hljs-number">100</span>,
    };

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Memory change from <span class="hljs-subst">${label1}</span> to <span class="hljs-subst">${label2}</span>:`</span>, diff);
    <span class="hljs-keyword">return</span> diff;
  }

  startMonitoring(interval = <span class="hljs-number">5000</span>) {
    <span class="hljs-keyword">this</span>.monitoringInterval = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">this</span>.takeSnapshot(<span class="hljs-string">`auto-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>);

      <span class="hljs-comment">// Alert if memory usage is growing rapidly</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.snapshots.length &gt;= <span class="hljs-number">2</span>) {
        <span class="hljs-keyword">const</span> recent = <span class="hljs-keyword">this</span>.snapshots.slice(<span class="hljs-number">-2</span>);
        <span class="hljs-keyword">const</span> growth = recent[<span class="hljs-number">1</span>].usedJSHeapSize - recent[<span class="hljs-number">0</span>].usedJSHeapSize;

        <span class="hljs-keyword">if</span> (growth &gt; <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) {
          <span class="hljs-comment">// 10MB growth</span>
          <span class="hljs-built_in">console</span>.warn(
            <span class="hljs-string">"Rapid memory growth detected:"</span>,
            growth / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>,
            <span class="hljs-string">"MB"</span>
          );
        }
      }
    }, interval);
  }

  stopMonitoring() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.monitoringInterval) {
      clearInterval(<span class="hljs-keyword">this</span>.monitoringInterval);
    }
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> memoryMonitor = <span class="hljs-keyword">new</span> MemoryMonitor();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">potentiallyLeakyFunction</span>(<span class="hljs-params"></span>) </span>{
  memoryMonitor.takeSnapshot(<span class="hljs-string">"before-operation"</span>);

  <span class="hljs-comment">// Simulate memory-intensive operation</span>
  <span class="hljs-keyword">const</span> largeArray = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>).fill(<span class="hljs-string">"data"</span>);

  <span class="hljs-comment">// Potential leak: not cleaning up event listeners</span>
  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  element.addEventListener(<span class="hljs-string">"click"</span>, () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Clicked"</span>);
  });

  memoryMonitor.takeSnapshot(<span class="hljs-string">"after-operation"</span>);
  memoryMonitor.compareSnapshots(<span class="hljs-string">"before-operation"</span>, <span class="hljs-string">"after-operation"</span>);

  <span class="hljs-comment">// Clean up to prevent leaks</span>
  element.removeEventListener(<span class="hljs-string">"click"</span>, () =&gt; {});
}
</div></code></pre>
<h3 id="performance-profiling">Performance Profiling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Performance profiling utilities</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Profiler</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.marks = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.measures = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  mark(name) {
    <span class="hljs-keyword">const</span> timestamp = performance.now();
    <span class="hljs-keyword">this</span>.marks.set(name, timestamp);

    <span class="hljs-keyword">if</span> (performance.mark) {
      performance.mark(name);
    }
  }

  measure(name, startMark, endMark) {
    <span class="hljs-keyword">const</span> startTime = <span class="hljs-keyword">this</span>.marks.get(startMark);
    <span class="hljs-keyword">const</span> endTime = <span class="hljs-keyword">this</span>.marks.get(endMark);

    <span class="hljs-keyword">if</span> (startTime &amp;&amp; endTime) {
      <span class="hljs-keyword">const</span> duration = endTime - startTime;
      <span class="hljs-keyword">this</span>.measures.set(name, duration);

      <span class="hljs-keyword">if</span> (performance.measure) {
        performance.measure(name, startMark, endMark);
      }

      <span class="hljs-keyword">return</span> duration;
    }

    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Start or end mark not found"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  time(label, fn) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> (...args) =&gt; {
      <span class="hljs-keyword">this</span>.mark(<span class="hljs-string">`<span class="hljs-subst">${label}</span>-start`</span>);

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> fn(...args);
        <span class="hljs-keyword">this</span>.mark(<span class="hljs-string">`<span class="hljs-subst">${label}</span>-end`</span>);
        <span class="hljs-keyword">const</span> duration = <span class="hljs-keyword">this</span>.measure(label, <span class="hljs-string">`<span class="hljs-subst">${label}</span>-start`</span>, <span class="hljs-string">`<span class="hljs-subst">${label}</span>-end`</span>);

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${label}</span> took <span class="hljs-subst">${duration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
        <span class="hljs-keyword">return</span> result;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">this</span>.mark(<span class="hljs-string">`<span class="hljs-subst">${label}</span>-end`</span>);
        <span class="hljs-keyword">this</span>.measure(label, <span class="hljs-string">`<span class="hljs-subst">${label}</span>-start`</span>, <span class="hljs-string">`<span class="hljs-subst">${label}</span>-end`</span>);
        <span class="hljs-keyword">throw</span> error;
      }
    };
  }

  getReport() {
    <span class="hljs-keyword">const</span> report = {
      <span class="hljs-attr">marks</span>: <span class="hljs-built_in">Object</span>.fromEntries(<span class="hljs-keyword">this</span>.marks),
      <span class="hljs-attr">measures</span>: <span class="hljs-built_in">Object</span>.fromEntries(<span class="hljs-keyword">this</span>.measures),
    };

    <span class="hljs-built_in">console</span>.table(report.measures);
    <span class="hljs-keyword">return</span> report;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> profiler = <span class="hljs-keyword">new</span> Profiler();

<span class="hljs-keyword">const</span> timedFunction = profiler.time(<span class="hljs-string">"data-processing"</span>, <span class="hljs-keyword">async</span> (data) =&gt; {
  <span class="hljs-comment">// Simulate processing</span>
  <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, <span class="hljs-number">100</span>));
  <span class="hljs-keyword">return</span> data.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item * <span class="hljs-number">2</span>);
});

<span class="hljs-comment">// Function will automatically be timed</span>
timedFunction([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]).then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Result:"</span>, result);
  profiler.getReport();
});
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-swallowing-errors">1. Swallowing Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Swallowing errors (hiding problems)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">badErrorHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    riskyOperation();
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Silent failure - very bad!</span>
    <span class="hljs-comment">// Error is lost, making debugging impossible</span>
  }
}

<span class="hljs-comment">// ❌ Generic error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">genericErrorHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    riskyOperation();
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Something went wrong"</span>); <span class="hljs-comment">// Not helpful!</span>
  }
}

<span class="hljs-comment">// ✅ Proper error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goodErrorHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    riskyOperation();
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Log the actual error</span>
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Risk operation failed:"</span>, error);

    <span class="hljs-comment">// Provide context</span>
    logger.error(<span class="hljs-string">"Risk operation failed"</span>, {
      <span class="hljs-attr">operation</span>: <span class="hljs-string">"riskyOperation"</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      <span class="hljs-attr">stack</span>: error.stack,
    });

    <span class="hljs-comment">// Re-throw if caller should handle it</span>
    <span class="hljs-keyword">throw</span> error;
  }
}
</div></code></pre>
<h3 id="2-not-handling-async-errors">2. Not Handling Async Errors</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Unhandled promise rejections</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">unhandledPromiseRejection</span>(<span class="hljs-params"></span>) </span>{
  fetch(<span class="hljs-string">"/api/data"</span>); <span class="hljs-comment">// No .catch() - unhandled rejection!</span>

  <span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Oops"</span>);
  }); <span class="hljs-comment">// No .catch() - unhandled rejection!</span>
}

<span class="hljs-comment">// ✅ Proper async error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">properAsyncErrorHandling</span>(<span class="hljs-params"></span>) </span>{
  fetch(<span class="hljs-string">"/api/data"</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json())
    .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(data))
    .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Fetch failed:"</span>, error));

  <span class="hljs-built_in">Promise</span>.resolve()
    .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Oops"</span>);
    })
    .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Promise failed:"</span>, error));
}

<span class="hljs-comment">// ✅ With async/await</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">asyncErrorHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>);
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
    <span class="hljs-built_in">console</span>.log(data);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Async operation failed:"</span>, error);
  }
}

<span class="hljs-comment">// Global unhandled rejection handler</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unhandledrejection"</span>, (event) =&gt; {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Unhandled promise rejection:"</span>, event.reason);

  <span class="hljs-comment">// Log to monitoring service</span>
  logger.error(<span class="hljs-string">"Unhandled promise rejection"</span>, {
    <span class="hljs-attr">reason</span>: event.reason,
    <span class="hljs-attr">stack</span>: event.reason?.stack,
  });

  <span class="hljs-comment">// Prevent default browser behavior</span>
  event.preventDefault();
});
</div></code></pre>
<h3 id="3-improper-error-propagation">3. Improper Error Propagation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Converting errors to different types unnecessarily</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">badErrorPropagation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> result = validateUser(user);
    <span class="hljs-keyword">return</span> result;
  } <span class="hljs-keyword">catch</span> (validationError) {
    <span class="hljs-comment">// Don't do this - loses original error information</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"User validation failed"</span>);
  }
}

<span class="hljs-comment">// ✅ Proper error propagation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goodErrorPropagation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> result = validateUser(user);
    <span class="hljs-keyword">return</span> result;
  } <span class="hljs-keyword">catch</span> (validationError) {
    <span class="hljs-comment">// Add context but preserve original error</span>
    validationError.context = { <span class="hljs-attr">userId</span>: user.id, <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now() };
    <span class="hljs-keyword">throw</span> validationError;
  }
}

<span class="hljs-comment">// ✅ Wrapping with additional context</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">errorWrapping</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> result = validateUser(user);
    <span class="hljs-keyword">return</span> result;
  } <span class="hljs-keyword">catch</span> (originalError) {
    <span class="hljs-keyword">const</span> wrappedError = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">`User validation failed for user <span class="hljs-subst">${user.id}</span>`</span>
    );
    wrappedError.originalError = originalError;
    wrappedError.userId = user.id;
    <span class="hljs-keyword">throw</span> wrappedError;
  }
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-error-safe-json-parser">Problem 1: Error-Safe JSON Parser</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a safe JSON parser that handles various error cases</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeJSONParse</span>(<span class="hljs-params">jsonString, defaultValue = null</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Should handle:</span>
  <span class="hljs-comment">// - Invalid JSON syntax</span>
  <span class="hljs-comment">// - null/undefined input</span>
  <span class="hljs-comment">// - Non-string input</span>
  <span class="hljs-comment">// - Return defaultValue on any error</span>
  <span class="hljs-comment">// - Log errors appropriately</span>
}

<span class="hljs-comment">// Test cases:</span>
<span class="hljs-built_in">console</span>.log(safeJSONParse(<span class="hljs-string">'{"name": "Alice"}'</span>)); <span class="hljs-comment">// { name: "Alice" }</span>
<span class="hljs-built_in">console</span>.log(safeJSONParse(<span class="hljs-string">"invalid json"</span>)); <span class="hljs-comment">// null</span>
<span class="hljs-built_in">console</span>.log(safeJSONParse(<span class="hljs-literal">null</span>)); <span class="hljs-comment">// null</span>
<span class="hljs-built_in">console</span>.log(safeJSONParse(<span class="hljs-literal">undefined</span>, {})); <span class="hljs-comment">// {}</span>
<span class="hljs-built_in">console</span>.log(safeJSONParse(<span class="hljs-number">123</span>)); <span class="hljs-comment">// null</span>
</div></code></pre>
<h3 id="problem-2-async-operation-with-timeout">Problem 2: Async Operation with Timeout</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that adds timeout to any async operation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withTimeout</span>(<span class="hljs-params">asyncFn, timeoutMs</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Should return a function that:</span>
  <span class="hljs-comment">// - Calls the original async function</span>
  <span class="hljs-comment">// - Rejects with timeout error if operation takes too long</span>
  <span class="hljs-comment">// - Properly cleans up resources</span>
}

<span class="hljs-comment">// Test:</span>
<span class="hljs-keyword">const</span> slowOperation = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
  <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(<span class="hljs-string">"Done"</span>), <span class="hljs-number">5000</span>));

<span class="hljs-keyword">const</span> fastOperation = withTimeout(slowOperation, <span class="hljs-number">2000</span>);

fastOperation()
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Result:"</span>, result))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error.message)); <span class="hljs-comment">// Should timeout</span>
</div></code></pre>
<h3 id="problem-3-error-aggregator">Problem 3: Error Aggregator</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a utility that collects multiple errors and reports them together</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorAggregator</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation here</span>
  }

  add(error, context = {}) {
    <span class="hljs-comment">// Add an error with optional context</span>
  }

  hasErrors() {
    <span class="hljs-comment">// Return true if any errors were added</span>
  }

  getErrors() {
    <span class="hljs-comment">// Return array of all errors with context</span>
  }

  throwIfAny() {
    <span class="hljs-comment">// Throw aggregated error if any errors exist</span>
  }

  clear() {
    <span class="hljs-comment">// Clear all errors</span>
  }
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">new</span> ErrorAggregator();

<span class="hljs-comment">// Collect multiple validation errors</span>
<span class="hljs-keyword">if</span> (!user.name) errors.add(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Name required"</span>), { <span class="hljs-attr">field</span>: <span class="hljs-string">"name"</span> });
<span class="hljs-keyword">if</span> (!user.email) errors.add(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Email required"</span>), { <span class="hljs-attr">field</span>: <span class="hljs-string">"email"</span> });
<span class="hljs-keyword">if</span> (user.age &lt; <span class="hljs-number">0</span>) errors.add(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid age"</span>), { <span class="hljs-attr">field</span>: <span class="hljs-string">"age"</span> });

<span class="hljs-keyword">if</span> (errors.hasErrors()) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Validation errors:"</span>, errors.getErrors());
  errors.throwIfAny(); <span class="hljs-comment">// Throw combined error</span>
}
</div></code></pre>
<h3 id="problem-4-retry-with-circuit-breaker">Problem 4: Retry with Circuit Breaker</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Combine retry logic with circuit breaker pattern</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResilientCaller</span> </span>{
  <span class="hljs-keyword">constructor</span>(maxRetries = 3, circuitThreshold = 5, circuitTimeout = 30000) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should combine RetryHandler and CircuitBreaker functionality</span>
  }

  <span class="hljs-keyword">async</span> call(fn, ...args) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should:</span>
    <span class="hljs-comment">// - Check circuit breaker state</span>
    <span class="hljs-comment">// - Retry on failures (with exponential backoff)</span>
    <span class="hljs-comment">// - Update circuit breaker on success/failure</span>
    <span class="hljs-comment">// - Respect circuit breaker open state</span>
  }

  getStats() {
    <span class="hljs-comment">// Return statistics about calls, failures, circuit state</span>
  }
}

<span class="hljs-comment">// Test:</span>
<span class="hljs-keyword">const</span> resilientCaller = <span class="hljs-keyword">new</span> ResilientCaller(<span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">10000</span>);

<span class="hljs-keyword">const</span> unreliableAPI = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.random() &lt; <span class="hljs-number">0.7</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"API temporarily unavailable"</span>);
  }
  <span class="hljs-keyword">return</span> <span class="hljs-string">"Success"</span>;
};

<span class="hljs-comment">// Should retry failures and eventually open circuit</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
  resilientCaller
    .call(unreliableAPI)
    .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Call <span class="hljs-subst">${i}</span>:`</span>, result))
    .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Call <span class="hljs-subst">${i}</span>:`</span>, error.message));
}
</div></code></pre>
<h3 id="problem-5-error-reporting-service">Problem 5: Error Reporting Service</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create an error reporting service that batches and sends errors</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorReporter</span> </span>{
  <span class="hljs-keyword">constructor</span>(options = {}) {
    <span class="hljs-keyword">this</span>.endpoint = options.endpoint || <span class="hljs-string">"/api/errors"</span>;
    <span class="hljs-keyword">this</span>.batchSize = options.batchSize || <span class="hljs-number">10</span>;
    <span class="hljs-keyword">this</span>.flushInterval = options.flushInterval || <span class="hljs-number">30000</span>;
    <span class="hljs-comment">// Your implementation here</span>
  }

  report(error, context = {}) {
    <span class="hljs-comment">// Add error to batch queue</span>
    <span class="hljs-comment">// Auto-flush if batch is full</span>
  }

  flush() {
    <span class="hljs-comment">// Send all queued errors to server</span>
    <span class="hljs-comment">// Return promise that resolves when sent</span>
  }

  startAutoFlush() {
    <span class="hljs-comment">// Start automatic flushing on interval</span>
  }

  stopAutoFlush() {
    <span class="hljs-comment">// Stop automatic flushing</span>
  }
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> errorReporter = <span class="hljs-keyword">new</span> ErrorReporter({
  <span class="hljs-attr">endpoint</span>: <span class="hljs-string">"/api/errors"</span>,
  <span class="hljs-attr">batchSize</span>: <span class="hljs-number">5</span>,
  <span class="hljs-attr">flushInterval</span>: <span class="hljs-number">10000</span>,
});

errorReporter.startAutoFlush();

<span class="hljs-comment">// Report errors throughout the application</span>
<span class="hljs-keyword">try</span> {
  riskyOperation();
} <span class="hljs-keyword">catch</span> (error) {
  errorReporter.report(error, {
    <span class="hljs-attr">userId</span>: currentUser.id,
    <span class="hljs-attr">page</span>: <span class="hljs-built_in">window</span>.location.pathname,
    <span class="hljs-attr">userAgent</span>: navigator.userAgent,
  });
}
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What are the different types of errors in JavaScript?</strong></p>
<ul>
<li>Syntax errors: Invalid code structure, caught at parse time</li>
<li>Reference errors: Using undefined variables or functions</li>
<li>Type errors: Wrong type operations (calling non-function, accessing null properties)</li>
<li>Range errors: Values outside valid range (array length, recursion depth)</li>
<li>Custom errors: Application-specific error types</li>
</ul>
<p><strong>Q: What's the difference between throw and return in error handling?</strong></p>
<ul>
<li><code>throw</code>: Stops execution, propagates up the call stack until caught</li>
<li><code>return</code>: Normal function exit, doesn't indicate error to caller</li>
<li>Use <code>throw</code> for exceptional conditions, <code>return</code> for normal flow</li>
</ul>
<p><strong>Q: How do you handle errors in async/await vs Promises?</strong></p>
<ul>
<li>Async/await: Use try-catch blocks</li>
<li>Promises: Use .catch() method</li>
<li>Both can be combined: async functions return promises</li>
</ul>
<p><strong>Q: What are unhandled promise rejections and how do you prevent them?</strong></p>
<ul>
<li>Promises that reject without .catch() handler</li>
<li>Can crash Node.js applications</li>
<li>Prevent with global handlers and proper error handling</li>
</ul>
<p><strong>Q: What's the purpose of the finally block?</strong></p>
<ul>
<li>Always executes regardless of try/catch outcome</li>
<li>Used for cleanup (closing files, releasing resources)</li>
<li>Executes even if return statement in try/catch</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Design an error handling system for a large-scale application&quot;</li>
<li><strong>Facebook</strong>: &quot;Implement a circuit breaker pattern from scratch&quot;</li>
<li><strong>Amazon</strong>: &quot;How would you debug a memory leak in a JavaScript application?&quot;</li>
<li><strong>Microsoft</strong>: &quot;Create a logging system that handles different error severities&quot;</li>
<li><strong>Netflix</strong>: &quot;Design error boundaries for a component-based architecture&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Handle errors explicitly</strong> - don't let them fail silently</li>
<li><strong>Use appropriate error types</strong> - built-in and custom error classes</li>
<li><strong>Provide meaningful error messages</strong> - include context and actionable information</li>
<li><strong>Log errors properly</strong> - with sufficient detail for debugging</li>
<li><strong>Handle async errors</strong> - use try-catch with async/await or .catch() with promises</li>
<li><strong>Implement error boundaries</strong> - prevent single failures from crashing entire application</li>
<li><strong>Use debugging tools effectively</strong> - console methods, debugger, performance profiling</li>
<li><strong>Plan for failure</strong> - circuit breakers, retries, fallbacks</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./10-async-javascript.md">← Asynchronous JavaScript</a><br>
<strong>Next Chapter</strong>: <a href="./12-es6-features.md">ES6+ Features →</a></p>
<p><strong>Practice</strong>: Try the error handling problems and experiment with different debugging techniques!</p>
<h1 id="%F0%9F%93%9A-chapter-12-es6-features">📚 Chapter 12: ES6+ Features</h1>
<blockquote>
<p>Master modern JavaScript syntax and features that make code more elegant and powerful.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>ES6+ features are like upgrading from an old car to a modern one:</p>
<ul>
<li><strong>Arrow functions</strong> = automatic transmission (simpler, more intuitive)</li>
<li><strong>Template literals</strong> = GPS navigation (easier string formatting)</li>
<li><strong>Destructuring</strong> = organized toolbox (extract what you need easily)</li>
<li><strong>Modules</strong> = standardized parts (import/export functionality)</li>
<li><strong>Classes</strong> = blueprint system (cleaner object-oriented programming)</li>
<li><strong>Promises</strong> = delivery tracking (better async handling)</li>
</ul>
<p>These features make JavaScript more readable, maintainable, and powerful while reducing common programming errors.</p>
<h2 id="%F0%9F%8F%B9-arrow-functions">🏹 Arrow Functions</h2>
<h3 id="basic-syntax">Basic Syntax</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Traditional function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traditionalAdd</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// Arrow function - basic</span>
<span class="hljs-keyword">const</span> arrowAdd = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> a + b;
};

<span class="hljs-comment">// Arrow function - concise (implicit return)</span>
<span class="hljs-keyword">const</span> conciseAdd = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a + b;

<span class="hljs-comment">// Single parameter (parentheses optional)</span>
<span class="hljs-keyword">const</span> square = <span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x * x;
<span class="hljs-keyword">const</span> squareExplicit = <span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x * x;

<span class="hljs-comment">// No parameters</span>
<span class="hljs-keyword">const</span> greet = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">"Hello World!"</span>;
<span class="hljs-keyword">const</span> getCurrentTime = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();

<span class="hljs-comment">// Multiple statements</span>
<span class="hljs-keyword">const</span> processUser = <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Processing <span class="hljs-subst">${user.name}</span>`</span>);
  <span class="hljs-keyword">const</span> processed = { ...user, <span class="hljs-attr">processed</span>: <span class="hljs-literal">true</span> };
  <span class="hljs-keyword">return</span> processed;
};

<span class="hljs-comment">// Returning object literals (wrap in parentheses)</span>
<span class="hljs-keyword">const</span> createUser = <span class="hljs-function">(<span class="hljs-params">name, age</span>) =&gt;</span> ({ name, age, <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now() });

<span class="hljs-comment">// Array methods with arrow functions</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> doubled = numbers.map(<span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n * <span class="hljs-number">2</span>);
<span class="hljs-keyword">const</span> evens = numbers.filter(<span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> sum = numbers.reduce(<span class="hljs-function">(<span class="hljs-params">acc, n</span>) =&gt;</span> acc + n, <span class="hljs-number">0</span>);
</div></code></pre>
<h3 id="lexical-this-binding">Lexical <code>this</code> Binding</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Traditional function - `this` depends on how it's called</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TraditionalTimer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.seconds = <span class="hljs-number">0</span>;

  setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">this</span>.seconds++; <span class="hljs-comment">// `this` refers to global object, not TraditionalTimer</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.seconds); <span class="hljs-comment">// NaN or undefined</span>
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">// Solution with traditional function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TraditionalTimerFixed</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.seconds = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> self = <span class="hljs-keyword">this</span>; <span class="hljs-comment">// Capture reference</span>

  setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    self.seconds++; <span class="hljs-comment">// Use captured reference</span>
    <span class="hljs-built_in">console</span>.log(self.seconds);
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">// Arrow function - `this` is lexically bound</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ArrowTimer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">this</span>.seconds = <span class="hljs-number">0</span>;

  setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">this</span>.seconds++; <span class="hljs-comment">// `this` refers to ArrowTimer instance</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.seconds); <span class="hljs-comment">// Works correctly!</span>
  }, <span class="hljs-number">1000</span>);
}

<span class="hljs-comment">// Practical example: Event handlers</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Button</span> </span>{
  <span class="hljs-keyword">constructor</span>(element) {
    <span class="hljs-keyword">this</span>.element = element;
    <span class="hljs-keyword">this</span>.clickCount = <span class="hljs-number">0</span>;

    <span class="hljs-comment">// Arrow function preserves `this`</span>
    <span class="hljs-keyword">this</span>.element.addEventListener(<span class="hljs-string">"click"</span>, () =&gt; {
      <span class="hljs-keyword">this</span>.clickCount++;
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Clicked <span class="hljs-subst">${<span class="hljs-keyword">this</span>.clickCount}</span> times`</span>);
    });

    <span class="hljs-comment">// Traditional function would need .bind(this)</span>
    <span class="hljs-comment">// this.element.addEventListener('click', function() {</span>
    <span class="hljs-comment">//     this.clickCount++; // `this` would be the element, not Button</span>
    <span class="hljs-comment">// }.bind(this));</span>
  }
}

<span class="hljs-comment">// React component example</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TodoList</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = { <span class="hljs-attr">todos</span>: [] };
  }

  <span class="hljs-comment">// Arrow function method - automatically bound</span>
  addTodo = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    <span class="hljs-keyword">this</span>.setState({
      <span class="hljs-attr">todos</span>: [...this.state.todos, { <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(), text }],
    });
  };

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        {/* No need for .bind(this) */}
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> this.addTodo("New Todo")}&gt;Add Todo<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }
}
</div></code></pre>
<h3 id="when-not-to-use-arrow-functions">When NOT to Use Arrow Functions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Object methods (loses `this` context)</span>
<span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">greet</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>); <span class="hljs-comment">// `this` is not person</span>
  },
};

<span class="hljs-comment">// ✅ Use regular function for object methods</span>
<span class="hljs-keyword">const</span> personFixed = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  greet() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>); <span class="hljs-comment">// Works correctly</span>
  },
};

<span class="hljs-comment">// ❌ Constructor functions</span>
<span class="hljs-keyword">const</span> Person = <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
  <span class="hljs-keyword">this</span>.name = name; <span class="hljs-comment">// Error: arrow functions can't be constructors</span>
};

<span class="hljs-comment">// ✅ Use regular function or class</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PersonConstructor</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PersonClass</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
  }
}

<span class="hljs-comment">// ❌ When you need `arguments` object</span>
<span class="hljs-keyword">const</span> sumAll = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>); <span class="hljs-comment">// ReferenceError: arguments is not defined</span>
};

<span class="hljs-comment">// ✅ Use rest parameters instead</span>
<span class="hljs-keyword">const</span> sumAllFixed = <span class="hljs-function">(<span class="hljs-params">...numbers</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> numbers.reduce(<span class="hljs-function">(<span class="hljs-params">sum, num</span>) =&gt;</span> sum + num, <span class="hljs-number">0</span>);
};

<span class="hljs-comment">// ❌ Dynamic context methods</span>
<span class="hljs-keyword">const</span> calculator = {
  <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> (<span class="hljs-keyword">this</span>.value += n), <span class="hljs-comment">// `this` doesn't refer to calculator</span>
  <span class="hljs-attr">multiply</span>: <span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> (<span class="hljs-keyword">this</span>.value *= n),
};

<span class="hljs-comment">// ✅ Use regular methods</span>
<span class="hljs-keyword">const</span> calculatorFixed = {
  <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,
  add(n) {
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.value += n);
  },
  multiply(n) {
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">this</span>.value *= n);
  },
};
</div></code></pre>
<h2 id="%F0%9F%93%9D-template-literals">📝 Template Literals</h2>
<h3 id="basic-string-interpolation">Basic String Interpolation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Old way - string concatenation</span>
<span class="hljs-keyword">const</span> name = <span class="hljs-string">"Alice"</span>;
<span class="hljs-keyword">const</span> age = <span class="hljs-number">30</span>;
<span class="hljs-keyword">const</span> oldWay = <span class="hljs-string">"Hello, my name is "</span> + name + <span class="hljs-string">" and I am "</span> + age + <span class="hljs-string">" years old."</span>;

<span class="hljs-comment">// Template literals - much cleaner</span>
<span class="hljs-keyword">const</span> newWay = <span class="hljs-string">`Hello, my name is <span class="hljs-subst">${name}</span> and I am <span class="hljs-subst">${age}</span> years old.`</span>;

<span class="hljs-comment">// Expressions in template literals</span>
<span class="hljs-keyword">const</span> a = <span class="hljs-number">5</span>;
<span class="hljs-keyword">const</span> b = <span class="hljs-number">10</span>;
<span class="hljs-keyword">const</span> mathResult = <span class="hljs-string">`The sum of <span class="hljs-subst">${a}</span> and <span class="hljs-subst">${b}</span> is <span class="hljs-subst">${a + b}</span>.`</span>;

<span class="hljs-comment">// Function calls</span>
<span class="hljs-keyword">const</span> getCurrentTime = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString();
<span class="hljs-keyword">const</span> timeMessage = <span class="hljs-string">`Current time: <span class="hljs-subst">${getCurrentTime()}</span>`</span>;

<span class="hljs-comment">// Object properties</span>
<span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span> };
<span class="hljs-keyword">const</span> userInfo = <span class="hljs-string">`User: <span class="hljs-subst">${user.name}</span> (<span class="hljs-subst">${user.role.toUpperCase()}</span>)`</span>;

<span class="hljs-comment">// Conditional expressions</span>
<span class="hljs-keyword">const</span> score = <span class="hljs-number">85</span>;
<span class="hljs-keyword">const</span> result = <span class="hljs-string">`You <span class="hljs-subst">${
  score &gt;= <span class="hljs-number">60</span> ? <span class="hljs-string">"passed"</span> : <span class="hljs-string">"failed"</span>
}</span> the test with <span class="hljs-subst">${score}</span>%.`</span>;

<span class="hljs-comment">// Complex expressions</span>
<span class="hljs-keyword">const</span> items = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>];
<span class="hljs-keyword">const</span> itemList = <span class="hljs-string">`You have <span class="hljs-subst">${items.length}</span> items: <span class="hljs-subst">${items.join(<span class="hljs-string">", "</span>)}</span>.`</span>;
</div></code></pre>
<h3 id="multiline-strings">Multiline Strings</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Old way - concatenation or escaping</span>
<span class="hljs-keyword">const</span> oldMultiline = <span class="hljs-string">"This is line 1\n"</span> + <span class="hljs-string">"This is line 2\n"</span> + <span class="hljs-string">"This is line 3"</span>;

<span class="hljs-comment">// Template literals - natural multiline</span>
<span class="hljs-keyword">const</span> newMultiline = <span class="hljs-string">`This is line 1
This is line 2
This is line 3`</span>;

<span class="hljs-comment">// HTML templates</span>
<span class="hljs-keyword">const</span> htmlTemplate = <span class="hljs-string">`
    &lt;div class="user-card"&gt;
        &lt;h2&gt;<span class="hljs-subst">${user.name}</span>&lt;/h2&gt;
        &lt;p&gt;Email: <span class="hljs-subst">${user.email}</span>&lt;/p&gt;
        &lt;p&gt;Role: <span class="hljs-subst">${user.role}</span>&lt;/p&gt;
        &lt;button onclick="editUser(<span class="hljs-subst">${user.id}</span>)"&gt;
            Edit User
        &lt;/button&gt;
    &lt;/div&gt;
`</span>;

<span class="hljs-comment">// SQL queries</span>
<span class="hljs-keyword">const</span> sqlQuery = <span class="hljs-string">`
    SELECT users.name, users.email, profiles.bio
    FROM users
    JOIN profiles ON users.id = profiles.user_id
    WHERE users.active = true
    AND users.created_at &gt; '<span class="hljs-subst">${startDate}</span>'
    ORDER BY users.name
`</span>;

<span class="hljs-comment">// Configuration files</span>
<span class="hljs-keyword">const</span> configFile = <span class="hljs-string">`
    {
        "name": "<span class="hljs-subst">${projectName}</span>",
        "version": "<span class="hljs-subst">${version}</span>",
        "description": "<span class="hljs-subst">${description}</span>",
        "main": "<span class="hljs-subst">${entryPoint}</span>"
    }
`</span>;
</div></code></pre>
<h3 id="tagged-template-literals">Tagged Template Literals</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Custom template tag functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">highlight</span>(<span class="hljs-params">strings, ...values</span>) </span>{
  <span class="hljs-keyword">return</span> strings.reduce(<span class="hljs-function">(<span class="hljs-params">result, string, i</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> value = values[i] ? <span class="hljs-string">`&lt;mark&gt;<span class="hljs-subst">${values[i]}</span>&lt;/mark&gt;`</span> : <span class="hljs-string">""</span>;
    <span class="hljs-keyword">return</span> result + string + value;
  }, <span class="hljs-string">""</span>);
}

<span class="hljs-keyword">const</span> searchTerm = <span class="hljs-string">"JavaScript"</span>;
<span class="hljs-keyword">const</span> text = highlight<span class="hljs-string">`Learn <span class="hljs-subst">${searchTerm}</span> programming with ease!`</span>;
<span class="hljs-comment">// Result: "Learn &lt;mark&gt;JavaScript&lt;/mark&gt; programming with ease!"</span>

<span class="hljs-comment">// SQL template tag (prevents injection)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sql</span>(<span class="hljs-params">strings, ...values</span>) </span>{
  <span class="hljs-keyword">const</span> escapedValues = values.map(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`'<span class="hljs-subst">${value.replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"''"</span>)}</span>'`</span>; <span class="hljs-comment">// Escape single quotes</span>
    }
    <span class="hljs-keyword">return</span> value;
  });

  <span class="hljs-keyword">return</span> strings.reduce(<span class="hljs-function">(<span class="hljs-params">result, string, i</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> value = escapedValues[i] || <span class="hljs-string">""</span>;
    <span class="hljs-keyword">return</span> result + string + value;
  }, <span class="hljs-string">""</span>);
}

<span class="hljs-keyword">const</span> userId = <span class="hljs-number">123</span>;
<span class="hljs-keyword">const</span> userName = <span class="hljs-string">"O'Connor"</span>;
<span class="hljs-keyword">const</span> query = sql<span class="hljs-string">`SELECT * FROM users WHERE id = <span class="hljs-subst">${userId}</span> AND name = <span class="hljs-subst">${userName}</span>`</span>;
<span class="hljs-comment">// Result: "SELECT * FROM users WHERE id = 123 AND name = 'O''Connor'"</span>

<span class="hljs-comment">// Internationalization template tag</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">i18n</span>(<span class="hljs-params">strings, ...values</span>) </span>{
  <span class="hljs-keyword">const</span> key = strings.join(<span class="hljs-string">"{}"</span>);
  <span class="hljs-keyword">const</span> translation = translations[key] || key;

  <span class="hljs-keyword">return</span> values.reduce(<span class="hljs-function">(<span class="hljs-params">result, value, i</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> result.replace(<span class="hljs-string">"{}"</span>, value);
  }, translation);
}

<span class="hljs-keyword">const</span> translations = {
  <span class="hljs-string">"Hello, {}! You have {} messages."</span>: <span class="hljs-string">"Hola, {}! Tienes {} mensajes."</span>,
};

<span class="hljs-keyword">const</span> greeting = i18n<span class="hljs-string">`Hello, <span class="hljs-subst">${userName}</span>! You have <span class="hljs-subst">${messageCount}</span> messages.`</span>;

<span class="hljs-comment">// Styled components (React)</span>
<span class="hljs-keyword">const</span> Button = styled.button<span class="hljs-string">`
  background-color: <span class="hljs-subst">${(props) =&gt; (props.primary ? <span class="hljs-string">"blue"</span> : <span class="hljs-string">"gray"</span>)}</span>;
  color: white;
  padding: <span class="hljs-subst">${(props) =&gt; (props.size === <span class="hljs-string">"large"</span> ? <span class="hljs-string">"12px 24px"</span> : <span class="hljs-string">"8px 16px"</span>)}</span>;
  border: none;
  border-radius: 4px;
  cursor: pointer;

  &amp;:hover {
    opacity: 0.8;
  }
`</span>;
</div></code></pre>
<h2 id="%F0%9F%8E%AF-destructuring">🎯 Destructuring</h2>
<h3 id="array-destructuring">Array Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic array destructuring</span>
<span class="hljs-keyword">const</span> colors = [<span class="hljs-string">"red"</span>, <span class="hljs-string">"green"</span>, <span class="hljs-string">"blue"</span>];
<span class="hljs-keyword">const</span> [first, second, third] = colors;
<span class="hljs-built_in">console</span>.log(first); <span class="hljs-comment">// 'red'</span>
<span class="hljs-built_in">console</span>.log(second); <span class="hljs-comment">// 'green'</span>
<span class="hljs-built_in">console</span>.log(third); <span class="hljs-comment">// 'blue'</span>

<span class="hljs-comment">// Skipping elements</span>
<span class="hljs-keyword">const</span> [primary, , tertiary] = colors;
<span class="hljs-built_in">console</span>.log(primary); <span class="hljs-comment">// 'red'</span>
<span class="hljs-built_in">console</span>.log(tertiary); <span class="hljs-comment">// 'blue'</span>

<span class="hljs-comment">// Default values</span>
<span class="hljs-keyword">const</span> [a, b, c, d = <span class="hljs-string">"yellow"</span>] = colors;
<span class="hljs-built_in">console</span>.log(d); <span class="hljs-comment">// 'yellow' (default value)</span>

<span class="hljs-comment">// Rest operator</span>
<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-keyword">const</span> [head, ...tail] = numbers;
<span class="hljs-built_in">console</span>.log(head); <span class="hljs-comment">// 1</span>
<span class="hljs-built_in">console</span>.log(tail); <span class="hljs-comment">// [2, 3, 4, 5]</span>

<span class="hljs-comment">// Swapping variables</span>
<span class="hljs-keyword">let</span> x = <span class="hljs-number">1</span>;
<span class="hljs-keyword">let</span> y = <span class="hljs-number">2</span>;
[x, y] = [y, x];
<span class="hljs-built_in">console</span>.log(x); <span class="hljs-comment">// 2</span>
<span class="hljs-built_in">console</span>.log(y); <span class="hljs-comment">// 1</span>

<span class="hljs-comment">// Function return values</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCoordinates</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> [<span class="hljs-number">10</span>, <span class="hljs-number">20</span>];
}

<span class="hljs-keyword">const</span> [x, y] = getCoordinates();

<span class="hljs-comment">// Nested arrays</span>
<span class="hljs-keyword">const</span> matrix = [
  [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
  [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>],
];
<span class="hljs-keyword">const</span> [[a, b], [c, d]] = matrix;
<span class="hljs-built_in">console</span>.log(a, b, c, d); <span class="hljs-comment">// 1 2 3 4</span>

<span class="hljs-comment">// Practical examples</span>
<span class="hljs-keyword">const</span> csvLine = <span class="hljs-string">"John,Doe,30,Engineer"</span>;
<span class="hljs-keyword">const</span> [firstName, lastName, age, profession] = csvLine.split(<span class="hljs-string">","</span>);

<span class="hljs-comment">// React hooks</span>
<span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
<span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);

<span class="hljs-comment">// Array methods</span>
<span class="hljs-keyword">const</span> entries = <span class="hljs-built_in">Object</span>.entries({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });
entries.forEach(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${key}</span>: <span class="hljs-subst">${value}</span>`</span>);
});
</div></code></pre>
<h3 id="object-destructuring">Object Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic object destructuring</span>
<span class="hljs-keyword">const</span> person = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">street</span>: <span class="hljs-string">"123 Main St"</span>,
    <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
    <span class="hljs-attr">country</span>: <span class="hljs-string">"USA"</span>,
  },
};

<span class="hljs-keyword">const</span> { name, age, email } = person;
<span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(age); <span class="hljs-comment">// 30</span>

<span class="hljs-comment">// Renaming variables</span>
<span class="hljs-keyword">const</span> { <span class="hljs-attr">name</span>: fullName, <span class="hljs-attr">age</span>: years } = person;
<span class="hljs-built_in">console</span>.log(fullName); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(years); <span class="hljs-comment">// 30</span>

<span class="hljs-comment">// Default values</span>
<span class="hljs-keyword">const</span> { name, age, phone = <span class="hljs-string">"Not provided"</span> } = person;
<span class="hljs-built_in">console</span>.log(phone); <span class="hljs-comment">// 'Not provided'</span>

<span class="hljs-comment">// Nested destructuring</span>
<span class="hljs-keyword">const</span> {
  <span class="hljs-attr">address</span>: { street, city },
} = person;
<span class="hljs-built_in">console</span>.log(street); <span class="hljs-comment">// '123 Main St'</span>
<span class="hljs-built_in">console</span>.log(city); <span class="hljs-comment">// 'New York'</span>

<span class="hljs-comment">// Renaming nested properties</span>
<span class="hljs-keyword">const</span> {
  <span class="hljs-attr">address</span>: { <span class="hljs-attr">street</span>: streetAddress, <span class="hljs-attr">city</span>: cityName },
} = person;

<span class="hljs-comment">// Rest operator with objects</span>
<span class="hljs-keyword">const</span> { name, ...otherInfo } = person;
<span class="hljs-built_in">console</span>.log(otherInfo); <span class="hljs-comment">// { age: 30, email: '...', address: {...} }</span>

<span class="hljs-comment">// Function parameters</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greetUser</span>(<span class="hljs-params">{ name, age, email = <span class="hljs-string">"No email"</span> }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hello <span class="hljs-subst">${name}</span>, you are <span class="hljs-subst">${age}</span> years old.`</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Email: <span class="hljs-subst">${email}</span>`</span>);
}

greetUser(person);

<span class="hljs-comment">// API response handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleApiResponse</span>(<span class="hljs-params">{ data, status, message = <span class="hljs-string">"Success"</span> }</span>) </span>{
  <span class="hljs-keyword">if</span> (status === <span class="hljs-string">"success"</span>) {
    <span class="hljs-built_in">console</span>.log(message);
    <span class="hljs-keyword">return</span> data;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(message);
  }
}

<span class="hljs-comment">// React props destructuring</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserCard</span>(<span class="hljs-params">{ user: { name, email, avatar }, onEdit, className = <span class="hljs-string">""</span> }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">user-card</span> ${<span class="hljs-attr">className</span>}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{avatar}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{name}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onEdit(name)}&gt;Edit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Configuration objects</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createServer</span>(<span class="hljs-params">{
  port = <span class="hljs-number">3000</span>,
  host = <span class="hljs-string">"localhost"</span>,
  ssl = false,
  middleware = [],
  routes = {},
}</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Starting server on <span class="hljs-subst">${host}</span>:<span class="hljs-subst">${port}</span>`</span>);
  <span class="hljs-comment">// Server setup logic...</span>
}

createServer({
  <span class="hljs-attr">port</span>: <span class="hljs-number">8080</span>,
  <span class="hljs-attr">ssl</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">middleware</span>: [cors(), helmet()],
});
</div></code></pre>
<h3 id="advanced-destructuring-patterns">Advanced Destructuring Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Computed property names</span>
<span class="hljs-keyword">const</span> key = <span class="hljs-string">"dynamicKey"</span>;
<span class="hljs-keyword">const</span> obj = { [key]: <span class="hljs-string">"value"</span>, <span class="hljs-attr">other</span>: <span class="hljs-string">"data"</span> };
<span class="hljs-keyword">const</span> { [key]: dynamicValue, other } = obj;
<span class="hljs-built_in">console</span>.log(dynamicValue); <span class="hljs-comment">// 'value'</span>

<span class="hljs-comment">// Destructuring in loops</span>
<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span> },
];

<span class="hljs-comment">// Array of objects</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { name, age } <span class="hljs-keyword">of</span> users) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span> is <span class="hljs-subst">${age}</span> years old`</span>);
}

<span class="hljs-comment">// Map entries</span>
<span class="hljs-keyword">const</span> userMap = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>([
  [<span class="hljs-string">"alice"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span> }],
  [<span class="hljs-string">"bob"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">"user"</span> }],
]);

<span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [username, { name, role }] <span class="hljs-keyword">of</span> userMap) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${username}</span>: <span class="hljs-subst">${name}</span> (<span class="hljs-subst">${role}</span>)`</span>);
}

<span class="hljs-comment">// Mixed destructuring</span>
<span class="hljs-keyword">const</span> response = {
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">users</span>: [
      { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> },
      { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span> },
    ],
    <span class="hljs-attr">meta</span>: { <span class="hljs-attr">total</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">page</span>: <span class="hljs-number">1</span> },
  },
  <span class="hljs-attr">status</span>: <span class="hljs-string">"success"</span>,
};

<span class="hljs-keyword">const</span> {
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">users</span>: [firstUser, ...otherUsers],
    <span class="hljs-attr">meta</span>: { total },
  },
  status,
} = response;

<span class="hljs-built_in">console</span>.log(firstUser); <span class="hljs-comment">// { id: 1, name: 'Alice' }</span>
<span class="hljs-built_in">console</span>.log(total); <span class="hljs-comment">// 2</span>
<span class="hljs-built_in">console</span>.log(status); <span class="hljs-comment">// 'success'</span>

<span class="hljs-comment">// Destructuring with validation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processOrder</span>(<span class="hljs-params">{
  items = [],
  customer: { name, email } = {},
  shipping: { address, method = <span class="hljs-string">"standard"</span> } = {},
}</span>) </span>{
  <span class="hljs-keyword">if</span> (!name || !email) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Customer information is required"</span>);
  }

  <span class="hljs-keyword">if</span> (!address) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Shipping address is required"</span>);
  }

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Processing order for <span class="hljs-subst">${name}</span> (<span class="hljs-subst">${email}</span>)`</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${items.length}</span> items, shipping to <span class="hljs-subst">${address}</span>`</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Shipping method: <span class="hljs-subst">${method}</span>`</span>);
}
</div></code></pre>
<h2 id="%F0%9F%94%84-spread-and-rest-operators">🔄 Spread and Rest Operators</h2>
<h3 id="spread-operator">Spread Operator (...)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Array spreading</span>
<span class="hljs-keyword">const</span> arr1 = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">const</span> arr2 = [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>];
<span class="hljs-keyword">const</span> combined = [...arr1, ...arr2]; <span class="hljs-comment">// [1, 2, 3, 4, 5, 6]</span>

<span class="hljs-comment">// Adding elements</span>
<span class="hljs-keyword">const</span> withExtra = [<span class="hljs-number">0</span>, ...arr1, <span class="hljs-number">3.5</span>, ...arr2, <span class="hljs-number">7</span>]; <span class="hljs-comment">// [0, 1, 2, 3, 3.5, 4, 5, 6, 7]</span>

<span class="hljs-comment">// Array copying (shallow)</span>
<span class="hljs-keyword">const</span> originalArray = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">const</span> copiedArray = [...originalArray];
copiedArray.push(<span class="hljs-number">4</span>); <span class="hljs-comment">// originalArray remains [1, 2, 3]</span>

<span class="hljs-comment">// Converting iterables to arrays</span>
<span class="hljs-keyword">const</span> nodeList = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".item"</span>);
<span class="hljs-keyword">const</span> elementsArray = [...nodeList];

<span class="hljs-keyword">const</span> str = <span class="hljs-string">"hello"</span>;
<span class="hljs-keyword">const</span> chars = [...str]; <span class="hljs-comment">// ['h', 'e', 'l', 'l', 'o']</span>

<span class="hljs-keyword">const</span> <span class="hljs-keyword">set</span> = new Set([1, 2, 3, 2, 1]);
const uniqueArray = [...<span class="hljs-keyword">set</span>]; // [1, 2, 3]

// Function arguments
function sum(a, b, c) {
  <span class="hljs-keyword">return</span> a + b + c;
}

<span class="hljs-keyword">const</span> numbers = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>];
<span class="hljs-keyword">const</span> result = sum(...numbers); <span class="hljs-comment">// Same as sum(1, 2, 3)</span>

<span class="hljs-comment">// Math functions</span>
<span class="hljs-keyword">const</span> scores = [<span class="hljs-number">85</span>, <span class="hljs-number">92</span>, <span class="hljs-number">78</span>, <span class="hljs-number">96</span>, <span class="hljs-number">88</span>];
<span class="hljs-keyword">const</span> highest = <span class="hljs-built_in">Math</span>.max(...scores);
<span class="hljs-keyword">const</span> lowest = <span class="hljs-built_in">Math</span>.min(...scores);

<span class="hljs-comment">// Object spreading</span>
<span class="hljs-keyword">const</span> person = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-keyword">const</span> employee = { ...person, <span class="hljs-attr">role</span>: <span class="hljs-string">"developer"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">75000</span> };
<span class="hljs-comment">// { name: 'Alice', age: 30, role: 'developer', salary: 75000 }</span>

<span class="hljs-comment">// Overriding properties</span>
<span class="hljs-keyword">const</span> updated = { ...person, <span class="hljs-attr">age</span>: <span class="hljs-number">31</span> }; <span class="hljs-comment">// age is updated to 31</span>

<span class="hljs-comment">// Merging objects</span>
<span class="hljs-keyword">const</span> defaults = { <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span>, <span class="hljs-attr">language</span>: <span class="hljs-string">"en"</span> };
<span class="hljs-keyword">const</span> userPrefs = { <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span> };
<span class="hljs-keyword">const</span> settings = { ...defaults, ...userPrefs };
<span class="hljs-comment">// { theme: 'dark', language: 'en' }</span>

<span class="hljs-comment">// Conditional spreading</span>
<span class="hljs-keyword">const</span> includeExtra = <span class="hljs-literal">true</span>;
<span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">base</span>: <span class="hljs-string">"value"</span>,
  ...(includeExtra &amp;&amp; { <span class="hljs-attr">extra</span>: <span class="hljs-string">"data"</span> }),
};

<span class="hljs-comment">// React props spreading</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params">{ children, ...props }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> {<span class="hljs-attr">...props</span>}&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}

<span class="hljs-comment">// Usage: &lt;Button className="primary" onClick={handleClick}&gt;Click me&lt;/Button&gt;</span>
</div></code></pre>
<h3 id="rest-operator">Rest Operator (...)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Function parameters</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sum</span>(<span class="hljs-params">...numbers</span>) </span>{
  <span class="hljs-keyword">return</span> numbers.reduce(<span class="hljs-function">(<span class="hljs-params">total, num</span>) =&gt;</span> total + num, <span class="hljs-number">0</span>);
}

sum(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>); <span class="hljs-comment">// 15</span>
sum(<span class="hljs-number">10</span>, <span class="hljs-number">20</span>); <span class="hljs-comment">// 30</span>
sum(); <span class="hljs-comment">// 0</span>

<span class="hljs-comment">// Mixed parameters</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">greet</span>(<span class="hljs-params">greeting, ...names</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${greeting}</span> <span class="hljs-subst">${names.join(<span class="hljs-string">", "</span>)}</span>!`</span>;
}

greet(<span class="hljs-string">"Hello"</span>, <span class="hljs-string">"Alice"</span>, <span class="hljs-string">"Bob"</span>, <span class="hljs-string">"Charlie"</span>); <span class="hljs-comment">// "Hello Alice, Bob, Charlie!"</span>

<span class="hljs-comment">// Array destructuring with rest</span>
<span class="hljs-keyword">const</span> [first, second, ...rest] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>];
<span class="hljs-built_in">console</span>.log(first); <span class="hljs-comment">// 1</span>
<span class="hljs-built_in">console</span>.log(second); <span class="hljs-comment">// 2</span>
<span class="hljs-built_in">console</span>.log(rest); <span class="hljs-comment">// [3, 4, 5]</span>

<span class="hljs-comment">// Object destructuring with rest</span>
<span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
  <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span>,
};
<span class="hljs-keyword">const</span> { name, age, ...otherProps } = user;
<span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// 'Alice'</span>
<span class="hljs-built_in">console</span>.log(age); <span class="hljs-comment">// 30</span>
<span class="hljs-built_in">console</span>.log(otherProps); <span class="hljs-comment">// { email: 'alice@example.com', role: 'admin' }</span>

<span class="hljs-comment">// Function that accepts options</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createUser</span>(<span class="hljs-params">name, email, ...options</span>) </span>{
  <span class="hljs-keyword">const</span> [age, role = <span class="hljs-string">"user"</span>, department] = options;

  <span class="hljs-keyword">return</span> {
    name,
    email,
    age,
    role,
    department,
  };
}

<span class="hljs-keyword">const</span> newUser = createUser(<span class="hljs-string">"Bob"</span>, <span class="hljs-string">"bob@example.com"</span>, <span class="hljs-number">25</span>, <span class="hljs-string">"admin"</span>, <span class="hljs-string">"IT"</span>);

<span class="hljs-comment">// Flexible API functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">apiCall</span>(<span class="hljs-params">endpoint, method = <span class="hljs-string">"GET"</span>, ...middlewares</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${method}</span> <span class="hljs-subst">${endpoint}</span>`</span>);
  middlewares.forEach(<span class="hljs-function">(<span class="hljs-params">middleware</span>) =&gt;</span> middleware());
}

apiCall(
  <span class="hljs-string">"/users"</span>,
  <span class="hljs-string">"POST"</span>,
  authMiddleware,
  validationMiddleware,
  loggingMiddleware
);

<span class="hljs-comment">// Event handler with rest</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleFormSubmit</span>(<span class="hljs-params">event, ...validators</span>) </span>{
  event.preventDefault();

  <span class="hljs-keyword">const</span> isValid = validators.every(<span class="hljs-function">(<span class="hljs-params">validator</span>) =&gt;</span> validator());

  <span class="hljs-keyword">if</span> (isValid) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form is valid, submitting..."</span>);
  }
}
</div></code></pre>
<h3 id="practical-combinations">Practical Combinations</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Array manipulation utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeItem</span>(<span class="hljs-params">array, index</span>) </span>{
  <span class="hljs-keyword">return</span> [...array.slice(<span class="hljs-number">0</span>, index), ...array.slice(index + <span class="hljs-number">1</span>)];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">insertItem</span>(<span class="hljs-params">array, index, item</span>) </span>{
  <span class="hljs-keyword">return</span> [...array.slice(<span class="hljs-number">0</span>, index), item, ...array.slice(index)];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateItem</span>(<span class="hljs-params">array, index, newItem</span>) </span>{
  <span class="hljs-keyword">return</span> array.map(<span class="hljs-function">(<span class="hljs-params">item, i</span>) =&gt;</span> (i === index ? newItem : item));
}

<span class="hljs-comment">// Object utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">omit</span>(<span class="hljs-params">obj, ...keys</span>) </span>{
  <span class="hljs-keyword">const</span> { [keys[<span class="hljs-number">0</span>]]: omitted, ...rest } = obj;
  <span class="hljs-keyword">return</span> keys.length &gt; <span class="hljs-number">1</span> ? omit(rest, ...keys.slice(<span class="hljs-number">1</span>)) : rest;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pick</span>(<span class="hljs-params">obj, ...keys</span>) </span>{
  <span class="hljs-keyword">return</span> keys.reduce(<span class="hljs-function">(<span class="hljs-params">result, key</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (key <span class="hljs-keyword">in</span> obj) {
      result[key] = obj[key];
    }
    <span class="hljs-keyword">return</span> result;
  }, {});
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
  <span class="hljs-attr">password</span>: <span class="hljs-string">"secret"</span>,
};
<span class="hljs-keyword">const</span> publicUser = omit(user, <span class="hljs-string">"password"</span>); <span class="hljs-comment">// { name: 'Alice', age: 30, email: 'alice@example.com' }</span>
<span class="hljs-keyword">const</span> basicInfo = pick(user, <span class="hljs-string">"name"</span>, <span class="hljs-string">"age"</span>); <span class="hljs-comment">// { name: 'Alice', age: 30 }</span>

<span class="hljs-comment">// Redux-style state updates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateUserState</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_USER"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">user</span>: {
          ...state.user,
          ...action.payload,
        },
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_ITEM"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: [...state.items, action.payload],
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"REMOVE_ITEM"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: state.items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== action.payload.id),
      };

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</div></code></pre>
<h2 id="%F0%9F%8F%97%EF%B8%8F-enhanced-object-literals">🏗️ Enhanced Object Literals</h2>
<h3 id="shorthand-properties-and-methods">Shorthand Properties and Methods</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Old way</span>
<span class="hljs-keyword">const</span> name = <span class="hljs-string">"Alice"</span>;
<span class="hljs-keyword">const</span> age = <span class="hljs-number">30</span>;
<span class="hljs-keyword">const</span> email = <span class="hljs-string">"alice@example.com"</span>;

<span class="hljs-keyword">const</span> oldUser = {
  <span class="hljs-attr">name</span>: name,
  <span class="hljs-attr">age</span>: age,
  <span class="hljs-attr">email</span>: email,
  <span class="hljs-attr">greet</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello!"</span>;
  },
};

<span class="hljs-comment">// New way - shorthand properties</span>
<span class="hljs-keyword">const</span> newUser = {
  name, <span class="hljs-comment">// Same as name: name</span>
  age, <span class="hljs-comment">// Same as age: age</span>
  email, <span class="hljs-comment">// Same as email: email</span>
  greet() {
    <span class="hljs-comment">// Same as greet: function()</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">"Hello!"</span>;
  },
};

<span class="hljs-comment">// Method definitions</span>
<span class="hljs-keyword">const</span> calculator = {
  <span class="hljs-attr">value</span>: <span class="hljs-number">0</span>,

  add(n) {
    <span class="hljs-keyword">this</span>.value += n;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },

  multiply(n) {
    <span class="hljs-keyword">this</span>.value *= n;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  },

  <span class="hljs-keyword">get</span> result() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.value;
  },

  <span class="hljs-keyword">set</span> reset(val) {
    <span class="hljs-keyword">this</span>.value = val || <span class="hljs-number">0</span>;
  },
};

<span class="hljs-comment">// Usage: calculator.add(5).multiply(2).result; // 10</span>

<span class="hljs-comment">// Async methods</span>
<span class="hljs-keyword">const</span> apiService = {
  <span class="hljs-attr">baseUrl</span>: <span class="hljs-string">"https://api.example.com"</span>,

  <span class="hljs-keyword">async</span> fetchUser(id) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.baseUrl}</span>/users/<span class="hljs-subst">${id}</span>`</span>);
    <span class="hljs-keyword">return</span> response.json();
  },

  <span class="hljs-keyword">async</span> createUser(userData) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.baseUrl}</span>/users`</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(userData),
    });
    <span class="hljs-keyword">return</span> response.json();
  },
};
</div></code></pre>
<h3 id="computed-property-names">Computed Property Names</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Dynamic property names</span>
<span class="hljs-keyword">const</span> propertyName = <span class="hljs-string">"dynamicKey"</span>;
<span class="hljs-keyword">const</span> value = <span class="hljs-string">"dynamicValue"</span>;

<span class="hljs-keyword">const</span> obj = {
  [propertyName]: value,
  [<span class="hljs-string">`<span class="hljs-subst">${propertyName}</span>_modified`</span>]: value.toUpperCase(),
  [propertyName + <span class="hljs-string">"_count"</span>]: <span class="hljs-number">1</span>,
};
<span class="hljs-comment">// { dynamicKey: 'dynamicValue', dynamicKey_modified: 'DYNAMICVALUE', dynamicKey_count: 1 }</span>

<span class="hljs-comment">// Function-based property names</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPropertyName</span>(<span class="hljs-params">prefix, suffix</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${prefix}</span>_<span class="hljs-subst">${suffix}</span>`</span>;
}

<span class="hljs-keyword">const</span> config = {
  [getPropertyName(<span class="hljs-string">"api"</span>, <span class="hljs-string">"url"</span>)]: <span class="hljs-string">"https://api.example.com"</span>,
  [getPropertyName(<span class="hljs-string">"api"</span>, <span class="hljs-string">"key"</span>)]: <span class="hljs-string">"secret-key"</span>,
};
<span class="hljs-comment">// { api_url: 'https://api.example.com', api_key: 'secret-key' }</span>

<span class="hljs-comment">// Symbol properties</span>
<span class="hljs-keyword">const</span> uniqueId = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">"id"</span>);
<span class="hljs-keyword">const</span> metadata = <span class="hljs-built_in">Symbol</span>(<span class="hljs-string">"metadata"</span>);

<span class="hljs-keyword">const</span> user = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  [uniqueId]: <span class="hljs-number">12345</span>,
  [metadata]: { <span class="hljs-attr">created</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(), <span class="hljs-attr">version</span>: <span class="hljs-number">1</span> },
};

<span class="hljs-comment">// Computed method names</span>
<span class="hljs-keyword">const</span> actions = [<span class="hljs-string">"create"</span>, <span class="hljs-string">"read"</span>, <span class="hljs-string">"update"</span>, <span class="hljs-string">"delete"</span>];
<span class="hljs-keyword">const</span> api = {};

actions.forEach(<span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> {
  api[<span class="hljs-string">`<span class="hljs-subst">${action}</span>User`</span>] = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${action.toUpperCase()}</span> user:`</span>, data);
  };
});
<span class="hljs-comment">// api.createUser, api.readUser, api.updateUser, api.deleteUser</span>

<span class="hljs-comment">// React component with dynamic handlers</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FormComponent</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = {};

    <span class="hljs-comment">// Create handlers for each field</span>
    props.fields.forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>[<span class="hljs-string">`handle<span class="hljs-subst">${field.charAt(<span class="hljs-number">0</span>).toUpperCase() + field.slice(<span class="hljs-number">1</span>)}</span>Change`</span>] = (
        e
      ) =&gt; {
        <span class="hljs-keyword">this</span>.setState({ [field]: e.target.value });
      };
    });
  }
}

<span class="hljs-comment">// Practical example: Form validation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createValidator</span>(<span class="hljs-params">rules</span>) </span>{
  <span class="hljs-keyword">return</span> {
    [<span class="hljs-built_in">Symbol</span>.toStringTag]: <span class="hljs-string">"Validator"</span>,

    validate(data) {
      <span class="hljs-keyword">const</span> errors = {};

      <span class="hljs-built_in">Object</span>.keys(rules).forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> rule = rules[field];
        <span class="hljs-keyword">const</span> value = data[field];

        <span class="hljs-keyword">if</span> (rule.required &amp;&amp; !value) {
          errors[field] = <span class="hljs-string">`<span class="hljs-subst">${field}</span> is required`</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rule.minLength &amp;&amp; value.length &lt; rule.minLength) {
          errors[
            field
          ] = <span class="hljs-string">`<span class="hljs-subst">${field}</span> must be at least <span class="hljs-subst">${rule.minLength}</span> characters`</span>;
        }
      });

      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">isValid</span>: <span class="hljs-built_in">Object</span>.keys(errors).length === <span class="hljs-number">0</span>,
        errors,
      };
    },
  };
}

<span class="hljs-keyword">const</span> userValidator = createValidator({
  <span class="hljs-attr">name</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">minLength</span>: <span class="hljs-number">2</span> },
  <span class="hljs-attr">email</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">password</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">minLength</span>: <span class="hljs-number">8</span> },
});
</div></code></pre>
<h2 id="%F0%9F%93%A6-modules-importexport">📦 Modules (Import/Export)</h2>
<h3 id="named-exports-and-imports">Named Exports and Imports</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// math.js - Named exports</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> PI = <span class="hljs-number">3.14159</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> E = <span class="hljs-number">2.71828</span>;

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">multiply</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a * b;
}

<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Calculator</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.value = <span class="hljs-number">0</span>;
  }

  add(n) {
    <span class="hljs-keyword">this</span>.value += n;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }
}

<span class="hljs-comment">// Alternative export syntax</span>
<span class="hljs-keyword">const</span> subtract = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b;
<span class="hljs-keyword">const</span> divide = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a / b;

<span class="hljs-keyword">export</span> { subtract, divide };

<span class="hljs-comment">// Exporting with different names</span>
<span class="hljs-keyword">const</span> power = <span class="hljs-function">(<span class="hljs-params">base, exponent</span>) =&gt;</span> <span class="hljs-built_in">Math</span>.pow(base, exponent);
<span class="hljs-keyword">export</span> { power <span class="hljs-keyword">as</span> pow };

<span class="hljs-comment">// main.js - Named imports</span>
<span class="hljs-keyword">import</span> { PI, add, multiply, Calculator } <span class="hljs-keyword">from</span> <span class="hljs-string">"./math.js"</span>;
<span class="hljs-keyword">import</span> { subtract, divide, pow } <span class="hljs-keyword">from</span> <span class="hljs-string">"./math.js"</span>;

<span class="hljs-comment">// Using imported functions</span>
<span class="hljs-built_in">console</span>.log(add(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// 8</span>
<span class="hljs-built_in">console</span>.log(multiply(<span class="hljs-number">4</span>, <span class="hljs-number">7</span>)); <span class="hljs-comment">// 28</span>
<span class="hljs-built_in">console</span>.log(PI); <span class="hljs-comment">// 3.14159</span>

<span class="hljs-keyword">const</span> calc = <span class="hljs-keyword">new</span> Calculator();
calc.add(<span class="hljs-number">10</span>).add(<span class="hljs-number">5</span>);

<span class="hljs-comment">// Importing with different names</span>
<span class="hljs-keyword">import</span> { pow <span class="hljs-keyword">as</span> power } <span class="hljs-keyword">from</span> <span class="hljs-string">"./math.js"</span>;
<span class="hljs-built_in">console</span>.log(power(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// 8</span>

<span class="hljs-comment">// Importing all named exports</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> MathUtils <span class="hljs-keyword">from</span> <span class="hljs-string">"./math.js"</span>;
<span class="hljs-built_in">console</span>.log(MathUtils.PI);
<span class="hljs-built_in">console</span>.log(MathUtils.add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>));

<span class="hljs-comment">// Selective imports</span>
<span class="hljs-keyword">import</span> { add, multiply } <span class="hljs-keyword">from</span> <span class="hljs-string">"./math.js"</span>;
</div></code></pre>
<h3 id="default-exports-and-imports">Default Exports and Imports</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// user.js - Default export</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
    <span class="hljs-keyword">constructor</span>(name, email) {
        <span class="hljs-keyword">this</span>.name = name;
        <span class="hljs-keyword">this</span>.email = email;
    }

    greet() {
        <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span>`</span>;
    }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> User;

<span class="hljs-comment">// Alternative default export syntax</span>
<span class="hljs-keyword">const</span> createUser = <span class="hljs-function">(<span class="hljs-params">name, email</span>) =&gt;</span> <span class="hljs-keyword">new</span> User(name, email);
<span class="hljs-keyword">export</span> { createUser <span class="hljs-keyword">as</span> <span class="hljs-keyword">default</span> };

<span class="hljs-comment">// Or inline default export</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateEmail</span>(<span class="hljs-params">email</span>) </span>{
    <span class="hljs-keyword">return</span> email.includes(<span class="hljs-string">'@'</span>);
}

<span class="hljs-comment">// main.js - Default imports</span>
<span class="hljs-keyword">import</span> User <span class="hljs-keyword">from</span> <span class="hljs-string">'./user.js'</span>;              <span class="hljs-comment">// Import default export</span>
<span class="hljs-keyword">import</span> MyUser <span class="hljs-keyword">from</span> <span class="hljs-string">'./user.js'</span>;            <span class="hljs-comment">// Can use any name</span>
<span class="hljs-keyword">import</span> validateEmail <span class="hljs-keyword">from</span> <span class="hljs-string">'./validator.js'</span>; <span class="hljs-comment">// Import default function</span>

<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">new</span> User(<span class="hljs-string">'Alice'</span>, <span class="hljs-string">'alice@example.com'</span>);
<span class="hljs-built_in">console</span>.log(user.greet());

<span class="hljs-comment">// Mixed imports (default + named)</span>
<span class="hljs-comment">// utils.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">message</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`[LOG]: <span class="hljs-subst">${message}</span>`</span>);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> version = <span class="hljs-string">'1.0.0'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> author = <span class="hljs-string">'John Doe'</span>;

<span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">import</span> log, { version, author } <span class="hljs-keyword">from</span> <span class="hljs-string">'./utils.js'</span>;

log(<span class="hljs-string">`App version: <span class="hljs-subst">${version}</span> by <span class="hljs-subst">${author}</span>`</span>);
</div></code></pre>
<h3 id="re-exports-and-module-aggregation">Re-exports and Module Aggregation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// api/users.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUsers</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/users"</span>);
  <span class="hljs-keyword">return</span> response.json();
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createUser</span>(<span class="hljs-params">userData</span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/users"</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
    <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(userData),
  });
  <span class="hljs-keyword">return</span> response.json();
}

<span class="hljs-comment">// api/posts.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getPosts</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/posts"</span>);
  <span class="hljs-keyword">return</span> response.json();
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createPost</span>(<span class="hljs-params">postData</span>) </span>{
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/posts"</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
    <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(postData),
  });
  <span class="hljs-keyword">return</span> response.json();
}

<span class="hljs-comment">// api/index.js - Aggregating exports</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">"./users.js"</span>; <span class="hljs-comment">// Re-export all named exports</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">"./posts.js"</span>;

<span class="hljs-comment">// Or selective re-exports</span>
<span class="hljs-keyword">export</span> { getUsers, createUser } <span class="hljs-keyword">from</span> <span class="hljs-string">"./users.js"</span>;
<span class="hljs-keyword">export</span> { getPosts, createPost } <span class="hljs-keyword">from</span> <span class="hljs-string">"./posts.js"</span>;

<span class="hljs-comment">// Re-export with renaming</span>
<span class="hljs-keyword">export</span> { getUsers <span class="hljs-keyword">as</span> fetchUsers } <span class="hljs-keyword">from</span> <span class="hljs-string">"./users.js"</span>;

<span class="hljs-comment">// Re-export default as named</span>
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> UserClass } <span class="hljs-keyword">from</span> <span class="hljs-string">"./user.js"</span>;

<span class="hljs-comment">// main.js - Clean imports</span>
<span class="hljs-keyword">import</span> { getUsers, createUser, getPosts, createPost } <span class="hljs-keyword">from</span> <span class="hljs-string">"./api/index.js"</span>;

<span class="hljs-comment">// Or namespace import</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> API <span class="hljs-keyword">from</span> <span class="hljs-string">"./api/index.js"</span>;
API.getUsers().then(<span class="hljs-function">(<span class="hljs-params">users</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(users));
</div></code></pre>
<h3 id="dynamic-imports">Dynamic Imports</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Dynamic imports for code splitting</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadModule</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./heavy-module.js"</span>);
    <span class="hljs-built_in">module</span>.doSomething();
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to load module:"</span>, error);
  }
}

<span class="hljs-comment">// Conditional loading</span>
<span class="hljs-keyword">if</span> (condition) {
  <span class="hljs-keyword">import</span>(<span class="hljs-string">"./feature-module.js"</span>)
    .then(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">module</span></span>) =&gt;</span> {
      <span class="hljs-built_in">module</span>.initializeFeature();
    })
    .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Feature not available:"</span>, error);
    });
}

<span class="hljs-comment">// React lazy loading</span>
<span class="hljs-keyword">const</span> LazyComponent = React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./LazyComponent.js"</span>));

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">LazyComponent</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Dynamic import with destructuring</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadUtilities</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { add, multiply, PI } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./math.js"</span>);
  <span class="hljs-built_in">console</span>.log(add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>));
  <span class="hljs-built_in">console</span>.log(PI);
}

<span class="hljs-comment">// Module loading based on environment</span>
<span class="hljs-keyword">const</span> isDevelopment = process.env.NODE_ENV === <span class="hljs-string">"development"</span>;

<span class="hljs-keyword">const</span> logger = isDevelopment
  ? <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./dev-logger.js"</span>)
  : <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./prod-logger.js"</span>);

logger.log(<span class="hljs-string">"Application started"</span>);

<span class="hljs-comment">// Plugin system with dynamic imports</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PluginManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.plugins = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  <span class="hljs-keyword">async</span> loadPlugin(name) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> plugin = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`./plugins/<span class="hljs-subst">${name}</span>.js`</span>);
      <span class="hljs-keyword">this</span>.plugins.set(name, plugin.default || plugin);
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Plugin <span class="hljs-subst">${name}</span> loaded successfully`</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Failed to load plugin <span class="hljs-subst">${name}</span>:`</span>, error);
    }
  }

  getPlugin(name) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.plugins.get(name);
  }
}

<span class="hljs-keyword">const</span> pluginManager = <span class="hljs-keyword">new</span> PluginManager();
<span class="hljs-keyword">await</span> pluginManager.loadPlugin(<span class="hljs-string">"analytics"</span>);
<span class="hljs-keyword">await</span> pluginManager.loadPlugin(<span class="hljs-string">"authentication"</span>);
</div></code></pre>
<h2 id="%F0%9F%8F%9B%EF%B8%8F-classes">🏛️ Classes</h2>
<h3 id="basic-class-syntax">Basic Class Syntax</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ES6 Class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, age) {
    <span class="hljs-keyword">this</span>.name = name;
    <span class="hljs-keyword">this</span>.age = age;
  }

  greet() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Hello, I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> and I'm <span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span> years old.`</span>;
  }

  haveBirthday() {
    <span class="hljs-keyword">this</span>.age++;
    <span class="hljs-keyword">return</span> <span class="hljs-string">`Happy birthday! I'm now <span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span>.`</span>;
  }

  <span class="hljs-comment">// Static method</span>
  <span class="hljs-keyword">static</span> createAdult(name) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Person(name, <span class="hljs-number">18</span>);
  }

  <span class="hljs-comment">// Getter</span>
  <span class="hljs-keyword">get</span> description() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> (<span class="hljs-subst">${<span class="hljs-keyword">this</span>.age}</span> years old)`</span>;
  }

  <span class="hljs-comment">// Setter</span>
  <span class="hljs-keyword">set</span> fullName(name) {
    <span class="hljs-keyword">this</span>.name = name;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>);
<span class="hljs-built_in">console</span>.log(person.greet());
<span class="hljs-built_in">console</span>.log(person.haveBirthday());
<span class="hljs-built_in">console</span>.log(person.description);

person.fullName = <span class="hljs-string">"Alice Smith"</span>;
<span class="hljs-built_in">console</span>.log(person.description);

<span class="hljs-keyword">const</span> adult = Person.createAdult(<span class="hljs-string">"Bob"</span>);
<span class="hljs-built_in">console</span>.log(adult.age); <span class="hljs-comment">// 18</span>
</div></code></pre>
<h3 id="inheritance">Inheritance</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Base class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, species) {
    <span class="hljs-keyword">this</span>.name = name;
    <span class="hljs-keyword">this</span>.species = species;
  }

  makeSound() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> makes a sound`</span>;
  }

  move() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> moves`</span>;
  }

  toString() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> the <span class="hljs-subst">${<span class="hljs-keyword">this</span>.species}</span>`</span>;
  }
}

<span class="hljs-comment">// Derived class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, breed) {
    <span class="hljs-keyword">super</span>(name, <span class="hljs-string">"Dog"</span>); <span class="hljs-comment">// Call parent constructor</span>
    <span class="hljs-keyword">this</span>.breed = breed;
  }

  makeSound() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> barks: Woof!`</span>;
  }

  fetch() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> fetches the ball`</span>;
  }

  <span class="hljs-comment">// Override toString</span>
  toString() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">super</span>.toString()}</span> (<span class="hljs-subst">${<span class="hljs-keyword">this</span>.breed}</span>)`</span>;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cat</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, isIndoor = true) {
    <span class="hljs-keyword">super</span>(name, <span class="hljs-string">"Cat"</span>);
    <span class="hljs-keyword">this</span>.isIndoor = isIndoor;
  }

  makeSound() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> meows: Meow!`</span>;
  }

  climb() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> climbs the tree`</span>;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> dog = <span class="hljs-keyword">new</span> Dog(<span class="hljs-string">"Buddy"</span>, <span class="hljs-string">"Golden Retriever"</span>);
<span class="hljs-keyword">const</span> cat = <span class="hljs-keyword">new</span> Cat(<span class="hljs-string">"Whiskers"</span>);

<span class="hljs-built_in">console</span>.log(dog.makeSound()); <span class="hljs-comment">// "Buddy barks: Woof!"</span>
<span class="hljs-built_in">console</span>.log(cat.makeSound()); <span class="hljs-comment">// "Whiskers meows: Meow!"</span>
<span class="hljs-built_in">console</span>.log(dog.toString()); <span class="hljs-comment">// "Buddy the Dog (Golden Retriever)"</span>

<span class="hljs-comment">// Polymorphism</span>
<span class="hljs-keyword">const</span> animals = [dog, cat];
animals.forEach(<span class="hljs-function">(<span class="hljs-params">animal</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(animal.makeSound()); <span class="hljs-comment">// Different behavior for each</span>
});

<span class="hljs-comment">// instanceof checks</span>
<span class="hljs-built_in">console</span>.log(dog <span class="hljs-keyword">instanceof</span> Dog); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(dog <span class="hljs-keyword">instanceof</span> Animal); <span class="hljs-comment">// true</span>
<span class="hljs-built_in">console</span>.log(cat <span class="hljs-keyword">instanceof</span> Dog); <span class="hljs-comment">// false</span>
</div></code></pre>
<h3 id="private-fields-and-methods-es2022">Private Fields and Methods (ES2022)</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BankAccount</span> </span>{
  <span class="hljs-comment">// Private fields</span>
  #balance = <span class="hljs-number">0</span>;
  #accountNumber;
  #transactions = [];

  <span class="hljs-keyword">constructor</span>(accountNumber, initialBalance = 0) {
    <span class="hljs-keyword">this</span>.#accountNumber = accountNumber;
    <span class="hljs-keyword">this</span>.#balance = initialBalance;
    <span class="hljs-keyword">this</span>.#addTransaction(<span class="hljs-string">"Initial deposit"</span>, initialBalance);
  }

  <span class="hljs-comment">// Private method</span>
  #addTransaction(type, amount) {
    <span class="hljs-keyword">this</span>.#transactions.push({
      type,
      amount,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),
      <span class="hljs-attr">balance</span>: <span class="hljs-keyword">this</span>.#balance,
    });
  }

  <span class="hljs-comment">// Public methods</span>
  deposit(amount) {
    <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Deposit amount must be positive"</span>);
    }

    <span class="hljs-keyword">this</span>.#balance += amount;
    <span class="hljs-keyword">this</span>.#addTransaction(<span class="hljs-string">"Deposit"</span>, amount);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#balance;
  }

  withdraw(amount) {
    <span class="hljs-keyword">if</span> (amount &lt;= <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Withdrawal amount must be positive"</span>);
    }

    <span class="hljs-keyword">if</span> (amount &gt; <span class="hljs-keyword">this</span>.#balance) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Insufficient funds"</span>);
    }

    <span class="hljs-keyword">this</span>.#balance -= amount;
    <span class="hljs-keyword">this</span>.#addTransaction(<span class="hljs-string">"Withdrawal"</span>, -amount);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#balance;
  }

  <span class="hljs-comment">// Getter for balance (read-only access)</span>
  <span class="hljs-keyword">get</span> balance() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#balance;
  }

  <span class="hljs-keyword">get</span> accountNumber() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#accountNumber;
  }

  getTransactionHistory() {
    <span class="hljs-comment">// Return copy to prevent external modification</span>
    <span class="hljs-keyword">return</span> [...this.#transactions];
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> account = <span class="hljs-keyword">new</span> BankAccount(<span class="hljs-string">"12345"</span>, <span class="hljs-number">1000</span>);
<span class="hljs-built_in">console</span>.log(account.balance); <span class="hljs-comment">// 1000</span>

account.deposit(<span class="hljs-number">500</span>);
<span class="hljs-built_in">console</span>.log(account.balance); <span class="hljs-comment">// 1500</span>

account.withdraw(<span class="hljs-number">200</span>);
<span class="hljs-built_in">console</span>.log(account.balance); <span class="hljs-comment">// 1300</span>

<span class="hljs-comment">// These would throw errors:</span>
<span class="hljs-comment">// console.log(account.#balance);     // SyntaxError: Private field '#balance' must be declared in an enclosing class</span>
<span class="hljs-comment">// account.#addTransaction('test', 100); // SyntaxError</span>

<span class="hljs-built_in">console</span>.log(account.getTransactionHistory());
</div></code></pre>
<h3 id="static-fields-and-methods">Static Fields and Methods</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MathUtils</span> </span>{
  <span class="hljs-comment">// Static fields</span>
  <span class="hljs-keyword">static</span> PI = <span class="hljs-number">3.14159</span>;
  <span class="hljs-keyword">static</span> E = <span class="hljs-number">2.71828</span>;
  <span class="hljs-keyword">static</span> #precision = <span class="hljs-number">10</span>; <span class="hljs-comment">// Private static field</span>

  <span class="hljs-comment">// Static methods</span>
  <span class="hljs-keyword">static</span> add(a, b) {
    <span class="hljs-keyword">return</span> a + b;
  }

  <span class="hljs-keyword">static</span> multiply(a, b) {
    <span class="hljs-keyword">return</span> a * b;
  }

  <span class="hljs-keyword">static</span> round(number, decimals = <span class="hljs-number">2</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.round(number * <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">10</span>, decimals)) / <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">10</span>, decimals);
  }

  <span class="hljs-comment">// Private static method</span>
  <span class="hljs-keyword">static</span> #validateNumber(num) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> num !== <span class="hljs-string">"number"</span> || <span class="hljs-built_in">isNaN</span>(num)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid number"</span>);
    }
  }

  <span class="hljs-keyword">static</span> circleArea(radius) {
    <span class="hljs-keyword">this</span>.#validateNumber(radius);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.round(<span class="hljs-keyword">this</span>.PI * radius * radius);
  }

  <span class="hljs-comment">// Static getter</span>
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">get</span> precision() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.#precision;
  }

  <span class="hljs-comment">// Static setter</span>
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">set</span> precision(value) {
    <span class="hljs-keyword">if</span> (value &gt; <span class="hljs-number">0</span> &amp;&amp; value &lt;= <span class="hljs-number">20</span>) {
      <span class="hljs-keyword">this</span>.#precision = value;
    }
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-built_in">console</span>.log(MathUtils.PI); <span class="hljs-comment">// 3.14159</span>
<span class="hljs-built_in">console</span>.log(MathUtils.add(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)); <span class="hljs-comment">// 8</span>
<span class="hljs-built_in">console</span>.log(MathUtils.circleArea(<span class="hljs-number">5</span>)); <span class="hljs-comment">// 78.54</span>
<span class="hljs-built_in">console</span>.log(MathUtils.precision); <span class="hljs-comment">// 10</span>

MathUtils.precision = <span class="hljs-number">5</span>;
<span class="hljs-built_in">console</span>.log(MathUtils.precision); <span class="hljs-comment">// 5</span>

<span class="hljs-comment">// Counter example with static fields</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Counter</span> </span>{
  <span class="hljs-keyword">static</span> #count = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">static</span> #instances = [];

  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
    <span class="hljs-keyword">this</span>.id = ++Counter.#count;
    Counter.#instances.push(<span class="hljs-keyword">this</span>);
  }

  <span class="hljs-keyword">static</span> getCount() {
    <span class="hljs-keyword">return</span> Counter.#count;
  }

  <span class="hljs-keyword">static</span> getAllInstances() {
    <span class="hljs-keyword">return</span> [...Counter.#instances];
  }

  <span class="hljs-keyword">static</span> reset() {
    Counter.#count = <span class="hljs-number">0</span>;
    Counter.#instances = [];
  }
}

<span class="hljs-keyword">const</span> counter1 = <span class="hljs-keyword">new</span> Counter(<span class="hljs-string">"First"</span>);
<span class="hljs-keyword">const</span> counter2 = <span class="hljs-keyword">new</span> Counter(<span class="hljs-string">"Second"</span>);

<span class="hljs-built_in">console</span>.log(Counter.getCount()); <span class="hljs-comment">// 2</span>
<span class="hljs-built_in">console</span>.log(Counter.getAllInstances()); <span class="hljs-comment">// [Counter, Counter]</span>
</div></code></pre>
<h3 id="mixins-and-composition">Mixins and Composition</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Mixin functions</span>
<span class="hljs-keyword">const</span> Flyable = {
  fly() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is flying`</span>;
  },

  land() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> has landed`</span>;
  },
};

<span class="hljs-keyword">const</span> Swimmable = {
  swim() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is swimming`</span>;
  },

  dive() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> dives underwater`</span>;
  },
};

<span class="hljs-keyword">const</span> Walkable = {
  walk() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is walking`</span>;
  },

  run() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.name}</span> is running`</span>;
  },
};

<span class="hljs-comment">// Mixin helper function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mixin</span>(<span class="hljs-params">target, ...sources</span>) </span>{
  sources.forEach(<span class="hljs-function">(<span class="hljs-params">source</span>) =&gt;</span> {
    <span class="hljs-built_in">Object</span>.getOwnPropertyNames(source).forEach(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (name !== <span class="hljs-string">"constructor"</span>) {
        target.prototype[name] = source[name];
      }
    });
  });
  <span class="hljs-keyword">return</span> target;
}

<span class="hljs-comment">// Base class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
  }
}

<span class="hljs-comment">// Classes with mixins</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Bird</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, wingspan) {
    <span class="hljs-keyword">super</span>(name);
    <span class="hljs-keyword">this</span>.wingspan = wingspan;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Duck</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">super</span>(name);
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Human</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, age) {
    <span class="hljs-keyword">super</span>(name);
    <span class="hljs-keyword">this</span>.age = age;
  }
}

<span class="hljs-comment">// Apply mixins</span>
mixin(Bird, Flyable, Walkable);
mixin(Duck, Flyable, Swimmable, Walkable);
mixin(Human, Walkable, Swimmable);

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> eagle = <span class="hljs-keyword">new</span> Bird(<span class="hljs-string">"Eagle"</span>, <span class="hljs-number">200</span>);
<span class="hljs-keyword">const</span> mallard = <span class="hljs-keyword">new</span> Duck(<span class="hljs-string">"Mallard"</span>);
<span class="hljs-keyword">const</span> person = <span class="hljs-keyword">new</span> Human(<span class="hljs-string">"Alice"</span>, <span class="hljs-number">30</span>);

<span class="hljs-built_in">console</span>.log(eagle.fly()); <span class="hljs-comment">// "Eagle is flying"</span>
<span class="hljs-built_in">console</span>.log(eagle.walk()); <span class="hljs-comment">// "Eagle is walking"</span>

<span class="hljs-built_in">console</span>.log(mallard.fly()); <span class="hljs-comment">// "Mallard is flying"</span>
<span class="hljs-built_in">console</span>.log(mallard.swim()); <span class="hljs-comment">// "Mallard is swimming"</span>
<span class="hljs-built_in">console</span>.log(mallard.walk()); <span class="hljs-comment">// "Mallard is walking"</span>

<span class="hljs-built_in">console</span>.log(person.walk()); <span class="hljs-comment">// "Alice is walking"</span>
<span class="hljs-built_in">console</span>.log(person.swim()); <span class="hljs-comment">// "Alice is swimming"</span>
<span class="hljs-comment">// console.log(person.fly()); // Error: person.fly is not a function</span>

<span class="hljs-comment">// Factory function approach</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFlyingAnimal</span>(<span class="hljs-params">name, type</span>) </span>{
  <span class="hljs-keyword">const</span> animal = {
    name,
    type,
    ...Flyable,
    ...Walkable,
  };

  <span class="hljs-keyword">return</span> animal;
}

<span class="hljs-keyword">const</span> bat = createFlyingAnimal(<span class="hljs-string">"Bat"</span>, <span class="hljs-string">"Mammal"</span>);
<span class="hljs-built_in">console</span>.log(bat.fly()); <span class="hljs-comment">// "Bat is flying"</span>
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-arrow-function-context-issues">1. Arrow Function Context Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Using arrow functions where you need dynamic `this`</span>
<span class="hljs-keyword">const</span> button = {
  <span class="hljs-attr">text</span>: <span class="hljs-string">"Click me"</span>,
  <span class="hljs-attr">click</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.text); <span class="hljs-comment">// `this` is not the button object</span>
  },
};

<span class="hljs-comment">// ✅ Use regular function for object methods</span>
<span class="hljs-keyword">const</span> buttonFixed = {
  <span class="hljs-attr">text</span>: <span class="hljs-string">"Click me"</span>,
  click() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">this</span>.text); <span class="hljs-comment">// Works correctly</span>
  },
};

<span class="hljs-comment">// ❌ Arrow functions as constructors</span>
<span class="hljs-keyword">const</span> Person = <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
  <span class="hljs-keyword">this</span>.name = name; <span class="hljs-comment">// Error: Arrow functions cannot be constructors</span>
};

<span class="hljs-comment">// ✅ Use regular function or class</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PersonConstructor</span>(<span class="hljs-params">name</span>) </span>{
  <span class="hljs-keyword">this</span>.name = name;
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PersonClass</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
  }
}
</div></code></pre>
<h3 id="2-destructuring-with-default-values">2. Destructuring with Default Values</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Incorrect default value syntax</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUser</span>(<span class="hljs-params">{ name = <span class="hljs-string">"Anonymous"</span>, age = <span class="hljs-number">0</span>, email }</span>) </span>{
  <span class="hljs-comment">// This works, but what if the entire object is undefined?</span>
}

processUser(); <span class="hljs-comment">// TypeError: Cannot destructure property 'name' of 'undefined'</span>

<span class="hljs-comment">// ✅ Provide default for the entire parameter</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUserFixed</span>(<span class="hljs-params">{ name = <span class="hljs-string">"Anonymous"</span>, age = <span class="hljs-number">0</span>, email } = {}</span>) </span>{
  <span class="hljs-built_in">console</span>.log(name, age, email);
}

processUserFixed(); <span class="hljs-comment">// Works: "Anonymous 0 undefined"</span>

<span class="hljs-comment">// ❌ Nested destructuring without defaults</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAddress</span>(<span class="hljs-params">{
  user: {
    address: { street },
  },
}</span>) </span>{
  <span class="hljs-keyword">return</span> street;
}

getAddress({ <span class="hljs-attr">user</span>: {} }); <span class="hljs-comment">// TypeError: Cannot destructure property 'street' of 'undefined'</span>

<span class="hljs-comment">// ✅ Provide defaults at each level</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getAddressFixed</span>(<span class="hljs-params">{ user: { address: { street } = {} } = {} } = {}</span>) </span>{
  <span class="hljs-keyword">return</span> street;
}

getAddressFixed({ <span class="hljs-attr">user</span>: {} }); <span class="hljs-comment">// undefined (no error)</span>
</div></code></pre>
<h3 id="3-module-importexport-issues">3. Module Import/Export Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Mixing default and named exports incorrectly</span>
<span class="hljs-comment">// utils.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">log</span>(<span class="hljs-params">message</span>) </span>{
  <span class="hljs-built_in">console</span>.log(message);
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> version = <span class="hljs-string">"1.0.0"</span>;

<span class="hljs-comment">// main.js - Wrong import</span>
<span class="hljs-keyword">import</span> { log, version } <span class="hljs-keyword">from</span> <span class="hljs-string">"./utils.js"</span>; <span class="hljs-comment">// Error: log is default export</span>

<span class="hljs-comment">// ✅ Correct import</span>
<span class="hljs-keyword">import</span> log, { version } <span class="hljs-keyword">from</span> <span class="hljs-string">"./utils.js"</span>;

<span class="hljs-comment">// ❌ Circular dependencies</span>
<span class="hljs-comment">// a.js</span>
<span class="hljs-keyword">import</span> { b } <span class="hljs-keyword">from</span> <span class="hljs-string">"./b.js"</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> a = <span class="hljs-string">"A"</span>;

<span class="hljs-comment">// b.js</span>
<span class="hljs-keyword">import</span> { a } <span class="hljs-keyword">from</span> <span class="hljs-string">"./a.js"</span>; <span class="hljs-comment">// Circular dependency</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> b = <span class="hljs-string">"B"</span>;

<span class="hljs-comment">// ✅ Avoid circular dependencies or use dynamic imports</span>
<span class="hljs-comment">// b.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> b = <span class="hljs-string">"B"</span>;

<span class="hljs-comment">// Later, when needed:</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useA</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { a } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./a.js"</span>);
  <span class="hljs-built_in">console</span>.log(a);
}
</div></code></pre>
<h3 id="4-class-inheritance-pitfalls">4. Class Inheritance Pitfalls</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Forgetting to call super() in constructor</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, breed) {
    <span class="hljs-comment">// Missing super(name) call</span>
    <span class="hljs-keyword">this</span>.breed = breed; <span class="hljs-comment">// ReferenceError: Must call super constructor</span>
  }
}

<span class="hljs-comment">// ✅ Always call super() first</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DogFixed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Animal</span> </span>{
  <span class="hljs-keyword">constructor</span>(name, breed) {
    <span class="hljs-keyword">super</span>(name); <span class="hljs-comment">// Call parent constructor first</span>
    <span class="hljs-keyword">this</span>.breed = breed;
  }
}

<span class="hljs-comment">// ❌ Incorrect method overriding</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Calculator</span> </span>{
  add(a, b) {
    <span class="hljs-keyword">return</span> a + b;
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScientificCalculator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Calculator</span> </span>{
  add(a, b, c = <span class="hljs-number">0</span>) {
    <span class="hljs-comment">// Different signature</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.add(a, b) + c;
  }
}

<span class="hljs-comment">// This can cause confusion when used polymorphically</span>
<span class="hljs-keyword">const</span> calc = <span class="hljs-keyword">new</span> ScientificCalculator();
<span class="hljs-built_in">console</span>.log(calc.add(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)); <span class="hljs-comment">// Works, but third parameter is ignored</span>

<span class="hljs-comment">// ✅ Maintain consistent method signatures</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ScientificCalculatorFixed</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Calculator</span> </span>{
  add(a, b) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">super</span>.add(a, b);
  }

  addThree(a, b, c) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.add(a, b) + c;
  }
}
</div></code></pre>
<h3 id="5-template-literal-gotchas">5. Template Literal Gotchas</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Unintended expression evaluation</span>
<span class="hljs-keyword">const</span> userInput = <span class="hljs-string">'${alert("XSS")}'</span>;
<span class="hljs-keyword">const</span> message = <span class="hljs-string">`Hello <span class="hljs-subst">${userInput}</span>`</span>; <span class="hljs-comment">// Safe - treated as string</span>

<span class="hljs-comment">// But be careful with eval-like functions</span>
<span class="hljs-keyword">const</span> dangerousTemplate = <span class="hljs-string">`Hello <span class="hljs-subst">${<span class="hljs-built_in">eval</span>(userInput)}</span>`</span>; <span class="hljs-comment">// Dangerous!</span>

<span class="hljs-comment">// ✅ Always sanitize user input</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitize</span>(<span class="hljs-params">input</span>) </span>{
  <span class="hljs-keyword">return</span> input.replace(<span class="hljs-regexp">/[&lt;&gt;"'&amp;]/g</span>, (char) =&gt; {
    <span class="hljs-keyword">const</span> entities = {
      <span class="hljs-string">"&lt;"</span>: <span class="hljs-string">"&amp;lt;"</span>,
      <span class="hljs-string">"&gt;"</span>: <span class="hljs-string">"&amp;gt;"</span>,
      <span class="hljs-string">'"'</span>: <span class="hljs-string">"&amp;quot;"</span>,
      <span class="hljs-string">"'"</span>: <span class="hljs-string">"&amp;#39;"</span>,
      <span class="hljs-string">"&amp;"</span>: <span class="hljs-string">"&amp;amp;"</span>,
    };
    <span class="hljs-keyword">return</span> entities[char];
  });
}

<span class="hljs-keyword">const</span> safeMessage = <span class="hljs-string">`Hello <span class="hljs-subst">${sanitize(userInput)}</span>`</span>;

<span class="hljs-comment">// ❌ Performance issues with large templates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateLargeHTML</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">let</span> html = <span class="hljs-string">""</span>;
  items.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    html += <span class="hljs-string">`&lt;div&gt;<span class="hljs-subst">${item.name}</span>&lt;/div&gt;`</span>; <span class="hljs-comment">// String concatenation in loop</span>
  });
  <span class="hljs-keyword">return</span> html;
}

<span class="hljs-comment">// ✅ Use array join for better performance</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateLargeHTMLFixed</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">return</span> items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-string">`&lt;div&gt;<span class="hljs-subst">${item.name}</span>&lt;/div&gt;`</span>).join(<span class="hljs-string">""</span>);
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-advanced-destructuring">Problem 1: Advanced Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that extracts and transforms data from a complex API response</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processApiResponse</span>(<span class="hljs-params">response</span>) </span>{
  <span class="hljs-comment">// Your implementation here</span>
  <span class="hljs-comment">// Extract: user name, email, first hobby, remaining hobbies, and address city</span>
  <span class="hljs-comment">// Handle cases where data might be missing</span>
  <span class="hljs-comment">// Return an object with: userName, userEmail, primaryHobby, otherHobbies, city</span>
}

<span class="hljs-comment">// Test data:</span>
<span class="hljs-keyword">const</span> apiResponse = {
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">user</span>: {
      <span class="hljs-attr">profile</span>: {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice Johnson"</span>,
        <span class="hljs-attr">contact</span>: {
          <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
          <span class="hljs-attr">phone</span>: <span class="hljs-string">"123-456-7890"</span>,
        },
      },
      <span class="hljs-attr">preferences</span>: {
        <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"reading"</span>, <span class="hljs-string">"swimming"</span>, <span class="hljs-string">"photography"</span>],
        <span class="hljs-attr">settings</span>: {
          <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
        },
      },
      <span class="hljs-attr">location</span>: {
        <span class="hljs-attr">address</span>: {
          <span class="hljs-attr">street</span>: <span class="hljs-string">"123 Main St"</span>,
          <span class="hljs-attr">city</span>: <span class="hljs-string">"New York"</span>,
          <span class="hljs-attr">country</span>: <span class="hljs-string">"USA"</span>,
        },
      },
    },
  },
  <span class="hljs-attr">meta</span>: {
    <span class="hljs-attr">timestamp</span>: <span class="hljs-string">"2023-01-01T00:00:00Z"</span>,
  },
};

<span class="hljs-comment">// Expected output:</span>
<span class="hljs-comment">// {</span>
<span class="hljs-comment">//   userName: 'Alice Johnson',</span>
<span class="hljs-comment">//   userEmail: 'alice@example.com',</span>
<span class="hljs-comment">//   primaryHobby: 'reading',</span>
<span class="hljs-comment">//   otherHobbies: ['swimming', 'photography'],</span>
<span class="hljs-comment">//   city: 'New York'</span>
<span class="hljs-comment">// }</span>
</div></code></pre>
<h3 id="problem-2-class-with-mixins">Problem 2: Class with Mixins</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a Vehicle class system with mixins for different capabilities</span>

<span class="hljs-comment">// Base Vehicle class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Vehicle</span> </span>{
  <span class="hljs-keyword">constructor</span>(make, model, year) {
    <span class="hljs-comment">// Your implementation</span>
  }
}

<span class="hljs-comment">// Mixins</span>
<span class="hljs-keyword">const</span> Drivable = {
  <span class="hljs-comment">// Add methods: start(), stop(), accelerate(speed), brake()</span>
};

<span class="hljs-keyword">const</span> Flyable = {
  <span class="hljs-comment">// Add methods: takeOff(), land(), setAltitude(altitude)</span>
};

<span class="hljs-keyword">const</span> Floatable = {
  <span class="hljs-comment">// Add methods: launch(), dock(), setDepth(depth)</span>
};

<span class="hljs-comment">// Create specific vehicle types:</span>
<span class="hljs-comment">// Car (Drivable)</span>
<span class="hljs-comment">// Airplane (Drivable, Flyable)</span>
<span class="hljs-comment">// Boat (Drivable, Floatable)</span>
<span class="hljs-comment">// AmphibiousVehicle (Drivable, Flyable, Floatable)</span>

<span class="hljs-comment">// Test your implementation:</span>
<span class="hljs-keyword">const</span> car = <span class="hljs-keyword">new</span> Car(<span class="hljs-string">"Toyota"</span>, <span class="hljs-string">"Camry"</span>, <span class="hljs-number">2023</span>);
<span class="hljs-keyword">const</span> plane = <span class="hljs-keyword">new</span> Airplane(<span class="hljs-string">"Boeing"</span>, <span class="hljs-string">"737"</span>, <span class="hljs-number">2022</span>);
<span class="hljs-keyword">const</span> boat = <span class="hljs-keyword">new</span> Boat(<span class="hljs-string">"Yamaha"</span>, <span class="hljs-string">"WaveRunner"</span>, <span class="hljs-number">2023</span>);
<span class="hljs-keyword">const</span> amphibious = <span class="hljs-keyword">new</span> AmphibiousVehicle(<span class="hljs-string">"DUKW"</span>, <span class="hljs-string">"Amphibian"</span>, <span class="hljs-number">1944</span>);

<span class="hljs-comment">// All should work:</span>
car.start();
car.accelerate(<span class="hljs-number">60</span>);

plane.start();
plane.takeOff();
plane.setAltitude(<span class="hljs-number">30000</span>);

boat.launch();
boat.accelerate(<span class="hljs-number">25</span>);

amphibious.start();
amphibious.accelerate(<span class="hljs-number">30</span>);
amphibious.takeOff();
amphibious.launch();
</div></code></pre>
<h3 id="problem-3-module-system">Problem 3: Module System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a plugin system using ES6 modules</span>

<span class="hljs-comment">// plugin-manager.js</span>
<span class="hljs-comment">// Create a PluginManager class that can:</span>
<span class="hljs-comment">// - Register plugins dynamically</span>
<span class="hljs-comment">// - Load plugins from files</span>
<span class="hljs-comment">// - Execute plugin hooks</span>
<span class="hljs-comment">// - Handle plugin dependencies</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PluginManager</span> </span>{
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-comment">// Your implementation</span>
    }

    <span class="hljs-keyword">async</span> loadPlugin(pluginPath) {
        <span class="hljs-comment">// Load plugin from file path</span>
    }

    registerPlugin(name, plugin) {
        <span class="hljs-comment">// Register plugin manually</span>
    }

    executeHook(hookName, ...args) {
        <span class="hljs-comment">// Execute all plugins that have this hook</span>
    }

    getPlugin(name) {
        <span class="hljs-comment">// Get specific plugin</span>
    }
}

<span class="hljs-comment">// Example plugins:</span>
<span class="hljs-comment">// plugins/logger.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'logger'</span>,
    <span class="hljs-attr">hooks</span>: {
        <span class="hljs-attr">beforeRequest</span>: <span class="hljs-function">(<span class="hljs-params">url</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Making request to: <span class="hljs-subst">${url}</span>`</span>),
        <span class="hljs-attr">afterRequest</span>: <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Response status: <span class="hljs-subst">${response.status}</span>`</span>)
    }
};

<span class="hljs-comment">// plugins/cache.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'cache'</span>,
    <span class="hljs-attr">dependencies</span>: [<span class="hljs-string">'logger'</span>],
    <span class="hljs-attr">hooks</span>: {
        <span class="hljs-attr">beforeRequest</span>: <span class="hljs-function">(<span class="hljs-params">url</span>) =&gt;</span> {
            <span class="hljs-comment">// Check cache</span>
        },
        <span class="hljs-attr">afterRequest</span>: <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
            <span class="hljs-comment">// Store in cache</span>
        }
    }
};

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> pm = <span class="hljs-keyword">new</span> PluginManager();
<span class="hljs-keyword">await</span> pm.loadPlugin(<span class="hljs-string">'./plugins/logger.js'</span>);
<span class="hljs-keyword">await</span> pm.loadPlugin(<span class="hljs-string">'./plugins/cache.js'</span>);

pm.executeHook(<span class="hljs-string">'beforeRequest'</span>, <span class="hljs-string">'https://api.example.com/users'</span>);
</div></code></pre>
<h3 id="problem-4-advanced-template-literals">Problem 4: Advanced Template Literals</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a template engine using tagged template literals</span>

<span class="hljs-comment">// Your implementation should support:</span>
<span class="hljs-comment">// - Variable interpolation</span>
<span class="hljs-comment">// - Conditional rendering</span>
<span class="hljs-comment">// - Loop rendering</span>
<span class="hljs-comment">// - Nested templates</span>
<span class="hljs-comment">// - Escaping for security</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">template</span>(<span class="hljs-params">strings, ...values</span>) </span>{
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should handle special syntax like:</span>
    <span class="hljs-comment">// ${if condition}...${endif}</span>
    <span class="hljs-comment">// ${for item in items}...${endfor}</span>
    <span class="hljs-comment">// ${include 'template-name'}</span>
}

<span class="hljs-comment">// Register sub-templates</span>
template.register = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, templateFn</span>) </span>{
    <span class="hljs-comment">// Register named templates</span>
};

<span class="hljs-comment">// Example usage:</span>
<span class="hljs-keyword">const</span> users = [
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Alice'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">'admin'</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span> },
    { <span class="hljs-attr">name</span>: <span class="hljs-string">'Charlie'</span>, <span class="hljs-attr">active</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">role</span>: <span class="hljs-string">'user'</span> }
];

<span class="hljs-keyword">const</span> userListTemplate = template<span class="hljs-string">`
    &lt;div class="user-list"&gt;
        &lt;h2&gt;Users (<span class="hljs-subst">${users.length}</span>)&lt;/h2&gt;
        <span class="hljs-subst">${<span class="hljs-keyword">for</span> user <span class="hljs-keyword">in</span> users}</span>
            &lt;div class="user <span class="hljs-subst">${user.active ? <span class="hljs-string">'active'</span> : <span class="hljs-string">'inactive'</span>}</span>"&gt;
                &lt;h3&gt;<span class="hljs-subst">${user.name}</span>&lt;/h3&gt;
                &lt;p&gt;Role: <span class="hljs-subst">${user.role}</span>&lt;/p&gt;
                <span class="hljs-subst">${<span class="hljs-keyword">if</span> user.role === <span class="hljs-string">'admin'</span>}</span>
                    &lt;span class="badge"&gt;Administrator&lt;/span&gt;
                <span class="hljs-subst">${endif}</span>
            &lt;/div&gt;
        <span class="hljs-subst">${endfor}</span>
    &lt;/div&gt;
`</span>;

<span class="hljs-built_in">console</span>.log(userListTemplate);
</div></code></pre>
<h3 id="problem-5-async-class-with-error-handling">Problem 5: Async Class with Error Handling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a DataService class that handles async operations with proper error handling</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataService</span> </span>{
  <span class="hljs-keyword">constructor</span>(baseUrl, options = {}) {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Should support: timeout, retries, caching, rate limiting</span>
  }

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">get</span>(endpoint, options = {}) {
    <span class="hljs-comment">// GET request with error handling</span>
  }

  <span class="hljs-keyword">async</span> post(endpoint, data, options = {}) {
    <span class="hljs-comment">// POST request with error handling</span>
  }

  <span class="hljs-keyword">async</span> put(endpoint, data, options = {}) {
    <span class="hljs-comment">// PUT request with error handling</span>
  }

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">delete</span>(endpoint, options = {}) {
    <span class="hljs-comment">// DELETE request with error handling</span>
  }

  <span class="hljs-comment">// Private methods for:</span>
  <span class="hljs-comment">// - Retry logic</span>
  <span class="hljs-comment">// - Rate limiting</span>
  <span class="hljs-comment">// - Caching</span>
  <span class="hljs-comment">// - Request/response transformation</span>
}

<span class="hljs-comment">// Usage should support:</span>
<span class="hljs-keyword">const</span> api = <span class="hljs-keyword">new</span> DataService(<span class="hljs-string">"https://api.example.com"</span>, {
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span>,
  <span class="hljs-attr">retries</span>: <span class="hljs-number">3</span>,
  <span class="hljs-attr">cache</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">rateLimit</span>: { <span class="hljs-attr">requests</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">per</span>: <span class="hljs-string">"minute"</span> },
});

<span class="hljs-comment">// All methods should return promises and handle errors gracefully</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> users = <span class="hljs-keyword">await</span> api.get(<span class="hljs-string">"/users"</span>);
  <span class="hljs-keyword">const</span> newUser = <span class="hljs-keyword">await</span> api.post(<span class="hljs-string">"/users"</span>, {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
  });
  <span class="hljs-keyword">const</span> updatedUser = <span class="hljs-keyword">await</span> api.put(<span class="hljs-string">`/users/<span class="hljs-subst">${newUser.id}</span>`</span>, {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice Smith"</span>,
  });
  <span class="hljs-keyword">await</span> api.delete(<span class="hljs-string">`/users/<span class="hljs-subst">${newUser.id}</span>`</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"API operation failed:"</span>, error);
}
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between <code>let</code>, <code>const</code>, and <code>var</code>?</strong></p>
<ul>
<li><code>var</code>: Function-scoped, hoisted, can be redeclared</li>
<li><code>let</code>: Block-scoped, hoisted but in temporal dead zone, cannot be redeclared</li>
<li><code>const</code>: Block-scoped, hoisted but in temporal dead zone, cannot be reassigned or redeclared</li>
</ul>
<p><strong>Q: When should you use arrow functions vs regular functions?</strong></p>
<ul>
<li>Arrow functions: Callbacks, array methods, when you want lexical <code>this</code></li>
<li>Regular functions: Object methods, constructors, when you need dynamic <code>this</code></li>
</ul>
<p><strong>Q: What are the benefits of destructuring?</strong></p>
<ul>
<li>Cleaner code, easier data extraction, default values, swapping variables</li>
<li>Reduces repetitive property access, makes function parameters more readable</li>
</ul>
<p><strong>Q: How do ES6 modules differ from CommonJS?</strong></p>
<ul>
<li>ES6: Static analysis, tree shaking, top-level await, import/export syntax</li>
<li>CommonJS: Dynamic loading, require/module.exports, synchronous</li>
</ul>
<p><strong>Q: What are the advantages of ES6 classes over function constructors?</strong></p>
<ul>
<li>Cleaner syntax, built-in inheritance with <code>extends</code>, static methods, private fields</li>
<li>Better error messages, no accidental function calls without <code>new</code></li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement a module bundler that handles ES6 imports&quot;</li>
<li><strong>Facebook</strong>: &quot;Create a React-like component system using ES6 classes&quot;</li>
<li><strong>Amazon</strong>: &quot;Design a plugin architecture using ES6 modules and dynamic imports&quot;</li>
<li><strong>Microsoft</strong>: &quot;Implement a template engine using tagged template literals&quot;</li>
<li><strong>Netflix</strong>: &quot;Create a data fetching library with classes and async/await&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Arrow functions</strong> - Great for callbacks and when you need lexical <code>this</code></li>
<li><strong>Template literals</strong> - Much cleaner than string concatenation</li>
<li><strong>Destructuring</strong> - Powerful way to extract data from arrays and objects</li>
<li><strong>Spread/Rest</strong> - Flexible operators for arrays, objects, and function parameters</li>
<li><strong>Modules</strong> - Proper way to organize and share code</li>
<li><strong>Classes</strong> - Clean syntax for object-oriented programming</li>
<li><strong>Enhanced object literals</strong> - Shorthand properties and computed names</li>
<li><strong>Default parameters</strong> - Cleaner function definitions</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./11-error-handling.md">← Error Handling &amp; Debugging</a><br>
<strong>Next Chapter</strong>: <a href="./13-dom-manipulation.md">DOM Manipulation →</a></p>
<p><strong>Practice</strong>: Try the ES6+ problems and experiment with modern JavaScript features!</p>
<h1 id="%F0%9F%93%9A-chapter-13-dom-manipulation">📚 Chapter 13: DOM Manipulation</h1>
<blockquote>
<p>Master the art of dynamically controlling web page content and user interactions.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>DOM manipulation is like being a stage director for a theater production:</p>
<ul>
<li><strong>Selecting elements</strong> = finding specific actors on stage</li>
<li><strong>Changing content</strong> = giving actors new lines to say</li>
<li><strong>Modifying styles</strong> = changing costumes and lighting</li>
<li><strong>Adding/removing elements</strong> = bringing actors on/off stage</li>
<li><strong>Event handling</strong> = responding to audience reactions</li>
<li><strong>Animation</strong> = choreographing smooth movements</li>
</ul>
<p>The DOM (Document Object Model) is the browser's representation of your HTML page as a tree of objects that JavaScript can manipulate.</p>
<h2 id="%F0%9F%8E%AF-selecting-elements">🎯 Selecting Elements</h2>
<h3 id="basic-selection-methods">Basic Selection Methods</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// By ID (returns single element or null)</span>
<span class="hljs-keyword">const</span> header = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"main-header"</span>);
<span class="hljs-keyword">const</span> loginForm = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"login-form"</span>);

<span class="hljs-comment">// By class name (returns HTMLCollection - array-like)</span>
<span class="hljs-keyword">const</span> buttons = <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"btn"</span>);
<span class="hljs-keyword">const</span> cards = <span class="hljs-built_in">document</span>.getElementsByClassName(<span class="hljs-string">"card"</span>);

<span class="hljs-comment">// By tag name (returns HTMLCollection)</span>
<span class="hljs-keyword">const</span> paragraphs = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"p"</span>);
<span class="hljs-keyword">const</span> images = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"img"</span>);

<span class="hljs-comment">// By name attribute (returns NodeList)</span>
<span class="hljs-keyword">const</span> radioButtons = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">"gender"</span>);
<span class="hljs-keyword">const</span> checkboxes = <span class="hljs-built_in">document</span>.getElementsByName(<span class="hljs-string">"interests"</span>);

<span class="hljs-comment">// Modern selectors (CSS-style)</span>
<span class="hljs-keyword">const</span> firstButton = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".btn"</span>); <span class="hljs-comment">// First match</span>
<span class="hljs-keyword">const</span> allButtons = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".btn"</span>); <span class="hljs-comment">// All matches (NodeList)</span>
<span class="hljs-keyword">const</span> specificButton = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#submit-btn"</span>); <span class="hljs-comment">// By ID</span>
<span class="hljs-keyword">const</span> nestedElement = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".container .card .title"</span>);

<span class="hljs-comment">// Advanced CSS selectors</span>
<span class="hljs-keyword">const</span> evenRows = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"tr:nth-child(even)"</span>);
<span class="hljs-keyword">const</span> firstChild = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".menu &gt; li:first-child"</span>);
<span class="hljs-keyword">const</span> lastInput = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"input:last-of-type"</span>);
<span class="hljs-keyword">const</span> checkedBoxes = <span class="hljs-built_in">document</span>.querySelectorAll(
  <span class="hljs-string">'input[type="checkbox"]:checked'</span>
);
<span class="hljs-keyword">const</span> externalLinks = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'a[href^="http"]'</span>);

<span class="hljs-comment">// Attribute selectors</span>
<span class="hljs-keyword">const</span> requiredFields = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"input[required]"</span>);
<span class="hljs-keyword">const</span> dataElements = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'[data-category="electronics"]'</span>);
<span class="hljs-keyword">const</span> partialMatch = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'[class*="btn"]'</span>);
</div></code></pre>
<h3 id="element-relationships-and-navigation">Element Relationships and Navigation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Parent/child relationships</span>
<span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".target"</span>);

<span class="hljs-comment">// Parent navigation</span>
<span class="hljs-keyword">const</span> parent = element.parentElement; <span class="hljs-comment">// Direct parent</span>
<span class="hljs-keyword">const</span> parentNode = element.parentNode; <span class="hljs-comment">// Parent node (includes text nodes)</span>
<span class="hljs-keyword">const</span> closestContainer = element.closest(<span class="hljs-string">".container"</span>); <span class="hljs-comment">// Nearest ancestor matching selector</span>

<span class="hljs-comment">// Child navigation</span>
<span class="hljs-keyword">const</span> children = element.children; <span class="hljs-comment">// HTMLCollection of child elements</span>
<span class="hljs-keyword">const</span> childNodes = element.childNodes; <span class="hljs-comment">// NodeList including text nodes</span>
<span class="hljs-keyword">const</span> firstChild = element.firstElementChild; <span class="hljs-comment">// First child element</span>
<span class="hljs-keyword">const</span> lastChild = element.lastElementChild; <span class="hljs-comment">// Last child element</span>

<span class="hljs-comment">// Sibling navigation</span>
<span class="hljs-keyword">const</span> nextSibling = element.nextElementSibling; <span class="hljs-comment">// Next sibling element</span>
<span class="hljs-keyword">const</span> prevSibling = element.previousElementSibling; <span class="hljs-comment">// Previous sibling element</span>
<span class="hljs-keyword">const</span> allSiblings = <span class="hljs-built_in">Array</span>.from(element.parentElement.children).filter(
  <span class="hljs-function">(<span class="hljs-params">child</span>) =&gt;</span> child !== element
);

<span class="hljs-comment">// Practical examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">highlightSiblings</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">const</span> siblings = <span class="hljs-built_in">Array</span>.from(element.parentElement.children);
  siblings.forEach(<span class="hljs-function">(<span class="hljs-params">sibling</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (sibling !== element) {
      sibling.classList.add(<span class="hljs-string">"highlighted"</span>);
    }
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">findFormContainer</span>(<span class="hljs-params">inputElement</span>) </span>{
  <span class="hljs-keyword">return</span> (
    inputElement.closest(<span class="hljs-string">"form"</span>) || inputElement.closest(<span class="hljs-string">".form-container"</span>)
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getTableRow</span>(<span class="hljs-params">cellElement</span>) </span>{
  <span class="hljs-keyword">return</span> cellElement.closest(<span class="hljs-string">"tr"</span>);
}

<span class="hljs-comment">// Walking the DOM tree</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">walkDOM</span>(<span class="hljs-params">node, callback</span>) </span>{
  callback(node);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> child <span class="hljs-keyword">of</span> node.children) {
    walkDOM(child, callback);
  }
}

<span class="hljs-comment">// Usage: Find all elements with specific data attribute</span>
walkDOM(<span class="hljs-built_in">document</span>.body, (element) =&gt; {
  <span class="hljs-keyword">if</span> (element.dataset &amp;&amp; element.dataset.trackable) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Trackable element:"</span>, element);
  }
});
</div></code></pre>
<h3 id="modern-selection-patterns">Modern Selection Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Utility functions for common selections</span>
<span class="hljs-keyword">const</span> $ = <span class="hljs-function">(<span class="hljs-params">selector</span>) =&gt;</span> <span class="hljs-built_in">document</span>.querySelector(selector);
<span class="hljs-keyword">const</span> $$ = <span class="hljs-function">(<span class="hljs-params">selector</span>) =&gt;</span> <span class="hljs-built_in">document</span>.querySelectorAll(selector);

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> header = $(<span class="hljs-string">"#main-header"</span>);
<span class="hljs-keyword">const</span> buttons = $$(<span class="hljs-string">".btn"</span>);

<span class="hljs-comment">// Converting NodeList to Array for array methods</span>
<span class="hljs-keyword">const</span> buttonArray = <span class="hljs-built_in">Array</span>.from($$(<span class="hljs-string">".btn"</span>));
<span class="hljs-keyword">const</span> activeButtons = [...$$(<span class="hljs-string">".btn"</span>)].filter(<span class="hljs-function">(<span class="hljs-params">btn</span>) =&gt;</span> !btn.disabled);

<span class="hljs-comment">// Chaining selections</span>
<span class="hljs-keyword">const</span> menuItems = <span class="hljs-built_in">Array</span>.from($(<span class="hljs-string">".navigation"</span>).children)
  .filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.tagName === <span class="hljs-string">"LI"</span>)
  .map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.querySelector(<span class="hljs-string">"a"</span>))
  .filter(<span class="hljs-function">(<span class="hljs-params">link</span>) =&gt;</span> link !== <span class="hljs-literal">null</span>);

<span class="hljs-comment">// Conditional selection</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getElement</span>(<span class="hljs-params">selector, fallback = null</span>) </span>{
  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(selector);
  <span class="hljs-keyword">return</span> element || (fallback &amp;&amp; <span class="hljs-built_in">document</span>.querySelector(fallback));
}

<span class="hljs-keyword">const</span> mainContent = getElement(<span class="hljs-string">"#main-content"</span>, <span class="hljs-string">".content"</span>);

<span class="hljs-comment">// Selection with error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeSelect</span>(<span class="hljs-params">selector</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> elements = <span class="hljs-built_in">document</span>.querySelectorAll(selector);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.from(elements);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Invalid selector:"</span>, selector, error);
    <span class="hljs-keyword">return</span> [];
  }
}

<span class="hljs-comment">// Scoped selection (within a container)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">selectWithin</span>(<span class="hljs-params">container, selector</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> container === <span class="hljs-string">"string"</span>) {
    container = <span class="hljs-built_in">document</span>.querySelector(container);
  }

  <span class="hljs-keyword">return</span> container ? <span class="hljs-built_in">Array</span>.from(container.querySelectorAll(selector)) : [];
}

<span class="hljs-keyword">const</span> formInputs = selectWithin(<span class="hljs-string">"#user-form"</span>, <span class="hljs-string">"input, select, textarea"</span>);
<span class="hljs-keyword">const</span> cardButtons = selectWithin(<span class="hljs-string">".card-container"</span>, <span class="hljs-string">".btn"</span>);
</div></code></pre>
<h2 id="%F0%9F%93%9D-content-manipulation">📝 Content Manipulation</h2>
<h3 id="text-content">Text Content</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Getting and setting text content</span>
<span class="hljs-keyword">const</span> heading = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"h1"</span>);

<span class="hljs-comment">// textContent - gets/sets text only (no HTML)</span>
<span class="hljs-built_in">console</span>.log(heading.textContent); <span class="hljs-comment">// "Welcome to Our Site"</span>
heading.textContent = <span class="hljs-string">"New Heading"</span>; <span class="hljs-comment">// Safe - no HTML injection</span>

<span class="hljs-comment">// innerText - respects styling (hidden elements ignored)</span>
<span class="hljs-built_in">console</span>.log(heading.innerText); <span class="hljs-comment">// Visible text only</span>
heading.innerText = <span class="hljs-string">"Styled Heading"</span>;

<span class="hljs-comment">// innerHTML - gets/sets HTML content (dangerous with user input)</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".content"</span>);
<span class="hljs-built_in">console</span>.log(container.innerHTML); <span class="hljs-comment">// "&lt;p&gt;Hello &lt;strong&gt;World&lt;/strong&gt;&lt;/p&gt;"</span>
container.innerHTML = <span class="hljs-string">"&lt;p&gt;New &lt;em&gt;content&lt;/em&gt;&lt;/p&gt;"</span>;

<span class="hljs-comment">// Safe HTML insertion</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeSetHTML</span>(<span class="hljs-params">element, htmlString</span>) </span>{
  <span class="hljs-comment">// Create a temporary element to parse HTML</span>
  <span class="hljs-keyword">const</span> temp = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  temp.innerHTML = htmlString;

  <span class="hljs-comment">// Clear existing content</span>
  element.innerHTML = <span class="hljs-string">""</span>;

  <span class="hljs-comment">// Move parsed nodes to target element</span>
  <span class="hljs-keyword">while</span> (temp.firstChild) {
    element.appendChild(temp.firstChild);
  }
}

<span class="hljs-comment">// Text manipulation utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">appendText</span>(<span class="hljs-params">element, text</span>) </span>{
  element.textContent += text;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">prependText</span>(<span class="hljs-params">element, text</span>) </span>{
  element.textContent = text + element.textContent;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceText</span>(<span class="hljs-params">element, oldText, newText</span>) </span>{
  element.textContent = element.textContent.replace(oldText, newText);
}

<span class="hljs-comment">// Practical examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateCounter</span>(<span class="hljs-params">element, count</span>) </span>{
  element.textContent = <span class="hljs-string">`Count: <span class="hljs-subst">${count}</span>`</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formatPrice</span>(<span class="hljs-params">element, price</span>) </span>{
  element.textContent = <span class="hljs-string">`$<span class="hljs-subst">${price.toFixed(<span class="hljs-number">2</span>)}</span>`</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">truncateText</span>(<span class="hljs-params">element, maxLength</span>) </span>{
  <span class="hljs-keyword">const</span> text = element.textContent;
  <span class="hljs-keyword">if</span> (text.length &gt; maxLength) {
    element.textContent = text.substring(<span class="hljs-number">0</span>, maxLength) + <span class="hljs-string">"..."</span>;
    element.title = text; <span class="hljs-comment">// Show full text on hover</span>
  }
}

<span class="hljs-comment">// Dynamic content updates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateStatus</span>(<span class="hljs-params">statusElement, status, message</span>) </span>{
  statusElement.textContent = message;
  statusElement.className = <span class="hljs-string">`status status-<span class="hljs-subst">${status}</span>`</span>;
}

<span class="hljs-comment">// Usage</span>
updateStatus($(<span class="hljs-string">".status"</span>), <span class="hljs-string">"success"</span>, <span class="hljs-string">"Operation completed successfully!"</span>);
updateStatus($(<span class="hljs-string">".status"</span>), <span class="hljs-string">"error"</span>, <span class="hljs-string">"Something went wrong."</span>);
</div></code></pre>
<h3 id="html-content-and-templates">HTML Content and Templates</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Template-based content creation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createUserCard</span>(<span class="hljs-params">user</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`
        &lt;div class="user-card" data-user-id="<span class="hljs-subst">${user.id}</span>"&gt;
            &lt;img src="<span class="hljs-subst">${user.avatar}</span>" alt="<span class="hljs-subst">${user.name}</span>" class="avatar"&gt;
            &lt;h3 class="name"&gt;<span class="hljs-subst">${user.name}</span>&lt;/h3&gt;
            &lt;p class="email"&gt;<span class="hljs-subst">${user.email}</span>&lt;/p&gt;
            &lt;div class="actions"&gt;
                &lt;button class="btn btn-primary" onclick="editUser(<span class="hljs-subst">${user.id}</span>)"&gt;
                    Edit
                &lt;/button&gt;
                &lt;button class="btn btn-danger" onclick="deleteUser(<span class="hljs-subst">${user.id}</span>)"&gt;
                    Delete
                &lt;/button&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    `</span>;
}

<span class="hljs-comment">// Safe template rendering</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderTemplate</span>(<span class="hljs-params">container, template, data</span>) </span>{
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> container === <span class="hljs-string">"string"</span>) {
    container = <span class="hljs-built_in">document</span>.querySelector(container);
  }

  <span class="hljs-keyword">const</span> html = <span class="hljs-keyword">typeof</span> template === <span class="hljs-string">"function"</span> ? template(data) : template;
  container.innerHTML = html;
}

<span class="hljs-comment">// List rendering</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderUserList</span>(<span class="hljs-params">users</span>) </span>{
  <span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#user-list"</span>);
  <span class="hljs-keyword">const</span> html = users.map(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> createUserCard(user)).join(<span class="hljs-string">""</span>);
  container.innerHTML = html;
}

<span class="hljs-comment">// Conditional rendering</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">renderContent</span>(<span class="hljs-params">container, data</span>) </span>{
  <span class="hljs-keyword">if</span> (!data || data.length === <span class="hljs-number">0</span>) {
    container.innerHTML = <span class="hljs-string">'&lt;p class="empty-state"&gt;No data available&lt;/p&gt;'</span>;
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">const</span> html = data.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> createItemTemplate(item)).join(<span class="hljs-string">""</span>);
  container.innerHTML = html;
}

<span class="hljs-comment">// Template with escaping for security</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">escapeHtml</span>(<span class="hljs-params">text</span>) </span>{
  <span class="hljs-keyword">const</span> div = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  div.textContent = text;
  <span class="hljs-keyword">return</span> div.innerHTML;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSafeUserCard</span>(<span class="hljs-params">user</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`
        &lt;div class="user-card"&gt;
            &lt;h3&gt;<span class="hljs-subst">${escapeHtml(user.name)}</span>&lt;/h3&gt;
            &lt;p&gt;<span class="hljs-subst">${escapeHtml(user.email)}</span>&lt;/p&gt;
            &lt;p&gt;<span class="hljs-subst">${escapeHtml(user.bio)}</span>&lt;/p&gt;
        &lt;/div&gt;
    `</span>;
}

<span class="hljs-comment">// Using HTML templates (modern approach)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElementFromTemplate</span>(<span class="hljs-params">templateId, data</span>) </span>{
  <span class="hljs-keyword">const</span> template = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">`#<span class="hljs-subst">${templateId}</span>`</span>);
  <span class="hljs-keyword">const</span> clone = template.content.cloneNode(<span class="hljs-literal">true</span>);

  <span class="hljs-comment">// Fill in data</span>
  <span class="hljs-built_in">Object</span>.keys(data).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> element = clone.querySelector(<span class="hljs-string">`[data-field="<span class="hljs-subst">${key}</span>"]`</span>);
    <span class="hljs-keyword">if</span> (element) {
      element.textContent = data[key];
    }
  });

  <span class="hljs-keyword">return</span> clone;
}

<span class="hljs-comment">// HTML template in the document:</span>
<span class="hljs-comment">// &lt;template id="user-template"&gt;</span>
<span class="hljs-comment">//     &lt;div class="user-card"&gt;</span>
<span class="hljs-comment">//         &lt;h3 data-field="name"&gt;&lt;/h3&gt;</span>
<span class="hljs-comment">//         &lt;p data-field="email"&gt;&lt;/p&gt;</span>
<span class="hljs-comment">//     &lt;/div&gt;</span>
<span class="hljs-comment">// &lt;/template&gt;</span>

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> userElement = createElementFromTemplate(<span class="hljs-string">"user-template"</span>, {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span>,
});

<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#container"</span>).appendChild(userElement);
</div></code></pre>
<h2 id="%F0%9F%8E%A8-style-manipulation">🎨 Style Manipulation</h2>
<h3 id="css-classes">CSS Classes</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".target"</span>);

<span class="hljs-comment">// Class manipulation methods</span>
element.classList.add(<span class="hljs-string">"active"</span>); <span class="hljs-comment">// Add class</span>
element.classList.remove(<span class="hljs-string">"hidden"</span>); <span class="hljs-comment">// Remove class</span>
element.classList.toggle(<span class="hljs-string">"expanded"</span>); <span class="hljs-comment">// Toggle class</span>
element.classList.replace(<span class="hljs-string">"old"</span>, <span class="hljs-string">"new"</span>); <span class="hljs-comment">// Replace class</span>

<span class="hljs-comment">// Check if class exists</span>
<span class="hljs-keyword">if</span> (element.classList.contains(<span class="hljs-string">"active"</span>)) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Element is active"</span>);
}

<span class="hljs-comment">// Multiple classes</span>
element.classList.add(<span class="hljs-string">"class1"</span>, <span class="hljs-string">"class2"</span>, <span class="hljs-string">"class3"</span>);
element.classList.remove(<span class="hljs-string">"class1"</span>, <span class="hljs-string">"class2"</span>);

<span class="hljs-comment">// Conditional class manipulation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setActiveState</span>(<span class="hljs-params">element, isActive</span>) </span>{
  element.classList.toggle(<span class="hljs-string">"active"</span>, isActive);
  element.classList.toggle(<span class="hljs-string">"inactive"</span>, !isActive);
}

<span class="hljs-comment">// Class utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasAnyClass</span>(<span class="hljs-params">element, classes</span>) </span>{
  <span class="hljs-keyword">return</span> classes.some(<span class="hljs-function">(<span class="hljs-params">className</span>) =&gt;</span> element.classList.contains(className));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasAllClasses</span>(<span class="hljs-params">element, classes</span>) </span>{
  <span class="hljs-keyword">return</span> classes.every(<span class="hljs-function">(<span class="hljs-params">className</span>) =&gt;</span> element.classList.contains(className));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceClasses</span>(<span class="hljs-params">element, oldClasses, newClasses</span>) </span>{
  oldClasses.forEach(<span class="hljs-function">(<span class="hljs-params">cls</span>) =&gt;</span> element.classList.remove(cls));
  newClasses.forEach(<span class="hljs-function">(<span class="hljs-params">cls</span>) =&gt;</span> element.classList.add(cls));
}

<span class="hljs-comment">// State management with classes</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ElementState</span> </span>{
  <span class="hljs-keyword">constructor</span>(element) {
    <span class="hljs-keyword">this</span>.element = element;
    <span class="hljs-keyword">this</span>.states = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();
  }

  setState(state, active = <span class="hljs-literal">true</span>) {
    <span class="hljs-keyword">if</span> (active) {
      <span class="hljs-keyword">this</span>.states.add(state);
      <span class="hljs-keyword">this</span>.element.classList.add(<span class="hljs-string">`state-<span class="hljs-subst">${state}</span>`</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.states.delete(state);
      <span class="hljs-keyword">this</span>.element.classList.remove(<span class="hljs-string">`state-<span class="hljs-subst">${state}</span>`</span>);
    }
  }

  hasState(state) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.states.has(state);
  }

  clearStates() {
    <span class="hljs-keyword">this</span>.states.forEach(<span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.element.classList.remove(<span class="hljs-string">`state-<span class="hljs-subst">${state}</span>`</span>);
    });
    <span class="hljs-keyword">this</span>.states.clear();
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> buttonState = <span class="hljs-keyword">new</span> ElementState(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-button"</span>));
buttonState.setState(<span class="hljs-string">"loading"</span>, <span class="hljs-literal">true</span>);
buttonState.setState(<span class="hljs-string">"disabled"</span>, <span class="hljs-literal">true</span>);

<span class="hljs-comment">// Practical examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showElement</span>(<span class="hljs-params">element</span>) </span>{
  element.classList.remove(<span class="hljs-string">"hidden"</span>, <span class="hljs-string">"fade-out"</span>);
  element.classList.add(<span class="hljs-string">"visible"</span>, <span class="hljs-string">"fade-in"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideElement</span>(<span class="hljs-params">element</span>) </span>{
  element.classList.remove(<span class="hljs-string">"visible"</span>, <span class="hljs-string">"fade-in"</span>);
  element.classList.add(<span class="hljs-string">"hidden"</span>, <span class="hljs-string">"fade-out"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setLoadingState</span>(<span class="hljs-params">button, isLoading</span>) </span>{
  button.classList.toggle(<span class="hljs-string">"loading"</span>, isLoading);
  button.disabled = isLoading;

  <span class="hljs-keyword">const</span> text = button.querySelector(<span class="hljs-string">".text"</span>);
  <span class="hljs-keyword">const</span> spinner = button.querySelector(<span class="hljs-string">".spinner"</span>);

  <span class="hljs-keyword">if</span> (isLoading) {
    text.style.display = <span class="hljs-string">"none"</span>;
    spinner.style.display = <span class="hljs-string">"inline-block"</span>;
  } <span class="hljs-keyword">else</span> {
    text.style.display = <span class="hljs-string">"inline-block"</span>;
    spinner.style.display = <span class="hljs-string">"none"</span>;
  }
}
</div></code></pre>
<h3 id="inline-styles">Inline Styles</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".target"</span>);

<span class="hljs-comment">// Setting individual styles</span>
element.style.color = <span class="hljs-string">"red"</span>;
element.style.backgroundColor = <span class="hljs-string">"blue"</span>;
element.style.fontSize = <span class="hljs-string">"16px"</span>;
element.style.marginTop = <span class="hljs-string">"10px"</span>;

<span class="hljs-comment">// CSS property names (camelCase)</span>
element.style.borderRadius = <span class="hljs-string">"5px"</span>;
element.style.textAlign = <span class="hljs-string">"center"</span>;
element.style.zIndex = <span class="hljs-string">"1000"</span>;

<span class="hljs-comment">// Setting multiple styles</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setStyles</span>(<span class="hljs-params">element, styles</span>) </span>{
  <span class="hljs-built_in">Object</span>.assign(element.style, styles);
}

<span class="hljs-comment">// Usage</span>
setStyles(element, {
  <span class="hljs-attr">color</span>: <span class="hljs-string">"white"</span>,
  <span class="hljs-attr">backgroundColor</span>: <span class="hljs-string">"navy"</span>,
  <span class="hljs-attr">padding</span>: <span class="hljs-string">"10px"</span>,
  <span class="hljs-attr">borderRadius</span>: <span class="hljs-string">"5px"</span>,
});

<span class="hljs-comment">// CSS custom properties (CSS variables)</span>
element.style.setProperty(<span class="hljs-string">"--primary-color"</span>, <span class="hljs-string">"#007bff"</span>);
element.style.setProperty(<span class="hljs-string">"--border-width"</span>, <span class="hljs-string">"2px"</span>);

<span class="hljs-comment">// Getting computed styles</span>
<span class="hljs-keyword">const</span> computedStyle = <span class="hljs-built_in">window</span>.getComputedStyle(element);
<span class="hljs-keyword">const</span> color = computedStyle.getPropertyValue(<span class="hljs-string">"color"</span>);
<span class="hljs-keyword">const</span> fontSize = computedStyle.fontSize;

<span class="hljs-comment">// Style utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNumericStyle</span>(<span class="hljs-params">element, property</span>) </span>{
  <span class="hljs-keyword">const</span> value = <span class="hljs-built_in">window</span>.getComputedStyle(element).getPropertyValue(property);
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(value) || <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setOpacity</span>(<span class="hljs-params">element, opacity</span>) </span>{
  element.style.opacity = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, <span class="hljs-built_in">Math</span>.min(<span class="hljs-number">1</span>, opacity));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fadeIn</span>(<span class="hljs-params">element, duration = <span class="hljs-number">300</span></span>) </span>{
  element.style.opacity = <span class="hljs-string">"0"</span>;
  element.style.display = <span class="hljs-string">"block"</span>;

  <span class="hljs-keyword">const</span> start = performance.now();

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animate</span>(<span class="hljs-params">currentTime</span>) </span>{
    <span class="hljs-keyword">const</span> elapsed = currentTime - start;
    <span class="hljs-keyword">const</span> progress = <span class="hljs-built_in">Math</span>.min(elapsed / duration, <span class="hljs-number">1</span>);

    element.style.opacity = progress;

    <span class="hljs-keyword">if</span> (progress &lt; <span class="hljs-number">1</span>) {
      requestAnimationFrame(animate);
    }
  }

  requestAnimationFrame(animate);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fadeOut</span>(<span class="hljs-params">element, duration = <span class="hljs-number">300</span></span>) </span>{
  <span class="hljs-keyword">const</span> start = performance.now();
  <span class="hljs-keyword">const</span> startOpacity = <span class="hljs-built_in">parseFloat</span>(element.style.opacity) || <span class="hljs-number">1</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animate</span>(<span class="hljs-params">currentTime</span>) </span>{
    <span class="hljs-keyword">const</span> elapsed = currentTime - start;
    <span class="hljs-keyword">const</span> progress = <span class="hljs-built_in">Math</span>.min(elapsed / duration, <span class="hljs-number">1</span>);

    element.style.opacity = startOpacity * (<span class="hljs-number">1</span> - progress);

    <span class="hljs-keyword">if</span> (progress &gt;= <span class="hljs-number">1</span>) {
      element.style.display = <span class="hljs-string">"none"</span>;
    } <span class="hljs-keyword">else</span> {
      requestAnimationFrame(animate);
    }
  }

  requestAnimationFrame(animate);
}

<span class="hljs-comment">// Responsive style adjustments</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">adjustForScreenSize</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">const</span> width = <span class="hljs-built_in">window</span>.innerWidth;

  <span class="hljs-keyword">if</span> (width &lt; <span class="hljs-number">768</span>) {
    setStyles(element, {
      <span class="hljs-attr">fontSize</span>: <span class="hljs-string">"14px"</span>,
      <span class="hljs-attr">padding</span>: <span class="hljs-string">"5px"</span>,
    });
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (width &lt; <span class="hljs-number">1024</span>) {
    setStyles(element, {
      <span class="hljs-attr">fontSize</span>: <span class="hljs-string">"16px"</span>,
      <span class="hljs-attr">padding</span>: <span class="hljs-string">"10px"</span>,
    });
  } <span class="hljs-keyword">else</span> {
    setStyles(element, {
      <span class="hljs-attr">fontSize</span>: <span class="hljs-string">"18px"</span>,
      <span class="hljs-attr">padding</span>: <span class="hljs-string">"15px"</span>,
    });
  }
}

<span class="hljs-comment">// Theme switching</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">applyTheme</span>(<span class="hljs-params">themeName</span>) </span>{
  <span class="hljs-keyword">const</span> themes = {
    <span class="hljs-attr">light</span>: {
      <span class="hljs-string">"--bg-color"</span>: <span class="hljs-string">"#ffffff"</span>,
      <span class="hljs-string">"--text-color"</span>: <span class="hljs-string">"#333333"</span>,
      <span class="hljs-string">"--border-color"</span>: <span class="hljs-string">"#cccccc"</span>,
    },
    <span class="hljs-attr">dark</span>: {
      <span class="hljs-string">"--bg-color"</span>: <span class="hljs-string">"#333333"</span>,
      <span class="hljs-string">"--text-color"</span>: <span class="hljs-string">"#ffffff"</span>,
      <span class="hljs-string">"--border-color"</span>: <span class="hljs-string">"#555555"</span>,
    },
  };

  <span class="hljs-keyword">const</span> theme = themes[themeName];
  <span class="hljs-keyword">if</span> (theme) {
    <span class="hljs-built_in">Object</span>.entries(theme).forEach(<span class="hljs-function">(<span class="hljs-params">[property, value]</span>) =&gt;</span> {
      <span class="hljs-built_in">document</span>.documentElement.style.setProperty(property, value);
    });
  }
}
</div></code></pre>
<h2 id="%F0%9F%8F%97%EF%B8%8F-creating-and-modifying-elements">🏗️ Creating and Modifying Elements</h2>
<h3 id="creating-elements">Creating Elements</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic element creation</span>
<span class="hljs-keyword">const</span> div = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
<span class="hljs-keyword">const</span> paragraph = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"p"</span>);
<span class="hljs-keyword">const</span> button = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"button"</span>);
<span class="hljs-keyword">const</span> image = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"img"</span>);

<span class="hljs-comment">// Setting attributes and content</span>
div.className = <span class="hljs-string">"container"</span>;
div.id = <span class="hljs-string">"main-container"</span>;
paragraph.textContent = <span class="hljs-string">"Hello, World!"</span>;
button.textContent = <span class="hljs-string">"Click me"</span>;
button.type = <span class="hljs-string">"button"</span>;
image.src = <span class="hljs-string">"image.jpg"</span>;
image.alt = <span class="hljs-string">"Description"</span>;

<span class="hljs-comment">// Creating complex elements</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createElement</span>(<span class="hljs-params">tag, attributes = {}, children = []</span>) </span>{
  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(tag);

  <span class="hljs-comment">// Set attributes</span>
  <span class="hljs-built_in">Object</span>.entries(attributes).forEach(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"className"</span>) {
      element.className = value;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"textContent"</span>) {
      element.textContent = value;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"innerHTML"</span>) {
      element.innerHTML = value;
    } <span class="hljs-keyword">else</span> {
      element.setAttribute(key, value);
    }
  });

  <span class="hljs-comment">// Add children</span>
  children.forEach(<span class="hljs-function">(<span class="hljs-params">child</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> child === <span class="hljs-string">"string"</span>) {
      element.appendChild(<span class="hljs-built_in">document</span>.createTextNode(child));
    } <span class="hljs-keyword">else</span> {
      element.appendChild(child);
    }
  });

  <span class="hljs-keyword">return</span> element;
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> card = createElement(
  <span class="hljs-string">"div"</span>,
  {
    <span class="hljs-attr">className</span>: <span class="hljs-string">"card"</span>,
    <span class="hljs-string">"data-id"</span>: <span class="hljs-string">"123"</span>,
  },
  [
    createElement(<span class="hljs-string">"h3"</span>, { <span class="hljs-attr">textContent</span>: <span class="hljs-string">"Card Title"</span> }),
    createElement(<span class="hljs-string">"p"</span>, { <span class="hljs-attr">textContent</span>: <span class="hljs-string">"Card description"</span> }),
    createElement(<span class="hljs-string">"button"</span>, {
      <span class="hljs-attr">className</span>: <span class="hljs-string">"btn btn-primary"</span>,
      <span class="hljs-attr">textContent</span>: <span class="hljs-string">"Action"</span>,
    }),
  ]
);

<span class="hljs-comment">// Factory functions for common elements</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createButton</span>(<span class="hljs-params">text, className = <span class="hljs-string">"btn"</span>, onClick = null</span>) </span>{
  <span class="hljs-keyword">const</span> button = createElement(<span class="hljs-string">"button"</span>, {
    className,
    <span class="hljs-attr">textContent</span>: text,
    <span class="hljs-attr">type</span>: <span class="hljs-string">"button"</span>,
  });

  <span class="hljs-keyword">if</span> (onClick) {
    button.addEventListener(<span class="hljs-string">"click"</span>, onClick);
  }

  <span class="hljs-keyword">return</span> button;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createInput</span>(<span class="hljs-params">type, name, placeholder = <span class="hljs-string">""</span></span>) </span>{
  <span class="hljs-keyword">return</span> createElement(<span class="hljs-string">"input"</span>, {
    type,
    name,
    placeholder,
    <span class="hljs-attr">className</span>: <span class="hljs-string">"form-control"</span>,
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createSelect</span>(<span class="hljs-params">name, options = []</span>) </span>{
  <span class="hljs-keyword">const</span> select = createElement(<span class="hljs-string">"select"</span>, {
    name,
    <span class="hljs-attr">className</span>: <span class="hljs-string">"form-control"</span>,
  });

  options.forEach(<span class="hljs-function">(<span class="hljs-params">option</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> optionElement = createElement(<span class="hljs-string">"option"</span>, {
      <span class="hljs-attr">value</span>: option.value,
      <span class="hljs-attr">textContent</span>: option.text,
    });
    select.appendChild(optionElement);
  });

  <span class="hljs-keyword">return</span> select;
}

<span class="hljs-comment">// Creating from HTML strings</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createFromHTML</span>(<span class="hljs-params">htmlString</span>) </span>{
  <span class="hljs-keyword">const</span> template = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"template"</span>);
  template.innerHTML = htmlString.trim();
  <span class="hljs-keyword">return</span> template.content.firstChild;
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> element = createFromHTML(<span class="hljs-string">`
    &lt;div class="alert alert-success"&gt;
        &lt;strong&gt;Success!&lt;/strong&gt; Operation completed.
    &lt;/div&gt;
`</span>);

<span class="hljs-comment">// Document fragments for efficient DOM manipulation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createMultipleElements</span>(<span class="hljs-params">count, elementFactory</span>) </span>{
  <span class="hljs-keyword">const</span> fragment = <span class="hljs-built_in">document</span>.createDocumentFragment();

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count; i++) {
    fragment.appendChild(elementFactory(i));
  }

  <span class="hljs-keyword">return</span> fragment;
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> listItems = createMultipleElements(<span class="hljs-number">10</span>, (index) =&gt; {
  <span class="hljs-keyword">return</span> createElement(<span class="hljs-string">"li"</span>, {
    <span class="hljs-attr">textContent</span>: <span class="hljs-string">`Item <span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span>`</span>,
    <span class="hljs-string">"data-index"</span>: index,
  });
});

<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#list"</span>).appendChild(listItems);
</div></code></pre>
<h3 id="adding-and-removing-elements">Adding and Removing Elements</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Adding elements</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#container"</span>);
<span class="hljs-keyword">const</span> newElement = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);

<span class="hljs-comment">// Append to end</span>
container.appendChild(newElement);

<span class="hljs-comment">// Insert at beginning</span>
container.insertBefore(newElement, container.firstChild);

<span class="hljs-comment">// Insert at specific position</span>
<span class="hljs-keyword">const</span> referenceElement = container.children[<span class="hljs-number">2</span>];
container.insertBefore(newElement, referenceElement);

<span class="hljs-comment">// Modern insertion methods</span>
<span class="hljs-keyword">const</span> targetElement = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".target"</span>);

<span class="hljs-comment">// Insert adjacent to element</span>
targetElement.insertAdjacentElement(<span class="hljs-string">"beforebegin"</span>, newElement); <span class="hljs-comment">// Before target</span>
targetElement.insertAdjacentElement(<span class="hljs-string">"afterbegin"</span>, newElement); <span class="hljs-comment">// First child of target</span>
targetElement.insertAdjacentElement(<span class="hljs-string">"beforeend"</span>, newElement); <span class="hljs-comment">// Last child of target</span>
targetElement.insertAdjacentElement(<span class="hljs-string">"afterend"</span>, newElement); <span class="hljs-comment">// After target</span>

<span class="hljs-comment">// Insert HTML strings</span>
targetElement.insertAdjacentHTML(<span class="hljs-string">"beforebegin"</span>, <span class="hljs-string">"&lt;div&gt;Before&lt;/div&gt;"</span>);
targetElement.insertAdjacentHTML(<span class="hljs-string">"afterbegin"</span>, <span class="hljs-string">"&lt;div&gt;First child&lt;/div&gt;"</span>);
targetElement.insertAdjacentHTML(<span class="hljs-string">"beforeend"</span>, <span class="hljs-string">"&lt;div&gt;Last child&lt;/div&gt;"</span>);
targetElement.insertAdjacentHTML(<span class="hljs-string">"afterend"</span>, <span class="hljs-string">"&lt;div&gt;After&lt;/div&gt;"</span>);

<span class="hljs-comment">// Removing elements</span>
<span class="hljs-keyword">const</span> elementToRemove = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".remove-me"</span>);

<span class="hljs-comment">// Modern way</span>
elementToRemove.remove();

<span class="hljs-comment">// Traditional way</span>
elementToRemove.parentNode.removeChild(elementToRemove);

<span class="hljs-comment">// Remove all children</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearElement</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">while</span> (element.firstChild) {
    element.removeChild(element.firstChild);
  }
  <span class="hljs-comment">// Or simply:</span>
  <span class="hljs-comment">// element.innerHTML = '';</span>
}

<span class="hljs-comment">// Conditional removal</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeIf</span>(<span class="hljs-params">selector, condition</span>) </span>{
  <span class="hljs-keyword">const</span> elements = <span class="hljs-built_in">document</span>.querySelectorAll(selector);
  elements.forEach(<span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (condition(element)) {
      element.remove();
    }
  });
}

<span class="hljs-comment">// Usage: Remove all empty paragraphs</span>
removeIf(<span class="hljs-string">"p"</span>, (p) =&gt; p.textContent.trim() === <span class="hljs-string">""</span>);

<span class="hljs-comment">// Replace elements</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replaceElement</span>(<span class="hljs-params">oldElement, newElement</span>) </span>{
  oldElement.parentNode.replaceChild(newElement, oldElement);
}

<span class="hljs-comment">// Clone elements</span>
<span class="hljs-keyword">const</span> original = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".original"</span>);
<span class="hljs-keyword">const</span> clone = original.cloneNode(<span class="hljs-literal">true</span>); <span class="hljs-comment">// true = deep clone (includes children)</span>
<span class="hljs-keyword">const</span> shallowClone = original.cloneNode(<span class="hljs-literal">false</span>); <span class="hljs-comment">// false = shallow clone</span>

<span class="hljs-comment">// Move elements</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">moveElement</span>(<span class="hljs-params">element, newParent</span>) </span>{
  newParent.appendChild(element); <span class="hljs-comment">// Automatically removes from old parent</span>
}

<span class="hljs-comment">// Batch operations with DocumentFragment</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">batchInsert</span>(<span class="hljs-params">container, elements</span>) </span>{
  <span class="hljs-keyword">const</span> fragment = <span class="hljs-built_in">document</span>.createDocumentFragment();
  elements.forEach(<span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> fragment.appendChild(element));
  container.appendChild(fragment); <span class="hljs-comment">// Single DOM operation</span>
}

<span class="hljs-comment">// List management utilities</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ListManager</span> </span>{
  <span class="hljs-keyword">constructor</span>(containerSelector) {
    <span class="hljs-keyword">this</span>.container = <span class="hljs-built_in">document</span>.querySelector(containerSelector);
    <span class="hljs-keyword">this</span>.items = [];
  }

  addItem(data, template) {
    <span class="hljs-keyword">const</span> element = template(data);
    <span class="hljs-keyword">this</span>.container.appendChild(element);
    <span class="hljs-keyword">this</span>.items.push({ data, element });
    <span class="hljs-keyword">return</span> element;
  }

  removeItem(index) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.items[index]) {
      <span class="hljs-keyword">this</span>.items[index].element.remove();
      <span class="hljs-keyword">this</span>.items.splice(index, <span class="hljs-number">1</span>);
    }
  }

  updateItem(index, newData, template) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.items[index]) {
      <span class="hljs-keyword">const</span> newElement = template(newData);
      <span class="hljs-keyword">this</span>.items[index].element.replaceWith(newElement);
      <span class="hljs-keyword">this</span>.items[index] = { <span class="hljs-attr">data</span>: newData, <span class="hljs-attr">element</span>: newElement };
    }
  }

  clear() {
    <span class="hljs-keyword">this</span>.container.innerHTML = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">this</span>.items = [];
  }

  getItems() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.data);
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> todoList = <span class="hljs-keyword">new</span> ListManager(<span class="hljs-string">"#todo-list"</span>);

todoList.addItem({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Buy groceries"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> }, (data) =&gt;
  createElement(<span class="hljs-string">"li"</span>, {
    <span class="hljs-attr">textContent</span>: data.text,
    <span class="hljs-attr">className</span>: data.completed ? <span class="hljs-string">"completed"</span> : <span class="hljs-string">""</span>,
  })
);
</div></code></pre>
<h2 id="%F0%9F%8E%9B%EF%B8%8F-attributes-and-properties">🎛️ Attributes and Properties</h2>
<h3 id="working-with-attributes">Working with Attributes</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".target"</span>);

<span class="hljs-comment">// Getting attributes</span>
<span class="hljs-keyword">const</span> id = element.getAttribute(<span class="hljs-string">"id"</span>);
<span class="hljs-keyword">const</span> className = element.getAttribute(<span class="hljs-string">"class"</span>);
<span class="hljs-keyword">const</span> dataValue = element.getAttribute(<span class="hljs-string">"data-value"</span>);

<span class="hljs-comment">// Setting attributes</span>
element.setAttribute(<span class="hljs-string">"id"</span>, <span class="hljs-string">"new-id"</span>);
element.setAttribute(<span class="hljs-string">"class"</span>, <span class="hljs-string">"new-class"</span>);
element.setAttribute(<span class="hljs-string">"data-value"</span>, <span class="hljs-string">"123"</span>);
element.setAttribute(<span class="hljs-string">"aria-label"</span>, <span class="hljs-string">"Close button"</span>);

<span class="hljs-comment">// Removing attributes</span>
element.removeAttribute(<span class="hljs-string">"data-old"</span>);
element.removeAttribute(<span class="hljs-string">"disabled"</span>);

<span class="hljs-comment">// Checking if attribute exists</span>
<span class="hljs-keyword">if</span> (element.hasAttribute(<span class="hljs-string">"data-value"</span>)) {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Element has data-value attribute"</span>);
}

<span class="hljs-comment">// Getting all attributes</span>
<span class="hljs-keyword">const</span> attributes = <span class="hljs-built_in">Array</span>.from(element.attributes);
attributes.forEach(<span class="hljs-function">(<span class="hljs-params">attr</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${attr.name}</span>: <span class="hljs-subst">${attr.value}</span>`</span>);
});

<span class="hljs-comment">// Data attributes (modern approach)</span>
<span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'[data-user-id="123"]'</span>);

<span class="hljs-comment">// Access via dataset property</span>
<span class="hljs-built_in">console</span>.log(element.dataset.userId); <span class="hljs-comment">// "123"</span>
<span class="hljs-built_in">console</span>.log(element.dataset.userName); <span class="hljs-comment">// Gets data-user-name</span>

<span class="hljs-comment">// Setting data attributes</span>
element.dataset.status = <span class="hljs-string">"active"</span>;
element.dataset.lastModified = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString();

<span class="hljs-comment">// Data attribute utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setDataAttributes</span>(<span class="hljs-params">element, data</span>) </span>{
  <span class="hljs-built_in">Object</span>.entries(data).forEach(<span class="hljs-function">(<span class="hljs-params">[key, value]</span>) =&gt;</span> {
    element.dataset[key] = value;
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDataAttributes</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">return</span> { ...element.dataset };
}

<span class="hljs-comment">// Usage</span>
setDataAttributes(element, {
  <span class="hljs-attr">userId</span>: <span class="hljs-string">"456"</span>,
  <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span>,
  <span class="hljs-attr">permissions</span>: <span class="hljs-string">"read,write,delete"</span>,
});

<span class="hljs-keyword">const</span> data = getDataAttributes(element);
<span class="hljs-built_in">console</span>.log(data); <span class="hljs-comment">// { userId: '456', role: 'admin', permissions: 'read,write,delete' }</span>

<span class="hljs-comment">// Boolean attributes</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setBooleanAttribute</span>(<span class="hljs-params">element, attribute, value</span>) </span>{
  <span class="hljs-keyword">if</span> (value) {
    element.setAttribute(attribute, <span class="hljs-string">""</span>);
  } <span class="hljs-keyword">else</span> {
    element.removeAttribute(attribute);
  }
}

<span class="hljs-comment">// Usage</span>
setBooleanAttribute(button, <span class="hljs-string">"disabled"</span>, <span class="hljs-literal">true</span>);
setBooleanAttribute(input, <span class="hljs-string">"required"</span>, <span class="hljs-literal">false</span>);
setBooleanAttribute(details, <span class="hljs-string">"open"</span>, <span class="hljs-literal">true</span>);
</div></code></pre>
<h3 id="properties-vs-attributes">Properties vs Attributes</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> input = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'input[type="text"]'</span>);

<span class="hljs-comment">// Properties (JavaScript object properties)</span>
input.value = <span class="hljs-string">"Hello"</span>; <span class="hljs-comment">// Current value</span>
input.disabled = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Current state</span>
input.checked = <span class="hljs-literal">false</span>; <span class="hljs-comment">// For checkboxes/radios</span>

<span class="hljs-comment">// Attributes (HTML attributes)</span>
input.setAttribute(<span class="hljs-string">"value"</span>, <span class="hljs-string">"Hello"</span>); <span class="hljs-comment">// Default value</span>
input.setAttribute(<span class="hljs-string">"disabled"</span>, <span class="hljs-string">""</span>); <span class="hljs-comment">// Presence indicates disabled</span>
input.setAttribute(<span class="hljs-string">"checked"</span>, <span class="hljs-string">""</span>); <span class="hljs-comment">// Default checked state</span>

<span class="hljs-comment">// Key differences:</span>
<span class="hljs-comment">// 1. Properties reflect current state, attributes reflect initial state</span>
<span class="hljs-comment">// 2. Properties are typed (boolean, string, number), attributes are always strings</span>
<span class="hljs-comment">// 3. Some properties don't have corresponding attributes</span>

<span class="hljs-comment">// Form element properties</span>
<span class="hljs-keyword">const</span> form = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"form"</span>);
<span class="hljs-keyword">const</span> select = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"select"</span>);
<span class="hljs-keyword">const</span> checkbox = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'input[type="checkbox"]'</span>);

<span class="hljs-comment">// Input properties</span>
<span class="hljs-built_in">console</span>.log(input.value); <span class="hljs-comment">// Current value</span>
<span class="hljs-built_in">console</span>.log(input.defaultValue); <span class="hljs-comment">// Original value attribute</span>
<span class="hljs-built_in">console</span>.log(input.validity); <span class="hljs-comment">// Validation state</span>
<span class="hljs-built_in">console</span>.log(input.files); <span class="hljs-comment">// For file inputs</span>

<span class="hljs-comment">// Select properties</span>
<span class="hljs-built_in">console</span>.log(select.selectedIndex); <span class="hljs-comment">// Index of selected option</span>
<span class="hljs-built_in">console</span>.log(select.selectedOptions); <span class="hljs-comment">// Selected option elements</span>
<span class="hljs-built_in">console</span>.log(select.options); <span class="hljs-comment">// All option elements</span>

<span class="hljs-comment">// Checkbox/radio properties</span>
<span class="hljs-built_in">console</span>.log(checkbox.checked); <span class="hljs-comment">// Current checked state</span>
<span class="hljs-built_in">console</span>.log(checkbox.defaultChecked); <span class="hljs-comment">// Original checked attribute</span>

<span class="hljs-comment">// Form properties</span>
<span class="hljs-built_in">console</span>.log(form.elements); <span class="hljs-comment">// All form controls</span>
<span class="hljs-built_in">console</span>.log(form.length); <span class="hljs-comment">// Number of form controls</span>

<span class="hljs-comment">// Property utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFormData</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">const</span> data = {};
  <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(form);

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> formData.entries()) {
    <span class="hljs-keyword">if</span> (data[key]) {
      <span class="hljs-comment">// Handle multiple values (checkboxes, multi-select)</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(data[key])) {
        data[key].push(value);
      } <span class="hljs-keyword">else</span> {
        data[key] = [data[key], value];
      }
    } <span class="hljs-keyword">else</span> {
      data[key] = value;
    }
  }

  <span class="hljs-keyword">return</span> data;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setFormData</span>(<span class="hljs-params">form, data</span>) </span>{
  <span class="hljs-built_in">Object</span>.entries(data).forEach(<span class="hljs-function">(<span class="hljs-params">[name, value]</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> element = form.elements[name];
    <span class="hljs-keyword">if</span> (element) {
      <span class="hljs-keyword">if</span> (element.type === <span class="hljs-string">"checkbox"</span> || element.type === <span class="hljs-string">"radio"</span>) {
        element.checked = value;
      } <span class="hljs-keyword">else</span> {
        element.value = value;
      }
    }
  });
}

<span class="hljs-comment">// Element state management</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ElementState</span> </span>{
  <span class="hljs-keyword">constructor</span>(element) {
    <span class="hljs-keyword">this</span>.element = element;
    <span class="hljs-keyword">this</span>.originalAttributes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.originalProperties = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  saveState() {
    <span class="hljs-comment">// Save current attributes</span>
    <span class="hljs-built_in">Array</span>.from(<span class="hljs-keyword">this</span>.element.attributes).forEach(<span class="hljs-function">(<span class="hljs-params">attr</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.originalAttributes.set(attr.name, attr.value);
    });

    <span class="hljs-comment">// Save important properties</span>
    <span class="hljs-keyword">const</span> props = [<span class="hljs-string">"value"</span>, <span class="hljs-string">"checked"</span>, <span class="hljs-string">"selected"</span>, <span class="hljs-string">"disabled"</span>];
    props.forEach(<span class="hljs-function">(<span class="hljs-params">prop</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (prop <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.element) {
        <span class="hljs-keyword">this</span>.originalProperties.set(prop, <span class="hljs-keyword">this</span>.element[prop]);
      }
    });
  }

  restoreState() {
    <span class="hljs-comment">// Restore attributes</span>
    <span class="hljs-keyword">this</span>.originalAttributes.forEach(<span class="hljs-function">(<span class="hljs-params">value, name</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.element.setAttribute(name, value);
    });

    <span class="hljs-comment">// Restore properties</span>
    <span class="hljs-keyword">this</span>.originalProperties.forEach(<span class="hljs-function">(<span class="hljs-params">value, prop</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.element[prop] = value;
    });
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> elementState = <span class="hljs-keyword">new</span> ElementState(input);
elementState.saveState();

<span class="hljs-comment">// Make changes...</span>
input.value = <span class="hljs-string">"Modified"</span>;
input.disabled = <span class="hljs-literal">true</span>;

<span class="hljs-comment">// Restore original state</span>
elementState.restoreState();
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-nodelist-vs-htmlcollection">1. NodeList vs HTMLCollection</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Assuming live collections are static</span>
<span class="hljs-keyword">const</span> divs = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"div"</span>); <span class="hljs-comment">// HTMLCollection (live)</span>
<span class="hljs-built_in">console</span>.log(divs.length); <span class="hljs-comment">// 5</span>

<span class="hljs-comment">// Adding a new div</span>
<span class="hljs-built_in">document</span>.body.appendChild(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>));
<span class="hljs-built_in">console</span>.log(divs.length); <span class="hljs-comment">// 6 (automatically updated!)</span>

<span class="hljs-comment">// This can cause infinite loops:</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; divs.length; i++) {
  <span class="hljs-built_in">document</span>.body.appendChild(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>)); <span class="hljs-comment">// Infinite loop!</span>
}

<span class="hljs-comment">// ✅ Convert to static array when needed</span>
<span class="hljs-keyword">const</span> staticDivs = <span class="hljs-built_in">Array</span>.from(<span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">"div"</span>));
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; staticDivs.length; i++) {
  <span class="hljs-built_in">document</span>.body.appendChild(<span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>)); <span class="hljs-comment">// Safe</span>
}

<span class="hljs-comment">// ✅ Or use querySelectorAll (returns static NodeList)</span>
<span class="hljs-keyword">const</span> divs = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"div"</span>);
</div></code></pre>
<h3 id="2-innerhtml-security-issues">2. innerHTML Security Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Dangerous - XSS vulnerability</span>
<span class="hljs-keyword">const</span> userInput = <span class="hljs-string">'&lt;img src="x" onerror="alert(\'XSS\')"&gt;'</span>;
element.innerHTML = userInput; <span class="hljs-comment">// Executes malicious script!</span>

<span class="hljs-comment">// ✅ Safe alternatives</span>
<span class="hljs-comment">// Use textContent for plain text</span>
element.textContent = userInput; <span class="hljs-comment">// Safe - no HTML execution</span>

<span class="hljs-comment">// Use createElement for dynamic content</span>
<span class="hljs-keyword">const</span> img = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"img"</span>);
img.src = userSrc; <span class="hljs-comment">// Validate userSrc first</span>
img.alt = userAlt; <span class="hljs-comment">// Validate userAlt first</span>
element.appendChild(img);

<span class="hljs-comment">// Sanitize HTML if you must use innerHTML</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sanitizeHTML</span>(<span class="hljs-params">html</span>) </span>{
  <span class="hljs-keyword">const</span> temp = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  temp.textContent = html;
  <span class="hljs-keyword">return</span> temp.innerHTML;
}

element.innerHTML = sanitizeHTML(userInput);
</div></code></pre>
<h3 id="3-event-delegation-issues">3. Event Delegation Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Adding event listeners to many elements</span>
<span class="hljs-keyword">const</span> buttons = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".btn"</span>);
buttons.forEach(<span class="hljs-function">(<span class="hljs-params">button</span>) =&gt;</span> {
  button.addEventListener(<span class="hljs-string">"click"</span>, handleClick); <span class="hljs-comment">// Memory intensive</span>
});

<span class="hljs-comment">// ✅ Use event delegation</span>
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, (event) =&gt; {
  <span class="hljs-keyword">if</span> (event.target.matches(<span class="hljs-string">".btn"</span>)) {
    handleClick(event);
  }
});

<span class="hljs-comment">// ❌ Not checking if element exists</span>
<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".non-existent"</span>).addEventListener(<span class="hljs-string">"click"</span>, handler);
<span class="hljs-comment">// TypeError: Cannot read property 'addEventListener' of null</span>

<span class="hljs-comment">// ✅ Always check existence</span>
<span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".maybe-exists"</span>);
<span class="hljs-keyword">if</span> (element) {
  element.addEventListener(<span class="hljs-string">"click"</span>, handler);
}

<span class="hljs-comment">// Or use optional chaining (modern browsers)</span>
<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".maybe-exists"</span>)?.addEventListener(<span class="hljs-string">"click"</span>, handler);
</div></code></pre>
<h3 id="4-style-manipulation-issues">4. Style Manipulation Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Setting styles that cause layout thrashing</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateElements</span>(<span class="hljs-params">elements</span>) </span>{
  elements.forEach(<span class="hljs-function">(<span class="hljs-params">element, index</span>) =&gt;</span> {
    element.style.left = <span class="hljs-string">`<span class="hljs-subst">${index * <span class="hljs-number">100</span>}</span>px`</span>; <span class="hljs-comment">// Causes reflow for each element</span>
  });
}

<span class="hljs-comment">// ✅ Batch DOM operations</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateElementsEfficiently</span>(<span class="hljs-params">elements</span>) </span>{
  <span class="hljs-comment">// Use DocumentFragment or CSS transforms</span>
  elements.forEach(<span class="hljs-function">(<span class="hljs-params">element, index</span>) =&gt;</span> {
    element.style.transform = <span class="hljs-string">`translateX(<span class="hljs-subst">${index * <span class="hljs-number">100</span>}</span>px)`</span>; <span class="hljs-comment">// No reflow</span>
  });
}

<span class="hljs-comment">// ❌ Reading and writing styles in a loop</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; elements.length; i++) {
  <span class="hljs-keyword">const</span> height = elements[i].offsetHeight; <span class="hljs-comment">// Read (causes reflow)</span>
  elements[i].style.height = <span class="hljs-string">`<span class="hljs-subst">${height + <span class="hljs-number">10</span>}</span>px`</span>; <span class="hljs-comment">// Write (causes reflow)</span>
}

<span class="hljs-comment">// ✅ Separate reads and writes</span>
<span class="hljs-keyword">const</span> heights = elements.map(<span class="hljs-function">(<span class="hljs-params">el</span>) =&gt;</span> el.offsetHeight); <span class="hljs-comment">// Batch reads</span>
elements.forEach(<span class="hljs-function">(<span class="hljs-params">el, i</span>) =&gt;</span> {
  el.style.height = <span class="hljs-string">`<span class="hljs-subst">${heights[i] + <span class="hljs-number">10</span>}</span>px`</span>; <span class="hljs-comment">// Batch writes</span>
});
</div></code></pre>
<h3 id="5-memory-leaks">5. Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not removing event listeners</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> button = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"button"</span>);
  <span class="hljs-keyword">const</span> handler = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"clicked"</span>);

  button.addEventListener(<span class="hljs-string">"click"</span>, handler);
  <span class="hljs-built_in">document</span>.body.appendChild(button);

  <span class="hljs-comment">// Later, removing the button but not the listener</span>
  button.remove(); <span class="hljs-comment">// Memory leak - handler still referenced</span>
}

<span class="hljs-comment">// ✅ Proper cleanup</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupComponentProperly</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> button = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"button"</span>);
  <span class="hljs-keyword">const</span> handler = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"clicked"</span>);

  button.addEventListener(<span class="hljs-string">"click"</span>, handler);
  <span class="hljs-built_in">document</span>.body.appendChild(button);

  <span class="hljs-comment">// Cleanup function</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    button.removeEventListener(<span class="hljs-string">"click"</span>, handler);
    button.remove();
  };
}

<span class="hljs-keyword">const</span> cleanup = setupComponentProperly();
<span class="hljs-comment">// Later...</span>
cleanup(); <span class="hljs-comment">// Proper cleanup</span>

<span class="hljs-comment">// ❌ Circular references</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createCircularReference</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  element.customProperty = {
    <span class="hljs-attr">element</span>: element, <span class="hljs-comment">// Circular reference</span>
    <span class="hljs-attr">data</span>: <span class="hljs-string">"some data"</span>,
  };
  <span class="hljs-keyword">return</span> element;
}

<span class="hljs-comment">// ✅ Avoid circular references</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createProperReference</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  <span class="hljs-keyword">const</span> data = {
    <span class="hljs-attr">elementId</span>: element.id || <span class="hljs-string">`element-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>,
    <span class="hljs-attr">data</span>: <span class="hljs-string">"some data"</span>,
  };
  element.dataset.objectId = data.elementId;
  <span class="hljs-keyword">return</span> { element, data };
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-dynamic-table-generator">Problem 1: Dynamic Table Generator</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a function that generates a sortable, filterable table</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDataTable</span>(<span class="hljs-params">container, data, options = {}</span>) </span>{
  <span class="hljs-comment">// Your implementation should:</span>
  <span class="hljs-comment">// - Generate table with headers and data rows</span>
  <span class="hljs-comment">// - Add sorting functionality (click headers to sort)</span>
  <span class="hljs-comment">// - Add filtering (search input)</span>
  <span class="hljs-comment">// - Support pagination</span>
  <span class="hljs-comment">// - Handle empty data gracefully</span>
  <span class="hljs-comment">// - Allow custom cell renderers</span>
  <span class="hljs-comment">// Options should support:</span>
  <span class="hljs-comment">// {</span>
  <span class="hljs-comment">//   sortable: true,</span>
  <span class="hljs-comment">//   filterable: true,</span>
  <span class="hljs-comment">//   pageSize: 10,</span>
  <span class="hljs-comment">//   columns: [</span>
  <span class="hljs-comment">//     { key: 'name', title: 'Name', sortable: true },</span>
  <span class="hljs-comment">//     { key: 'age', title: 'Age', sortable: true, type: 'number' },</span>
  <span class="hljs-comment">//     { key: 'email', title: 'Email', sortable: false },</span>
  <span class="hljs-comment">//     { key: 'actions', title: 'Actions', render: (row) =&gt; `&lt;button onclick="edit(${row.id})"&gt;Edit&lt;/button&gt;` }</span>
  <span class="hljs-comment">//   ]</span>
  <span class="hljs-comment">// }</span>
}

<span class="hljs-comment">// Test data</span>
<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"alice@example.com"</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"bob@example.com"</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">35</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"charlie@example.com"</span> },
];

createDataTable(<span class="hljs-string">"#table-container"</span>, users, {
  <span class="hljs-attr">sortable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">filterable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">pageSize</span>: <span class="hljs-number">5</span>,
  <span class="hljs-attr">columns</span>: [
    { <span class="hljs-attr">key</span>: <span class="hljs-string">"name"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Name"</span> },
    { <span class="hljs-attr">key</span>: <span class="hljs-string">"age"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Age"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"number"</span> },
    { <span class="hljs-attr">key</span>: <span class="hljs-string">"email"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Email"</span> },
    {
      <span class="hljs-attr">key</span>: <span class="hljs-string">"actions"</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Actions"</span>,
      <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">row</span>) =&gt;</span> <span class="hljs-string">`&lt;button&gt;Edit&lt;/button&gt;`</span>,
    },
  ],
});
</div></code></pre>
<h3 id="problem-2-modal-dialog-system">Problem 2: Modal Dialog System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a reusable modal dialog system</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ModalManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Should handle:</span>
    <span class="hljs-comment">// - Multiple modals</span>
    <span class="hljs-comment">// - Modal stacking (z-index management)</span>
    <span class="hljs-comment">// - Backdrop clicks</span>
    <span class="hljs-comment">// - Escape key handling</span>
    <span class="hljs-comment">// - Focus management</span>
    <span class="hljs-comment">// - Animations</span>
  }

  create(options) {
    <span class="hljs-comment">// Create and return a modal instance</span>
    <span class="hljs-comment">// Options: { title, content, size, closable, backdrop }</span>
  }

  open(modal) {
    <span class="hljs-comment">// Open a modal</span>
  }

  close(modal) {
    <span class="hljs-comment">// Close a modal</span>
  }

  closeAll() {
    <span class="hljs-comment">// Close all open modals</span>
  }

  confirm(message, options = {}) {
    <span class="hljs-comment">// Show confirmation dialog, return promise</span>
  }

  alert(message, options = {}) {
    <span class="hljs-comment">// Show alert dialog, return promise</span>
  }

  prompt(message, defaultValue = <span class="hljs-string">""</span>, options = {}) {
    <span class="hljs-comment">// Show prompt dialog, return promise with user input</span>
  }
}

<span class="hljs-comment">// Usage examples:</span>
<span class="hljs-keyword">const</span> modals = <span class="hljs-keyword">new</span> ModalManager();

<span class="hljs-comment">// Basic modal</span>
<span class="hljs-keyword">const</span> modal = modals.create({
  <span class="hljs-attr">title</span>: <span class="hljs-string">"User Profile"</span>,
  <span class="hljs-attr">content</span>: <span class="hljs-string">"&lt;form&gt;...&lt;/form&gt;"</span>,
  <span class="hljs-attr">size</span>: <span class="hljs-string">"large"</span>,
});
modals.open(modal);

<span class="hljs-comment">// Confirmation</span>
modals
  .confirm(<span class="hljs-string">"Are you sure you want to delete this item?"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">confirmed</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (confirmed) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Item deleted"</span>);
    }
  });

<span class="hljs-comment">// Prompt</span>
modals.prompt(<span class="hljs-string">"Enter your name:"</span>, <span class="hljs-string">"John Doe"</span>).then(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (name) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Hello,"</span>, name);
  }
});
</div></code></pre>
<h3 id="problem-3-drag-and-drop-list">Problem 3: Drag and Drop List</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a drag-and-drop sortable list</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SortableList</span> </span>{
  <span class="hljs-keyword">constructor</span>(container, options = {}) {
    <span class="hljs-comment">// Your implementation should:</span>
    <span class="hljs-comment">// - Make list items draggable</span>
    <span class="hljs-comment">// - Show visual feedback during drag</span>
    <span class="hljs-comment">// - Handle drop zones</span>
    <span class="hljs-comment">// - Animate reordering</span>
    <span class="hljs-comment">// - Support touch devices</span>
    <span class="hljs-comment">// - Emit events for reorder</span>
    <span class="hljs-comment">// - Support disabled items</span>
    <span class="hljs-comment">// - Handle nested lists (optional)</span>
    <span class="hljs-comment">// Options: {</span>
    <span class="hljs-comment">//   itemSelector: '.list-item',</span>
    <span class="hljs-comment">//   handleSelector: '.drag-handle', // Optional drag handle</span>
    <span class="hljs-comment">//   placeholder: 'drop-placeholder',</span>
    <span class="hljs-comment">//   animation: 300,</span>
    <span class="hljs-comment">//   disabled: false,</span>
    <span class="hljs-comment">//   onSort: (oldIndex, newIndex) =&gt; {}</span>
    <span class="hljs-comment">// }</span>
  }

  enable() {
    <span class="hljs-comment">// Enable drag and drop</span>
  }

  disable() {
    <span class="hljs-comment">// Disable drag and drop</span>
  }

  destroy() {
    <span class="hljs-comment">// Clean up event listeners</span>
  }

  getOrder() {
    <span class="hljs-comment">// Return current order of items</span>
  }

  setOrder(order) {
    <span class="hljs-comment">// Set order of items</span>
  }
}

<span class="hljs-comment">// HTML structure:</span>
<span class="hljs-comment">// &lt;ul id="sortable-list"&gt;</span>
<span class="hljs-comment">//   &lt;li class="list-item" data-id="1"&gt;</span>
<span class="hljs-comment">//     &lt;span class="drag-handle"&gt;⋮⋮&lt;/span&gt;</span>
<span class="hljs-comment">//     &lt;span&gt;Item 1&lt;/span&gt;</span>
<span class="hljs-comment">//   &lt;/li&gt;</span>
<span class="hljs-comment">//   &lt;li class="list-item" data-id="2"&gt;</span>
<span class="hljs-comment">//     &lt;span class="drag-handle"&gt;⋮⋮&lt;/span&gt;</span>
<span class="hljs-comment">//     &lt;span&gt;Item 2&lt;/span&gt;</span>
<span class="hljs-comment">//   &lt;/li&gt;</span>
<span class="hljs-comment">// &lt;/ul&gt;</span>

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> sortable = <span class="hljs-keyword">new</span> SortableList(<span class="hljs-string">"#sortable-list"</span>, {
  <span class="hljs-attr">handleSelector</span>: <span class="hljs-string">".drag-handle"</span>,
  <span class="hljs-attr">onSort</span>: <span class="hljs-function">(<span class="hljs-params">oldIndex, newIndex</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Moved item from <span class="hljs-subst">${oldIndex}</span> to <span class="hljs-subst">${newIndex}</span>`</span>);
  },
});
</div></code></pre>
<h3 id="problem-4-virtual-scrolling-list">Problem 4: Virtual Scrolling List</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a virtual scrolling list for large datasets</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VirtualList</span> </span>{
  <span class="hljs-keyword">constructor</span>(container, options = {}) {
    <span class="hljs-comment">// Your implementation should:</span>
    <span class="hljs-comment">// - Only render visible items</span>
    <span class="hljs-comment">// - Handle scrolling efficiently</span>
    <span class="hljs-comment">// - Support variable item heights</span>
    <span class="hljs-comment">// - Maintain scroll position</span>
    <span class="hljs-comment">// - Support dynamic data updates</span>
    <span class="hljs-comment">// - Handle resize events</span>
    <span class="hljs-comment">// Options: {</span>
    <span class="hljs-comment">//   itemHeight: 50, // Fixed height or function</span>
    <span class="hljs-comment">//   renderItem: (item, index) =&gt; string, // Item renderer</span>
    <span class="hljs-comment">//   overscan: 5, // Extra items to render outside viewport</span>
    <span class="hljs-comment">//   data: [], // Initial data</span>
    <span class="hljs-comment">//   estimatedItemHeight: 50 // For variable heights</span>
    <span class="hljs-comment">// }</span>
  }

  setData(data) {
    <span class="hljs-comment">// Update the data and re-render</span>
  }

  scrollToIndex(index) {
    <span class="hljs-comment">// Scroll to specific item</span>
  }

  scrollToTop() {
    <span class="hljs-comment">// Scroll to top</span>
  }

  refresh() {
    <span class="hljs-comment">// Force re-render</span>
  }

  destroy() {
    <span class="hljs-comment">// Clean up</span>
  }
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> virtualList = <span class="hljs-keyword">new</span> VirtualList(<span class="hljs-string">"#list-container"</span>, {
  <span class="hljs-attr">itemHeight</span>: <span class="hljs-number">60</span>,
  <span class="hljs-attr">renderItem</span>: <span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> <span class="hljs-string">`
        &lt;div class="list-item"&gt;
            &lt;h4&gt;<span class="hljs-subst">${item.title}</span>&lt;/h4&gt;
            &lt;p&gt;<span class="hljs-subst">${item.description}</span>&lt;/p&gt;
        &lt;/div&gt;
    `</span>,
  <span class="hljs-attr">overscan</span>: <span class="hljs-number">10</span>,
});

<span class="hljs-comment">// Large dataset</span>
<span class="hljs-keyword">const</span> largeData = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">100000</span> }, (_, i) =&gt; ({
  <span class="hljs-attr">id</span>: i,
  <span class="hljs-attr">title</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
  <span class="hljs-attr">description</span>: <span class="hljs-string">`Description for item <span class="hljs-subst">${i}</span>`</span>,
}));

virtualList.setData(largeData);
</div></code></pre>
<h3 id="problem-5-form-validation-system">Problem 5: Form Validation System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a comprehensive form validation system</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FormValidator</span> </span>{
  <span class="hljs-keyword">constructor</span>(form, rules = {}) {
    <span class="hljs-comment">// Your implementation should:</span>
    <span class="hljs-comment">// - Validate on input, blur, and submit</span>
    <span class="hljs-comment">// - Show/hide error messages</span>
    <span class="hljs-comment">// - Support custom validation rules</span>
    <span class="hljs-comment">// - Handle different input types</span>
    <span class="hljs-comment">// - Support async validation</span>
    <span class="hljs-comment">// - Prevent form submission if invalid</span>
    <span class="hljs-comment">// - Highlight invalid fields</span>
    <span class="hljs-comment">// Rules format:</span>
    <span class="hljs-comment">// {</span>
    <span class="hljs-comment">//   fieldName: [</span>
    <span class="hljs-comment">//     { rule: 'required', message: 'This field is required' },</span>
    <span class="hljs-comment">//     { rule: 'email', message: 'Invalid email format' },</span>
    <span class="hljs-comment">//     { rule: 'minLength', value: 8, message: 'Minimum 8 characters' },</span>
    <span class="hljs-comment">//     { rule: 'custom', validate: (value) =&gt; boolean, message: 'Custom error' },</span>
    <span class="hljs-comment">//     { rule: 'async', validate: async (value) =&gt; boolean, message: 'Async error' }</span>
    <span class="hljs-comment">//   ]</span>
    <span class="hljs-comment">// }</span>
  }

  addRule(fieldName, rule) {
    <span class="hljs-comment">// Add validation rule to field</span>
  }

  removeRule(fieldName, ruleType) {
    <span class="hljs-comment">// Remove validation rule from field</span>
  }

  validate(fieldName = <span class="hljs-literal">null</span>) {
    <span class="hljs-comment">// Validate specific field or entire form</span>
    <span class="hljs-comment">// Return { isValid: boolean, errors: {} }</span>
  }

  showError(fieldName, message) {
    <span class="hljs-comment">// Show error message for field</span>
  }

  hideError(fieldName) {
    <span class="hljs-comment">// Hide error message for field</span>
  }

  reset() {
    <span class="hljs-comment">// Reset form and clear all errors</span>
  }

  destroy() {
    <span class="hljs-comment">// Clean up event listeners</span>
  }
}

<span class="hljs-comment">// Built-in validation rules</span>
<span class="hljs-keyword">const</span> validationRules = {
  <span class="hljs-attr">required</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value.trim() !== <span class="hljs-string">""</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.test(value),
  <span class="hljs-attr">minLength</span>: <span class="hljs-function">(<span class="hljs-params">value, length</span>) =&gt;</span> value.length &gt;= length,
  <span class="hljs-attr">maxLength</span>: <span class="hljs-function">(<span class="hljs-params">value, length</span>) =&gt;</span> value.length &lt;= length,
  <span class="hljs-attr">pattern</span>: <span class="hljs-function">(<span class="hljs-params">value, regex</span>) =&gt;</span> regex.test(value),
  <span class="hljs-attr">number</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> !<span class="hljs-built_in">isNaN</span>(value) &amp;&amp; !<span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseFloat</span>(value)),
  <span class="hljs-attr">url</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">new</span> URL(value);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  },
};

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> validator = <span class="hljs-keyword">new</span> FormValidator(<span class="hljs-string">"#user-form"</span>, {
  <span class="hljs-attr">username</span>: [
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"required"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Username is required"</span> },
    {
      <span class="hljs-attr">rule</span>: <span class="hljs-string">"minLength"</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">"Username must be at least 3 characters"</span>,
    },
  ],
  <span class="hljs-attr">email</span>: [
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"required"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Email is required"</span> },
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"email"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Please enter a valid email"</span> },
    {
      <span class="hljs-attr">rule</span>: <span class="hljs-string">"async"</span>,
      <span class="hljs-attr">validate</span>: <span class="hljs-keyword">async</span> (email) =&gt; {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/check-email?email=<span class="hljs-subst">${email}</span>`</span>);
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
        <span class="hljs-keyword">return</span> !result.exists;
      },
      <span class="hljs-attr">message</span>: <span class="hljs-string">"Email already exists"</span>,
    },
  ],
  <span class="hljs-attr">password</span>: [
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"required"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Password is required"</span> },
    {
      <span class="hljs-attr">rule</span>: <span class="hljs-string">"minLength"</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-number">8</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">"Password must be at least 8 characters"</span>,
    },
    {
      <span class="hljs-attr">rule</span>: <span class="hljs-string">"custom"</span>,
      <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/</span>.test(value),
      <span class="hljs-attr">message</span>: <span class="hljs-string">"Password must contain uppercase, lowercase, and number"</span>,
    },
  ],
});
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between <code>innerHTML</code>, <code>textContent</code>, and <code>innerText</code>?</strong></p>
<ul>
<li><code>innerHTML</code>: Gets/sets HTML content, can execute scripts (security risk)</li>
<li><code>textContent</code>: Gets/sets text content, ignores HTML tags, includes hidden text</li>
<li><code>innerText</code>: Gets/sets visible text content, respects styling (hidden elements ignored)</li>
</ul>
<p><strong>Q: How do you efficiently add many elements to the DOM?</strong></p>
<ul>
<li>Use <code>DocumentFragment</code> to batch operations</li>
<li>Use <code>insertAdjacentHTML</code> for HTML strings</li>
<li>Avoid adding elements one by one in a loop</li>
</ul>
<p><strong>Q: What's the difference between <code>querySelector</code> and <code>getElementById</code>?</strong></p>
<ul>
<li><code>getElementById</code>: Faster, returns single element by ID</li>
<li><code>querySelector</code>: More flexible (CSS selectors), returns first match</li>
<li><code>querySelectorAll</code>: Returns all matches as static NodeList</li>
</ul>
<p><strong>Q: How do you prevent XSS when inserting user content?</strong></p>
<ul>
<li>Use <code>textContent</code> instead of <code>innerHTML</code> for plain text</li>
<li>Sanitize HTML content before insertion</li>
<li>Use <code>createElement</code> and set properties instead of HTML strings</li>
<li>Validate and escape user input</li>
</ul>
<p><strong>Q: What's event delegation and when should you use it?</strong></p>
<ul>
<li>Attaching event listener to parent element instead of individual children</li>
<li>Use when you have many similar elements or dynamic content</li>
<li>More memory efficient, handles dynamically added elements</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement a virtual scrolling component for large lists&quot;</li>
<li><strong>Facebook</strong>: &quot;Create a drag-and-drop interface with React-like virtual DOM&quot;</li>
<li><strong>Amazon</strong>: &quot;Build a form validation system with real-time feedback&quot;</li>
<li><strong>Microsoft</strong>: &quot;Design a modal system that handles focus management and accessibility&quot;</li>
<li><strong>Netflix</strong>: &quot;Create a responsive grid layout that adapts to different screen sizes&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Use modern selectors</strong> - <code>querySelector</code> and <code>querySelectorAll</code> are more flexible</li>
<li><strong>Batch DOM operations</strong> - Use DocumentFragment for multiple insertions</li>
<li><strong>Prefer <code>textContent</code> over <code>innerHTML</code></strong> - Safer and often faster</li>
<li><strong>Use event delegation</strong> - More efficient for many elements</li>
<li><strong>Check element existence</strong> - Always verify elements exist before manipulation</li>
<li><strong>Separate reads and writes</strong> - Avoid layout thrashing</li>
<li><strong>Clean up event listeners</strong> - Prevent memory leaks</li>
<li><strong>Use CSS classes over inline styles</strong> - Better performance and maintainability</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./12-es6-features.md">← ES6+ Features</a><br>
<strong>Next Chapter</strong>: <a href="./14-event-handling.md">Event Handling →</a></p>
<p><strong>Practice</strong>: Try the DOM manipulation problems and experiment with different selection and modification techniques!</p>
<h1 id="%F0%9F%93%9A-chapter-14-event-handling">📚 Chapter 14: Event Handling</h1>
<blockquote>
<p>Master the art of creating interactive web applications through effective event management.</p>
</blockquote>
<h2 id="%F0%9F%93%96-plain-english-explanation">📖 Plain English Explanation</h2>
<p>Event handling is like being a receptionist at a busy office:</p>
<ul>
<li><strong>Events</strong> = phone calls, visitors, emails coming in</li>
<li><strong>Event listeners</strong> = your ears and eyes watching for these events</li>
<li><strong>Event handlers</strong> = your responses to each type of event</li>
<li><strong>Event delegation</strong> = training assistants to handle certain types of calls</li>
<li><strong>Event bubbling</strong> = how information travels up the company hierarchy</li>
<li><strong>Event capturing</strong> = intercepting information before it reaches its destination</li>
</ul>
<p>Events are actions that happen in the browser - clicks, key presses, mouse movements, form submissions, page loads, etc. Event handling is how we make our web pages respond to these actions.</p>
<h2 id="%F0%9F%8E%AF-event-fundamentals">🎯 Event Fundamentals</h2>
<h3 id="adding-event-listeners">Adding Event Listeners</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Modern way (recommended)</span>
<span class="hljs-keyword">const</span> button = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-button"</span>);

<span class="hljs-comment">// Basic event listener</span>
button.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked!"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Event object:"</span>, event);
});

<span class="hljs-comment">// Arrow function syntax</span>
button.addEventListener(<span class="hljs-string">"click"</span>, (event) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked with arrow function!"</span>);
});

<span class="hljs-comment">// Named function (easier to remove later)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleButtonClick</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked with named function!"</span>);
}
button.addEventListener(<span class="hljs-string">"click"</span>, handleButtonClick);

<span class="hljs-comment">// Multiple event listeners on same element</span>
button.addEventListener(<span class="hljs-string">"click"</span>, handleButtonClick);
button.addEventListener(<span class="hljs-string">"click"</span>, anotherClickHandler);
button.addEventListener(<span class="hljs-string">"mouseenter"</span>, handleMouseEnter);
button.addEventListener(<span class="hljs-string">"mouseleave"</span>, handleMouseLeave);

<span class="hljs-comment">// Event listener options</span>
button.addEventListener(<span class="hljs-string">"click"</span>, handleClick, {
  <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Remove after first execution</span>
  <span class="hljs-attr">passive</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Never calls preventDefault()</span>
  <span class="hljs-attr">capture</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Capture phase instead of bubble phase</span>
});

<span class="hljs-comment">// Legacy ways (avoid these)</span>
<span class="hljs-comment">// HTML attribute: &lt;button onclick="handleClick()"&gt;Click me&lt;/button&gt;</span>
<span class="hljs-comment">// DOM property: button.onclick = handleClick;</span>
</div></code></pre>
<h3 id="removing-event-listeners">Removing Event Listeners</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Remove specific event listener</span>
button.removeEventListener(<span class="hljs-string">"click"</span>, handleButtonClick);

<span class="hljs-comment">// Anonymous functions can't be removed!</span>
<span class="hljs-comment">// ❌ This won't work:</span>
button.addEventListener(<span class="hljs-string">"click"</span>, () =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"click"</span>));
button.removeEventListener(<span class="hljs-string">"click"</span>, () =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"click"</span>)); <span class="hljs-comment">// Different function!</span>

<span class="hljs-comment">// ✅ Use named functions or store references:</span>
<span class="hljs-keyword">const</span> clickHandler = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"click"</span>);
button.addEventListener(<span class="hljs-string">"click"</span>, clickHandler);
button.removeEventListener(<span class="hljs-string">"click"</span>, clickHandler); <span class="hljs-comment">// This works!</span>

<span class="hljs-comment">// Utility function for temporary event listeners</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addTemporaryListener</span>(<span class="hljs-params">element, eventType, handler, duration</span>) </span>{
  element.addEventListener(eventType, handler);

  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    element.removeEventListener(eventType, handler);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Removed <span class="hljs-subst">${eventType}</span> listener after <span class="hljs-subst">${duration}</span>ms`</span>);
  }, duration);
}

<span class="hljs-comment">// Usage</span>
addTemporaryListener(button, <span class="hljs-string">"click"</span>, handleClick, <span class="hljs-number">5000</span>); <span class="hljs-comment">// Remove after 5 seconds</span>

<span class="hljs-comment">// Clean up all listeners (nuclear option)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">removeAllListeners</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">const</span> newElement = element.cloneNode(<span class="hljs-literal">true</span>);
  element.parentNode.replaceChild(newElement, element);
  <span class="hljs-keyword">return</span> newElement;
}
</div></code></pre>
<h3 id="event-object-properties">Event Object Properties</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleEvent</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-comment">// Target vs CurrentTarget</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"event.target:"</span>, event.target); <span class="hljs-comment">// Element that triggered the event</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"event.currentTarget:"</span>, event.currentTarget); <span class="hljs-comment">// Element with the listener</span>

  <span class="hljs-comment">// Event type and timing</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"event.type:"</span>, event.type); <span class="hljs-comment">// 'click', 'keydown', etc.</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"event.timeStamp:"</span>, event.timeStamp); <span class="hljs-comment">// When event occurred</span>

  <span class="hljs-comment">// Event flow control</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"event.bubbles:"</span>, event.bubbles); <span class="hljs-comment">// Does event bubble?</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"event.cancelable:"</span>, event.cancelable); <span class="hljs-comment">// Can be cancelled?</span>

  <span class="hljs-comment">// Prevent default behavior</span>
  event.preventDefault(); <span class="hljs-comment">// Stop default action (form submit, link navigation)</span>

  <span class="hljs-comment">// Stop event propagation</span>
  event.stopPropagation(); <span class="hljs-comment">// Stop bubbling to parent elements</span>
  event.stopImmediatePropagation(); <span class="hljs-comment">// Stop other listeners on same element</span>

  <span class="hljs-comment">// Mouse events specific properties</span>
  <span class="hljs-keyword">if</span> (event.type.startsWith(<span class="hljs-string">"mouse"</span>) || event.type === <span class="hljs-string">"click"</span>) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse position:"</span>, event.clientX, event.clientY);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Page position:"</span>, event.pageX, event.pageY);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Screen position:"</span>, event.screenX, event.screenY);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button pressed:"</span>, event.button); <span class="hljs-comment">// 0=left, 1=middle, 2=right</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Modifier keys:"</span>, {
      <span class="hljs-attr">ctrl</span>: event.ctrlKey,
      <span class="hljs-attr">shift</span>: event.shiftKey,
      <span class="hljs-attr">alt</span>: event.altKey,
      <span class="hljs-attr">meta</span>: event.metaKey, <span class="hljs-comment">// Cmd on Mac, Windows key on PC</span>
    });
  }

  <span class="hljs-comment">// Keyboard events specific properties</span>
  <span class="hljs-keyword">if</span> (event.type.startsWith(<span class="hljs-string">"key"</span>)) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Key pressed:"</span>, event.key); <span class="hljs-comment">// 'a', 'Enter', 'ArrowUp'</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Key code:"</span>, event.code); <span class="hljs-comment">// 'KeyA', 'Enter', 'ArrowUp'</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Legacy keyCode:"</span>, event.keyCode); <span class="hljs-comment">// Deprecated but still used</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Modifier keys:"</span>, {
      <span class="hljs-attr">ctrl</span>: event.ctrlKey,
      <span class="hljs-attr">shift</span>: event.shiftKey,
      <span class="hljs-attr">alt</span>: event.altKey,
      <span class="hljs-attr">meta</span>: event.metaKey,
    });
  }
}

<span class="hljs-comment">// Practical examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleMouseClick</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-comment">// Different actions based on which button was clicked</span>
  <span class="hljs-keyword">switch</span> (event.button) {
    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">// Left click</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Left click"</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// Middle click</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Middle click"</span>);
      event.preventDefault(); <span class="hljs-comment">// Prevent scroll behavior</span>
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-comment">// Right click</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Right click"</span>);
      <span class="hljs-keyword">break</span>;
  }

  <span class="hljs-comment">// Modifier key combinations</span>
  <span class="hljs-keyword">if</span> (event.ctrlKey &amp;&amp; event.shiftKey) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Ctrl+Shift+Click"</span>);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (event.ctrlKey) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Ctrl+Click"</span>);
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleKeyPress</span>(<span class="hljs-params">event</span>) </span>{
  <span class="hljs-comment">// Common key combinations</span>
  <span class="hljs-keyword">if</span> (event.ctrlKey || event.metaKey) {
    <span class="hljs-keyword">switch</span> (event.key) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"s"</span>:
        event.preventDefault();
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Save shortcut"</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"z"</span>:
        event.preventDefault();
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Undo shortcut"</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"y"</span>:
        event.preventDefault();
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Redo shortcut"</span>);
        <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-comment">// Navigation keys</span>
  <span class="hljs-keyword">switch</span> (event.key) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"Escape"</span>:
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Close modal or cancel action"</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"Enter"</span>:
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Submit or confirm"</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">"Tab"</span>:
      <span class="hljs-comment">// Don't prevent default - let normal tab behavior work</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Tab navigation"</span>);
      <span class="hljs-keyword">break</span>;
  }
}
</div></code></pre>
<h2 id="%F0%9F%8E%AA-event-types-and-examples">🎪 Event Types and Examples</h2>
<h3 id="mouse-events">Mouse Events</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".interactive"</span>);

<span class="hljs-comment">// Basic mouse events</span>
element.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Single click"</span>);
});

element.addEventListener(<span class="hljs-string">"dblclick"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Double click"</span>);
});

element.addEventListener(<span class="hljs-string">"contextmenu"</span>, (e) =&gt; {
  e.preventDefault(); <span class="hljs-comment">// Prevent right-click menu</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Right click"</span>);
});

<span class="hljs-comment">// Mouse movement events</span>
element.addEventListener(<span class="hljs-string">"mouseenter"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse entered element"</span>);
  e.target.classList.add(<span class="hljs-string">"hovered"</span>);
});

element.addEventListener(<span class="hljs-string">"mouseleave"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse left element"</span>);
  e.target.classList.remove(<span class="hljs-string">"hovered"</span>);
});

element.addEventListener(<span class="hljs-string">"mouseover"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse over (bubbles from children)"</span>);
});

element.addEventListener(<span class="hljs-string">"mouseout"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse out (bubbles from children)"</span>);
});

element.addEventListener(<span class="hljs-string">"mousemove"</span>, (e) =&gt; {
  <span class="hljs-comment">// Be careful - this fires very frequently!</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Mouse at: <span class="hljs-subst">${e.clientX}</span>, <span class="hljs-subst">${e.clientY}</span>`</span>);
});

<span class="hljs-comment">// Mouse button events</span>
element.addEventListener(<span class="hljs-string">"mousedown"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse button pressed"</span>);
  e.target.classList.add(<span class="hljs-string">"pressed"</span>);
});

element.addEventListener(<span class="hljs-string">"mouseup"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse button released"</span>);
  e.target.classList.remove(<span class="hljs-string">"pressed"</span>);
});

<span class="hljs-comment">// Practical mouse event examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createDraggableElement</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">let</span> isDragging = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">let</span> startX, startY, initialX, initialY;

  element.addEventListener(<span class="hljs-string">"mousedown"</span>, (e) =&gt; {
    isDragging = <span class="hljs-literal">true</span>;
    startX = e.clientX;
    startY = e.clientY;

    <span class="hljs-keyword">const</span> rect = element.getBoundingClientRect();
    initialX = rect.left;
    initialY = rect.top;

    element.style.cursor = <span class="hljs-string">"grabbing"</span>;
    e.preventDefault(); <span class="hljs-comment">// Prevent text selection</span>
  });

  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"mousemove"</span>, (e) =&gt; {
    <span class="hljs-keyword">if</span> (!isDragging) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> deltaX = e.clientX - startX;
    <span class="hljs-keyword">const</span> deltaY = e.clientY - startY;

    element.style.left = <span class="hljs-string">`<span class="hljs-subst">${initialX + deltaX}</span>px`</span>;
    element.style.top = <span class="hljs-string">`<span class="hljs-subst">${initialY + deltaY}</span>px`</span>;
  });

  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"mouseup"</span>, () =&gt; {
    <span class="hljs-keyword">if</span> (isDragging) {
      isDragging = <span class="hljs-literal">false</span>;
      element.style.cursor = <span class="hljs-string">"grab"</span>;
    }
  });
}

<span class="hljs-comment">// Mouse tracking utility</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MouseTracker</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.position = { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> };
    <span class="hljs-keyword">this</span>.isDown = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.button = <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"mousemove"</span>, (e) =&gt; {
      <span class="hljs-keyword">this</span>.position.x = e.clientX;
      <span class="hljs-keyword">this</span>.position.y = e.clientY;
    });

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"mousedown"</span>, (e) =&gt; {
      <span class="hljs-keyword">this</span>.isDown = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.button = e.button;
    });

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"mouseup"</span>, () =&gt; {
      <span class="hljs-keyword">this</span>.isDown = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">this</span>.button = <span class="hljs-literal">null</span>;
    });
  }

  getPosition() {
    <span class="hljs-keyword">return</span> { ...this.position };
  }

  isMouseDown() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isDown;
  }

  getButton() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.button;
  }
}

<span class="hljs-keyword">const</span> mouseTracker = <span class="hljs-keyword">new</span> MouseTracker();

<span class="hljs-comment">// Usage</span>
setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">if</span> (mouseTracker.isMouseDown()) {
    <span class="hljs-keyword">const</span> pos = mouseTracker.getPosition();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Mouse down at: <span class="hljs-subst">${pos.x}</span>, <span class="hljs-subst">${pos.y}</span>`</span>);
  }
}, <span class="hljs-number">100</span>);
</div></code></pre>
<h3 id="keyboard-events">Keyboard Events</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Keyboard event types</span>
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Key pressed down:"</span>, e.key);
  <span class="hljs-comment">// Fires repeatedly while key is held</span>
});

<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keyup"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Key released:"</span>, e.key);
  <span class="hljs-comment">// Fires once when key is released</span>
});

<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keypress"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Key pressed (deprecated):"</span>, e.key);
  <span class="hljs-comment">// Deprecated - use keydown instead</span>
});

<span class="hljs-comment">// Input-specific events (for form elements)</span>
<span class="hljs-keyword">const</span> input = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"input"</span>);

input.addEventListener(<span class="hljs-string">"input"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Input value changed:"</span>, e.target.value);
  <span class="hljs-comment">// Fires on every character change</span>
});

input.addEventListener(<span class="hljs-string">"change"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Input lost focus with changes:"</span>, e.target.value);
  <span class="hljs-comment">// Fires when element loses focus and value has changed</span>
});

input.addEventListener(<span class="hljs-string">"focus"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Input gained focus"</span>);
  e.target.classList.add(<span class="hljs-string">"focused"</span>);
});

input.addEventListener(<span class="hljs-string">"blur"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Input lost focus"</span>);
  e.target.classList.remove(<span class="hljs-string">"focused"</span>);
});

<span class="hljs-comment">// Keyboard shortcuts system</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeyboardShortcuts</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.shortcuts = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.pressedKeys = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();

    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, (e) =&gt; {
      <span class="hljs-keyword">this</span>.pressedKeys.add(e.code);
      <span class="hljs-keyword">this</span>.checkShortcuts(e);
    });

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keyup"</span>, (e) =&gt; {
      <span class="hljs-keyword">this</span>.pressedKeys.delete(e.code);
    });

    <span class="hljs-comment">// Clear pressed keys when window loses focus</span>
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"blur"</span>, () =&gt; {
      <span class="hljs-keyword">this</span>.pressedKeys.clear();
    });
  }

  addShortcut(keys, callback, description = <span class="hljs-string">""</span>) {
    <span class="hljs-keyword">const</span> keyString = <span class="hljs-built_in">Array</span>.isArray(keys) ? keys.join(<span class="hljs-string">"+"</span>) : keys;
    <span class="hljs-keyword">this</span>.shortcuts.set(keyString.toLowerCase(), {
      callback,
      description,
      <span class="hljs-attr">keys</span>: <span class="hljs-built_in">Array</span>.isArray(keys) ? keys : [keys],
    });
  }

  removeShortcut(keys) {
    <span class="hljs-keyword">const</span> keyString = <span class="hljs-built_in">Array</span>.isArray(keys) ? keys.join(<span class="hljs-string">"+"</span>) : keys;
    <span class="hljs-keyword">this</span>.shortcuts.delete(keyString.toLowerCase());
  }

  checkShortcuts(event) {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [keyString, shortcut] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.shortcuts) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isShortcutPressed(shortcut.keys, event)) {
        event.preventDefault();
        shortcut.callback(event);
        <span class="hljs-keyword">break</span>;
      }
    }
  }

  isShortcutPressed(keys, event) {
    <span class="hljs-comment">// Check if all required keys are pressed</span>
    <span class="hljs-keyword">return</span> keys.every(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"ctrl"</span>) <span class="hljs-keyword">return</span> event.ctrlKey;
      <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"shift"</span>) <span class="hljs-keyword">return</span> event.shiftKey;
      <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"alt"</span>) <span class="hljs-keyword">return</span> event.altKey;
      <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"meta"</span>) <span class="hljs-keyword">return</span> event.metaKey;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pressedKeys.has(key) || event.code === key;
    });
  }

  getShortcuts() {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.from(<span class="hljs-keyword">this</span>.shortcuts.entries()).map(<span class="hljs-function">(<span class="hljs-params">[keys, data]</span>) =&gt;</span> ({
      keys,
      <span class="hljs-attr">description</span>: data.description,
    }));
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> shortcuts = <span class="hljs-keyword">new</span> KeyboardShortcuts();

<span class="hljs-comment">// Add shortcuts</span>
shortcuts.addShortcut(
  [<span class="hljs-string">"ctrl"</span>, <span class="hljs-string">"KeyS"</span>],
  () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Save document"</span>);
  },
  <span class="hljs-string">"Save document"</span>
);

shortcuts.addShortcut(
  [<span class="hljs-string">"ctrl"</span>, <span class="hljs-string">"shift"</span>, <span class="hljs-string">"KeyZ"</span>],
  () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Redo action"</span>);
  },
  <span class="hljs-string">"Redo last action"</span>
);

shortcuts.addShortcut(
  [<span class="hljs-string">"Escape"</span>],
  () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Close modal"</span>);
  },
  <span class="hljs-string">"Close modal or cancel"</span>
);

<span class="hljs-comment">// Form validation with keyboard events</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setupFormValidation</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">const</span> inputs = form.querySelectorAll(<span class="hljs-string">"input, textarea, select"</span>);

  inputs.forEach(<span class="hljs-function">(<span class="hljs-params">input</span>) =&gt;</span> {
    <span class="hljs-comment">// Real-time validation</span>
    input.addEventListener(<span class="hljs-string">"input"</span>, (e) =&gt; {
      validateField(e.target);
    });

    <span class="hljs-comment">// Validation on blur</span>
    input.addEventListener(<span class="hljs-string">"blur"</span>, (e) =&gt; {
      validateField(e.target);
    });

    <span class="hljs-comment">// Enter key handling</span>
    input.addEventListener(<span class="hljs-string">"keydown"</span>, (e) =&gt; {
      <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">"Enter"</span>) {
        <span class="hljs-keyword">if</span> (input.type === <span class="hljs-string">"textarea"</span> &amp;&amp; !e.shiftKey) {
          <span class="hljs-comment">// Allow line breaks with Shift+Enter</span>
          <span class="hljs-keyword">return</span>;
        }

        e.preventDefault();

        <span class="hljs-comment">// Move to next field or submit</span>
        <span class="hljs-keyword">const</span> nextInput = getNextInput(input, inputs);
        <span class="hljs-keyword">if</span> (nextInput) {
          nextInput.focus();
        } <span class="hljs-keyword">else</span> {
          form.requestSubmit();
        }
      }
    });
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getNextInput</span>(<span class="hljs-params">currentInput, allInputs</span>) </span>{
  <span class="hljs-keyword">const</span> currentIndex = <span class="hljs-built_in">Array</span>.from(allInputs).indexOf(currentInput);
  <span class="hljs-keyword">return</span> allInputs[currentIndex + <span class="hljs-number">1</span>] || <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateField</span>(<span class="hljs-params">field</span>) </span>{
  <span class="hljs-comment">// Add your validation logic here</span>
  <span class="hljs-keyword">const</span> isValid = field.value.trim() !== <span class="hljs-string">""</span>;
  field.classList.toggle(<span class="hljs-string">"invalid"</span>, !isValid);
  <span class="hljs-keyword">return</span> isValid;
}
</div></code></pre>
<h3 id="form-events">Form Events</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> form = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-form"</span>);
<span class="hljs-keyword">const</span> inputs = form.querySelectorAll(<span class="hljs-string">"input, select, textarea"</span>);

<span class="hljs-comment">// Form submission</span>
form.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt; {
  e.preventDefault(); <span class="hljs-comment">// Prevent default form submission</span>

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted"</span>);

  <span class="hljs-comment">// Get form data</span>
  <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(form);
  <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">Object</span>.fromEntries(formData.entries());

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form data:"</span>, data);

  <span class="hljs-comment">// Validate form</span>
  <span class="hljs-keyword">if</span> (validateForm(form)) {
    submitForm(data);
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form validation failed"</span>);
  }
});

<span class="hljs-comment">// Form reset</span>
form.addEventListener(<span class="hljs-string">"reset"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form reset"</span>);

  <span class="hljs-comment">// Custom reset logic if needed</span>
  inputs.forEach(<span class="hljs-function">(<span class="hljs-params">input</span>) =&gt;</span> {
    input.classList.remove(<span class="hljs-string">"invalid"</span>, <span class="hljs-string">"valid"</span>);
  });
});

<span class="hljs-comment">// Input events for different field types</span>
inputs.forEach(<span class="hljs-function">(<span class="hljs-params">input</span>) =&gt;</span> {
  <span class="hljs-comment">// Universal input event</span>
  input.addEventListener(<span class="hljs-string">"input"</span>, (e) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${e.target.name}</span> changed to:`</span>, e.target.value);

    <span class="hljs-comment">// Real-time validation</span>
    validateField(e.target);

    <span class="hljs-comment">// Auto-save draft</span>
    saveDraft(form);
  });

  <span class="hljs-comment">// Focus events</span>
  input.addEventListener(<span class="hljs-string">"focus"</span>, (e) =&gt; {
    e.target.classList.add(<span class="hljs-string">"focused"</span>);

    <span class="hljs-comment">// Show help text</span>
    showFieldHelp(e.target);
  });

  input.addEventListener(<span class="hljs-string">"blur"</span>, (e) =&gt; {
    e.target.classList.remove(<span class="hljs-string">"focused"</span>);

    <span class="hljs-comment">// Hide help text</span>
    hideFieldHelp(e.target);

    <span class="hljs-comment">// Final validation</span>
    validateField(e.target);
  });
});

<span class="hljs-comment">// Specific input type events</span>
<span class="hljs-keyword">const</span> fileInput = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'input[type="file"]'</span>);
<span class="hljs-keyword">if</span> (fileInput) {
  fileInput.addEventListener(<span class="hljs-string">"change"</span>, (e) =&gt; {
    <span class="hljs-keyword">const</span> files = <span class="hljs-built_in">Array</span>.from(e.target.files);
    <span class="hljs-built_in">console</span>.log(
      <span class="hljs-string">"Files selected:"</span>,
      files.map(<span class="hljs-function">(<span class="hljs-params">f</span>) =&gt;</span> f.name)
    );

    <span class="hljs-comment">// Validate file types and sizes</span>
    files.forEach(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (file.size &gt; <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>) {
        <span class="hljs-comment">// 5MB limit</span>
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"File too large:"</span>, file.name);
      }
    });

    <span class="hljs-comment">// Preview images</span>
    files.forEach(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (file.type.startsWith(<span class="hljs-string">"image/"</span>)) {
        previewImage(file);
      }
    });
  });
}

<span class="hljs-keyword">const</span> selectElement = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"select"</span>);
<span class="hljs-keyword">if</span> (selectElement) {
  selectElement.addEventListener(<span class="hljs-string">"change"</span>, (e) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Selection changed to:"</span>, e.target.value);

    <span class="hljs-comment">// Show/hide dependent fields</span>
    toggleDependentFields(e.target.value);
  });
}

<span class="hljs-comment">// Checkbox and radio events</span>
<span class="hljs-keyword">const</span> checkboxes = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">'input[type="checkbox"]'</span>);
checkboxes.forEach(<span class="hljs-function">(<span class="hljs-params">checkbox</span>) =&gt;</span> {
  checkbox.addEventListener(<span class="hljs-string">"change"</span>, (e) =&gt; {
    <span class="hljs-built_in">console</span>.log(
      <span class="hljs-string">`<span class="hljs-subst">${e.target.name}</span> <span class="hljs-subst">${e.target.checked ? <span class="hljs-string">"checked"</span> : <span class="hljs-string">"unchecked"</span>}</span>`</span>
    );

    <span class="hljs-comment">// Handle "select all" functionality</span>
    <span class="hljs-keyword">if</span> (e.target.classList.contains(<span class="hljs-string">"select-all"</span>)) {
      <span class="hljs-keyword">const</span> relatedCheckboxes = <span class="hljs-built_in">document</span>.querySelectorAll(
        <span class="hljs-string">`input[name="<span class="hljs-subst">${e.target.dataset.group}</span>"]`</span>
      );
      relatedCheckboxes.forEach(<span class="hljs-function">(<span class="hljs-params">cb</span>) =&gt;</span> {
        cb.checked = e.target.checked;
      });
    }
  });
});

<span class="hljs-comment">// Form utilities</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateForm</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">const</span> inputs = form.querySelectorAll(
    <span class="hljs-string">"input[required], select[required], textarea[required]"</span>
  );
  <span class="hljs-keyword">let</span> isValid = <span class="hljs-literal">true</span>;

  inputs.forEach(<span class="hljs-function">(<span class="hljs-params">input</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!validateField(input)) {
      isValid = <span class="hljs-literal">false</span>;
    }
  });

  <span class="hljs-keyword">return</span> isValid;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">saveDraft</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(form);
  <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">Object</span>.fromEntries(formData.entries());

  localStorage.setItem(<span class="hljs-string">`draft_<span class="hljs-subst">${form.id}</span>`</span>, <span class="hljs-built_in">JSON</span>.stringify(data));
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadDraft</span>(<span class="hljs-params">form</span>) </span>{
  <span class="hljs-keyword">const</span> draft = localStorage.getItem(<span class="hljs-string">`draft_<span class="hljs-subst">${form.id}</span>`</span>);
  <span class="hljs-keyword">if</span> (draft) {
    <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">JSON</span>.parse(draft);

    <span class="hljs-built_in">Object</span>.entries(data).forEach(<span class="hljs-function">(<span class="hljs-params">[name, value]</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> field = form.elements[name];
      <span class="hljs-keyword">if</span> (field) {
        <span class="hljs-keyword">if</span> (field.type === <span class="hljs-string">"checkbox"</span> || field.type === <span class="hljs-string">"radio"</span>) {
          field.checked = value === <span class="hljs-string">"on"</span>;
        } <span class="hljs-keyword">else</span> {
          field.value = value;
        }
      }
    });
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearDraft</span>(<span class="hljs-params">form</span>) </span>{
  localStorage.removeItem(<span class="hljs-string">`draft_<span class="hljs-subst">${form.id}</span>`</span>);
}

<span class="hljs-comment">// Auto-save functionality</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AutoSave</span> </span>{
  <span class="hljs-keyword">constructor</span>(form, options = {}) {
    <span class="hljs-keyword">this</span>.form = form;
    <span class="hljs-keyword">this</span>.options = {
      <span class="hljs-attr">interval</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// 30 seconds</span>
      <span class="hljs-attr">storageKey</span>: <span class="hljs-string">`autosave_<span class="hljs-subst">${form.id}</span>`</span>,
      ...options,
    };

    <span class="hljs-keyword">this</span>.timeoutId = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-keyword">this</span>.form.addEventListener(<span class="hljs-string">"input"</span>, () =&gt; {
      <span class="hljs-keyword">this</span>.scheduleAutoSave();
    });

    <span class="hljs-comment">// Load saved data on page load</span>
    <span class="hljs-keyword">this</span>.loadAutoSave();
  }

  scheduleAutoSave() {
    clearTimeout(<span class="hljs-keyword">this</span>.timeoutId);

    <span class="hljs-keyword">this</span>.timeoutId = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">this</span>.saveForm();
    }, <span class="hljs-keyword">this</span>.options.interval);
  }

  saveForm() {
    <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(<span class="hljs-keyword">this</span>.form);
    <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">Object</span>.fromEntries(formData.entries());

    localStorage.setItem(
      <span class="hljs-keyword">this</span>.options.storageKey,
      <span class="hljs-built_in">JSON</span>.stringify({
        data,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
      })
    );

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form auto-saved"</span>);
  }

  loadAutoSave() {
    <span class="hljs-keyword">const</span> saved = localStorage.getItem(<span class="hljs-keyword">this</span>.options.storageKey);
    <span class="hljs-keyword">if</span> (saved) {
      <span class="hljs-keyword">const</span> { data, timestamp } = <span class="hljs-built_in">JSON</span>.parse(saved);

      <span class="hljs-comment">// Check if data is not too old (e.g., 24 hours)</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Date</span>.now() - timestamp &lt; <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>) {
        <span class="hljs-built_in">Object</span>.entries(data).forEach(<span class="hljs-function">(<span class="hljs-params">[name, value]</span>) =&gt;</span> {
          <span class="hljs-keyword">const</span> field = <span class="hljs-keyword">this</span>.form.elements[name];
          <span class="hljs-keyword">if</span> (field &amp;&amp; field.value === <span class="hljs-string">""</span>) {
            <span class="hljs-comment">// Only fill empty fields</span>
            field.value = value;
          }
        });

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Auto-saved data loaded"</span>);
      }
    }
  }

  clearAutoSave() {
    localStorage.removeItem(<span class="hljs-keyword">this</span>.options.storageKey);
    clearTimeout(<span class="hljs-keyword">this</span>.timeoutId);
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> autoSave = <span class="hljs-keyword">new</span> AutoSave(form, {
  <span class="hljs-attr">interval</span>: <span class="hljs-number">10000</span>, <span class="hljs-comment">// Save every 10 seconds</span>
  <span class="hljs-attr">storageKey</span>: <span class="hljs-string">"my_form_autosave"</span>,
});
</div></code></pre>
<h3 id="window-and-document-events">Window and Document Events</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Page lifecycle events</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"load"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Page fully loaded (including images, stylesheets)"</span>);
  <span class="hljs-comment">// Initialize heavy components here</span>
});

<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"DOM fully loaded (before images, stylesheets)"</span>);
  <span class="hljs-comment">// Initialize DOM-dependent code here</span>
});

<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"beforeunload"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User is about to leave the page"</span>);

  <span class="hljs-comment">// Show confirmation dialog for unsaved changes</span>
  <span class="hljs-keyword">if</span> (hasUnsavedChanges()) {
    e.preventDefault();
    e.returnValue = <span class="hljs-string">""</span>; <span class="hljs-comment">// Required for some browsers</span>
    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>; <span class="hljs-comment">// Required for some browsers</span>
  }
});

<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unload"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Page is being unloaded"</span>);
  <span class="hljs-comment">// Clean up, send analytics, etc.</span>
  <span class="hljs-comment">// Note: Limited time and functionality here</span>
});

<span class="hljs-comment">// Visibility API</span>
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"visibilitychange"</span>, () =&gt; {
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.hidden) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Page is hidden (tab switched, minimized)"</span>);
    <span class="hljs-comment">// Pause animations, stop timers</span>
    pauseApplication();
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Page is visible again"</span>);
    <span class="hljs-comment">// Resume animations, restart timers</span>
    resumeApplication();
  }
});

<span class="hljs-comment">// Window resize and scroll</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"resize"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Window resized to:"</span>, <span class="hljs-built_in">window</span>.innerWidth, <span class="hljs-string">"x"</span>, <span class="hljs-built_in">window</span>.innerHeight);

  <span class="hljs-comment">// Debounce resize events</span>
  clearTimeout(<span class="hljs-built_in">window</span>.resizeTimeout);
  <span class="hljs-built_in">window</span>.resizeTimeout = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    handleResize();
  }, <span class="hljs-number">250</span>);
});

<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"scroll"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Page scrolled to:"</span>, <span class="hljs-built_in">window</span>.pageYOffset);

  <span class="hljs-comment">// Throttle scroll events</span>
  <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">window</span>.scrolling) {
    <span class="hljs-built_in">window</span>.scrolling = <span class="hljs-literal">true</span>;
    requestAnimationFrame(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      handleScroll();
      <span class="hljs-built_in">window</span>.scrolling = <span class="hljs-literal">false</span>;
    });
  }
});

<span class="hljs-comment">// Focus and blur (for entire window)</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"focus"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Window gained focus"</span>);
  <span class="hljs-comment">// Resume real-time updates</span>
});

<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"blur"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Window lost focus"</span>);
  <span class="hljs-comment">// Pause real-time updates to save resources</span>
});

<span class="hljs-comment">// Error handling</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"error"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Global error:"</span>, e.error);
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error details:"</span>, {
    <span class="hljs-attr">message</span>: e.message,
    <span class="hljs-attr">filename</span>: e.filename,
    <span class="hljs-attr">lineno</span>: e.lineno,
    <span class="hljs-attr">colno</span>: e.colno,
  });

  <span class="hljs-comment">// Send error to logging service</span>
  logError(e.error);
});

<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unhandledrejection"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Unhandled promise rejection:"</span>, e.reason);

  <span class="hljs-comment">// Prevent the default browser behavior</span>
  e.preventDefault();

  <span class="hljs-comment">// Send error to logging service</span>
  logError(e.reason);
});

<span class="hljs-comment">// Utility functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasUnsavedChanges</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Check if there are unsaved changes</span>
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".dirty"</span>) !== <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">pauseApplication</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Pause animations, timers, etc.</span>
  <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"video, audio"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">media</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!media.paused) {
      media.pause();
      media.dataset.wasPlaying = <span class="hljs-string">"true"</span>;
    }
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resumeApplication</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Resume animations, timers, etc.</span>
  <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"video, audio"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">media</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (media.dataset.wasPlaying === <span class="hljs-string">"true"</span>) {
      media.play();
      <span class="hljs-keyword">delete</span> media.dataset.wasPlaying;
    }
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleResize</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Handling resize..."</span>);
  <span class="hljs-comment">// Recalculate layouts, update responsive components</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleScroll</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Handling scroll..."</span>);
  <span class="hljs-comment">// Update scroll-dependent UI elements</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logError</span>(<span class="hljs-params">error</span>) </span>{
  <span class="hljs-comment">// Send error to logging service</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Logging error:"</span>, error);
}

<span class="hljs-comment">// Performance monitoring</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceMonitor</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.metrics = {
      <span class="hljs-attr">pageLoadTime</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">domContentLoadedTime</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">firstPaintTime</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">firstContentfulPaintTime</span>: <span class="hljs-number">0</span>,
    };

    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-comment">// Page load metrics</span>
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"load"</span>, () =&gt; {
      <span class="hljs-keyword">this</span>.metrics.pageLoadTime = performance.now();
      <span class="hljs-keyword">this</span>.reportMetrics();
    });

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, () =&gt; {
      <span class="hljs-keyword">this</span>.metrics.domContentLoadedTime = performance.now();
    });

    <span class="hljs-comment">// Paint metrics (if supported)</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"PerformanceObserver"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) {
      <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> list.getEntries()) {
          <span class="hljs-keyword">if</span> (entry.name === <span class="hljs-string">"first-paint"</span>) {
            <span class="hljs-keyword">this</span>.metrics.firstPaintTime = entry.startTime;
          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (entry.name === <span class="hljs-string">"first-contentful-paint"</span>) {
            <span class="hljs-keyword">this</span>.metrics.firstContentfulPaintTime = entry.startTime;
          }
        }
      });

      observer.observe({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"paint"</span>] });
    }
  }

  reportMetrics() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Performance Metrics:"</span>, <span class="hljs-keyword">this</span>.metrics);

    <span class="hljs-comment">// Send to analytics service</span>
    <span class="hljs-comment">// analytics.track('page_performance', this.metrics);</span>
  }

  getMetrics() {
    <span class="hljs-keyword">return</span> { ...this.metrics };
  }
}

<span class="hljs-keyword">const</span> performanceMonitor = <span class="hljs-keyword">new</span> PerformanceMonitor();
</div></code></pre>
<h2 id="%F0%9F%8E%AF-event-delegation">🎯 Event Delegation</h2>
<h3 id="basic-event-delegation">Basic Event Delegation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Adding listeners to many elements (inefficient)</span>
<span class="hljs-keyword">const</span> buttons = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".btn"</span>);
buttons.forEach(<span class="hljs-function">(<span class="hljs-params">button</span>) =&gt;</span> {
  button.addEventListener(<span class="hljs-string">"click"</span>, handleButtonClick);
});

<span class="hljs-comment">// ✅ Event delegation (efficient)</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".button-container"</span>);
container.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".btn"</span>)) {
    handleButtonClick(e);
  }
});

<span class="hljs-comment">// More complex delegation with multiple selectors</span>
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-comment">// Handle different types of elements</span>
  <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".btn-primary"</span>)) {
    handlePrimaryButton(e);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".btn-secondary"</span>)) {
    handleSecondaryButton(e);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".delete-btn"</span>)) {
    handleDeleteButton(e);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.target.closest(<span class="hljs-string">".card"</span>)) {
    handleCardClick(e);
  }
});

<span class="hljs-comment">// Delegation utility function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">delegate</span>(<span class="hljs-params">container, selector, eventType, handler</span>) </span>{
  container.addEventListener(eventType, (e) =&gt; {
    <span class="hljs-keyword">const</span> target = e.target.closest(selector);
    <span class="hljs-keyword">if</span> (target &amp;&amp; container.contains(target)) {
      handler.call(target, e);
    }
  });
}

<span class="hljs-comment">// Usage</span>
delegate(<span class="hljs-built_in">document</span>, <span class="hljs-string">".btn"</span>, <span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked:"</span>, <span class="hljs-keyword">this</span>.textContent);
});

delegate(<span class="hljs-built_in">document</span>, <span class="hljs-string">".card"</span>, <span class="hljs-string">"mouseenter"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">this</span>.classList.add(<span class="hljs-string">"hovered"</span>);
});

delegate(<span class="hljs-built_in">document</span>, <span class="hljs-string">".card"</span>, <span class="hljs-string">"mouseleave"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">this</span>.classList.remove(<span class="hljs-string">"hovered"</span>);
});
</div></code></pre>
<h3 id="advanced-event-delegation">Advanced Event Delegation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Event delegation class for complex scenarios</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventDelegator</span> </span>{
  <span class="hljs-keyword">constructor</span>(container) {
    <span class="hljs-keyword">this</span>.container =
      <span class="hljs-keyword">typeof</span> container === <span class="hljs-string">"string"</span>
        ? <span class="hljs-built_in">document</span>.querySelector(container)
        : container;
    <span class="hljs-keyword">this</span>.handlers = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-comment">// Single event listener for all delegated events</span>
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt;
      <span class="hljs-keyword">this</span>.handleEvent(e, <span class="hljs-string">"click"</span>)
    );
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"change"</span>, (e) =&gt;
      <span class="hljs-keyword">this</span>.handleEvent(e, <span class="hljs-string">"change"</span>)
    );
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"input"</span>, (e) =&gt;
      <span class="hljs-keyword">this</span>.handleEvent(e, <span class="hljs-string">"input"</span>)
    );
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt;
      <span class="hljs-keyword">this</span>.handleEvent(e, <span class="hljs-string">"submit"</span>)
    );
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"keydown"</span>, (e) =&gt;
      <span class="hljs-keyword">this</span>.handleEvent(e, <span class="hljs-string">"keydown"</span>)
    );
  }

  handleEvent(e, eventType) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${eventType}</span>:<span class="hljs-subst">${e.target.tagName.toLowerCase()}</span>`</span>;

    <span class="hljs-comment">// Check for specific handlers</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [selector, handler] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.handlers) {
      <span class="hljs-keyword">if</span> (selector.startsWith(eventType + <span class="hljs-string">":"</span>)) {
        <span class="hljs-keyword">const</span> selectorPart = selector.substring(eventType.length + <span class="hljs-number">1</span>);
        <span class="hljs-keyword">const</span> target = e.target.closest(selectorPart);

        <span class="hljs-keyword">if</span> (target &amp;&amp; <span class="hljs-keyword">this</span>.container.contains(target)) {
          handler.call(target, e);
        }
      }
    }
  }

  on(eventType, selector, handler) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${eventType}</span>:<span class="hljs-subst">${selector}</span>`</span>;
    <span class="hljs-keyword">this</span>.handlers.set(key, handler);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>; <span class="hljs-comment">// For chaining</span>
  }

  off(eventType, selector) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${eventType}</span>:<span class="hljs-subst">${selector}</span>`</span>;
    <span class="hljs-keyword">this</span>.handlers.delete(key);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }

  destroy() {
    <span class="hljs-keyword">this</span>.handlers.clear();
    <span class="hljs-comment">// Note: In a real implementation, you'd also remove the event listeners</span>
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> delegator = <span class="hljs-keyword">new</span> EventDelegator(<span class="hljs-string">"#app"</span>);

delegator
  .on(<span class="hljs-string">"click"</span>, <span class="hljs-string">".btn-save"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Save button clicked"</span>);
    saveData();
  })
  .on(<span class="hljs-string">"click"</span>, <span class="hljs-string">".btn-delete"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Delete button clicked"</span>);
    <span class="hljs-keyword">if</span> (confirm(<span class="hljs-string">"Are you sure?"</span>)) {
      deleteItem(<span class="hljs-keyword">this</span>.dataset.id);
    }
  })
  .on(<span class="hljs-string">"change"</span>, <span class="hljs-string">"select.category"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Category changed to:"</span>, <span class="hljs-keyword">this</span>.value);
    updateSubcategories(<span class="hljs-keyword">this</span>.value);
  })
  .on(<span class="hljs-string">"input"</span>, <span class="hljs-string">"input.search"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Search input:"</span>, <span class="hljs-keyword">this</span>.value);
    debounce(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> performSearch(<span class="hljs-keyword">this</span>.value), <span class="hljs-number">300</span>)();
  });

<span class="hljs-comment">// Dynamic list management with delegation</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DynamicList</span> </span>{
  <span class="hljs-keyword">constructor</span>(container) {
    <span class="hljs-keyword">this</span>.container = <span class="hljs-built_in">document</span>.querySelector(container);
    <span class="hljs-keyword">this</span>.items = [];

    <span class="hljs-keyword">this</span>.setupEventDelegation();
  }

  setupEventDelegation() {
    <span class="hljs-comment">// Handle all list item interactions through delegation</span>
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
      <span class="hljs-keyword">const</span> listItem = e.target.closest(<span class="hljs-string">".list-item"</span>);
      <span class="hljs-keyword">if</span> (!listItem) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">const</span> itemId = listItem.dataset.id;

      <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".edit-btn"</span>)) {
        <span class="hljs-keyword">this</span>.editItem(itemId);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".delete-btn"</span>)) {
        <span class="hljs-keyword">this</span>.deleteItem(itemId);
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".toggle-btn"</span>)) {
        <span class="hljs-keyword">this</span>.toggleItem(itemId);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.selectItem(itemId);
      }
    });

    <span class="hljs-comment">// Handle keyboard navigation</span>
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"keydown"</span>, (e) =&gt; {
      <span class="hljs-keyword">const</span> listItem = e.target.closest(<span class="hljs-string">".list-item"</span>);
      <span class="hljs-keyword">if</span> (!listItem) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">switch</span> (e.key) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"Enter"</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">" "</span>:
          e.preventDefault();
          <span class="hljs-keyword">this</span>.selectItem(listItem.dataset.id);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"Delete"</span>:
        <span class="hljs-keyword">case</span> <span class="hljs-string">"Backspace"</span>:
          e.preventDefault();
          <span class="hljs-keyword">this</span>.deleteItem(listItem.dataset.id);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"ArrowUp"</span>:
          e.preventDefault();
          <span class="hljs-keyword">this</span>.focusPreviousItem(listItem);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"ArrowDown"</span>:
          e.preventDefault();
          <span class="hljs-keyword">this</span>.focusNextItem(listItem);
          <span class="hljs-keyword">break</span>;
      }
    });
  }

  addItem(data) {
    <span class="hljs-keyword">const</span> item = {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now().toString(),
      ...data,
    };

    <span class="hljs-keyword">this</span>.items.push(item);

    <span class="hljs-keyword">const</span> element = <span class="hljs-keyword">this</span>.createItemElement(item);
    <span class="hljs-keyword">this</span>.container.appendChild(element);

    <span class="hljs-keyword">return</span> item;
  }

  createItemElement(item) {
    <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    element.className = <span class="hljs-string">"list-item"</span>;
    element.dataset.id = item.id;
    element.tabIndex = <span class="hljs-number">0</span>;

    element.innerHTML = <span class="hljs-string">`
            &lt;span class="item-text"&gt;<span class="hljs-subst">${item.text}</span>&lt;/span&gt;
            &lt;div class="item-actions"&gt;
                &lt;button class="edit-btn" type="button"&gt;Edit&lt;/button&gt;
                &lt;button class="toggle-btn" type="button"&gt;
                    <span class="hljs-subst">${item.completed ? <span class="hljs-string">"Undo"</span> : <span class="hljs-string">"Complete"</span>}</span>
                &lt;/button&gt;
                &lt;button class="delete-btn" type="button"&gt;Delete&lt;/button&gt;
            &lt;/div&gt;
        `</span>;

    <span class="hljs-keyword">if</span> (item.completed) {
      element.classList.add(<span class="hljs-string">"completed"</span>);
    }

    <span class="hljs-keyword">return</span> element;
  }

  editItem(id) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Edit item:"</span>, id);
    <span class="hljs-comment">// Implementation for editing</span>
  }

  deleteItem(id) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Delete item:"</span>, id);

    <span class="hljs-keyword">const</span> index = <span class="hljs-keyword">this</span>.items.findIndex(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === id);
    <span class="hljs-keyword">if</span> (index !== <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">this</span>.items.splice(index, <span class="hljs-number">1</span>);

      <span class="hljs-keyword">const</span> element = <span class="hljs-keyword">this</span>.container.querySelector(<span class="hljs-string">`[data-id="<span class="hljs-subst">${id}</span>"]`</span>);
      <span class="hljs-keyword">if</span> (element) {
        element.remove();
      }
    }
  }

  toggleItem(id) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Toggle item:"</span>, id);

    <span class="hljs-keyword">const</span> item = <span class="hljs-keyword">this</span>.items.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === id);
    <span class="hljs-keyword">if</span> (item) {
      item.completed = !item.completed;

      <span class="hljs-keyword">const</span> element = <span class="hljs-keyword">this</span>.container.querySelector(<span class="hljs-string">`[data-id="<span class="hljs-subst">${id}</span>"]`</span>);
      <span class="hljs-keyword">if</span> (element) {
        element.classList.toggle(<span class="hljs-string">"completed"</span>, item.completed);

        <span class="hljs-keyword">const</span> toggleBtn = element.querySelector(<span class="hljs-string">".toggle-btn"</span>);
        toggleBtn.textContent = item.completed ? <span class="hljs-string">"Undo"</span> : <span class="hljs-string">"Complete"</span>;
      }
    }
  }

  selectItem(id) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Select item:"</span>, id);

    <span class="hljs-comment">// Remove previous selection</span>
    <span class="hljs-keyword">this</span>.container.querySelectorAll(<span class="hljs-string">".list-item.selected"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      item.classList.remove(<span class="hljs-string">"selected"</span>);
    });

    <span class="hljs-comment">// Add selection to current item</span>
    <span class="hljs-keyword">const</span> element = <span class="hljs-keyword">this</span>.container.querySelector(<span class="hljs-string">`[data-id="<span class="hljs-subst">${id}</span>"]`</span>);
    <span class="hljs-keyword">if</span> (element) {
      element.classList.add(<span class="hljs-string">"selected"</span>);
      element.focus();
    }
  }

  focusPreviousItem(currentItem) {
    <span class="hljs-keyword">const</span> previousItem = currentItem.previousElementSibling;
    <span class="hljs-keyword">if</span> (previousItem &amp;&amp; previousItem.classList.contains(<span class="hljs-string">"list-item"</span>)) {
      previousItem.focus();
    }
  }

  focusNextItem(currentItem) {
    <span class="hljs-keyword">const</span> nextItem = currentItem.nextElementSibling;
    <span class="hljs-keyword">if</span> (nextItem &amp;&amp; nextItem.classList.contains(<span class="hljs-string">"list-item"</span>)) {
      nextItem.focus();
    }
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> todoList = <span class="hljs-keyword">new</span> DynamicList(<span class="hljs-string">"#todo-list"</span>);

todoList.addItem({ <span class="hljs-attr">text</span>: <span class="hljs-string">"Learn JavaScript"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> });
todoList.addItem({ <span class="hljs-attr">text</span>: <span class="hljs-string">"Build a project"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> });
todoList.addItem({ <span class="hljs-attr">text</span>: <span class="hljs-string">"Get a job"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> });
</div></code></pre>
<h2 id="%F0%9F%94%84-event-flow-and-propagation">🔄 Event Flow and Propagation</h2>
<h3 id="understanding-event-phases">Understanding Event Phases</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Event flow: Capture → Target → Bubble</span>

<span class="hljs-comment">// HTML structure:</span>
<span class="hljs-comment">// &lt;div id="outer"&gt;</span>
<span class="hljs-comment">//   &lt;div id="middle"&gt;</span>
<span class="hljs-comment">//     &lt;button id="inner"&gt;Click me&lt;/button&gt;</span>
<span class="hljs-comment">//   &lt;/div&gt;</span>
<span class="hljs-comment">// &lt;/div&gt;</span>

<span class="hljs-keyword">const</span> outer = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"outer"</span>);
<span class="hljs-keyword">const</span> middle = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"middle"</span>);
<span class="hljs-keyword">const</span> inner = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"inner"</span>);

<span class="hljs-comment">// Capture phase (top to bottom)</span>
outer.addEventListener(
  <span class="hljs-string">"click"</span>,
  (e) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Outer - Capture phase"</span>);
  },
  <span class="hljs-literal">true</span>
); <span class="hljs-comment">// true = capture phase</span>

middle.addEventListener(
  <span class="hljs-string">"click"</span>,
  (e) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Middle - Capture phase"</span>);
  },
  <span class="hljs-literal">true</span>
);

inner.addEventListener(
  <span class="hljs-string">"click"</span>,
  (e) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Inner - Capture phase"</span>);
  },
  <span class="hljs-literal">true</span>
);

<span class="hljs-comment">// Target phase (at the target element)</span>
inner.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Inner - Target phase"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Event phase:"</span>, e.eventPhase); <span class="hljs-comment">// 2 = AT_TARGET</span>
});

<span class="hljs-comment">// Bubble phase (bottom to top) - default</span>
inner.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Inner - Bubble phase"</span>);
});

middle.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Middle - Bubble phase"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Event phase:"</span>, e.eventPhase); <span class="hljs-comment">// 3 = BUBBLING_PHASE</span>
});

outer.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Outer - Bubble phase"</span>);
});

<span class="hljs-comment">// When you click the button, you'll see:</span>
<span class="hljs-comment">// Outer - Capture phase</span>
<span class="hljs-comment">// Middle - Capture phase</span>
<span class="hljs-comment">// Inner - Capture phase</span>
<span class="hljs-comment">// Inner - Target phase</span>
<span class="hljs-comment">// Inner - Bubble phase</span>
<span class="hljs-comment">// Middle - Bubble phase</span>
<span class="hljs-comment">// Outer - Bubble phase</span>
</div></code></pre>
<h3 id="controlling-event-propagation">Controlling Event Propagation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Stop propagation examples</span>
<span class="hljs-keyword">const</span> button = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#stop-button"</span>);
<span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#container"</span>);

<span class="hljs-comment">// Container click handler</span>
container.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Container clicked"</span>);
});

<span class="hljs-comment">// Button click handler that stops propagation</span>
button.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked"</span>);

  <span class="hljs-comment">// Stop the event from bubbling up to container</span>
  e.stopPropagation();

  <span class="hljs-comment">// Container click handler will NOT be called</span>
});

<span class="hljs-comment">// Stop immediate propagation (stops other listeners on same element)</span>
button.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"First button handler"</span>);
  e.stopImmediatePropagation();
  <span class="hljs-comment">// Other listeners on this button won't be called</span>
});

button.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Second button handler"</span>); <span class="hljs-comment">// This won't be called</span>
});

<span class="hljs-comment">// Prevent default behavior</span>
<span class="hljs-keyword">const</span> link = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"a"</span>);
link.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  e.preventDefault(); <span class="hljs-comment">// Prevent navigation</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Link clicked but navigation prevented"</span>);
});

<span class="hljs-keyword">const</span> form = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"form"</span>);
form.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt; {
  e.preventDefault(); <span class="hljs-comment">// Prevent form submission</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submission prevented"</span>);

  <span class="hljs-comment">// Handle form submission with JavaScript</span>
  handleFormSubmission(e.target);
});

<span class="hljs-comment">// Conditional event handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleConditionalClick</span>(<span class="hljs-params">e</span>) </span>{
  <span class="hljs-comment">// Only handle if certain conditions are met</span>
  <span class="hljs-keyword">if</span> (e.target.classList.contains(<span class="hljs-string">"disabled"</span>)) {
    e.preventDefault();
    e.stopPropagation();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Action disabled"</span>);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-keyword">if</span> (e.ctrlKey) {
    <span class="hljs-comment">// Special behavior for Ctrl+click</span>
    e.preventDefault();
    handleCtrlClick(e);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// Normal click behavior</span>
  handleNormalClick(e);
}

<span class="hljs-comment">// Event flow visualization utility</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">visualizeEventFlow</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">const</span> phases = [<span class="hljs-string">"capture"</span>, <span class="hljs-string">"target"</span>, <span class="hljs-string">"bubble"</span>];
  <span class="hljs-keyword">const</span> phaseNames = {
    <span class="hljs-number">1</span>: <span class="hljs-string">"CAPTURING_PHASE"</span>,
    <span class="hljs-number">2</span>: <span class="hljs-string">"AT_TARGET"</span>,
    <span class="hljs-number">3</span>: <span class="hljs-string">"BUBBLING_PHASE"</span>,
  };

  <span class="hljs-comment">// Add listeners for all phases</span>
  element.addEventListener(
    <span class="hljs-string">"click"</span>,
    (e) =&gt; {
      <span class="hljs-built_in">console</span>.log(
        <span class="hljs-string">`<span class="hljs-subst">${element.tagName}</span>#<span class="hljs-subst">${element.id}</span> - <span class="hljs-subst">${phaseNames[e.eventPhase]}</span>`</span>
      );
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Target:"</span>, e.target.tagName + <span class="hljs-string">"#"</span> + e.target.id);
      <span class="hljs-built_in">console</span>.log(
        <span class="hljs-string">"CurrentTarget:"</span>,
        e.currentTarget.tagName + <span class="hljs-string">"#"</span> + e.currentTarget.id
      );
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"---"</span>);
    },
    <span class="hljs-literal">true</span>
  ); <span class="hljs-comment">// Capture</span>

  element.addEventListener(
    <span class="hljs-string">"click"</span>,
    (e) =&gt; {
      <span class="hljs-built_in">console</span>.log(
        <span class="hljs-string">`<span class="hljs-subst">${element.tagName}</span>#<span class="hljs-subst">${element.id}</span> - <span class="hljs-subst">${
          phaseNames[e.eventPhase]
        }</span> (bubble)`</span>
      );
    },
    <span class="hljs-literal">false</span>
  ); <span class="hljs-comment">// Bubble</span>
}

<span class="hljs-comment">// Apply to all elements to see event flow</span>
<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"*[id]"</span>).forEach(visualizeEventFlow);
</div></code></pre>
<h3 id="custom-event-system">Custom Event System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Creating and dispatching custom events</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomEventSystem</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.listeners = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  <span class="hljs-comment">// Create custom event</span>
  createEvent(type, detail = {}, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CustomEvent(type, {
      detail,
      <span class="hljs-attr">bubbles</span>: options.bubbles || <span class="hljs-literal">false</span>,
      <span class="hljs-attr">cancelable</span>: options.cancelable || <span class="hljs-literal">false</span>,
      <span class="hljs-attr">composed</span>: options.composed || <span class="hljs-literal">false</span>,
    });
  }

  <span class="hljs-comment">// Dispatch custom event</span>
  dispatch(element, eventType, detail = {}, options = {}) {
    <span class="hljs-keyword">const</span> event = <span class="hljs-keyword">this</span>.createEvent(eventType, detail, options);
    <span class="hljs-keyword">return</span> element.dispatchEvent(event);
  }

  <span class="hljs-comment">// Listen for custom events</span>
  on(element, eventType, handler) {
    element.addEventListener(eventType, handler);

    <span class="hljs-comment">// Store for cleanup</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.listeners.has(element)) {
      <span class="hljs-keyword">this</span>.listeners.set(element, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>());
    }

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.listeners.get(element).has(eventType)) {
      <span class="hljs-keyword">this</span>.listeners.get(element).set(eventType, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());
    }

    <span class="hljs-keyword">this</span>.listeners.get(element).get(eventType).add(handler);
  }

  <span class="hljs-comment">// Remove custom event listener</span>
  off(element, eventType, handler) {
    element.removeEventListener(eventType, handler);

    <span class="hljs-comment">// Clean up storage</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.listeners.has(element)) {
      <span class="hljs-keyword">const</span> elementListeners = <span class="hljs-keyword">this</span>.listeners.get(element);
      <span class="hljs-keyword">if</span> (elementListeners.has(eventType)) {
        elementListeners.get(eventType).delete(handler);
      }
    }
  }

  <span class="hljs-comment">// Clean up all listeners for an element</span>
  cleanup(element) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.listeners.has(element)) {
      <span class="hljs-keyword">const</span> elementListeners = <span class="hljs-keyword">this</span>.listeners.get(element);

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [eventType, handlers] <span class="hljs-keyword">of</span> elementListeners) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> handler <span class="hljs-keyword">of</span> handlers) {
          element.removeEventListener(eventType, handler);
        }
      }

      <span class="hljs-keyword">this</span>.listeners.delete(element);
    }
  }
}

<span class="hljs-keyword">const</span> eventSystem = <span class="hljs-keyword">new</span> CustomEventSystem();

<span class="hljs-comment">// Usage examples</span>
<span class="hljs-keyword">const</span> component = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-component"</span>);

<span class="hljs-comment">// Listen for custom events</span>
eventSystem.on(component, <span class="hljs-string">"data-loaded"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Data loaded:"</span>, e.detail.data);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Load time:"</span>, e.detail.loadTime);
});

eventSystem.on(component, <span class="hljs-string">"user-action"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User action:"</span>, e.detail.action);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User data:"</span>, e.detail.user);
});

<span class="hljs-comment">// Dispatch custom events</span>
eventSystem.dispatch(
  component,
  <span class="hljs-string">"data-loaded"</span>,
  {
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">users</span>: [], <span class="hljs-attr">posts</span>: [] },
    <span class="hljs-attr">loadTime</span>: <span class="hljs-number">1250</span>,
  },
  { <span class="hljs-attr">bubbles</span>: <span class="hljs-literal">true</span> }
);

eventSystem.dispatch(component, <span class="hljs-string">"user-action"</span>, {
  <span class="hljs-attr">action</span>: <span class="hljs-string">"profile-update"</span>,
  <span class="hljs-attr">user</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span> },
});

<span class="hljs-comment">// Real-world example: Component communication</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComponentA</span> </span>{
  <span class="hljs-keyword">constructor</span>(element) {
    <span class="hljs-keyword">this</span>.element = element;
    <span class="hljs-keyword">this</span>.eventSystem = <span class="hljs-keyword">new</span> CustomEventSystem();

    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-comment">// Listen for events from other components</span>
    <span class="hljs-keyword">this</span>.eventSystem.on(<span class="hljs-built_in">document</span>, <span class="hljs-string">"component-b-updated"</span>, (e) =&gt; {
      <span class="hljs-keyword">this</span>.handleComponentBUpdate(e.detail);
    });

    <span class="hljs-comment">// Set up internal event handlers</span>
    <span class="hljs-keyword">this</span>.element.addEventListener(<span class="hljs-string">"click"</span>, () =&gt; {
      <span class="hljs-keyword">this</span>.performAction();
    });
  }

  performAction() {
    <span class="hljs-comment">// Do some work</span>
    <span class="hljs-keyword">const</span> result = { <span class="hljs-attr">message</span>: <span class="hljs-string">"Action completed"</span>, <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now() };

    <span class="hljs-comment">// Notify other components</span>
    <span class="hljs-keyword">this</span>.eventSystem.dispatch(<span class="hljs-built_in">document</span>, <span class="hljs-string">"component-a-action"</span>, result, {
      <span class="hljs-attr">bubbles</span>: <span class="hljs-literal">true</span>,
    });
  }

  handleComponentBUpdate(data) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Component A received update from Component B:"</span>, data);
    <span class="hljs-comment">// Update UI based on Component B's state</span>
  }

  destroy() {
    <span class="hljs-keyword">this</span>.eventSystem.cleanup(<span class="hljs-keyword">this</span>.element);
    <span class="hljs-keyword">this</span>.eventSystem.cleanup(<span class="hljs-built_in">document</span>);
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ComponentB</span> </span>{
  <span class="hljs-keyword">constructor</span>(element) {
    <span class="hljs-keyword">this</span>.element = element;
    <span class="hljs-keyword">this</span>.eventSystem = <span class="hljs-keyword">new</span> CustomEventSystem();

    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-comment">// Listen for events from Component A</span>
    <span class="hljs-keyword">this</span>.eventSystem.on(<span class="hljs-built_in">document</span>, <span class="hljs-string">"component-a-action"</span>, (e) =&gt; {
      <span class="hljs-keyword">this</span>.handleComponentAAction(e.detail);
    });
  }

  handleComponentAAction(data) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Component B received action from Component A:"</span>, data);

    <span class="hljs-comment">// Update state and notify others</span>
    <span class="hljs-keyword">this</span>.updateState(data);

    <span class="hljs-keyword">this</span>.eventSystem.dispatch(
      <span class="hljs-built_in">document</span>,
      <span class="hljs-string">"component-b-updated"</span>,
      {
        <span class="hljs-attr">state</span>: <span class="hljs-keyword">this</span>.getState(),
        <span class="hljs-attr">triggeredBy</span>: <span class="hljs-string">"component-a-action"</span>,
      },
      { <span class="hljs-attr">bubbles</span>: <span class="hljs-literal">true</span> }
    );
  }

  updateState(data) {
    <span class="hljs-comment">// Update component state</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Updating Component B state..."</span>);
  }

  getState() {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">status</span>: <span class="hljs-string">"updated"</span>, <span class="hljs-attr">lastAction</span>: <span class="hljs-built_in">Date</span>.now() };
  }

  destroy() {
    <span class="hljs-keyword">this</span>.eventSystem.cleanup(<span class="hljs-keyword">this</span>.element);
    <span class="hljs-keyword">this</span>.eventSystem.cleanup(<span class="hljs-built_in">document</span>);
  }
}

<span class="hljs-comment">// Initialize components</span>
<span class="hljs-keyword">const</span> componentA = <span class="hljs-keyword">new</span> ComponentA(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#component-a"</span>));
<span class="hljs-keyword">const</span> componentB = <span class="hljs-keyword">new</span> ComponentB(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#component-b"</span>));
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-memory-leaks-from-event-listeners">1. Memory Leaks from Event Listeners</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not removing event listeners</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  <span class="hljs-keyword">const</span> handler = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"clicked"</span>);

  element.addEventListener(<span class="hljs-string">"click"</span>, handler);
  <span class="hljs-built_in">document</span>.body.appendChild(element);

  <span class="hljs-comment">// Later, removing element but not cleaning up listener</span>
  element.remove(); <span class="hljs-comment">// Memory leak - handler still referenced</span>
}

<span class="hljs-comment">// ✅ Proper cleanup</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createComponentProperly</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
  <span class="hljs-keyword">const</span> handler = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"clicked"</span>);

  element.addEventListener(<span class="hljs-string">"click"</span>, handler);
  <span class="hljs-built_in">document</span>.body.appendChild(element);

  <span class="hljs-comment">// Return cleanup function</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    element.removeEventListener(<span class="hljs-string">"click"</span>, handler);
    element.remove();
  };
}

<span class="hljs-keyword">const</span> cleanup = createComponentProperly();
<span class="hljs-comment">// Later...</span>
cleanup(); <span class="hljs-comment">// Proper cleanup</span>

<span class="hljs-comment">// ❌ Anonymous functions can't be removed</span>
element.addEventListener(<span class="hljs-string">"click"</span>, () =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"click"</span>)); <span class="hljs-comment">// Can't remove this!</span>

<span class="hljs-comment">// ✅ Use named functions or store references</span>
<span class="hljs-keyword">const</span> clickHandler = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"click"</span>);
element.addEventListener(<span class="hljs-string">"click"</span>, clickHandler);
<span class="hljs-comment">// Later...</span>
element.removeEventListener(<span class="hljs-string">"click"</span>, clickHandler); <span class="hljs-comment">// This works</span>
</div></code></pre>
<h3 id="2-event-listener-performance-issues">2. Event Listener Performance Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Adding listeners to many elements</span>
<span class="hljs-keyword">const</span> items = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".list-item"</span>); <span class="hljs-comment">// 1000 items</span>
items.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
  item.addEventListener(<span class="hljs-string">"click"</span>, handleClick); <span class="hljs-comment">// 1000 event listeners!</span>
});

<span class="hljs-comment">// ✅ Use event delegation</span>
<span class="hljs-keyword">const</span> list = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".list"</span>);
list.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">".list-item"</span>)) {
    handleClick(e);
  }
}); <span class="hljs-comment">// Only 1 event listener</span>

<span class="hljs-comment">// ❌ Not throttling/debouncing high-frequency events</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"scroll"</span>, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Scrolling..."</span>); <span class="hljs-comment">// Fires hundreds of times per second!</span>
  updateScrollPosition();
});

<span class="hljs-comment">// ✅ Throttle high-frequency events</span>
<span class="hljs-keyword">let</span> scrolling = <span class="hljs-literal">false</span>;
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"scroll"</span>, () =&gt; {
  <span class="hljs-keyword">if</span> (!scrolling) {
    scrolling = <span class="hljs-literal">true</span>;
    requestAnimationFrame(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      updateScrollPosition();
      scrolling = <span class="hljs-literal">false</span>;
    });
  }
});

<span class="hljs-comment">// ✅ Or use debouncing for resize events</span>
<span class="hljs-keyword">let</span> resizeTimeout;
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"resize"</span>, () =&gt; {
  clearTimeout(resizeTimeout);
  resizeTimeout = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    handleResize();
  }, <span class="hljs-number">250</span>);
});
</div></code></pre>
<h3 id="3-event-object-misunderstanding">3. Event Object Misunderstanding</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Confusing target vs currentTarget</span>
<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".container"</span>).addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Target:"</span>, e.target); <span class="hljs-comment">// Element that was actually clicked</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"CurrentTarget:"</span>, e.currentTarget); <span class="hljs-comment">// Element with the listener (.container)</span>

  <span class="hljs-comment">// Wrong: assuming target is always the container</span>
  <span class="hljs-keyword">if</span> (e.target.classList.contains(<span class="hljs-string">"container"</span>)) {
    <span class="hljs-comment">// This might not work if user clicks on child elements!</span>
  }

  <span class="hljs-comment">// ✅ Correct: use currentTarget for the element with listener</span>
  <span class="hljs-keyword">if</span> (e.currentTarget.classList.contains(<span class="hljs-string">"container"</span>)) {
    <span class="hljs-comment">// This always works</span>
  }
});

<span class="hljs-comment">// ❌ Not preventing default when needed</span>
<span class="hljs-keyword">const</span> form = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"form"</span>);
form.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt; {
  <span class="hljs-comment">// Forgot e.preventDefault() - form will submit normally!</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted"</span>);
  handleFormSubmission();
});

<span class="hljs-comment">// ✅ Always prevent default for custom handling</span>
form.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt; {
  e.preventDefault(); <span class="hljs-comment">// Prevent normal form submission</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted"</span>);
  handleFormSubmission();
});
</div></code></pre>
<h3 id="4-timing-issues">4. Timing Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Adding listeners before elements exist</span>
<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-button"</span>).addEventListener(<span class="hljs-string">"click"</span>, handler);
<span class="hljs-comment">// Error: Cannot read property 'addEventListener' of null</span>

<span class="hljs-comment">// ✅ Wait for DOM to be ready</span>
<span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"DOMContentLoaded"</span>, () =&gt; {
  <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-button"</span>).addEventListener(<span class="hljs-string">"click"</span>, handler);
});

<span class="hljs-comment">// ✅ Or check if element exists</span>
<span class="hljs-keyword">const</span> button = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-button"</span>);
<span class="hljs-keyword">if</span> (button) {
  button.addEventListener(<span class="hljs-string">"click"</span>, handler);
}

<span class="hljs-comment">// ✅ Or use optional chaining (modern browsers)</span>
<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-button"</span>)?.addEventListener(<span class="hljs-string">"click"</span>, handler);

<span class="hljs-comment">// ❌ Race conditions with dynamic content</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addDynamicContent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#container"</span>);
  container.innerHTML = <span class="hljs-string">'&lt;button id="dynamic-btn"&gt;Click me&lt;/button&gt;'</span>;

  <span class="hljs-comment">// This might not work - button might not be in DOM yet</span>
  <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#dynamic-btn"</span>).addEventListener(<span class="hljs-string">"click"</span>, handler);
}

<span class="hljs-comment">// ✅ Use event delegation for dynamic content</span>
<span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#container"</span>);
container.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-keyword">if</span> (e.target.id === <span class="hljs-string">"dynamic-btn"</span>) {
    handler(e);
  }
});

<span class="hljs-comment">// Now adding dynamic content works automatically</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addDynamicContent</span>(<span class="hljs-params"></span>) </span>{
  container.innerHTML = <span class="hljs-string">'&lt;button id="dynamic-btn"&gt;Click me&lt;/button&gt;'</span>;
  <span class="hljs-comment">// Event delegation handles this automatically</span>
}
</div></code></pre>
<h3 id="5-form-event-issues">5. Form Event Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not handling form submission properly</span>
<span class="hljs-keyword">const</span> submitButton = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#submit-btn"</span>);
submitButton.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
  <span class="hljs-comment">// This doesn't prevent form submission!</span>
  handleFormSubmission();
});

<span class="hljs-comment">// ✅ Listen to form submit event</span>
<span class="hljs-keyword">const</span> form = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#my-form"</span>);
form.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt; {
  e.preventDefault(); <span class="hljs-comment">// This prevents form submission</span>
  handleFormSubmission();
});

<span class="hljs-comment">// ❌ Not validating before submission</span>
form.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt; {
  e.preventDefault();
  <span class="hljs-comment">// Submitting without validation!</span>
  submitData();
});

<span class="hljs-comment">// ✅ Validate before submission</span>
form.addEventListener(<span class="hljs-string">"submit"</span>, (e) =&gt; {
  e.preventDefault();

  <span class="hljs-keyword">if</span> (validateForm(form)) {
    submitData();
  } <span class="hljs-keyword">else</span> {
    showValidationErrors();
  }
});
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-interactive-todo-list">Problem 1: Interactive Todo List</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a fully interactive todo list with the following features:</span>
<span class="hljs-comment">// - Add new todos by typing and pressing Enter</span>
<span class="hljs-comment">// - Mark todos as complete by clicking</span>
<span class="hljs-comment">// - Delete todos with a delete button</span>
<span class="hljs-comment">// - Edit todos by double-clicking</span>
<span class="hljs-comment">// - Filter todos (all, active, completed)</span>
<span class="hljs-comment">// - Clear all completed todos</span>
<span class="hljs-comment">// - Keyboard navigation (arrow keys, Enter, Escape)</span>
<span class="hljs-comment">// - Drag and drop reordering</span>
<span class="hljs-comment">// - Local storage persistence</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InteractiveTodoList</span> </span>{
  <span class="hljs-keyword">constructor</span>(container) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should handle all the features listed above</span>
    <span class="hljs-comment">// Use event delegation for efficiency</span>
    <span class="hljs-comment">// Implement proper keyboard accessibility</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// addTodo(text)</span>
  <span class="hljs-comment">// deleteTodo(id)</span>
  <span class="hljs-comment">// toggleTodo(id)</span>
  <span class="hljs-comment">// editTodo(id, newText)</span>
  <span class="hljs-comment">// filterTodos(filter) // 'all', 'active', 'completed'</span>
  <span class="hljs-comment">// clearCompleted()</span>
  <span class="hljs-comment">// saveTodos()</span>
  <span class="hljs-comment">// loadTodos()</span>
  <span class="hljs-comment">// setupEventListeners()</span>
  <span class="hljs-comment">// setupKeyboardNavigation()</span>
  <span class="hljs-comment">// setupDragAndDrop()</span>
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> todoList = <span class="hljs-keyword">new</span> InteractiveTodoList(<span class="hljs-string">"#todo-app"</span>);
</div></code></pre>
<h3 id="problem-2-modal-dialog-system">Problem 2: Modal Dialog System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a modal system that handles:</span>
<span class="hljs-comment">// - Multiple modals with proper z-index stacking</span>
<span class="hljs-comment">// - Focus management (trap focus within modal)</span>
<span class="hljs-comment">// - Escape key to close</span>
<span class="hljs-comment">// - Backdrop click to close (optional)</span>
<span class="hljs-comment">// - Prevent body scroll when modal is open</span>
<span class="hljs-comment">// - Smooth animations</span>
<span class="hljs-comment">// - Accessibility (ARIA attributes, screen reader support)</span>
<span class="hljs-comment">// - Promise-based API for user responses</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ModalSystem</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Handle focus management</span>
    <span class="hljs-comment">// Manage modal stack</span>
    <span class="hljs-comment">// Setup global event listeners</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// show(options) - returns Promise</span>
  <span class="hljs-comment">// hide(modal)</span>
  <span class="hljs-comment">// hideAll()</span>
  <span class="hljs-comment">// confirm(message, options) - returns Promise&lt;boolean&gt;</span>
  <span class="hljs-comment">// prompt(message, defaultValue, options) - returns Promise&lt;string|null&gt;</span>
  <span class="hljs-comment">// alert(message, options) - returns Promise</span>
  <span class="hljs-comment">// setupFocusTrap(modal)</span>
  <span class="hljs-comment">// setupKeyboardHandling()</span>
  <span class="hljs-comment">// preventBodyScroll()</span>
  <span class="hljs-comment">// restoreBodyScroll()</span>
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> modals = <span class="hljs-keyword">new</span> ModalSystem();

<span class="hljs-comment">// Show custom modal</span>
modals
  .show({
    <span class="hljs-attr">title</span>: <span class="hljs-string">"Confirm Action"</span>,
    <span class="hljs-attr">content</span>: <span class="hljs-string">"&lt;p&gt;Are you sure you want to delete this item?&lt;/p&gt;"</span>,
    <span class="hljs-attr">buttons</span>: [
      { <span class="hljs-attr">text</span>: <span class="hljs-string">"Cancel"</span>, <span class="hljs-attr">value</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">class</span>: <span class="hljs-string">"btn-secondary"</span> },
      { <span class="hljs-attr">text</span>: <span class="hljs-string">"Delete"</span>, <span class="hljs-attr">value</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">class</span>: <span class="hljs-string">"btn-danger"</span> },
    ],
  })
  .then(<span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (result) {
      deleteItem();
    }
  });

<span class="hljs-comment">// Built-in dialogs</span>
modals.confirm(<span class="hljs-string">"Delete this item?"</span>).then(<span class="hljs-function">(<span class="hljs-params">confirmed</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (confirmed) deleteItem();
});

modals.prompt(<span class="hljs-string">"Enter your name:"</span>, <span class="hljs-string">"John Doe"</span>).then(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (name) <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Hello,"</span>, name);
});
</div></code></pre>
<h3 id="problem-3-drag-and-drop-file-uploader">Problem 3: Drag and Drop File Uploader</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a drag-and-drop file uploader with:</span>
<span class="hljs-comment">// - Visual feedback during drag operations</span>
<span class="hljs-comment">// - File type validation</span>
<span class="hljs-comment">// - File size limits</span>
<span class="hljs-comment">// - Progress indicators</span>
<span class="hljs-comment">// - Preview for images</span>
<span class="hljs-comment">// - Multiple file support</span>
<span class="hljs-comment">// - Error handling</span>
<span class="hljs-comment">// - Accessibility support</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DragDropUploader</span> </span>{
  <span class="hljs-keyword">constructor</span>(container, options = {}) {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Options: {</span>
    <span class="hljs-comment">//   maxFileSize: 5 * 1024 * 1024, // 5MB</span>
    <span class="hljs-comment">//   allowedTypes: ['image/*', '.pdf', '.doc'],</span>
    <span class="hljs-comment">//   multiple: true,</span>
    <span class="hljs-comment">//   uploadUrl: '/api/upload',</span>
    <span class="hljs-comment">//   onProgress: (file, progress) =&gt; {},</span>
    <span class="hljs-comment">//   onComplete: (file, response) =&gt; {},</span>
    <span class="hljs-comment">//   onError: (file, error) =&gt; {}</span>
    <span class="hljs-comment">// }</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// setupDragAndDrop()</span>
  <span class="hljs-comment">// setupFileInput()</span>
  <span class="hljs-comment">// handleDragEnter(e)</span>
  <span class="hljs-comment">// handleDragOver(e)</span>
  <span class="hljs-comment">// handleDragLeave(e)</span>
  <span class="hljs-comment">// handleDrop(e)</span>
  <span class="hljs-comment">// validateFiles(files)</span>
  <span class="hljs-comment">// uploadFiles(files)</span>
  <span class="hljs-comment">// createPreview(file)</span>
  <span class="hljs-comment">// showProgress(file, progress)</span>
  <span class="hljs-comment">// showError(file, error)</span>
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> uploader = <span class="hljs-keyword">new</span> DragDropUploader(<span class="hljs-string">"#upload-area"</span>, {
  <span class="hljs-attr">maxFileSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 10MB</span>
  <span class="hljs-attr">allowedTypes</span>: [<span class="hljs-string">"image/*"</span>, <span class="hljs-string">".pdf"</span>],
  <span class="hljs-attr">multiple</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">onProgress</span>: <span class="hljs-function">(<span class="hljs-params">file, progress</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${file.name}</span>: <span class="hljs-subst">${progress}</span>%`</span>);
  },
  <span class="hljs-attr">onComplete</span>: <span class="hljs-function">(<span class="hljs-params">file, response</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${file.name}</span> uploaded successfully`</span>);
  },
  <span class="hljs-attr">onError</span>: <span class="hljs-function">(<span class="hljs-params">file, error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Error uploading <span class="hljs-subst">${file.name}</span>:`</span>, error);
  },
});
</div></code></pre>
<h3 id="problem-4-keyboard-shortcut-manager">Problem 4: Keyboard Shortcut Manager</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a comprehensive keyboard shortcut system:</span>
<span class="hljs-comment">// - Register shortcuts with descriptions</span>
<span class="hljs-comment">// - Handle modifier key combinations</span>
<span class="hljs-comment">// - Context-aware shortcuts (different shortcuts in different areas)</span>
<span class="hljs-comment">// - Conflict detection and resolution</span>
<span class="hljs-comment">// - Help dialog showing all shortcuts</span>
<span class="hljs-comment">// - Enable/disable shortcuts dynamically</span>
<span class="hljs-comment">// - Import/export shortcut configurations</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShortcutManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Handle global and context-specific shortcuts</span>
    <span class="hljs-comment">// Manage shortcut conflicts</span>
    <span class="hljs-comment">// Provide help system</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// register(keys, callback, options)</span>
  <span class="hljs-comment">// unregister(keys, context)</span>
  <span class="hljs-comment">// setContext(context)</span>
  <span class="hljs-comment">// enable(keys)</span>
  <span class="hljs-comment">// disable(keys)</span>
  <span class="hljs-comment">// showHelp()</span>
  <span class="hljs-comment">// exportConfig()</span>
  <span class="hljs-comment">// importConfig(config)</span>
  <span class="hljs-comment">// detectConflicts()</span>
  <span class="hljs-comment">// resolveConflict(keys, resolution)</span>
}

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> shortcuts = <span class="hljs-keyword">new</span> ShortcutManager();

<span class="hljs-comment">// Global shortcuts</span>
shortcuts.register(<span class="hljs-string">"ctrl+s"</span>, () =&gt; save(), {
  <span class="hljs-attr">description</span>: <span class="hljs-string">"Save document"</span>,
  <span class="hljs-attr">global</span>: <span class="hljs-literal">true</span>,
});

<span class="hljs-comment">// Context-specific shortcuts</span>
shortcuts.register(<span class="hljs-string">"enter"</span>, () =&gt; submitForm(), {
  <span class="hljs-attr">description</span>: <span class="hljs-string">"Submit form"</span>,
  <span class="hljs-attr">context</span>: <span class="hljs-string">"form"</span>,
  <span class="hljs-attr">element</span>: <span class="hljs-string">"#contact-form"</span>,
});

shortcuts.register(<span class="hljs-string">"escape"</span>, () =&gt; closeModal(), {
  <span class="hljs-attr">description</span>: <span class="hljs-string">"Close modal"</span>,
  <span class="hljs-attr">context</span>: <span class="hljs-string">"modal"</span>,
});

<span class="hljs-comment">// Change context</span>
shortcuts.setContext(<span class="hljs-string">"form"</span>);

<span class="hljs-comment">// Show help</span>
shortcuts.showHelp(); <span class="hljs-comment">// Display all available shortcuts</span>
</div></code></pre>
<h3 id="problem-5-real-time-form-validation">Problem 5: Real-time Form Validation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a real-time form validation system:</span>
<span class="hljs-comment">// - Validate as user types (debounced)</span>
<span class="hljs-comment">// - Show/hide error messages smoothly</span>
<span class="hljs-comment">// - Custom validation rules</span>
<span class="hljs-comment">// - Async validation (check username availability)</span>
<span class="hljs-comment">// - Field dependencies (password confirmation)</span>
<span class="hljs-comment">// - Accessibility support (ARIA attributes)</span>
<span class="hljs-comment">// - Visual indicators (colors, icons)</span>
<span class="hljs-comment">// - Summary of all errors</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FormValidator</span> </span>{
  <span class="hljs-keyword">constructor</span>(form, rules = {}) {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Handle real-time validation</span>
    <span class="hljs-comment">// Manage error display</span>
    <span class="hljs-comment">// Support async validation</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// addRule(field, rule)</span>
  <span class="hljs-comment">// removeRule(field, ruleType)</span>
  <span class="hljs-comment">// validateField(field)</span>
  <span class="hljs-comment">// validateForm()</span>
  <span class="hljs-comment">// showError(field, message)</span>
  <span class="hljs-comment">// hideError(field)</span>
  <span class="hljs-comment">// showSummary()</span>
  <span class="hljs-comment">// hideSummary()</span>
  <span class="hljs-comment">// setupRealTimeValidation()</span>
  <span class="hljs-comment">// setupAsyncValidation()</span>
}

<span class="hljs-comment">// Built-in validation rules</span>
<span class="hljs-keyword">const</span> validationRules = {
  <span class="hljs-attr">required</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value.trim() !== <span class="hljs-string">""</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.test(value),
  <span class="hljs-attr">minLength</span>: <span class="hljs-function">(<span class="hljs-params">value, min</span>) =&gt;</span> value.length &gt;= min,
  <span class="hljs-attr">maxLength</span>: <span class="hljs-function">(<span class="hljs-params">value, max</span>) =&gt;</span> value.length &lt;= max,
  <span class="hljs-attr">pattern</span>: <span class="hljs-function">(<span class="hljs-params">value, regex</span>) =&gt;</span> regex.test(value),
  <span class="hljs-attr">number</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> !<span class="hljs-built_in">isNaN</span>(value) &amp;&amp; !<span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseFloat</span>(value)),
  <span class="hljs-attr">url</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">new</span> URL(value);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  },
  <span class="hljs-attr">async</span>: <span class="hljs-keyword">async</span> (value, validator) =&gt; <span class="hljs-keyword">await</span> validator(value),
};

<span class="hljs-comment">// Usage:</span>
<span class="hljs-keyword">const</span> validator = <span class="hljs-keyword">new</span> FormValidator(<span class="hljs-string">"#registration-form"</span>, {
  <span class="hljs-attr">username</span>: [
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"required"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Username is required"</span> },
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"minLength"</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Minimum 3 characters"</span> },
    {
      <span class="hljs-attr">rule</span>: <span class="hljs-string">"async"</span>,
      <span class="hljs-attr">validator</span>: <span class="hljs-keyword">async</span> (username) =&gt; {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(
          <span class="hljs-string">`/api/check-username?username=<span class="hljs-subst">${username}</span>`</span>
        );
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
        <span class="hljs-keyword">return</span> !result.exists;
      },
      <span class="hljs-attr">message</span>: <span class="hljs-string">"Username already taken"</span>,
    },
  ],
  <span class="hljs-attr">email</span>: [
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"required"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Email is required"</span> },
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"email"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Invalid email format"</span> },
  ],
  <span class="hljs-attr">password</span>: [
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"required"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Password is required"</span> },
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"minLength"</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Minimum 8 characters"</span> },
    {
      <span class="hljs-attr">rule</span>: <span class="hljs-string">"pattern"</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-regexp">/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/</span>,
      <span class="hljs-attr">message</span>: <span class="hljs-string">"Must contain uppercase, lowercase, and number"</span>,
    },
  ],
  <span class="hljs-attr">confirmPassword</span>: [
    { <span class="hljs-attr">rule</span>: <span class="hljs-string">"required"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Please confirm password"</span> },
    {
      <span class="hljs-attr">rule</span>: <span class="hljs-string">"custom"</span>,
      <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">value, form</span>) =&gt;</span> value === form.elements.password.value,
      <span class="hljs-attr">message</span>: <span class="hljs-string">"Passwords do not match"</span>,
    },
  ],
});
</div></code></pre>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between event capturing and bubbling?</strong></p>
<ul>
<li><strong>Capturing</strong>: Event travels from document root down to target element</li>
<li><strong>Bubbling</strong>: Event travels from target element up to document root</li>
<li><strong>Target phase</strong>: Event is at the target element itself</li>
<li>Use <code>addEventListener(event, handler, true)</code> for capturing phase</li>
</ul>
<p><strong>Q: How do you prevent memory leaks with event listeners?</strong></p>
<ul>
<li>Always remove event listeners when elements are destroyed</li>
<li>Use named functions instead of anonymous functions for removal</li>
<li>Use event delegation to reduce number of listeners</li>
<li>Clean up listeners in component destroy/unmount methods</li>
</ul>
<p><strong>Q: When should you use event delegation?</strong></p>
<ul>
<li>When you have many similar elements (like list items)</li>
<li>When elements are added/removed dynamically</li>
<li>To improve performance by reducing number of event listeners</li>
<li>When you need to handle events on elements that don't exist yet</li>
</ul>
<p><strong>Q: How do you handle keyboard accessibility?</strong></p>
<ul>
<li>Support Tab navigation with proper focus management</li>
<li>Handle Enter and Space for activation</li>
<li>Support Arrow keys for navigation within components</li>
<li>Use Escape key to cancel/close operations</li>
<li>Provide keyboard shortcuts for common actions</li>
</ul>
<p><strong>Q: What's the difference between <code>target</code> and <code>currentTarget</code>?</strong></p>
<ul>
<li><code>target</code>: The element that actually triggered the event</li>
<li><code>currentTarget</code>: The element that has the event listener attached</li>
<li>In event delegation, <code>target</code> is the clicked child, <code>currentTarget</code> is the parent</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement a keyboard-navigable dropdown menu with accessibility support&quot;</li>
<li><strong>Facebook</strong>: &quot;Create an infinite scroll component that handles scroll events efficiently&quot;</li>
<li><strong>Amazon</strong>: &quot;Build a form validation system that works with screen readers&quot;</li>
<li><strong>Microsoft</strong>: &quot;Design a drag-and-drop interface for file uploads with progress tracking&quot;</li>
<li><strong>Netflix</strong>: &quot;Create a video player with custom keyboard controls and event handling&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Use event delegation</strong> - More efficient for many elements and dynamic content</li>
<li><strong>Always clean up listeners</strong> - Prevent memory leaks by removing listeners</li>
<li><strong>Throttle/debounce high-frequency events</strong> - Improve performance for scroll, resize, input</li>
<li><strong>Handle keyboard accessibility</strong> - Support Tab, Enter, Escape, Arrow keys</li>
<li><strong>Understand event flow</strong> - Know when to use capturing vs bubbling</li>
<li><strong>Prevent default when needed</strong> - Stop unwanted browser behavior</li>
<li><strong>Use custom events for component communication</strong> - Decouple components</li>
<li><strong>Check element existence</strong> - Always verify elements exist before adding listeners</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./13-dom-manipulation.md">← DOM Manipulation</a><br>
<strong>Next Chapter</strong>: <a href="./15-browser-apis.md">Browser APIs →</a></p>
<p><strong>Practice</strong>: Try the event handling problems and experiment with different event types and delegation patterns!</p>
<h1 id="15-browser-apis">15. Browser APIs</h1>
<h2 id="%F0%9F%93%9A-table-of-contents">📚 Table of Contents</h2>
<ul>
<li><a href="#local-storage--session-storage">Local Storage &amp; Session Storage</a></li>
<li><a href="#fetch-api">Fetch API</a></li>
<li><a href="#geolocation-api">Geolocation API</a></li>
<li><a href="#file-api">File API</a></li>
<li><a href="#canvas-api">Canvas API</a></li>
<li><a href="#web-workers">Web Workers</a></li>
<li><a href="#service-workers">Service Workers</a></li>
<li><a href="#intersection-observer">Intersection Observer</a></li>
<li><a href="#mutation-observer">Mutation Observer</a></li>
<li><a href="#history-api">History API</a></li>
<li><a href="#notification-api">Notification API</a></li>
<li><a href="#common-pitfalls">Common Pitfalls</a></li>
<li><a href="#mini-practice-problems">Mini Practice Problems</a></li>
<li><a href="#interview-notes">Interview Notes</a></li>
</ul>
<hr>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you will:</p>
<ul>
<li>Master browser storage APIs (localStorage, sessionStorage)</li>
<li>Use the Fetch API for HTTP requests</li>
<li>Work with geolocation and file handling</li>
<li>Understand Canvas for graphics and animations</li>
<li>Implement Web Workers for background processing</li>
<li>Use modern observer APIs for efficient DOM monitoring</li>
<li>Handle browser history and navigation</li>
<li>Implement push notifications</li>
</ul>
<hr>
<h2 id="%F0%9F%93%A6-local-storage--session-storage">📦 Local Storage &amp; Session Storage</h2>
<h3 id="basic-usage">Basic Usage</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// localStorage - persists until manually cleared</span>
localStorage.setItem(<span class="hljs-string">"username"</span>, <span class="hljs-string">"john_doe"</span>);
localStorage.setItem(
  <span class="hljs-string">"preferences"</span>,
  <span class="hljs-built_in">JSON</span>.stringify({
    <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
    <span class="hljs-attr">language</span>: <span class="hljs-string">"en"</span>,
  })
);

<span class="hljs-comment">// Get items</span>
<span class="hljs-keyword">const</span> username = localStorage.getItem(<span class="hljs-string">"username"</span>);
<span class="hljs-keyword">const</span> preferences = <span class="hljs-built_in">JSON</span>.parse(localStorage.getItem(<span class="hljs-string">"preferences"</span>) || <span class="hljs-string">"{}"</span>);

<span class="hljs-comment">// Remove items</span>
localStorage.removeItem(<span class="hljs-string">"username"</span>);
localStorage.clear(); <span class="hljs-comment">// Remove all items</span>

<span class="hljs-comment">// sessionStorage - persists only for the session</span>
sessionStorage.setItem(<span class="hljs-string">"tempData"</span>, <span class="hljs-string">"session-specific"</span>);
<span class="hljs-keyword">const</span> tempData = sessionStorage.getItem(<span class="hljs-string">"tempData"</span>);
</div></code></pre>
<h3 id="storage-events">Storage Events</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Listen for storage changes (only fires in other tabs/windows)</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"storage"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Storage changed:"</span>, {
    <span class="hljs-attr">key</span>: e.key,
    <span class="hljs-attr">oldValue</span>: e.oldValue,
    <span class="hljs-attr">newValue</span>: e.newValue,
    <span class="hljs-attr">url</span>: e.url,
  });

  <span class="hljs-comment">// Sync UI with storage changes</span>
  <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">"theme"</span>) {
    updateTheme(e.newValue);
  }
});
</div></code></pre>
<h3 id="storage-wrapper-class">Storage Wrapper Class</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">StorageManager</span> </span>{
  <span class="hljs-keyword">constructor</span>(storage = localStorage) {
    <span class="hljs-keyword">this</span>.storage = storage;
  }

  <span class="hljs-keyword">set</span>(key, value, expiry = null) {
    <span class="hljs-keyword">const</span> item = {
      value,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
      <span class="hljs-attr">expiry</span>: expiry ? <span class="hljs-built_in">Date</span>.now() + expiry : <span class="hljs-literal">null</span>,
    };

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">this</span>.storage.setItem(key, <span class="hljs-built_in">JSON</span>.stringify(item));
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Storage error:"</span>, error);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-keyword">get</span>(key) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> item = <span class="hljs-built_in">JSON</span>.parse(<span class="hljs-keyword">this</span>.storage.getItem(key));

      <span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

      <span class="hljs-comment">// Check expiry</span>
      <span class="hljs-keyword">if</span> (item.expiry &amp;&amp; <span class="hljs-built_in">Date</span>.now() &gt; item.expiry) {
        <span class="hljs-keyword">this</span>.remove(key);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
      }

      <span class="hljs-keyword">return</span> item.value;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Storage parse error:"</span>, error);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }

  remove(key) {
    <span class="hljs-keyword">this</span>.storage.removeItem(key);
  }

  clear() {
    <span class="hljs-keyword">this</span>.storage.clear();
  }

  keys() {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(<span class="hljs-keyword">this</span>.storage);
  }

  size() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.storage.length;
  }

  <span class="hljs-comment">// Get storage usage in bytes (approximate)</span>
  getUsage() {
    <span class="hljs-keyword">let</span> total = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span>.storage) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.storage.hasOwnProperty(key)) {
        total += <span class="hljs-keyword">this</span>.storage[key].length + key.length;
      }
    }
    <span class="hljs-keyword">return</span> total;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> storage = <span class="hljs-keyword">new</span> StorageManager();
storage.set(<span class="hljs-string">"user"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> }, <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>); <span class="hljs-comment">// 24 hours</span>
<span class="hljs-keyword">const</span> user = storage.get(<span class="hljs-string">"user"</span>);
</div></code></pre>
<hr>
<h2 id="%F0%9F%8C%90-fetch-api">🌐 Fetch API</h2>
<h3 id="basic-requests">Basic Requests</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// GET request</span>
fetch(<span class="hljs-string">"/api/users"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
    }
    <span class="hljs-keyword">return</span> response.json();
  })
  .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(data))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error));

<span class="hljs-comment">// POST request</span>
fetch(<span class="hljs-string">"/api/users"</span>, {
  <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
  <span class="hljs-attr">headers</span>: {
    <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
    <span class="hljs-attr">Authorization</span>: <span class="hljs-string">"Bearer "</span> + token,
  },
  <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({
    <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
  }),
})
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json())
  .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Success:"</span>, data))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error));
</div></code></pre>
<h3 id="advanced-fetch-patterns">Advanced Fetch Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Fetch with timeout</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchWithTimeout</span>(<span class="hljs-params">url, options = {}, timeout = <span class="hljs-number">5000</span></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.race([
    fetch(url, options),
    <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span>
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Request timeout"</span>)), timeout)
    ),
  ]);
}

<span class="hljs-comment">// Retry mechanism</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchWithRetry</span>(<span class="hljs-params">url, options = {}, maxRetries = <span class="hljs-number">3</span></span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt;= maxRetries; i++) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, options);
      <span class="hljs-keyword">if</span> (response.ok) <span class="hljs-keyword">return</span> response;

      <span class="hljs-keyword">if</span> (i === maxRetries)
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Failed after <span class="hljs-subst">${maxRetries}</span> retries`</span>);

      <span class="hljs-comment">// Exponential backoff</span>
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span>
        setTimeout(resolve, <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, i) * <span class="hljs-number">1000</span>)
      );
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">if</span> (i === maxRetries) <span class="hljs-keyword">throw</span> error;
    }
  }
}

<span class="hljs-comment">// Upload with progress</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">uploadWithProgress</span>(<span class="hljs-params">file, url, onProgress</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();
    <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData();
    formData.append(<span class="hljs-string">"file"</span>, file);

    xhr.upload.addEventListener(<span class="hljs-string">"progress"</span>, (e) =&gt; {
      <span class="hljs-keyword">if</span> (e.lengthComputable) {
        <span class="hljs-keyword">const</span> progress = (e.loaded / e.total) * <span class="hljs-number">100</span>;
        onProgress(progress);
      }
    });

    xhr.addEventListener(<span class="hljs-string">"load"</span>, () =&gt; {
      <span class="hljs-keyword">if</span> (xhr.status === <span class="hljs-number">200</span>) {
        resolve(<span class="hljs-built_in">JSON</span>.parse(xhr.responseText));
      } <span class="hljs-keyword">else</span> {
        reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Upload failed: <span class="hljs-subst">${xhr.status}</span>`</span>));
      }
    });

    xhr.addEventListener(<span class="hljs-string">"error"</span>, () =&gt; reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Upload failed"</span>)));

    xhr.open(<span class="hljs-string">"POST"</span>, url);
    xhr.send(formData);
  });
}
</div></code></pre>
<h3 id="http-client-class">HTTP Client Class</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HTTPClient</span> </span>{
  <span class="hljs-keyword">constructor</span>(baseURL = "", defaultHeaders = {}) {
    <span class="hljs-keyword">this</span>.baseURL = baseURL;
    <span class="hljs-keyword">this</span>.defaultHeaders = {
      <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
      ...defaultHeaders,
    };
    <span class="hljs-keyword">this</span>.interceptors = {
      <span class="hljs-attr">request</span>: [],
      <span class="hljs-attr">response</span>: [],
    };
  }

  addRequestInterceptor(interceptor) {
    <span class="hljs-keyword">this</span>.interceptors.request.push(interceptor);
  }

  addResponseInterceptor(interceptor) {
    <span class="hljs-keyword">this</span>.interceptors.response.push(interceptor);
  }

  <span class="hljs-keyword">async</span> request(url, options = {}) {
    <span class="hljs-comment">// Apply request interceptors</span>
    <span class="hljs-keyword">let</span> config = {
      ...options,
      <span class="hljs-attr">headers</span>: { ...this.defaultHeaders, ...options.headers },
    };

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> interceptor <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.interceptors.request) {
      config = <span class="hljs-keyword">await</span> interceptor(config);
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">let</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-keyword">this</span>.baseURL + url, config);

      <span class="hljs-comment">// Apply response interceptors</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> interceptor <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.interceptors.response) {
        response = <span class="hljs-keyword">await</span> interceptor(response);
      }

      <span class="hljs-keyword">return</span> response;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">throw</span> error;
    }
  }

  <span class="hljs-keyword">get</span>(url, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(url, { ...options, <span class="hljs-attr">method</span>: <span class="hljs-string">"GET"</span> });
  }

  post(url, data, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(url, {
      ...options,
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(data),
    });
  }

  put(url, data, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(url, {
      ...options,
      <span class="hljs-attr">method</span>: <span class="hljs-string">"PUT"</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(data),
    });
  }

  <span class="hljs-keyword">delete</span>(url, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(url, { ...options, <span class="hljs-attr">method</span>: <span class="hljs-string">"DELETE"</span> });
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> api = <span class="hljs-keyword">new</span> HTTPClient(<span class="hljs-string">"/api/v1"</span>);

<span class="hljs-comment">// Add auth interceptor</span>
api.addRequestInterceptor(<span class="hljs-keyword">async</span> (config) =&gt; {
  <span class="hljs-keyword">const</span> token = localStorage.getItem(<span class="hljs-string">"authToken"</span>);
  <span class="hljs-keyword">if</span> (token) {
    config.headers.Authorization = <span class="hljs-string">`Bearer <span class="hljs-subst">${token}</span>`</span>;
  }
  <span class="hljs-keyword">return</span> config;
});

<span class="hljs-comment">// Add error handling interceptor</span>
api.addResponseInterceptor(<span class="hljs-keyword">async</span> (response) =&gt; {
  <span class="hljs-keyword">if</span> (response.status === <span class="hljs-number">401</span>) {
    <span class="hljs-comment">// Redirect to login</span>
    <span class="hljs-built_in">window</span>.location.href = <span class="hljs-string">"/login"</span>;
  }
  <span class="hljs-keyword">return</span> response;
});

<span class="hljs-comment">// Make requests</span>
api.get(<span class="hljs-string">"/users"</span>).then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json());
api.post(<span class="hljs-string">"/users"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> });
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%8D-geolocation-api">📍 Geolocation API</h2>
<h3 id="basic-geolocation">Basic Geolocation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Check if geolocation is supported</span>
<span class="hljs-keyword">if</span> (<span class="hljs-string">"geolocation"</span> <span class="hljs-keyword">in</span> navigator) {
  <span class="hljs-comment">// Get current position</span>
  navigator.geolocation.getCurrentPosition(
    <span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> { latitude, longitude, accuracy } = position.coords;
      <span class="hljs-built_in">console</span>.log(
        <span class="hljs-string">`Lat: <span class="hljs-subst">${latitude}</span>, Lng: <span class="hljs-subst">${longitude}</span>, Accuracy: <span class="hljs-subst">${accuracy}</span>m`</span>
      );

      <span class="hljs-comment">// Use the coordinates</span>
      showLocationOnMap(latitude, longitude);
    },
    (error) =&gt; {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Geolocation error:"</span>, error.message);
      handleLocationError(error);
    },
    {
      <span class="hljs-attr">enableHighAccuracy</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
      <span class="hljs-attr">maximumAge</span>: <span class="hljs-number">60000</span>, <span class="hljs-comment">// Cache for 1 minute</span>
    }
  );
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Geolocation not supported"</span>);
}

<span class="hljs-comment">// Watch position changes</span>
<span class="hljs-keyword">const</span> watchId = navigator.geolocation.watchPosition(
  <span class="hljs-function">(<span class="hljs-params">position</span>) =&gt;</span> {
    updateLocationOnMap(position.coords.latitude, position.coords.longitude);
  },
  (error) =&gt; {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Watch position error:"</span>, error);
  },
  { <span class="hljs-attr">enableHighAccuracy</span>: <span class="hljs-literal">true</span> }
);

<span class="hljs-comment">// Stop watching</span>
<span class="hljs-comment">// navigator.geolocation.clearWatch(watchId);</span>
</div></code></pre>
<h3 id="geolocation-wrapper">Geolocation Wrapper</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GeolocationService</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.watchId = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.isSupported = <span class="hljs-string">"geolocation"</span> <span class="hljs-keyword">in</span> navigator;
  }

  <span class="hljs-keyword">async</span> getCurrentPosition(options = {}) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isSupported) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Geolocation not supported"</span>);
    }

    <span class="hljs-keyword">const</span> defaultOptions = {
      <span class="hljs-attr">enableHighAccuracy</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>,
      <span class="hljs-attr">maximumAge</span>: <span class="hljs-number">60000</span>,
    };

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      navigator.geolocation.getCurrentPosition(resolve, reject, {
        ...defaultOptions,
        ...options,
      });
    });
  }

  watchPosition(callback, errorCallback, options = {}) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isSupported) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Geolocation not supported"</span>);
    }

    <span class="hljs-keyword">this</span>.watchId = navigator.geolocation.watchPosition(
      callback,
      errorCallback,
      options
    );

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.watchId;
  }

  stopWatching() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.watchId !== <span class="hljs-literal">null</span>) {
      navigator.geolocation.clearWatch(<span class="hljs-keyword">this</span>.watchId);
      <span class="hljs-keyword">this</span>.watchId = <span class="hljs-literal">null</span>;
    }
  }

  <span class="hljs-keyword">async</span> getAddressFromCoords(lat, lng) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(
        <span class="hljs-string">`https://api.opencagedata.com/geocode/v1/json?q=<span class="hljs-subst">${lat}</span>+<span class="hljs-subst">${lng}</span>&amp;key=YOUR_API_KEY`</span>
      );
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
      <span class="hljs-keyword">return</span> data.results[<span class="hljs-number">0</span>]?.formatted || <span class="hljs-string">"Address not found"</span>;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Reverse geocoding error:"</span>, error);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }

  calculateDistance(lat1, lng1, lat2, lng2) {
    <span class="hljs-keyword">const</span> R = <span class="hljs-number">6371</span>; <span class="hljs-comment">// Earth's radius in kilometers</span>
    <span class="hljs-keyword">const</span> dLat = <span class="hljs-keyword">this</span>.toRadians(lat2 - lat1);
    <span class="hljs-keyword">const</span> dLng = <span class="hljs-keyword">this</span>.toRadians(lng2 - lng1);

    <span class="hljs-keyword">const</span> a =
      <span class="hljs-built_in">Math</span>.sin(dLat / <span class="hljs-number">2</span>) * <span class="hljs-built_in">Math</span>.sin(dLat / <span class="hljs-number">2</span>) +
      <span class="hljs-built_in">Math</span>.cos(<span class="hljs-keyword">this</span>.toRadians(lat1)) *
        <span class="hljs-built_in">Math</span>.cos(<span class="hljs-keyword">this</span>.toRadians(lat2)) *
        <span class="hljs-built_in">Math</span>.sin(dLng / <span class="hljs-number">2</span>) *
        <span class="hljs-built_in">Math</span>.sin(dLng / <span class="hljs-number">2</span>);

    <span class="hljs-keyword">const</span> c = <span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.atan2(<span class="hljs-built_in">Math</span>.sqrt(a), <span class="hljs-built_in">Math</span>.sqrt(<span class="hljs-number">1</span> - a));
    <span class="hljs-keyword">return</span> R * c; <span class="hljs-comment">// Distance in kilometers</span>
  }

  toRadians(degrees) {
    <span class="hljs-keyword">return</span> degrees * (<span class="hljs-built_in">Math</span>.PI / <span class="hljs-number">180</span>);
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> geo = <span class="hljs-keyword">new</span> GeolocationService();

<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> position = <span class="hljs-keyword">await</span> geo.getCurrentPosition();
  <span class="hljs-keyword">const</span> { latitude, longitude } = position.coords;

  <span class="hljs-keyword">const</span> address = <span class="hljs-keyword">await</span> geo.getAddressFromCoords(latitude, longitude);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Current location:"</span>, address);

  <span class="hljs-comment">// Calculate distance to a point of interest</span>
  <span class="hljs-keyword">const</span> distance = geo.calculateDistance(
    latitude,
    longitude,
    <span class="hljs-number">40.7128</span>,
    <span class="hljs-number">-74.006</span> <span class="hljs-comment">// New York City</span>
  );
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Distance to NYC: <span class="hljs-subst">${distance.toFixed(<span class="hljs-number">2</span>)}</span> km`</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Location error:"</span>, error);
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%81-file-api">📁 File API</h2>
<h3 id="file-input-handling">File Input Handling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// HTML: &lt;input type="file" id="fileInput" multiple accept="image/*"&gt;</span>

<span class="hljs-keyword">const</span> fileInput = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"fileInput"</span>);

fileInput.addEventListener(<span class="hljs-string">"change"</span>, (e) =&gt; {
  <span class="hljs-keyword">const</span> files = <span class="hljs-built_in">Array</span>.from(e.target.files);

  files.forEach(<span class="hljs-function">(<span class="hljs-params">file</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"File info:"</span>, {
      <span class="hljs-attr">name</span>: file.name,
      <span class="hljs-attr">size</span>: file.size,
      <span class="hljs-attr">type</span>: file.type,
      <span class="hljs-attr">lastModified</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(file.lastModified),
    });

    <span class="hljs-comment">// Process each file</span>
    processFile(file);
  });
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processFile</span>(<span class="hljs-params">file</span>) </span>{
  <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> FileReader();

  <span class="hljs-comment">// Read as different formats</span>
  <span class="hljs-keyword">if</span> (file.type.startsWith(<span class="hljs-string">"image/"</span>)) {
    reader.onload = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();
      img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Image dimensions: <span class="hljs-subst">${img.width}</span>x<span class="hljs-subst">${img.height}</span>`</span>);
        displayImage(e.target.result);
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (file.type === <span class="hljs-string">"text/plain"</span>) {
    reader.onload = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Text content:"</span>, e.target.result);
    };
    reader.readAsText(file);
  } <span class="hljs-keyword">else</span> {
    reader.onload = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Binary data:"</span>, e.target.result);
    };
    reader.readAsArrayBuffer(file);
  }

  reader.onerror = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"File reading error:"</span>, reader.error);
  };
}
</div></code></pre>
<h3 id="file-validation-and-processing">File Validation and Processing</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileProcessor</span> </span>{
  <span class="hljs-keyword">constructor</span>(options = {}) {
    <span class="hljs-keyword">this</span>.maxSize = options.maxSize || <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// 5MB</span>
    <span class="hljs-keyword">this</span>.allowedTypes = options.allowedTypes || [];
    <span class="hljs-keyword">this</span>.maxFiles = options.maxFiles || <span class="hljs-number">10</span>;
  }

  validateFile(file) {
    <span class="hljs-keyword">const</span> errors = [];

    <span class="hljs-comment">// Size validation</span>
    <span class="hljs-keyword">if</span> (file.size &gt; <span class="hljs-keyword">this</span>.maxSize) {
      errors.push(
        <span class="hljs-string">`File too large. Max size: <span class="hljs-subst">${<span class="hljs-keyword">this</span>.formatBytes(<span class="hljs-keyword">this</span>.maxSize)}</span>`</span>
      );
    }

    <span class="hljs-comment">// Type validation</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.allowedTypes.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> isAllowed = <span class="hljs-keyword">this</span>.allowedTypes.some(<span class="hljs-function">(<span class="hljs-params">type</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (type.endsWith(<span class="hljs-string">"/*"</span>)) {
          <span class="hljs-keyword">return</span> file.type.startsWith(type.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>));
        }
        <span class="hljs-keyword">return</span> file.type === type;
      });

      <span class="hljs-keyword">if</span> (!isAllowed) {
        errors.push(
          <span class="hljs-string">`File type not allowed. Allowed: <span class="hljs-subst">${<span class="hljs-keyword">this</span>.allowedTypes.join(<span class="hljs-string">", "</span>)}</span>`</span>
        );
      }
    }

    <span class="hljs-keyword">return</span> errors;
  }

  validateFiles(files) {
    <span class="hljs-keyword">if</span> (files.length &gt; <span class="hljs-keyword">this</span>.maxFiles) {
      <span class="hljs-keyword">return</span> [<span class="hljs-string">`Too many files. Max: <span class="hljs-subst">${<span class="hljs-keyword">this</span>.maxFiles}</span>`</span>];
    }

    <span class="hljs-keyword">const</span> allErrors = [];
    files.forEach(<span class="hljs-function">(<span class="hljs-params">file, index</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> errors = <span class="hljs-keyword">this</span>.validateFile(file);
      <span class="hljs-keyword">if</span> (errors.length &gt; <span class="hljs-number">0</span>) {
        allErrors.push(
          <span class="hljs-string">`File <span class="hljs-subst">${index + <span class="hljs-number">1</span>}</span> (<span class="hljs-subst">${file.name}</span>): <span class="hljs-subst">${errors.join(<span class="hljs-string">", "</span>)}</span>`</span>
        );
      }
    });

    <span class="hljs-keyword">return</span> allErrors;
  }

  <span class="hljs-keyword">async</span> readFileAsDataURL(file) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> FileReader();
      reader.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(reader.result);
      reader.onerror = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> reject(reader.error);
      reader.readAsDataURL(file);
    });
  }

  <span class="hljs-keyword">async</span> readFileAsText(file) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> reader = <span class="hljs-keyword">new</span> FileReader();
      reader.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(reader.result);
      reader.onerror = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> reject(reader.error);
      reader.readAsText(file);
    });
  }

  <span class="hljs-keyword">async</span> compressImage(file, quality = <span class="hljs-number">0.8</span>, maxWidth = <span class="hljs-number">1920</span>, maxHeight = <span class="hljs-number">1080</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> canvas = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"canvas"</span>);
      <span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();

      img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// Calculate new dimensions</span>
        <span class="hljs-keyword">let</span> { width, height } = img;

        <span class="hljs-keyword">if</span> (width &gt; maxWidth || height &gt; maxHeight) {
          <span class="hljs-keyword">const</span> ratio = <span class="hljs-built_in">Math</span>.min(maxWidth / width, maxHeight / height);
          width *= ratio;
          height *= ratio;
        }

        canvas.width = width;
        canvas.height = height;

        <span class="hljs-comment">// Draw and compress</span>
        ctx.drawImage(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, width, height);
        canvas.toBlob(resolve, file.type, quality);
      };

      img.src = URL.createObjectURL(file);
    });
  }

  formatBytes(bytes) {
    <span class="hljs-keyword">if</span> (bytes === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-string">"0 Bytes"</span>;
    <span class="hljs-keyword">const</span> k = <span class="hljs-number">1024</span>;
    <span class="hljs-keyword">const</span> sizes = [<span class="hljs-string">"Bytes"</span>, <span class="hljs-string">"KB"</span>, <span class="hljs-string">"MB"</span>, <span class="hljs-string">"GB"</span>];
    <span class="hljs-keyword">const</span> i = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.log(bytes) / <span class="hljs-built_in">Math</span>.log(k));
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>((bytes / <span class="hljs-built_in">Math</span>.pow(k, i)).toFixed(<span class="hljs-number">2</span>)) + <span class="hljs-string">" "</span> + sizes[i];
  }

  generateThumbnail(file, size = <span class="hljs-number">150</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> canvas = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"canvas"</span>);
      <span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();

      img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        canvas.width = size;
        canvas.height = size;

        <span class="hljs-comment">// Calculate crop area for square thumbnail</span>
        <span class="hljs-keyword">const</span> minDim = <span class="hljs-built_in">Math</span>.min(img.width, img.height);
        <span class="hljs-keyword">const</span> x = (img.width - minDim) / <span class="hljs-number">2</span>;
        <span class="hljs-keyword">const</span> y = (img.height - minDim) / <span class="hljs-number">2</span>;

        ctx.drawImage(img, x, y, minDim, minDim, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, size, size);
        canvas.toBlob(resolve, <span class="hljs-string">"image/jpeg"</span>, <span class="hljs-number">0.8</span>);
      };

      img.src = URL.createObjectURL(file);
    });
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> processor = <span class="hljs-keyword">new</span> FileProcessor({
  <span class="hljs-attr">maxSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 10MB</span>
  <span class="hljs-attr">allowedTypes</span>: [<span class="hljs-string">"image/*"</span>, <span class="hljs-string">"application/pdf"</span>],
  <span class="hljs-attr">maxFiles</span>: <span class="hljs-number">5</span>,
});

fileInput.addEventListener(<span class="hljs-string">"change"</span>, <span class="hljs-keyword">async</span> (e) =&gt; {
  <span class="hljs-keyword">const</span> files = <span class="hljs-built_in">Array</span>.from(e.target.files);

  <span class="hljs-comment">// Validate files</span>
  <span class="hljs-keyword">const</span> errors = processor.validateFiles(files);
  <span class="hljs-keyword">if</span> (errors.length &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Validation errors:"</span>, errors);
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// Process each file</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> file <span class="hljs-keyword">of</span> files) {
    <span class="hljs-keyword">if</span> (file.type.startsWith(<span class="hljs-string">"image/"</span>)) {
      <span class="hljs-comment">// Compress image</span>
      <span class="hljs-keyword">const</span> compressed = <span class="hljs-keyword">await</span> processor.compressImage(file);
      <span class="hljs-built_in">console</span>.log(
        <span class="hljs-string">`Original: <span class="hljs-subst">${processor.formatBytes(
          file.size
        )}</span>, Compressed: <span class="hljs-subst">${processor.formatBytes(compressed.size)}</span>`</span>
      );

      <span class="hljs-comment">// Generate thumbnail</span>
      <span class="hljs-keyword">const</span> thumbnail = <span class="hljs-keyword">await</span> processor.generateThumbnail(file);
      displayThumbnail(thumbnail);
    }
  }
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%8E%A8-canvas-api">🎨 Canvas API</h2>
<h3 id="basic-canvas-operations">Basic Canvas Operations</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> canvas = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"myCanvas"</span>);
<span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);

<span class="hljs-comment">// Set canvas size</span>
canvas.width = <span class="hljs-number">800</span>;
canvas.height = <span class="hljs-number">600</span>;

<span class="hljs-comment">// Basic shapes</span>
ctx.fillStyle = <span class="hljs-string">"#ff0000"</span>;
ctx.fillRect(<span class="hljs-number">10</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);

ctx.strokeStyle = <span class="hljs-string">"#0000ff"</span>;
ctx.lineWidth = <span class="hljs-number">3</span>;
ctx.strokeRect(<span class="hljs-number">150</span>, <span class="hljs-number">10</span>, <span class="hljs-number">100</span>, <span class="hljs-number">100</span>);

<span class="hljs-comment">// Circles</span>
ctx.beginPath();
ctx.arc(<span class="hljs-number">200</span>, <span class="hljs-number">200</span>, <span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.PI);
ctx.fillStyle = <span class="hljs-string">"#00ff00"</span>;
ctx.fill();

<span class="hljs-comment">// Lines and paths</span>
ctx.beginPath();
ctx.moveTo(<span class="hljs-number">300</span>, <span class="hljs-number">100</span>);
ctx.lineTo(<span class="hljs-number">400</span>, <span class="hljs-number">200</span>);
ctx.lineTo(<span class="hljs-number">300</span>, <span class="hljs-number">300</span>);
ctx.closePath();
ctx.stroke();

<span class="hljs-comment">// Text</span>
ctx.font = <span class="hljs-string">"24px Arial"</span>;
ctx.fillStyle = <span class="hljs-string">"#000000"</span>;
ctx.fillText(<span class="hljs-string">"Hello Canvas!"</span>, <span class="hljs-number">50</span>, <span class="hljs-number">400</span>);

<span class="hljs-comment">// Gradients</span>
<span class="hljs-keyword">const</span> gradient = ctx.createLinearGradient(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">200</span>, <span class="hljs-number">0</span>);
gradient.addColorStop(<span class="hljs-number">0</span>, <span class="hljs-string">"#ff0000"</span>);
gradient.addColorStop(<span class="hljs-number">1</span>, <span class="hljs-string">"#0000ff"</span>);
ctx.fillStyle = gradient;
ctx.fillRect(<span class="hljs-number">500</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">100</span>);
</div></code></pre>
<h3 id="animation-with-canvas">Animation with Canvas</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CanvasAnimation</span> </span>{
  <span class="hljs-keyword">constructor</span>(canvas) {
    <span class="hljs-keyword">this</span>.canvas = canvas;
    <span class="hljs-keyword">this</span>.ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);
    <span class="hljs-keyword">this</span>.animationId = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.lastTime = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.objects = [];
  }

  start() {
    <span class="hljs-keyword">this</span>.animate(<span class="hljs-number">0</span>);
  }

  stop() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.animationId) {
      cancelAnimationFrame(<span class="hljs-keyword">this</span>.animationId);
      <span class="hljs-keyword">this</span>.animationId = <span class="hljs-literal">null</span>;
    }
  }

  animate(currentTime) {
    <span class="hljs-keyword">const</span> deltaTime = currentTime - <span class="hljs-keyword">this</span>.lastTime;
    <span class="hljs-keyword">this</span>.lastTime = currentTime;

    <span class="hljs-comment">// Clear canvas</span>
    <span class="hljs-keyword">this</span>.ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.canvas.width, <span class="hljs-keyword">this</span>.canvas.height);

    <span class="hljs-comment">// Update and draw objects</span>
    <span class="hljs-keyword">this</span>.objects.forEach(<span class="hljs-function">(<span class="hljs-params">obj</span>) =&gt;</span> {
      obj.update(deltaTime);
      obj.draw(<span class="hljs-keyword">this</span>.ctx);
    });

    <span class="hljs-keyword">this</span>.animationId = requestAnimationFrame(<span class="hljs-function">(<span class="hljs-params">time</span>) =&gt;</span> <span class="hljs-keyword">this</span>.animate(time));
  }

  addObject(obj) {
    <span class="hljs-keyword">this</span>.objects.push(obj);
  }

  removeObject(obj) {
    <span class="hljs-keyword">const</span> index = <span class="hljs-keyword">this</span>.objects.indexOf(obj);
    <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">this</span>.objects.splice(index, <span class="hljs-number">1</span>);
    }
  }
}

<span class="hljs-comment">// Animated ball class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Ball</span> </span>{
  <span class="hljs-keyword">constructor</span>(x, y, radius, color, vx, vy) {
    <span class="hljs-keyword">this</span>.x = x;
    <span class="hljs-keyword">this</span>.y = y;
    <span class="hljs-keyword">this</span>.radius = radius;
    <span class="hljs-keyword">this</span>.color = color;
    <span class="hljs-keyword">this</span>.vx = vx;
    <span class="hljs-keyword">this</span>.vy = vy;
    <span class="hljs-keyword">this</span>.gravity = <span class="hljs-number">0.5</span>;
    <span class="hljs-keyword">this</span>.bounce = <span class="hljs-number">0.8</span>;
  }

  update(deltaTime) {
    <span class="hljs-comment">// Apply gravity</span>
    <span class="hljs-keyword">this</span>.vy += <span class="hljs-keyword">this</span>.gravity;

    <span class="hljs-comment">// Update position</span>
    <span class="hljs-keyword">this</span>.x += <span class="hljs-keyword">this</span>.vx;
    <span class="hljs-keyword">this</span>.y += <span class="hljs-keyword">this</span>.vy;

    <span class="hljs-comment">// Bounce off walls</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.x + <span class="hljs-keyword">this</span>.radius &gt; canvas.width || <span class="hljs-keyword">this</span>.x - <span class="hljs-keyword">this</span>.radius &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.vx *= -<span class="hljs-keyword">this</span>.bounce;
      <span class="hljs-keyword">this</span>.x = <span class="hljs-built_in">Math</span>.max(
        <span class="hljs-keyword">this</span>.radius,
        <span class="hljs-built_in">Math</span>.min(canvas.width - <span class="hljs-keyword">this</span>.radius, <span class="hljs-keyword">this</span>.x)
      );
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.y + <span class="hljs-keyword">this</span>.radius &gt; canvas.height || <span class="hljs-keyword">this</span>.y - <span class="hljs-keyword">this</span>.radius &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.vy *= -<span class="hljs-keyword">this</span>.bounce;
      <span class="hljs-keyword">this</span>.y = <span class="hljs-built_in">Math</span>.max(
        <span class="hljs-keyword">this</span>.radius,
        <span class="hljs-built_in">Math</span>.min(canvas.height - <span class="hljs-keyword">this</span>.radius, <span class="hljs-keyword">this</span>.y)
      );
    }
  }

  draw(ctx) {
    ctx.beginPath();
    ctx.arc(<span class="hljs-keyword">this</span>.x, <span class="hljs-keyword">this</span>.y, <span class="hljs-keyword">this</span>.radius, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.PI);
    ctx.fillStyle = <span class="hljs-keyword">this</span>.color;
    ctx.fill();
    ctx.strokeStyle = <span class="hljs-string">"#000"</span>;
    ctx.stroke();
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> animation = <span class="hljs-keyword">new</span> CanvasAnimation(canvas);

<span class="hljs-comment">// Add some bouncing balls</span>
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++) {
  <span class="hljs-keyword">const</span> ball = <span class="hljs-keyword">new</span> Ball(
    <span class="hljs-built_in">Math</span>.random() * canvas.width,
    <span class="hljs-built_in">Math</span>.random() * canvas.height,
    <span class="hljs-number">10</span> + <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">20</span>,
    <span class="hljs-string">`hsl(<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">360</span>}</span>, 70%, 50%)`</span>,
    (<span class="hljs-built_in">Math</span>.random() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">10</span>,
    (<span class="hljs-built_in">Math</span>.random() - <span class="hljs-number">0.5</span>) * <span class="hljs-number">10</span>
  );
  animation.addObject(ball);
}

animation.start();
</div></code></pre>
<h3 id="canvas-drawing-tools">Canvas Drawing Tools</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DrawingTool</span> </span>{
  <span class="hljs-keyword">constructor</span>(canvas) {
    <span class="hljs-keyword">this</span>.canvas = canvas;
    <span class="hljs-keyword">this</span>.ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);
    <span class="hljs-keyword">this</span>.isDrawing = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.tool = <span class="hljs-string">"pen"</span>;
    <span class="hljs-keyword">this</span>.color = <span class="hljs-string">"#000000"</span>;
    <span class="hljs-keyword">this</span>.lineWidth = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">this</span>.history = [];
    <span class="hljs-keyword">this</span>.historyStep = <span class="hljs-number">-1</span>;

    <span class="hljs-keyword">this</span>.setupEventListeners();
    <span class="hljs-keyword">this</span>.saveState();
  }

  setupEventListeners() {
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mousedown"</span>, (e) =&gt; <span class="hljs-keyword">this</span>.startDrawing(e));
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mousemove"</span>, (e) =&gt; <span class="hljs-keyword">this</span>.draw(e));
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mouseup"</span>, () =&gt; <span class="hljs-keyword">this</span>.stopDrawing());
    <span class="hljs-keyword">this</span>.canvas.addEventListener(<span class="hljs-string">"mouseout"</span>, () =&gt; <span class="hljs-keyword">this</span>.stopDrawing());
  }

  startDrawing(e) {
    <span class="hljs-keyword">this</span>.isDrawing = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">const</span> rect = <span class="hljs-keyword">this</span>.canvas.getBoundingClientRect();
    <span class="hljs-keyword">this</span>.lastX = e.clientX - rect.left;
    <span class="hljs-keyword">this</span>.lastY = e.clientY - rect.top;

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.tool === <span class="hljs-string">"pen"</span> || <span class="hljs-keyword">this</span>.tool === <span class="hljs-string">"eraser"</span>) {
      <span class="hljs-keyword">this</span>.ctx.beginPath();
      <span class="hljs-keyword">this</span>.ctx.moveTo(<span class="hljs-keyword">this</span>.lastX, <span class="hljs-keyword">this</span>.lastY);
    }
  }

  draw(e) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDrawing) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> rect = <span class="hljs-keyword">this</span>.canvas.getBoundingClientRect();
    <span class="hljs-keyword">const</span> currentX = e.clientX - rect.left;
    <span class="hljs-keyword">const</span> currentY = e.clientY - rect.top;

    <span class="hljs-keyword">this</span>.ctx.lineWidth = <span class="hljs-keyword">this</span>.lineWidth;
    <span class="hljs-keyword">this</span>.ctx.lineCap = <span class="hljs-string">"round"</span>;
    <span class="hljs-keyword">this</span>.ctx.lineJoin = <span class="hljs-string">"round"</span>;

    <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">this</span>.tool) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"pen"</span>:
        <span class="hljs-keyword">this</span>.ctx.globalCompositeOperation = <span class="hljs-string">"source-over"</span>;
        <span class="hljs-keyword">this</span>.ctx.strokeStyle = <span class="hljs-keyword">this</span>.color;
        <span class="hljs-keyword">this</span>.ctx.lineTo(currentX, currentY);
        <span class="hljs-keyword">this</span>.ctx.stroke();
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"eraser"</span>:
        <span class="hljs-keyword">this</span>.ctx.globalCompositeOperation = <span class="hljs-string">"destination-out"</span>;
        <span class="hljs-keyword">this</span>.ctx.lineTo(currentX, currentY);
        <span class="hljs-keyword">this</span>.ctx.stroke();
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"line"</span>:
        <span class="hljs-keyword">this</span>.redrawCanvas();
        <span class="hljs-keyword">this</span>.ctx.strokeStyle = <span class="hljs-keyword">this</span>.color;
        <span class="hljs-keyword">this</span>.ctx.beginPath();
        <span class="hljs-keyword">this</span>.ctx.moveTo(<span class="hljs-keyword">this</span>.lastX, <span class="hljs-keyword">this</span>.lastY);
        <span class="hljs-keyword">this</span>.ctx.lineTo(currentX, currentY);
        <span class="hljs-keyword">this</span>.ctx.stroke();
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"rectangle"</span>:
        <span class="hljs-keyword">this</span>.redrawCanvas();
        <span class="hljs-keyword">this</span>.ctx.strokeStyle = <span class="hljs-keyword">this</span>.color;
        <span class="hljs-keyword">this</span>.ctx.strokeRect(
          <span class="hljs-keyword">this</span>.lastX,
          <span class="hljs-keyword">this</span>.lastY,
          currentX - <span class="hljs-keyword">this</span>.lastX,
          currentY - <span class="hljs-keyword">this</span>.lastY
        );
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"circle"</span>:
        <span class="hljs-keyword">this</span>.redrawCanvas();
        <span class="hljs-keyword">const</span> radius = <span class="hljs-built_in">Math</span>.sqrt(
          <span class="hljs-built_in">Math</span>.pow(currentX - <span class="hljs-keyword">this</span>.lastX, <span class="hljs-number">2</span>) +
            <span class="hljs-built_in">Math</span>.pow(currentY - <span class="hljs-keyword">this</span>.lastY, <span class="hljs-number">2</span>)
        );
        <span class="hljs-keyword">this</span>.ctx.strokeStyle = <span class="hljs-keyword">this</span>.color;
        <span class="hljs-keyword">this</span>.ctx.beginPath();
        <span class="hljs-keyword">this</span>.ctx.arc(<span class="hljs-keyword">this</span>.lastX, <span class="hljs-keyword">this</span>.lastY, radius, <span class="hljs-number">0</span>, <span class="hljs-number">2</span> * <span class="hljs-built_in">Math</span>.PI);
        <span class="hljs-keyword">this</span>.ctx.stroke();
        <span class="hljs-keyword">break</span>;
    }
  }

  stopDrawing() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDrawing) {
      <span class="hljs-keyword">this</span>.isDrawing = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">this</span>.saveState();
    }
  }

  setTool(tool) {
    <span class="hljs-keyword">this</span>.tool = tool;
  }

  setColor(color) {
    <span class="hljs-keyword">this</span>.color = color;
  }

  setLineWidth(width) {
    <span class="hljs-keyword">this</span>.lineWidth = width;
  }

  clear() {
    <span class="hljs-keyword">this</span>.ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.canvas.width, <span class="hljs-keyword">this</span>.canvas.height);
    <span class="hljs-keyword">this</span>.saveState();
  }

  saveState() {
    <span class="hljs-keyword">this</span>.historyStep++;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.historyStep &lt; <span class="hljs-keyword">this</span>.history.length) {
      <span class="hljs-keyword">this</span>.history.length = <span class="hljs-keyword">this</span>.historyStep;
    }
    <span class="hljs-keyword">this</span>.history.push(<span class="hljs-keyword">this</span>.canvas.toDataURL());
  }

  undo() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.historyStep &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">this</span>.historyStep--;
      <span class="hljs-keyword">this</span>.restoreState();
    }
  }

  redo() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.historyStep &lt; <span class="hljs-keyword">this</span>.history.length - <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">this</span>.historyStep++;
      <span class="hljs-keyword">this</span>.restoreState();
    }
  }

  restoreState() {
    <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();
    img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">this</span>.ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.canvas.width, <span class="hljs-keyword">this</span>.canvas.height);
      <span class="hljs-keyword">this</span>.ctx.drawImage(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
    };
    img.src = <span class="hljs-keyword">this</span>.history[<span class="hljs-keyword">this</span>.historyStep];
  }

  redrawCanvas() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.historyStep &gt;= <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();
      img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-keyword">this</span>.ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.canvas.width, <span class="hljs-keyword">this</span>.canvas.height);
        <span class="hljs-keyword">this</span>.ctx.drawImage(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
      };
      img.src = <span class="hljs-keyword">this</span>.history[<span class="hljs-keyword">this</span>.historyStep];
    }
  }

  exportImage(format = <span class="hljs-string">"image/png"</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.canvas.toDataURL(format);
  }

  importImage(dataURL) {
    <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();
    img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">this</span>.ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.canvas.width, <span class="hljs-keyword">this</span>.canvas.height);
      <span class="hljs-keyword">this</span>.ctx.drawImage(img, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
      <span class="hljs-keyword">this</span>.saveState();
    };
    img.src = dataURL;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> drawingTool = <span class="hljs-keyword">new</span> DrawingTool(canvas);

<span class="hljs-comment">// Tool controls</span>
<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"penTool"</span>).addEventListener(<span class="hljs-string">"click"</span>, () =&gt; {
  drawingTool.setTool(<span class="hljs-string">"pen"</span>);
});

<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"colorPicker"</span>).addEventListener(<span class="hljs-string">"change"</span>, (e) =&gt; {
  drawingTool.setColor(e.target.value);
});

<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"lineWidth"</span>).addEventListener(<span class="hljs-string">"input"</span>, (e) =&gt; {
  drawingTool.setLineWidth(e.target.value);
});

<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"undo"</span>).addEventListener(<span class="hljs-string">"click"</span>, () =&gt; {
  drawingTool.undo();
});

<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"clear"</span>).addEventListener(<span class="hljs-string">"click"</span>, () =&gt; {
  drawingTool.clear();
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%91%B7-web-workers">👷 Web Workers</h2>
<h3 id="basic-web-worker">Basic Web Worker</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// main.js</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> Worker !== <span class="hljs-string">"undefined"</span>) {
  <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> Worker(<span class="hljs-string">"worker.js"</span>);

  <span class="hljs-comment">// Send data to worker</span>
  worker.postMessage({
    <span class="hljs-attr">command</span>: <span class="hljs-string">"calculate"</span>,
    <span class="hljs-attr">data</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>],
  });

  <span class="hljs-comment">// Receive data from worker</span>
  worker.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Result from worker:"</span>, e.data);
  };

  <span class="hljs-comment">// Handle errors</span>
  worker.onerror = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>{
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Worker error:"</span>, error);
  };

  <span class="hljs-comment">// Terminate worker when done</span>
  <span class="hljs-comment">// worker.terminate();</span>
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Web Workers not supported"</span>);
}
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// worker.js</span>
self.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">const</span> { command, data } = e.data;

  <span class="hljs-keyword">switch</span> (command) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"calculate"</span>:
      <span class="hljs-keyword">const</span> result = heavyCalculation(data);
      self.postMessage(result);
      <span class="hljs-keyword">break</span>;

    <span class="hljs-keyword">case</span> <span class="hljs-string">"processImage"</span>:
      <span class="hljs-keyword">const</span> processedImage = processImageData(data);
      self.postMessage(processedImage);
      <span class="hljs-keyword">break</span>;

    <span class="hljs-keyword">default</span>:
      self.postMessage({ <span class="hljs-attr">error</span>: <span class="hljs-string">"Unknown command"</span> });
  }
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">heavyCalculation</span>(<span class="hljs-params">numbers</span>) </span>{
  <span class="hljs-comment">// Simulate heavy computation</span>
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
    result += numbers.reduce(<span class="hljs-function">(<span class="hljs-params">sum, num</span>) =&gt;</span> sum + num * <span class="hljs-built_in">Math</span>.random(), <span class="hljs-number">0</span>);
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processImageData</span>(<span class="hljs-params">imageData</span>) </span>{
  <span class="hljs-comment">// Process image data (e.g., apply filters)</span>
  <span class="hljs-keyword">const</span> data = imageData.data;

  <span class="hljs-comment">// Apply grayscale filter</span>
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i += <span class="hljs-number">4</span>) {
    <span class="hljs-keyword">const</span> gray = data[i] * <span class="hljs-number">0.299</span> + data[i + <span class="hljs-number">1</span>] * <span class="hljs-number">0.587</span> + data[i + <span class="hljs-number">2</span>] * <span class="hljs-number">0.114</span>;
    data[i] = gray; <span class="hljs-comment">// Red</span>
    data[i + <span class="hljs-number">1</span>] = gray; <span class="hljs-comment">// Green</span>
    data[i + <span class="hljs-number">2</span>] = gray; <span class="hljs-comment">// Blue</span>
    <span class="hljs-comment">// Alpha channel (i + 3) remains unchanged</span>
  }

  <span class="hljs-keyword">return</span> imageData;
}
</div></code></pre>
<h3 id="worker-pool-manager">Worker Pool Manager</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WorkerPool</span> </span>{
  <span class="hljs-keyword">constructor</span>(workerScript, poolSize = navigator.hardwareConcurrency || 4) {
    <span class="hljs-keyword">this</span>.workerScript = workerScript;
    <span class="hljs-keyword">this</span>.poolSize = poolSize;
    <span class="hljs-keyword">this</span>.workers = [];
    <span class="hljs-keyword">this</span>.queue = [];
    <span class="hljs-keyword">this</span>.activeJobs = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

    <span class="hljs-keyword">this</span>.initializeWorkers();
  }

  initializeWorkers() {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.poolSize; i++) {
      <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> Worker(<span class="hljs-keyword">this</span>.workerScript);
      worker.id = i;
      worker.busy = <span class="hljs-literal">false</span>;

      worker.onmessage = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
        <span class="hljs-keyword">this</span>.handleWorkerMessage(worker, e);
      };

      worker.onerror = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-keyword">this</span>.handleWorkerError(worker, error);
      };

      <span class="hljs-keyword">this</span>.workers.push(worker);
    }
  }

  execute(data, transferable = []) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> job = {
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now() + <span class="hljs-built_in">Math</span>.random(),
        data,
        transferable,
        resolve,
        reject,
      };

      <span class="hljs-keyword">const</span> availableWorker = <span class="hljs-keyword">this</span>.workers.find(<span class="hljs-function">(<span class="hljs-params">w</span>) =&gt;</span> !w.busy);

      <span class="hljs-keyword">if</span> (availableWorker) {
        <span class="hljs-keyword">this</span>.assignJob(availableWorker, job);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.queue.push(job);
      }
    });
  }

  assignJob(worker, job) {
    worker.busy = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.activeJobs.set(worker.id, job);
    worker.postMessage(job.data, job.transferable);
  }

  handleWorkerMessage(worker, e) {
    <span class="hljs-keyword">const</span> job = <span class="hljs-keyword">this</span>.activeJobs.get(worker.id);

    <span class="hljs-keyword">if</span> (job) {
      job.resolve(e.data);
      <span class="hljs-keyword">this</span>.activeJobs.delete(worker.id);
      worker.busy = <span class="hljs-literal">false</span>;

      <span class="hljs-comment">// Process next job in queue</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.queue.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">const</span> nextJob = <span class="hljs-keyword">this</span>.queue.shift();
        <span class="hljs-keyword">this</span>.assignJob(worker, nextJob);
      }
    }
  }

  handleWorkerError(worker, error) {
    <span class="hljs-keyword">const</span> job = <span class="hljs-keyword">this</span>.activeJobs.get(worker.id);

    <span class="hljs-keyword">if</span> (job) {
      job.reject(error);
      <span class="hljs-keyword">this</span>.activeJobs.delete(worker.id);
      worker.busy = <span class="hljs-literal">false</span>;
    }
  }

  terminate() {
    <span class="hljs-keyword">this</span>.workers.forEach(<span class="hljs-function">(<span class="hljs-params">worker</span>) =&gt;</span> worker.terminate());
    <span class="hljs-keyword">this</span>.workers = [];
    <span class="hljs-keyword">this</span>.queue = [];
    <span class="hljs-keyword">this</span>.activeJobs.clear();
  }

  getStats() {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalWorkers</span>: <span class="hljs-keyword">this</span>.workers.length,
      <span class="hljs-attr">busyWorkers</span>: <span class="hljs-keyword">this</span>.workers.filter(<span class="hljs-function">(<span class="hljs-params">w</span>) =&gt;</span> w.busy).length,
      <span class="hljs-attr">queueLength</span>: <span class="hljs-keyword">this</span>.queue.length,
      <span class="hljs-attr">activeJobs</span>: <span class="hljs-keyword">this</span>.activeJobs.size,
    };
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> workerPool = <span class="hljs-keyword">new</span> WorkerPool(<span class="hljs-string">"worker.js"</span>, <span class="hljs-number">4</span>);

<span class="hljs-comment">// Process multiple tasks in parallel</span>
<span class="hljs-keyword">const</span> tasks = [
  { <span class="hljs-attr">command</span>: <span class="hljs-string">"calculate"</span>, <span class="hljs-attr">data</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>] },
  { <span class="hljs-attr">command</span>: <span class="hljs-string">"calculate"</span>, <span class="hljs-attr">data</span>: [<span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>] },
  { <span class="hljs-attr">command</span>: <span class="hljs-string">"calculate"</span>, <span class="hljs-attr">data</span>: [<span class="hljs-number">7</span>, <span class="hljs-number">8</span>, <span class="hljs-number">9</span>] },
  { <span class="hljs-attr">command</span>: <span class="hljs-string">"calculate"</span>, <span class="hljs-attr">data</span>: [<span class="hljs-number">10</span>, <span class="hljs-number">11</span>, <span class="hljs-number">12</span>] },
];

<span class="hljs-built_in">Promise</span>.all(tasks.map(<span class="hljs-function">(<span class="hljs-params">task</span>) =&gt;</span> workerPool.execute(task)))
  .then(<span class="hljs-function">(<span class="hljs-params">results</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"All tasks completed:"</span>, results);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Worker stats:"</span>, workerPool.getStats());
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Task error:"</span>, error);
  });
</div></code></pre>
<hr>
<h2 id="%E2%9A%99%EF%B8%8F-service-workers">⚙️ Service Workers</h2>
<h3 id="basic-service-worker">Basic Service Worker</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// main.js - Register service worker</span>
<span class="hljs-keyword">if</span> (<span class="hljs-string">"serviceWorker"</span> <span class="hljs-keyword">in</span> navigator) {
  <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"load"</span>, () =&gt; {
    navigator.serviceWorker
      .register(<span class="hljs-string">"/sw.js"</span>)
      .then(<span class="hljs-function">(<span class="hljs-params">registration</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"SW registered:"</span>, registration);

        <span class="hljs-comment">// Listen for updates</span>
        registration.addEventListener(<span class="hljs-string">"updatefound"</span>, () =&gt; {
          <span class="hljs-keyword">const</span> newWorker = registration.installing;
          newWorker.addEventListener(<span class="hljs-string">"statechange"</span>, () =&gt; {
            <span class="hljs-keyword">if</span> (
              newWorker.state === <span class="hljs-string">"installed"</span> &amp;&amp;
              navigator.serviceWorker.controller
            ) {
              <span class="hljs-comment">// New version available</span>
              showUpdateNotification();
            }
          });
        });
      })
      .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"SW registration failed:"</span>, error);
      });
  });

  <span class="hljs-comment">// Listen for messages from service worker</span>
  navigator.serviceWorker.addEventListener(<span class="hljs-string">"message"</span>, (e) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Message from SW:"</span>, e.data);
  });
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showUpdateNotification</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (confirm(<span class="hljs-string">"New version available! Reload to update?"</span>)) {
    <span class="hljs-built_in">window</span>.location.reload();
  }
}
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// sw.js - Service Worker</span>
<span class="hljs-keyword">const</span> CACHE_NAME = <span class="hljs-string">"my-app-v1"</span>;
<span class="hljs-keyword">const</span> urlsToCache = [
  <span class="hljs-string">"/"</span>,
  <span class="hljs-string">"/styles/main.css"</span>,
  <span class="hljs-string">"/scripts/main.js"</span>,
  <span class="hljs-string">"/images/logo.png"</span>,
  <span class="hljs-string">"/offline.html"</span>,
];

<span class="hljs-comment">// Install event - cache resources</span>
self.addEventListener(<span class="hljs-string">"install"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Service Worker installing"</span>);

  e.waitUntil(
    caches
      .open(CACHE_NAME)
      .then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Caching app shell"</span>);
        <span class="hljs-keyword">return</span> cache.addAll(urlsToCache);
      })
      .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// Force activation of new service worker</span>
        <span class="hljs-keyword">return</span> self.skipWaiting();
      })
  );
});

<span class="hljs-comment">// Activate event - clean up old caches</span>
self.addEventListener(<span class="hljs-string">"activate"</span>, (e) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Service Worker activating"</span>);

  e.waitUntil(
    caches
      .keys()
      .then(<span class="hljs-function">(<span class="hljs-params">cacheNames</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(
          cacheNames.map(<span class="hljs-function">(<span class="hljs-params">cacheName</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (cacheName !== CACHE_NAME) {
              <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Deleting old cache:"</span>, cacheName);
              <span class="hljs-keyword">return</span> caches.delete(cacheName);
            }
          })
        );
      })
      .then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// Take control of all pages</span>
        <span class="hljs-keyword">return</span> self.clients.claim();
      })
  );
});

<span class="hljs-comment">// Fetch event - serve from cache, fallback to network</span>
self.addEventListener(<span class="hljs-string">"fetch"</span>, (e) =&gt; {
  e.respondWith(
    caches
      .match(e.request)
      .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-comment">// Return cached version or fetch from network</span>
        <span class="hljs-keyword">if</span> (response) {
          <span class="hljs-keyword">return</span> response;
        }

        <span class="hljs-keyword">return</span> fetch(e.request).then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
          <span class="hljs-comment">// Don't cache non-successful responses</span>
          <span class="hljs-keyword">if</span> (
            !response ||
            response.status !== <span class="hljs-number">200</span> ||
            response.type !== <span class="hljs-string">"basic"</span>
          ) {
            <span class="hljs-keyword">return</span> response;
          }

          <span class="hljs-comment">// Clone response for caching</span>
          <span class="hljs-keyword">const</span> responseToCache = response.clone();

          caches.open(CACHE_NAME).then(<span class="hljs-function">(<span class="hljs-params">cache</span>) =&gt;</span> {
            cache.put(e.request, responseToCache);
          });

          <span class="hljs-keyword">return</span> response;
        });
      })
      .catch(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-comment">// Show offline page for navigation requests</span>
        <span class="hljs-keyword">if</span> (e.request.destination === <span class="hljs-string">"document"</span>) {
          <span class="hljs-keyword">return</span> caches.match(<span class="hljs-string">"/offline.html"</span>);
        }
      })
  );
});

<span class="hljs-comment">// Background sync</span>
self.addEventListener(<span class="hljs-string">"sync"</span>, (e) =&gt; {
  <span class="hljs-keyword">if</span> (e.tag === <span class="hljs-string">"background-sync"</span>) {
    e.waitUntil(doBackgroundSync());
  }
});

<span class="hljs-comment">// Push notifications</span>
self.addEventListener(<span class="hljs-string">"push"</span>, (e) =&gt; {
  <span class="hljs-keyword">const</span> options = {
    <span class="hljs-attr">body</span>: e.data ? e.data.text() : <span class="hljs-string">"Default notification body"</span>,
    <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/icon-192x192.png"</span>,
    <span class="hljs-attr">badge</span>: <span class="hljs-string">"/images/badge-72x72.png"</span>,
    <span class="hljs-attr">vibrate</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>],
    <span class="hljs-attr">data</span>: {
      <span class="hljs-attr">dateOfArrival</span>: <span class="hljs-built_in">Date</span>.now(),
      <span class="hljs-attr">primaryKey</span>: <span class="hljs-number">1</span>,
    },
    <span class="hljs-attr">actions</span>: [
      {
        <span class="hljs-attr">action</span>: <span class="hljs-string">"explore"</span>,
        <span class="hljs-attr">title</span>: <span class="hljs-string">"Explore"</span>,
        <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/checkmark.png"</span>,
      },
      {
        <span class="hljs-attr">action</span>: <span class="hljs-string">"close"</span>,
        <span class="hljs-attr">title</span>: <span class="hljs-string">"Close"</span>,
        <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/xmark.png"</span>,
      },
    ],
  };

  e.waitUntil(
    self.registration.showNotification(<span class="hljs-string">"My App Notification"</span>, options)
  );
});

<span class="hljs-comment">// Notification click</span>
self.addEventListener(<span class="hljs-string">"notificationclick"</span>, (e) =&gt; {
  e.notification.close();

  <span class="hljs-keyword">if</span> (e.action === <span class="hljs-string">"explore"</span>) {
    <span class="hljs-comment">// Open app</span>
    e.waitUntil(clients.openWindow(<span class="hljs-string">"/explore"</span>));
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.action === <span class="hljs-string">"close"</span>) {
    <span class="hljs-comment">// Just close notification</span>
    <span class="hljs-keyword">return</span>;
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// Default action</span>
    e.waitUntil(clients.openWindow(<span class="hljs-string">"/"</span>));
  }
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">doBackgroundSync</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Perform background tasks</span>
  <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">"/api/sync"</span>)
    .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json())
    .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Background sync completed:"</span>, data);
    })
    .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Background sync failed:"</span>, error);
    });
}

<span class="hljs-comment">// Message handling</span>
self.addEventListener(<span class="hljs-string">"message"</span>, (e) =&gt; {
  <span class="hljs-keyword">if</span> (e.data &amp;&amp; e.data.type === <span class="hljs-string">"SKIP_WAITING"</span>) {
    self.skipWaiting();
  }
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%91%81%EF%B8%8F-intersection-observer">👁️ Intersection Observer</h2>
<h3 id="basic-intersection-observer">Basic Intersection Observer</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Lazy loading images</span>
<span class="hljs-keyword">const</span> imageObserver = <span class="hljs-keyword">new</span> IntersectionObserver(
  <span class="hljs-function">(<span class="hljs-params">entries, observer</span>) =&gt;</span> {
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.isIntersecting) {
        <span class="hljs-keyword">const</span> img = entry.target;
        img.src = img.dataset.src;
        img.classList.remove(<span class="hljs-string">"lazy"</span>);
        observer.unobserve(img);
      }
    });
  },
  {
    <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">"50px 0px"</span>, <span class="hljs-comment">// Load 50px before entering viewport</span>
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.1</span>,
  }
);

<span class="hljs-comment">// Observe all lazy images</span>
<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"img[data-src]"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">img</span>) =&gt;</span> {
  imageObserver.observe(img);
});
</div></code></pre>
<h3 id="advanced-intersection-observer">Advanced Intersection Observer</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IntersectionManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.observers = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  createObserver(name, callback, options = {}) {
    <span class="hljs-keyword">const</span> defaultOptions = {
      <span class="hljs-attr">root</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">"0px"</span>,
      <span class="hljs-attr">threshold</span>: <span class="hljs-number">0</span>,
    };

    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> IntersectionObserver(callback, {
      ...defaultOptions,
      ...options,
    });

    <span class="hljs-keyword">this</span>.observers.set(name, observer);
    <span class="hljs-keyword">return</span> observer;
  }

  getObserver(name) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.observers.get(name);
  }

  destroyObserver(name) {
    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">this</span>.observers.get(name);
    <span class="hljs-keyword">if</span> (observer) {
      observer.disconnect();
      <span class="hljs-keyword">this</span>.observers.delete(name);
    }
  }

  destroyAll() {
    <span class="hljs-keyword">this</span>.observers.forEach(<span class="hljs-function">(<span class="hljs-params">observer</span>) =&gt;</span> observer.disconnect());
    <span class="hljs-keyword">this</span>.observers.clear();
  }
}

<span class="hljs-keyword">const</span> intersectionManager = <span class="hljs-keyword">new</span> IntersectionManager();

<span class="hljs-comment">// Lazy loading observer</span>
intersectionManager.createObserver(
  <span class="hljs-string">"lazyLoad"</span>,
  (entries) =&gt; {
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.isIntersecting) {
        <span class="hljs-keyword">const</span> element = entry.target;

        <span class="hljs-keyword">if</span> (element.dataset.src) {
          element.src = element.dataset.src;
          element.removeAttribute(<span class="hljs-string">"data-src"</span>);
        }

        <span class="hljs-keyword">if</span> (element.dataset.srcset) {
          element.srcset = element.dataset.srcset;
          element.removeAttribute(<span class="hljs-string">"data-srcset"</span>);
        }

        element.classList.add(<span class="hljs-string">"loaded"</span>);
        intersectionManager.getObserver(<span class="hljs-string">"lazyLoad"</span>).unobserve(element);
      }
    });
  },
  {
    <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">"100px 0px"</span>,
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.1</span>,
  }
);

<span class="hljs-comment">// Infinite scroll observer</span>
intersectionManager.createObserver(
  <span class="hljs-string">"infiniteScroll"</span>,
  (entries) =&gt; {
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.isIntersecting) {
        loadMoreContent();
      }
    });
  },
  {
    <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">"200px 0px"</span>,
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">1.0</span>,
  }
);

<span class="hljs-comment">// Animation trigger observer</span>
intersectionManager.createObserver(
  <span class="hljs-string">"animations"</span>,
  (entries) =&gt; {
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.isIntersecting) {
        entry.target.classList.add(<span class="hljs-string">"animate-in"</span>);
      } <span class="hljs-keyword">else</span> {
        entry.target.classList.remove(<span class="hljs-string">"animate-in"</span>);
      }
    });
  },
  {
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.3</span>,
  }
);

<span class="hljs-comment">// Progress tracking observer</span>
intersectionManager.createObserver(
  <span class="hljs-string">"progress"</span>,
  (entries) =&gt; {
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> progress = <span class="hljs-built_in">Math</span>.round(entry.intersectionRatio * <span class="hljs-number">100</span>);
      updateReadingProgress(progress);
    });
  },
  {
    <span class="hljs-attr">threshold</span>: <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">101</span> }, (_, i) =&gt; i / <span class="hljs-number">100</span>), <span class="hljs-comment">// 0, 0.01, 0.02, ..., 1.0</span>
  }
);

<span class="hljs-comment">// Usage</span>
<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"[data-src]"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">el</span>) =&gt;</span> {
  intersectionManager.getObserver(<span class="hljs-string">"lazyLoad"</span>).observe(el);
});

<span class="hljs-keyword">const</span> sentinel = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#scroll-sentinel"</span>);
<span class="hljs-keyword">if</span> (sentinel) {
  intersectionManager.getObserver(<span class="hljs-string">"infiniteScroll"</span>).observe(sentinel);
}

<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".animate-on-scroll"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">el</span>) =&gt;</span> {
  intersectionManager.getObserver(<span class="hljs-string">"animations"</span>).observe(el);
});

<span class="hljs-keyword">const</span> article = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"article"</span>);
<span class="hljs-keyword">if</span> (article) {
  intersectionManager.getObserver(<span class="hljs-string">"progress"</span>).observe(article);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadMoreContent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Load more content implementation</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Loading more content..."</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateReadingProgress</span>(<span class="hljs-params">progress</span>) </span>{
  <span class="hljs-keyword">const</span> progressBar = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"#reading-progress"</span>);
  <span class="hljs-keyword">if</span> (progressBar) {
    progressBar.style.width = <span class="hljs-string">`<span class="hljs-subst">${progress}</span>%`</span>;
  }
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%8D-mutation-observer">🔍 Mutation Observer</h2>
<h3 id="basic-mutation-observer">Basic Mutation Observer</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Watch for DOM changes</span>
<span class="hljs-keyword">const</span> targetNode = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"content"</span>);

<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> MutationObserver(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> {
  mutations.forEach(<span class="hljs-function">(<span class="hljs-params">mutation</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mutation type:"</span>, mutation.type);

    <span class="hljs-keyword">switch</span> (mutation.type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"childList"</span>:
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Children changed:"</span>, {
          <span class="hljs-attr">added</span>: mutation.addedNodes,
          <span class="hljs-attr">removed</span>: mutation.removedNodes,
        });
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"attributes"</span>:
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Attribute changed:"</span>, {
          <span class="hljs-attr">name</span>: mutation.attributeName,
          <span class="hljs-attr">oldValue</span>: mutation.oldValue,
          <span class="hljs-attr">newValue</span>: mutation.target.getAttribute(mutation.attributeName),
        });
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"characterData"</span>:
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Text content changed:"</span>, {
          <span class="hljs-attr">oldValue</span>: mutation.oldValue,
          <span class="hljs-attr">newValue</span>: mutation.target.textContent,
        });
        <span class="hljs-keyword">break</span>;
    }
  });
});

<span class="hljs-comment">// Start observing</span>
observer.observe(targetNode, {
  <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// Watch all descendants</span>
});

<span class="hljs-comment">// Stop observing</span>
<span class="hljs-comment">// observer.disconnect();</span>
</div></code></pre>
<h3 id="advanced-mutation-observer">Advanced Mutation Observer</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DOMWatcher</span> </span>{
    <span class="hljs-keyword">constructor</span>() {
        <span class="hljs-keyword">this</span>.observers = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
        <span class="hljs-keyword">this</span>.watchers = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    }

    watch(selector, options = {}, callback) {
        <span class="hljs-keyword">const</span> watchId = <span class="hljs-built_in">Date</span>.now() + <span class="hljs-built_in">Math</span>.random();

        <span class="hljs-keyword">const</span> defaultOptions = {
            <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">attributes</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">characterData</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
        };

        <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> MutationObserver(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> relevantMutations = mutations.filter(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (selector === <span class="hljs-string">'*'</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

                <span class="hljs-comment">// Check if mutation affects elements matching selector</span>
                <span class="hljs-keyword">if</span> (mutation.type === <span class="hljs-string">'childList'</span>) {
                    <span class="hljs-keyword">const</span> addedElements = <span class="hljs-built_in">Array</span>.from(mutation.addedNodes)
                        .filter(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> node.nodeType === Node.ELEMENT_NODE);
                    <span class="hljs-keyword">const</span> removedElements = <span class="hljs-built_in">Array</span>.from(mutation.removedNodes)
                        .filter(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> node.nodeType === Node.ELEMENT_NODE);

                    <span class="hljs-keyword">return</span> addedElements.some(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> el.matches(selector)) ||
                           removedElements.some(<span class="hljs-function"><span class="hljs-params">el</span> =&gt;</span> el.matches(selector));
                }

                <span class="hljs-keyword">return</span> mutation.target.matches(selector);
            });

            <span class="hljs-keyword">if</span> (relevantMutations.length &gt; <span class="hljs-number">0</span>) {
                callback(relevantMutations, observer);
            }
        });

        <span class="hljs-keyword">const</span> target = <span class="hljs-built_in">document</span>.body; <span class="hljs-comment">// Watch entire document</span>
        observer.observe(target, { ...defaultOptions, ...options });

        <span class="hljs-keyword">this</span>.observers.set(watchId, observer);
        <span class="hljs-keyword">this</span>.watchers.set(watchId, { selector, options, callback });

        <span class="hljs-keyword">return</span> watchId;
    }

    unwatch(watchId) {
        <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">this</span>.observers.get(watchId);
        <span class="hljs-keyword">if</span> (observer) {
            observer.disconnect();
            <span class="hljs-keyword">this</span>.observers.delete(watchId);
            <span class="hljs-keyword">this</span>.watchers.delete(watchId);
        }
    }

    unwatchAll() {
        <span class="hljs-keyword">this</span>.observers.forEach(<span class="hljs-function"><span class="hljs-params">observer</span> =&gt;</span> observer.disconnect());
        <span class="hljs-keyword">this</span>.observers.clear();
        <span class="hljs-keyword">this</span>.watchers.clear();
    }

    <span class="hljs-comment">// Watch for specific element additions</span>
    onElementAdded(selector, callback) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.watch(selector, { <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span> }, (mutations) =&gt; {
            mutations.forEach(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (mutation.type === <span class="hljs-string">'childList'</span>) {
                    <span class="hljs-keyword">const</span> addedElements = <span class="hljs-built_in">Array</span>.from(mutation.addedNodes)
                        .filter(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> node.nodeType === Node.ELEMENT_NODE &amp;&amp; node.matches(selector));

                    addedElements.forEach(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> callback(element));
                }
            });
        });
    }

    <span class="hljs-comment">// Watch for specific element removals</span>
    onElementRemoved(selector, callback) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.watch(selector, { <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span> }, (mutations) =&gt; {
            mutations.forEach(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (mutation.type === <span class="hljs-string">'childList'</span>) {
                    <span class="hljs-keyword">const</span> removedElements = <span class="hljs-built_in">Array</span>.from(mutation.removedNodes)
                        .filter(<span class="hljs-function"><span class="hljs-params">node</span> =&gt;</span> node.nodeType === Node.ELEMENT_NODE &amp;&amp; node.matches(selector));

                    removedElements.forEach(<span class="hljs-function"><span class="hljs-params">element</span> =&gt;</span> callback(element));
                }
            });
        });
    }

    <span class="hljs-comment">// Watch for attribute changes</span>
    onAttributeChange(selector, attributeName, callback) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.watch(selector, {
            <span class="hljs-attr">attributes</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">attributeOldValue</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">attributeFilter</span>: attributeName ? [attributeName] : <span class="hljs-literal">undefined</span>
        }, (mutations) =&gt; {
            mutations.forEach(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (mutation.type === <span class="hljs-string">'attributes'</span>) {
                    callback(mutation.target, {
                        <span class="hljs-attr">attributeName</span>: mutation.attributeName,
                        <span class="hljs-attr">oldValue</span>: mutation.oldValue,
                        <span class="hljs-attr">newValue</span>: mutation.target.getAttribute(mutation.attributeName)
                    });
                }
            });
        });
    }

    <span class="hljs-comment">// Watch for text content changes</span>
    onTextChange(selector, callback) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.watch(selector, {
            <span class="hljs-attr">characterData</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">characterDataOldValue</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>
        }, (mutations) =&gt; {
            mutations.forEach(<span class="hljs-function"><span class="hljs-params">mutation</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (mutation.type === <span class="hljs-string">'characterData'</span>) {
                    callback(mutation.target, {
                        <span class="hljs-attr">oldValue</span>: mutation.oldValue,
                        <span class="hljs-attr">newValue</span>: mutation.target.textContent
                    });
                }
            });
        });
    }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> domWatcher = <span class="hljs-keyword">new</span> DOMWatcher();

<span class="hljs-comment">// Watch for new buttons being added</span>
<span class="hljs-keyword">const</span> buttonWatchId = domWatcher.onElementAdded(<span class="hljs-string">'button'</span>, (button) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'New button added:'</span>, button);
    <span class="hljs-comment">// Auto-setup event listeners for new buttons</span>
    button.addEventListener(<span class="hljs-string">'click'</span>, handleButtonClick);
});

<span class="hljs-comment">// Watch for class changes on specific elements</span>
<span class="hljs-keyword">const</span> classWatchId = domWatcher.onAttributeChange(<span class="hljs-string">'.status-indicator'</span>, <span class="hljs-string">'class'</span>, (element, change) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Class changed:'</span>, change);
    <span class="hljs-keyword">if</span> (change.newValue.includes(<span class="hljs-string">'error'</span>)) {
        showErrorNotification();
    }
});

<span class="hljs-comment">// Watch for text changes in live content</span>
<span class="hljs-keyword">const</span> textWatchId = domWatcher.onTextChange(<span class="hljs-string">'#live-content'</span>, (textNode, change) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Text updated:'</span>, change);
    updateLastModified();
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleButtonClick</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Button clicked:'</span>, e.target);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showErrorNotification</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Error detected!'</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateLastModified</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#last-modified'</span>).textContent = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleString();
}

---

## 🕰️ History API

### Basic History Management
<span class="hljs-string">``</span><span class="hljs-string">`javascript
// Push new state
history.pushState({ page: 'about' }, 'About Page', '/about');

// Replace current state
history.replaceState({ page: 'home', section: 'hero' }, 'Home - Hero', '/home#hero');

// Go back/forward
history.back();
history.forward();
history.go(-2); // Go back 2 pages

// Listen for popstate events (back/forward button)
window.addEventListener('popstate', (e) =&gt; {
    console.log('State changed:', e.state);
    handleRouteChange(e.state);
});

function handleRouteChange(state) {
    if (state) {
        // Update page based on state
        switch (state.page) {
            case 'home':
                showHomePage();
                break;
            case 'about':
                showAboutPage();
                break;
            default:
                show404Page();
        }
    }
}
</span></div></code></pre>
<h3 id="single-page-application-router">Single Page Application Router</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SPARouter</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.routes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.currentRoute = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.beforeRouteChange = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.afterRouteChange = <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">this</span>.init();
  }

  init() {
    <span class="hljs-comment">// Handle popstate events</span>
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"popstate"</span>, (e) =&gt; {
      <span class="hljs-keyword">this</span>.handleRouteChange(<span class="hljs-built_in">window</span>.location.pathname, e.state, <span class="hljs-literal">false</span>);
    });

    <span class="hljs-comment">// Handle initial page load</span>
    <span class="hljs-keyword">this</span>.handleRouteChange(<span class="hljs-built_in">window</span>.location.pathname, <span class="hljs-literal">null</span>, <span class="hljs-literal">false</span>);

    <span class="hljs-comment">// Intercept link clicks</span>
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, (e) =&gt; {
      <span class="hljs-keyword">if</span> (e.target.matches(<span class="hljs-string">'a[href^="/"]'</span>)) {
        e.preventDefault();
        <span class="hljs-keyword">this</span>.navigate(e.target.getAttribute(<span class="hljs-string">"href"</span>));
      }
    });
  }

  addRoute(path, handler, options = {}) {
    <span class="hljs-keyword">this</span>.routes.set(path, {
      handler,
      <span class="hljs-attr">title</span>: options.title || <span class="hljs-string">""</span>,
      <span class="hljs-attr">meta</span>: options.meta || {},
      <span class="hljs-attr">guards</span>: options.guards || [],
    });
  }

  navigate(path, state = {}, replace = <span class="hljs-literal">false</span>) {
    <span class="hljs-keyword">const</span> route = <span class="hljs-keyword">this</span>.findRoute(path);

    <span class="hljs-keyword">if</span> (!route) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Route not found:"</span>, path);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">this</span>.handleRouteChange(path, state, <span class="hljs-literal">true</span>, replace);
  }

  findRoute(path) {
    <span class="hljs-comment">// Exact match first</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.routes.has(path)) {
      <span class="hljs-keyword">return</span> { path, ...this.routes.get(path) };
    }

    <span class="hljs-comment">// Pattern matching for dynamic routes</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [routePath, routeConfig] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.routes) {
      <span class="hljs-keyword">const</span> params = <span class="hljs-keyword">this</span>.matchRoute(routePath, path);
      <span class="hljs-keyword">if</span> (params) {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">path</span>: routePath, params, ...routeConfig };
      }
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  matchRoute(routePath, actualPath) {
    <span class="hljs-keyword">const</span> routeParts = routePath.split(<span class="hljs-string">"/"</span>);
    <span class="hljs-keyword">const</span> actualParts = actualPath.split(<span class="hljs-string">"/"</span>);

    <span class="hljs-keyword">if</span> (routeParts.length !== actualParts.length) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">const</span> params = {};

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; routeParts.length; i++) {
      <span class="hljs-keyword">const</span> routePart = routeParts[i];
      <span class="hljs-keyword">const</span> actualPart = actualParts[i];

      <span class="hljs-keyword">if</span> (routePart.startsWith(<span class="hljs-string">":"</span>)) {
        <span class="hljs-comment">// Dynamic parameter</span>
        params[routePart.slice(<span class="hljs-number">1</span>)] = actualPart;
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (routePart !== actualPart) {
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
      }
    }

    <span class="hljs-keyword">return</span> params;
  }

  <span class="hljs-keyword">async</span> handleRouteChange(path, state, updateHistory, replace = <span class="hljs-literal">false</span>) {
    <span class="hljs-keyword">const</span> route = <span class="hljs-keyword">this</span>.findRoute(path);

    <span class="hljs-keyword">if</span> (!route) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Route not found:"</span>, path);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Run before route change hook</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.beforeRouteChange) {
      <span class="hljs-keyword">const</span> canProceed = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.beforeRouteChange(route, <span class="hljs-keyword">this</span>.currentRoute);
      <span class="hljs-keyword">if</span> (!canProceed) <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Run route guards</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> guard <span class="hljs-keyword">of</span> route.guards) {
      <span class="hljs-keyword">const</span> canProceed = <span class="hljs-keyword">await</span> guard(route);
      <span class="hljs-keyword">if</span> (!canProceed) <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Update browser history</span>
    <span class="hljs-keyword">if</span> (updateHistory) {
      <span class="hljs-keyword">const</span> method = replace ? <span class="hljs-string">"replaceState"</span> : <span class="hljs-string">"pushState"</span>;
      history[method](state, route.title, path);
    }

    <span class="hljs-comment">// Update document title</span>
    <span class="hljs-keyword">if</span> (route.title) {
      <span class="hljs-built_in">document</span>.title = route.title;
    }

    <span class="hljs-comment">// Update meta tags</span>
    <span class="hljs-keyword">this</span>.updateMetaTags(route.meta);

    <span class="hljs-comment">// Execute route handler</span>
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> route.handler(route.params || {}, state);
      <span class="hljs-keyword">this</span>.currentRoute = route;

      <span class="hljs-comment">// Run after route change hook</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.afterRouteChange) {
        <span class="hljs-keyword">this</span>.afterRouteChange(route);
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Route handler error:"</span>, error);
    }
  }

  updateMetaTags(meta) {
    <span class="hljs-built_in">Object</span>.entries(meta).forEach(<span class="hljs-function">(<span class="hljs-params">[name, content]</span>) =&gt;</span> {
      <span class="hljs-keyword">let</span> metaTag = <span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">`meta[name="<span class="hljs-subst">${name}</span>"]`</span>);

      <span class="hljs-keyword">if</span> (!metaTag) {
        metaTag = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"meta"</span>);
        metaTag.name = name;
        <span class="hljs-built_in">document</span>.head.appendChild(metaTag);
      }

      metaTag.content = content;
    });
  }

  setBeforeRouteChange(callback) {
    <span class="hljs-keyword">this</span>.beforeRouteChange = callback;
  }

  setAfterRouteChange(callback) {
    <span class="hljs-keyword">this</span>.afterRouteChange = callback;
  }

  getCurrentRoute() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.currentRoute;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> SPARouter();

<span class="hljs-comment">// Add routes</span>
router.addRoute(
  <span class="hljs-string">"/"</span>,
  <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"app"</span>).innerHTML = <span class="hljs-string">"&lt;h1&gt;Home Page&lt;/h1&gt;"</span>;
  },
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">"Home - My App"</span>,
    <span class="hljs-attr">meta</span>: {
      <span class="hljs-attr">description</span>: <span class="hljs-string">"Welcome to our home page"</span>,
    },
  }
);

router.addRoute(
  <span class="hljs-string">"/about"</span>,
  <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"app"</span>).innerHTML = <span class="hljs-string">"&lt;h1&gt;About Page&lt;/h1&gt;"</span>;
  },
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">"About - My App"</span>,
  }
);

router.addRoute(
  <span class="hljs-string">"/user/:id"</span>,
  <span class="hljs-keyword">async</span> (params) =&gt; {
    <span class="hljs-keyword">const</span> userId = params.id;
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(userId);
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"app"</span>).innerHTML = <span class="hljs-string">`&lt;h1&gt;User: <span class="hljs-subst">${user.name}</span>&lt;/h1&gt;`</span>;
  },
  {
    <span class="hljs-attr">title</span>: <span class="hljs-string">"User Profile - My App"</span>,
    <span class="hljs-attr">guards</span>: [requireAuth],
  }
);

<span class="hljs-comment">// Route guards</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requireAuth</span>(<span class="hljs-params">route</span>) </span>{
  <span class="hljs-keyword">const</span> isAuthenticated = checkAuthStatus();
  <span class="hljs-keyword">if</span> (!isAuthenticated) {
    router.navigate(<span class="hljs-string">"/login"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}

<span class="hljs-comment">// Hooks</span>
router.setBeforeRouteChange(<span class="hljs-keyword">async</span> (newRoute, oldRoute) =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Navigating from"</span>, oldRoute?.path, <span class="hljs-string">"to"</span>, newRoute.path);
  showLoadingSpinner();
  <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
});

router.setAfterRouteChange(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Route changed to:"</span>, route.path);
  hideLoadingSpinner();
  trackPageView(route.path);
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUser</span>(<span class="hljs-params">id</span>) </span>{
  <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${id}</span>`</span>).then(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.json());
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkAuthStatus</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> localStorage.getItem(<span class="hljs-string">"authToken"</span>) !== <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showLoadingSpinner</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"loading"</span>).style.display = <span class="hljs-string">"block"</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hideLoadingSpinner</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"loading"</span>).style.display = <span class="hljs-string">"none"</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">trackPageView</span>(<span class="hljs-params">path</span>) </span>{
  <span class="hljs-comment">// Analytics tracking</span>
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Page view:"</span>, path);
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%94-notification-api">🔔 Notification API</h2>
<h3 id="basic-notifications">Basic Notifications</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Check if notifications are supported</span>
<span class="hljs-keyword">if</span> (<span class="hljs-string">"Notification"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) {
  <span class="hljs-comment">// Request permission</span>
  Notification.requestPermission().then(<span class="hljs-function">(<span class="hljs-params">permission</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (permission === <span class="hljs-string">"granted"</span>) {
      showNotification(<span class="hljs-string">"Welcome!"</span>, <span class="hljs-string">"Thanks for enabling notifications."</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Notification permission denied"</span>);
    }
  });
} <span class="hljs-keyword">else</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Notifications not supported"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showNotification</span>(<span class="hljs-params">title, body, options = {}</span>) </span>{
  <span class="hljs-keyword">if</span> (Notification.permission === <span class="hljs-string">"granted"</span>) {
    <span class="hljs-keyword">const</span> notification = <span class="hljs-keyword">new</span> Notification(title, {
      body,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/icon-192x192.png"</span>,
      <span class="hljs-attr">badge</span>: <span class="hljs-string">"/images/badge-72x72.png"</span>,
      <span class="hljs-attr">image</span>: <span class="hljs-string">"/images/notification-image.jpg"</span>,
      <span class="hljs-attr">vibrate</span>: [<span class="hljs-number">200</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>],
      <span class="hljs-attr">tag</span>: <span class="hljs-string">"general"</span>, <span class="hljs-comment">// Prevents duplicate notifications</span>
      <span class="hljs-attr">renotify</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">requireInteraction</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">silent</span>: <span class="hljs-literal">false</span>,
      ...options,
    });

    <span class="hljs-comment">// Handle notification events</span>
    notification.onclick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.focus();
      notification.close();
    };

    notification.onshow = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Notification shown"</span>);
    };

    notification.onclose = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Notification closed"</span>);
    };

    notification.onerror = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Notification error"</span>);
    };

    <span class="hljs-comment">// Auto-close after 5 seconds</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      notification.close();
    }, <span class="hljs-number">5000</span>);

    <span class="hljs-keyword">return</span> notification;
  }
}
</div></code></pre>
<h3 id="advanced-notification-manager">Advanced Notification Manager</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NotificationManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.permission = Notification.permission;
    <span class="hljs-keyword">this</span>.notifications = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.queue = [];
    <span class="hljs-keyword">this</span>.isSupported = <span class="hljs-string">"Notification"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>;
  }

  <span class="hljs-keyword">async</span> requestPermission() {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isSupported) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Notifications not supported"</span>);
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.permission === <span class="hljs-string">"default"</span>) {
      <span class="hljs-keyword">this</span>.permission = <span class="hljs-keyword">await</span> Notification.requestPermission();
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.permission;
  }

  <span class="hljs-keyword">async</span> show(title, options = {}) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isSupported) {
      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Notifications not supported"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.permission !== <span class="hljs-string">"granted"</span>) {
      <span class="hljs-keyword">const</span> permission = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.requestPermission();
      <span class="hljs-keyword">if</span> (permission !== <span class="hljs-string">"granted"</span>) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Notification permission denied"</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
      }
    }

    <span class="hljs-keyword">const</span> defaultOptions = {
      <span class="hljs-attr">body</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/icon-192x192.png"</span>,
      <span class="hljs-attr">badge</span>: <span class="hljs-string">"/images/badge-72x72.png"</span>,
      <span class="hljs-attr">tag</span>: <span class="hljs-string">"default"</span>,
      <span class="hljs-attr">renotify</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">requireInteraction</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">silent</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">vibrate</span>: [<span class="hljs-number">100</span>, <span class="hljs-number">50</span>, <span class="hljs-number">100</span>],
      <span class="hljs-attr">data</span>: {},
      <span class="hljs-attr">actions</span>: [],
    };

    <span class="hljs-keyword">const</span> finalOptions = { ...defaultOptions, ...options };

    <span class="hljs-comment">// Close existing notification with same tag</span>
    <span class="hljs-keyword">if</span> (finalOptions.tag &amp;&amp; <span class="hljs-keyword">this</span>.notifications.has(finalOptions.tag)) {
      <span class="hljs-keyword">this</span>.notifications.get(finalOptions.tag).close();
    }

    <span class="hljs-keyword">const</span> notification = <span class="hljs-keyword">new</span> Notification(title, finalOptions);

    <span class="hljs-comment">// Store notification</span>
    <span class="hljs-keyword">if</span> (finalOptions.tag) {
      <span class="hljs-keyword">this</span>.notifications.set(finalOptions.tag, notification);
    }

    <span class="hljs-comment">// Setup event handlers</span>
    notification.onclick = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (options.onClick) {
        options.onClick(e, notification);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">window</span>.focus();
        notification.close();
      }
    };

    notification.onclose = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (finalOptions.tag) {
        <span class="hljs-keyword">this</span>.notifications.delete(finalOptions.tag);
      }
      <span class="hljs-keyword">if</span> (options.onClose) {
        options.onClose(e, notification);
      }
    };

    notification.onerror = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (options.onError) {
        options.onError(e, notification);
      }
    };

    notification.onshow = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (options.onShow) {
        options.onShow(e, notification);
      }
    };

    <span class="hljs-comment">// Auto-close if specified</span>
    <span class="hljs-keyword">if</span> (options.autoClose) {
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        notification.close();
      }, options.autoClose);
    }

    <span class="hljs-keyword">return</span> notification;
  }

  close(tag) {
    <span class="hljs-keyword">const</span> notification = <span class="hljs-keyword">this</span>.notifications.get(tag);
    <span class="hljs-keyword">if</span> (notification) {
      notification.close();
    }
  }

  closeAll() {
    <span class="hljs-keyword">this</span>.notifications.forEach(<span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> notification.close());
    <span class="hljs-keyword">this</span>.notifications.clear();
  }

  <span class="hljs-comment">// Predefined notification types</span>
  success(title, body, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.show(title, {
      body,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/success-icon.png"</span>,
      <span class="hljs-attr">tag</span>: <span class="hljs-string">"success"</span>,
      <span class="hljs-attr">autoClose</span>: <span class="hljs-number">3000</span>,
      ...options,
    });
  }

  error(title, body, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.show(title, {
      body,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/error-icon.png"</span>,
      <span class="hljs-attr">tag</span>: <span class="hljs-string">"error"</span>,
      <span class="hljs-attr">requireInteraction</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">vibrate</span>: [<span class="hljs-number">200</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>, <span class="hljs-number">100</span>, <span class="hljs-number">200</span>],
      ...options,
    });
  }

  warning(title, body, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.show(title, {
      body,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/warning-icon.png"</span>,
      <span class="hljs-attr">tag</span>: <span class="hljs-string">"warning"</span>,
      <span class="hljs-attr">autoClose</span>: <span class="hljs-number">5000</span>,
      ...options,
    });
  }

  info(title, body, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.show(title, {
      body,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/info-icon.png"</span>,
      <span class="hljs-attr">tag</span>: <span class="hljs-string">"info"</span>,
      <span class="hljs-attr">autoClose</span>: <span class="hljs-number">4000</span>,
      ...options,
    });
  }

  <span class="hljs-comment">// Queue notifications when permission is not granted</span>
  queueNotification(title, options) {
    <span class="hljs-keyword">this</span>.queue.push({ title, options });
  }

  <span class="hljs-keyword">async</span> processQueue() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.permission === <span class="hljs-string">"granted"</span> &amp;&amp; <span class="hljs-keyword">this</span>.queue.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { title, options } <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.queue) {
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.show(title, options);
      }
      <span class="hljs-keyword">this</span>.queue = [];
    }
  }

  getPermissionStatus() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.permission;
  }

  isSupported() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.isSupported;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> notifications = <span class="hljs-keyword">new</span> NotificationManager();

<span class="hljs-comment">// Request permission on page load</span>
notifications.requestPermission().then(<span class="hljs-function">(<span class="hljs-params">permission</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (permission === <span class="hljs-string">"granted"</span>) {
    notifications.processQueue();
  }
});

<span class="hljs-comment">// Show different types of notifications</span>
notifications.success(<span class="hljs-string">"Success!"</span>, <span class="hljs-string">"Your changes have been saved."</span>);
notifications.error(<span class="hljs-string">"Error!"</span>, <span class="hljs-string">"Failed to save changes. Please try again."</span>);
notifications.warning(<span class="hljs-string">"Warning!"</span>, <span class="hljs-string">"Your session will expire in 5 minutes."</span>);
notifications.info(<span class="hljs-string">"Info"</span>, <span class="hljs-string">"New features are available!"</span>);

<span class="hljs-comment">// Custom notification with actions (requires service worker)</span>
notifications.show(<span class="hljs-string">"New Message"</span>, {
  <span class="hljs-attr">body</span>: <span class="hljs-string">"You have received a new message from John."</span>,
  <span class="hljs-attr">tag</span>: <span class="hljs-string">"message"</span>,
  <span class="hljs-attr">data</span>: { <span class="hljs-attr">messageId</span>: <span class="hljs-number">123</span> },
  <span class="hljs-attr">actions</span>: [
    { <span class="hljs-attr">action</span>: <span class="hljs-string">"reply"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Reply"</span>, <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/reply-icon.png"</span> },
    {
      <span class="hljs-attr">action</span>: <span class="hljs-string">"mark-read"</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Mark as Read"</span>,
      <span class="hljs-attr">icon</span>: <span class="hljs-string">"/images/read-icon.png"</span>,
    },
  ],
  <span class="hljs-attr">onClick</span>: <span class="hljs-function">(<span class="hljs-params">e, notification</span>) =&gt;</span> {
    <span class="hljs-comment">// Handle notification click</span>
    <span class="hljs-built_in">window</span>.open(<span class="hljs-string">"/messages/123"</span>);
    notification.close();
  },
});
</div></code></pre>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-storage-quota-exceeded">1. Storage Quota Exceeded</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not handling storage quota errors</span>
localStorage.setItem(<span class="hljs-string">"data"</span>, largeDataString); <span class="hljs-comment">// May throw QuotaExceededError</span>

<span class="hljs-comment">// ✅ Handle storage errors gracefully</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">safeSetItem</span>(<span class="hljs-params">key, value</span>) </span>{
  <span class="hljs-keyword">try</span> {
    localStorage.setItem(key, value);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-keyword">if</span> (error.name === <span class="hljs-string">"QuotaExceededError"</span>) {
      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Storage quota exceeded"</span>);
      <span class="hljs-comment">// Clear old data or ask user</span>
      clearOldData();
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
    <span class="hljs-keyword">throw</span> error;
  }
}
</div></code></pre>
<h3 id="2-fetch-api-error-handling">2. Fetch API Error Handling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not checking response status</span>
fetch(<span class="hljs-string">"/api/data"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json()) <span class="hljs-comment">// This will succeed even for 404/500</span>
  .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(data));

<span class="hljs-comment">// ✅ Proper error handling</span>
fetch(<span class="hljs-string">"/api/data"</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>);
    }
    <span class="hljs-keyword">return</span> response.json();
  })
  .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> <span class="hljs-built_in">console</span>.log(data))
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Fetch error:"</span>, error));
</div></code></pre>
<h3 id="3-geolocation-timeout">3. Geolocation Timeout</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ No timeout handling</span>
navigator.geolocation.getCurrentPosition(success, error);

<span class="hljs-comment">// ✅ Set appropriate timeout</span>
navigator.geolocation.getCurrentPosition(success, error, {
  <span class="hljs-attr">timeout</span>: <span class="hljs-number">10000</span>, <span class="hljs-comment">// 10 seconds</span>
  <span class="hljs-attr">maximumAge</span>: <span class="hljs-number">60000</span>, <span class="hljs-comment">// Cache for 1 minute</span>
  <span class="hljs-attr">enableHighAccuracy</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Faster, less accurate</span>
});
</div></code></pre>
<h3 id="4-canvas-memory-leaks">4. Canvas Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not cleaning up canvas resources</span>
<span class="hljs-keyword">const</span> canvas = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"canvas"</span>);
<span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);
<span class="hljs-comment">// ... use canvas</span>

<span class="hljs-comment">// ✅ Clean up properly</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanupCanvas</span>(<span class="hljs-params">canvas</span>) </span>{
  <span class="hljs-keyword">const</span> ctx = canvas.getContext(<span class="hljs-string">"2d"</span>);
  ctx.clearRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, canvas.width, canvas.height);
  canvas.width = <span class="hljs-number">0</span>;
  canvas.height = <span class="hljs-number">0</span>;
  canvas.remove();
}
</div></code></pre>
<h3 id="5-web-worker-memory-management">5. Web Worker Memory Management</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not terminating workers</span>
<span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> Worker(<span class="hljs-string">"worker.js"</span>);
worker.postMessage(data);
<span class="hljs-comment">// Worker keeps running</span>

<span class="hljs-comment">// ✅ Terminate when done</span>
worker.onmessage = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(e.data);
  worker.terminate(); <span class="hljs-comment">// Clean up</span>
};
</div></code></pre>
<h3 id="6-service-worker-update-issues">6. Service Worker Update Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not handling service worker updates</span>
navigator.serviceWorker.register(<span class="hljs-string">"/sw.js"</span>);

<span class="hljs-comment">// ✅ Handle updates properly</span>
navigator.serviceWorker.register(<span class="hljs-string">"/sw.js"</span>).then(<span class="hljs-function">(<span class="hljs-params">registration</span>) =&gt;</span> {
  registration.addEventListener(<span class="hljs-string">"updatefound"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> newWorker = registration.installing;
    newWorker.addEventListener(<span class="hljs-string">"statechange"</span>, () =&gt; {
      <span class="hljs-keyword">if</span> (
        newWorker.state === <span class="hljs-string">"installed"</span> &amp;&amp;
        navigator.serviceWorker.controller
      ) {
        <span class="hljs-comment">// New version available</span>
        showUpdatePrompt();
      }
    });
  });
});
</div></code></pre>
<h3 id="7-observer-memory-leaks">7. Observer Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not disconnecting observers</span>
<span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> IntersectionObserver(callback);
observer.observe(element);
<span class="hljs-comment">// Observer keeps running even after element is removed</span>

<span class="hljs-comment">// ✅ Clean up observers</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cleanup</span>(<span class="hljs-params"></span>) </span>{
  observer.disconnect();
  mutationObserver.disconnect();
}

<span class="hljs-comment">// Clean up when component unmounts</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"beforeunload"</span>, cleanup);
</div></code></pre>
<hr>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-offline-first-todo-app">Problem 1: Offline-First Todo App</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a todo app that works offline using:</span>
<span class="hljs-comment">// - Service Worker for caching</span>
<span class="hljs-comment">// - IndexedDB for data storage</span>
<span class="hljs-comment">// - Background sync for uploading when online</span>
<span class="hljs-comment">// - Push notifications for reminders</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OfflineTodoApp</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should handle:</span>
    <span class="hljs-comment">// - CRUD operations that work offline</span>
    <span class="hljs-comment">// - Sync with server when online</span>
    <span class="hljs-comment">// - Conflict resolution</span>
    <span class="hljs-comment">// - Push notifications for due dates</span>
    <span class="hljs-comment">// - Offline indicator</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// init()</span>
  <span class="hljs-comment">// addTodo(text, dueDate)</span>
  <span class="hljs-comment">// updateTodo(id, updates)</span>
  <span class="hljs-comment">// deleteTodo(id)</span>
  <span class="hljs-comment">// syncWithServer()</span>
  <span class="hljs-comment">// handleConflicts(localTodos, serverTodos)</span>
  <span class="hljs-comment">// scheduleNotification(todo)</span>
  <span class="hljs-comment">// showOfflineIndicator()</span>
  <span class="hljs-comment">// registerServiceWorker()</span>
}
</div></code></pre>
<h3 id="problem-2-real-time-collaborative-canvas">Problem 2: Real-time Collaborative Canvas</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a collaborative drawing canvas using:</span>
<span class="hljs-comment">// - Canvas API for drawing</span>
<span class="hljs-comment">// - WebSockets for real-time sync</span>
<span class="hljs-comment">// - Web Workers for heavy computations</span>
<span class="hljs-comment">// - File API for import/export</span>
<span class="hljs-comment">// - History API for undo/redo</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CollaborativeCanvas</span> </span>{
  <span class="hljs-keyword">constructor</span>(canvas, websocketUrl) {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Should handle:</span>
    <span class="hljs-comment">// - Multi-user drawing</span>
    <span class="hljs-comment">// - Real-time cursor positions</span>
    <span class="hljs-comment">// - Conflict-free drawing operations</span>
    <span class="hljs-comment">// - Export to various formats</span>
    <span class="hljs-comment">// - Undo/redo with collaborative history</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// setupCanvas()</span>
  <span class="hljs-comment">// setupWebSocket()</span>
  <span class="hljs-comment">// setupWorkers()</span>
  <span class="hljs-comment">// broadcastDrawing(operation)</span>
  <span class="hljs-comment">// receiveDrawing(operation)</span>
  <span class="hljs-comment">// exportCanvas(format)</span>
  <span class="hljs-comment">// importImage(file)</span>
  <span class="hljs-comment">// undo()</span>
  <span class="hljs-comment">// redo()</span>
  <span class="hljs-comment">// showCursors(users)</span>
}
</div></code></pre>
<h3 id="problem-3-progressive-web-app-dashboard">Problem 3: Progressive Web App Dashboard</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a PWA dashboard with:</span>
<span class="hljs-comment">// - Service Worker for offline functionality</span>
<span class="hljs-comment">// - Web App Manifest for installation</span>
<span class="hljs-comment">// - Push notifications for alerts</span>
<span class="hljs-comment">// - Background sync for data updates</span>
<span class="hljs-comment">// - Geolocation for location-based features</span>
<span class="hljs-comment">// - Local storage for user preferences</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PWADashboard</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Should include:</span>
    <span class="hljs-comment">// - Installable PWA</span>
    <span class="hljs-comment">// - Offline data visualization</span>
    <span class="hljs-comment">// - Real-time notifications</span>
    <span class="hljs-comment">// - Location-based widgets</span>
    <span class="hljs-comment">// - Customizable layout</span>
    <span class="hljs-comment">// - Data export/import</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// registerServiceWorker()</span>
  <span class="hljs-comment">// setupPushNotifications()</span>
  <span class="hljs-comment">// handleInstallPrompt()</span>
  <span class="hljs-comment">// syncData()</span>
  <span class="hljs-comment">// updateLocation()</span>
  <span class="hljs-comment">// saveLayout()</span>
  <span class="hljs-comment">// exportData()</span>
  <span class="hljs-comment">// showOfflineMessage()</span>
}
</div></code></pre>
<h3 id="problem-4-media-processing-workbench">Problem 4: Media Processing Workbench</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a media processing app using:</span>
<span class="hljs-comment">// - File API for file handling</span>
<span class="hljs-comment">// - Canvas API for image processing</span>
<span class="hljs-comment">// - Web Workers for heavy processing</span>
<span class="hljs-comment">// - Web Audio API for audio processing</span>
<span class="hljs-comment">// - Intersection Observer for lazy loading</span>
<span class="hljs-comment">// - Drag and Drop API</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MediaWorkbench</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Should support:</span>
    <span class="hljs-comment">// - Image filters and effects</span>
    <span class="hljs-comment">// - Audio visualization</span>
    <span class="hljs-comment">// - Batch processing</span>
    <span class="hljs-comment">// - Progress tracking</span>
    <span class="hljs-comment">// - Preview generation</span>
    <span class="hljs-comment">// - Format conversion</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// setupDropZone()</span>
  <span class="hljs-comment">// processImage(file, filters)</span>
  <span class="hljs-comment">// processAudio(file, effects)</span>
  <span class="hljs-comment">// generateThumbnails(files)</span>
  <span class="hljs-comment">// showProgress(operation)</span>
  <span class="hljs-comment">// exportProcessed(format)</span>
  <span class="hljs-comment">// setupWorkerPool()</span>
}
</div></code></pre>
<h3 id="problem-5-smart-notification-system">Problem 5: Smart Notification System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create an intelligent notification system using:</span>
<span class="hljs-comment">// - Notification API for alerts</span>
<span class="hljs-comment">// - Service Worker for background notifications</span>
<span class="hljs-comment">// - Geolocation for location-based alerts</span>
<span class="hljs-comment">// - Intersection Observer for engagement tracking</span>
<span class="hljs-comment">// - Local Storage for user preferences</span>
<span class="hljs-comment">// - Machine learning for notification timing</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SmartNotificationSystem</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Your implementation</span>
    <span class="hljs-comment">// Should include:</span>
    <span class="hljs-comment">// - Adaptive notification timing</span>
    <span class="hljs-comment">// - Location-based triggers</span>
    <span class="hljs-comment">// - User engagement analysis</span>
    <span class="hljs-comment">// - Notification grouping</span>
    <span class="hljs-comment">// - Do not disturb modes</span>
    <span class="hljs-comment">// - A/B testing for effectiveness</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// analyzeUserBehavior()</span>
  <span class="hljs-comment">// predictOptimalTime(notification)</span>
  <span class="hljs-comment">// scheduleNotification(notification, timing)</span>
  <span class="hljs-comment">// groupNotifications(notifications)</span>
  <span class="hljs-comment">// trackEngagement(notification, action)</span>
  <span class="hljs-comment">// respectDoNotDisturb()</span>
  <span class="hljs-comment">// optimizeDelivery()</span>
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between localStorage and sessionStorage?</strong></p>
<ul>
<li><strong>localStorage</strong>: Persists until manually cleared, shared across tabs</li>
<li><strong>sessionStorage</strong>: Persists only for the session, tab-specific</li>
<li><strong>Both</strong>: Synchronous, 5-10MB limit, string-only storage</li>
</ul>
<p><strong>Q: How do you handle CORS in fetch requests?</strong></p>
<ul>
<li>CORS is handled by the server, not the client</li>
<li>Use <code>mode: 'cors'</code> for cross-origin requests</li>
<li>Server must send appropriate CORS headers</li>
<li>For credentials: <code>credentials: 'include'</code> and server allows</li>
</ul>
<p><strong>Q: When would you use Web Workers?</strong></p>
<ul>
<li>Heavy computations that block the main thread</li>
<li>Image/video processing</li>
<li>Data parsing and transformation</li>
<li>Background data synchronization</li>
<li>Cryptographic operations</li>
</ul>
<p><strong>Q: What's the difference between Service Workers and Web Workers?</strong></p>
<ul>
<li><strong>Service Workers</strong>: Network proxy, caching, push notifications, background sync</li>
<li><strong>Web Workers</strong>: Parallel processing, doesn't intercept network requests</li>
<li><strong>Service Workers</strong>: Persist between sessions, control multiple pages</li>
<li><strong>Web Workers</strong>: Tied to the page that created them</li>
</ul>
<p><strong>Q: How do you implement offline functionality?</strong></p>
<ul>
<li>Service Worker for caching strategies</li>
<li>IndexedDB for offline data storage</li>
<li>Background sync for data synchronization</li>
<li>Cache API for resource caching</li>
<li>Network detection for online/offline states</li>
</ul>
<p><strong>Q: What are the different caching strategies?</strong></p>
<ul>
<li><strong>Cache First</strong>: Check cache, fallback to network</li>
<li><strong>Network First</strong>: Try network, fallback to cache</li>
<li><strong>Cache Only</strong>: Only serve from cache</li>
<li><strong>Network Only</strong>: Only fetch from network</li>
<li><strong>Stale While Revalidate</strong>: Serve from cache, update in background</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Implement a PWA with offline functionality and push notifications&quot;</li>
<li><strong>Facebook</strong>: &quot;Create a real-time collaborative editor using various browser APIs&quot;</li>
<li><strong>Amazon</strong>: &quot;Build a file upload system with progress tracking and resumable uploads&quot;</li>
<li><strong>Microsoft</strong>: &quot;Design a notification system that respects user preferences and timing&quot;</li>
<li><strong>Netflix</strong>: &quot;Implement video streaming with offline download capabilities&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Always check API support</strong> - Use feature detection before using APIs</li>
<li><strong>Handle errors gracefully</strong> - Network requests, storage limits, permissions</li>
<li><strong>Respect user preferences</strong> - Notifications, location, storage usage</li>
<li><strong>Optimize for performance</strong> - Use Web Workers for heavy tasks</li>
<li><strong>Implement offline strategies</strong> - Service Workers, caching, local storage</li>
<li><strong>Clean up resources</strong> - Terminate workers, disconnect observers</li>
<li><strong>Progressive enhancement</strong> - Apps should work without advanced APIs</li>
<li><strong>Security considerations</strong> - Validate data, handle permissions properly</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./14-event-handling.md">← Event Handling</a><br>
<strong>Next Chapter</strong>: <a href="./16-testing-debugging.md">Testing &amp; Debugging →</a></p>
<p><strong>Practice</strong>: Build a complete PWA using multiple browser APIs and test offline functionality!</p>
<pre class="hljs"><code><div>
</div></code></pre>
<h1 id="chapter-16-testing--debugging-%F0%9F%A7%AA">Chapter 16: Testing &amp; Debugging 🧪</h1>
<h2 id="%F0%9F%93%9A-table-of-contents">📚 Table of Contents</h2>
<ul>
<li><a href="#testing-fundamentals">Testing Fundamentals</a></li>
<li><a href="#unit-testing">Unit Testing</a></li>
<li><a href="#integration-testing">Integration Testing</a></li>
<li><a href="#end-to-end-testing">End-to-End Testing</a></li>
<li><a href="#test-driven-development-tdd">Test-Driven Development (TDD)</a></li>
<li><a href="#debugging-techniques">Debugging Techniques</a></li>
<li><a href="#browser-devtools">Browser DevTools</a></li>
<li><a href="#performance-testing">Performance Testing</a></li>
<li><a href="#common-pitfalls">Common Pitfalls</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
<li><a href="#interview-notes">Interview Notes</a></li>
</ul>
<hr>
<h2 id="%F0%9F%8E%AF-testing-fundamentals">🎯 Testing Fundamentals</h2>
<h3 id="what-is-testing">What is Testing?</h3>
<p>Testing ensures your code works as expected and helps prevent bugs from reaching production.</p>
<h3 id="types-of-testing">Types of Testing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. Unit Testing - Test individual functions/components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>) </span>{
  <span class="hljs-keyword">return</span> a + b;
}

<span class="hljs-comment">// Test</span>
expect(add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)).toBe(<span class="hljs-number">5</span>);

<span class="hljs-comment">// 2. Integration Testing - Test component interactions</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Calculator</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.result = <span class="hljs-number">0</span>;
  }

  add(num) {
    <span class="hljs-keyword">this</span>.result += num;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }

  getResult() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.result;
  }
}

<span class="hljs-comment">// Integration test</span>
<span class="hljs-keyword">const</span> calc = <span class="hljs-keyword">new</span> Calculator();
expect(calc.add(<span class="hljs-number">5</span>).add(<span class="hljs-number">3</span>).getResult()).toBe(<span class="hljs-number">8</span>);

<span class="hljs-comment">// 3. End-to-End Testing - Test complete user workflows</span>
<span class="hljs-comment">// (Usually done with tools like Cypress, Playwright)</span>
</div></code></pre>
<h3 id="testing-pyramid">Testing Pyramid</h3>
<pre class="hljs"><code><div>    /\     E2E Tests (Few, Slow, Expensive)
   /  \
  /____\   Integration Tests (Some, Medium)
 /______\  Unit Tests (Many, Fast, Cheap)
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%AC-unit-testing">🔬 Unit Testing</h2>
<h3 id="basic-test-structure">Basic Test Structure</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Using Jest syntax (most popular)</span>
describe(<span class="hljs-string">"Math utilities"</span>, () =&gt; {
  test(<span class="hljs-string">"should add two numbers correctly"</span>, () =&gt; {
    <span class="hljs-comment">// Arrange</span>
    <span class="hljs-keyword">const</span> a = <span class="hljs-number">2</span>;
    <span class="hljs-keyword">const</span> b = <span class="hljs-number">3</span>;

    <span class="hljs-comment">// Act</span>
    <span class="hljs-keyword">const</span> result = add(a, b);

    <span class="hljs-comment">// Assert</span>
    expect(result).toBe(<span class="hljs-number">5</span>);
  });

  test(<span class="hljs-string">"should handle negative numbers"</span>, () =&gt; {
    expect(add(<span class="hljs-number">-2</span>, <span class="hljs-number">3</span>)).toBe(<span class="hljs-number">1</span>);
    expect(add(<span class="hljs-number">-2</span>, <span class="hljs-number">-3</span>)).toBe(<span class="hljs-number">-5</span>);
  });
});
</div></code></pre>
<h3 id="testing-async-code">Testing Async Code</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Testing Promises</span>
test(<span class="hljs-string">"should fetch user data"</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> fetchUser(<span class="hljs-number">1</span>);
  expect(userData.name).toBe(<span class="hljs-string">"John Doe"</span>);
});

<span class="hljs-comment">// Testing with async/await</span>
test(<span class="hljs-string">"should handle API errors"</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">await</span> expect(fetchUser(<span class="hljs-number">-1</span>)).rejects.toThrow(<span class="hljs-string">"User not found"</span>);
});

<span class="hljs-comment">// Testing callbacks</span>
test(<span class="hljs-string">"should call callback with result"</span>, (done) =&gt; {
  processData(<span class="hljs-string">"input"</span>, (result) =&gt; {
    expect(result).toBe(<span class="hljs-string">"processed: input"</span>);
    done();
  });
});
</div></code></pre>
<h3 id="mocking-and-spies">Mocking and Spies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Mocking functions</span>
<span class="hljs-keyword">const</span> mockFetch = jest.fn();
global.fetch = mockFetch;

test(<span class="hljs-string">"should call API with correct parameters"</span>, <span class="hljs-keyword">async</span> () =&gt; {
  mockFetch.mockResolvedValue({
    <span class="hljs-attr">json</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">Promise</span>.resolve({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span> }),
  });

  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> getUser(<span class="hljs-number">1</span>);

  expect(mockFetch).toHaveBeenCalledWith(<span class="hljs-string">"/api/users/1"</span>);
  expect(user.name).toBe(<span class="hljs-string">"John"</span>);
});

<span class="hljs-comment">// Spying on methods</span>
test(<span class="hljs-string">"should log user creation"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> consoleSpy = jest.spyOn(<span class="hljs-built_in">console</span>, <span class="hljs-string">"log"</span>);

  createUser(<span class="hljs-string">"John"</span>);

  expect(consoleSpy).toHaveBeenCalledWith(<span class="hljs-string">"User created: John"</span>);

  consoleSpy.mockRestore();
});

<span class="hljs-comment">// Mocking modules</span>
jest.mock(<span class="hljs-string">"./userService"</span>, () =&gt; ({
  <span class="hljs-attr">getUser</span>: jest.fn(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">Promise</span>.resolve({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Mock User"</span> })),
}));
</div></code></pre>
<h3 id="testing-classes">Testing Classes</h3>
<pre class="hljs"><code><div><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserManager</span> </span>{
  <span class="hljs-keyword">constructor</span>(apiService) {
    <span class="hljs-keyword">this</span>.apiService = apiService;
    <span class="hljs-keyword">this</span>.users = [];
  }

  <span class="hljs-keyword">async</span> addUser(userData) {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.apiService.createUser(userData);
    <span class="hljs-keyword">this</span>.users.push(user);
    <span class="hljs-keyword">return</span> user;
  }

  getUserCount() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.users.length;
  }
}

describe(<span class="hljs-string">"UserManager"</span>, () =&gt; {
  <span class="hljs-keyword">let</span> userManager;
  <span class="hljs-keyword">let</span> mockApiService;

  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    mockApiService = {
      <span class="hljs-attr">createUser</span>: jest.fn(),
    };
    userManager = <span class="hljs-keyword">new</span> UserManager(mockApiService);
  });

  test(<span class="hljs-string">"should add user and update count"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> userData = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> };
    <span class="hljs-keyword">const</span> createdUser = { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, ...userData };

    mockApiService.createUser.mockResolvedValue(createdUser);

    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> userManager.addUser(userData);

    expect(result).toEqual(createdUser);
    expect(userManager.getUserCount()).toBe(<span class="hljs-number">1</span>);
    expect(mockApiService.createUser).toHaveBeenCalledWith(userData);
  });
});
</div></code></pre>
<h3 id="testing-dom-manipulation">Testing DOM Manipulation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Using jsdom (automatically set up in Jest)</span>
test(<span class="hljs-string">"should create button element"</span>, () =&gt; {
  <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;div id="container"&gt;&lt;/div&gt;'</span>;

  <span class="hljs-keyword">const</span> button = createButton(<span class="hljs-string">"Click me"</span>, () =&gt; <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"clicked"</span>));
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"container"</span>).appendChild(button);

  expect(button.tagName).toBe(<span class="hljs-string">"BUTTON"</span>);
  expect(button.textContent).toBe(<span class="hljs-string">"Click me"</span>);
  expect(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">"button"</span>)).toBeTruthy();
});

<span class="hljs-comment">// Testing event handlers</span>
test(<span class="hljs-string">"should handle button click"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> mockHandler = jest.fn();
  <span class="hljs-keyword">const</span> button = createButton(<span class="hljs-string">"Test"</span>, mockHandler);

  button.click();

  expect(mockHandler).toHaveBeenCalled();
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%97-integration-testing">🔗 Integration Testing</h2>
<h3 id="testing-component-interactions">Testing Component Interactions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Testing multiple components working together</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TodoApp</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.todos = [];
    <span class="hljs-keyword">this</span>.storage = <span class="hljs-keyword">new</span> LocalStorage();
    <span class="hljs-keyword">this</span>.ui = <span class="hljs-keyword">new</span> TodoUI();
  }

  addTodo(text) {
    <span class="hljs-keyword">const</span> todo = { <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(), text, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> };
    <span class="hljs-keyword">this</span>.todos.push(todo);
    <span class="hljs-keyword">this</span>.storage.save(<span class="hljs-string">"todos"</span>, <span class="hljs-keyword">this</span>.todos);
    <span class="hljs-keyword">this</span>.ui.render(<span class="hljs-keyword">this</span>.todos);
    <span class="hljs-keyword">return</span> todo;
  }
}

describe(<span class="hljs-string">"TodoApp Integration"</span>, () =&gt; {
  <span class="hljs-keyword">let</span> app;

  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Set up DOM</span>
    <span class="hljs-built_in">document</span>.body.innerHTML = <span class="hljs-string">'&lt;div id="todo-container"&gt;&lt;/div&gt;'</span>;
    localStorage.clear();
    app = <span class="hljs-keyword">new</span> TodoApp();
  });

  test(<span class="hljs-string">"should add todo and persist to storage"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> todo = app.addTodo(<span class="hljs-string">"Learn testing"</span>);

    <span class="hljs-comment">// Check todo was added</span>
    expect(app.todos).toContain(todo);

    <span class="hljs-comment">// Check storage was updated</span>
    <span class="hljs-keyword">const</span> stored = <span class="hljs-built_in">JSON</span>.parse(localStorage.getItem(<span class="hljs-string">"todos"</span>));
    expect(stored).toContain(todo);

    <span class="hljs-comment">// Check UI was updated</span>
    expect(<span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">".todo-item"</span>)).toBeTruthy();
  });
});
</div></code></pre>
<h3 id="api-integration-testing">API Integration Testing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Testing with real API calls (use sparingly)</span>
describe(<span class="hljs-string">"User API Integration"</span>, () =&gt; {
  test(<span class="hljs-string">"should create and retrieve user"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-comment">// Create user</span>
    <span class="hljs-keyword">const</span> userData = {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Test User"</span>,
      <span class="hljs-attr">email</span>: <span class="hljs-string">`test<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>@example.com`</span>,
    };

    <span class="hljs-keyword">const</span> createdUser = <span class="hljs-keyword">await</span> userAPI.create(userData);
    expect(createdUser.id).toBeDefined();
    expect(createdUser.name).toBe(userData.name);

    <span class="hljs-comment">// Retrieve user</span>
    <span class="hljs-keyword">const</span> retrievedUser = <span class="hljs-keyword">await</span> userAPI.get(createdUser.id);
    expect(retrievedUser).toEqual(createdUser);

    <span class="hljs-comment">// Cleanup</span>
    <span class="hljs-keyword">await</span> userAPI.delete(createdUser.id);
  });
});

<span class="hljs-comment">// Better: Mock the API layer</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserService</span> </span>{
  <span class="hljs-keyword">constructor</span>(apiClient) {
    <span class="hljs-keyword">this</span>.apiClient = apiClient;
  }

  <span class="hljs-keyword">async</span> createUser(userData) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.apiClient.post(<span class="hljs-string">"/users"</span>, userData);
    <span class="hljs-keyword">return</span> response.data;
  }
}

test(<span class="hljs-string">"UserService integration with API client"</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> mockApiClient = {
    <span class="hljs-attr">post</span>: jest.fn().mockResolvedValue({
      <span class="hljs-attr">data</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> },
    }),
  };

  <span class="hljs-keyword">const</span> userService = <span class="hljs-keyword">new</span> UserService(mockApiClient);
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> userService.createUser({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span> });

  expect(mockApiClient.post).toHaveBeenCalledWith(<span class="hljs-string">"/users"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span> });
  expect(result.id).toBe(<span class="hljs-number">1</span>);
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%8E%AD-end-to-end-testing">🎭 End-to-End Testing</h2>
<h3 id="cypress-example">Cypress Example</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// cypress/integration/todo-app.spec.js</span>
describe(<span class="hljs-string">"Todo App E2E"</span>, () =&gt; {
  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    cy.visit(<span class="hljs-string">"/todo-app"</span>);
  });

  it(<span class="hljs-string">"should add and complete a todo"</span>, () =&gt; {
    <span class="hljs-comment">// Add todo</span>
    cy.get(<span class="hljs-string">'[data-testid="todo-input"]'</span>).type(<span class="hljs-string">"Learn Cypress{enter}"</span>);

    <span class="hljs-comment">// Verify todo appears</span>
    cy.get(<span class="hljs-string">'[data-testid="todo-item"]'</span>)
      .should(<span class="hljs-string">"contain"</span>, <span class="hljs-string">"Learn Cypress"</span>)
      .should(<span class="hljs-string">"not.have.class"</span>, <span class="hljs-string">"completed"</span>);

    <span class="hljs-comment">// Complete todo</span>
    cy.get(<span class="hljs-string">'[data-testid="todo-checkbox"]'</span>).click();

    <span class="hljs-comment">// Verify completion</span>
    cy.get(<span class="hljs-string">'[data-testid="todo-item"]'</span>).should(<span class="hljs-string">"have.class"</span>, <span class="hljs-string">"completed"</span>);
  });

  it(<span class="hljs-string">"should persist todos after page reload"</span>, () =&gt; {
    cy.get(<span class="hljs-string">'[data-testid="todo-input"]'</span>).type(<span class="hljs-string">"Persistent todo{enter}"</span>);

    cy.reload();

    cy.get(<span class="hljs-string">'[data-testid="todo-item"]'</span>).should(<span class="hljs-string">"contain"</span>, <span class="hljs-string">"Persistent todo"</span>);
  });
});
</div></code></pre>
<h3 id="playwright-example">Playwright Example</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// tests/todo-app.spec.js</span>
<span class="hljs-keyword">const</span> { test, expect } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"@playwright/test"</span>);

test.describe(<span class="hljs-string">"Todo App"</span>, () =&gt; {
  test(<span class="hljs-string">"should handle user workflow"</span>, <span class="hljs-keyword">async</span> ({ page }) =&gt; {
    <span class="hljs-keyword">await</span> page.goto(<span class="hljs-string">"/todo-app"</span>);

    <span class="hljs-comment">// Add multiple todos</span>
    <span class="hljs-keyword">await</span> page.fill(<span class="hljs-string">'[data-testid="todo-input"]'</span>, <span class="hljs-string">"First todo"</span>);
    <span class="hljs-keyword">await</span> page.press(<span class="hljs-string">'[data-testid="todo-input"]'</span>, <span class="hljs-string">"Enter"</span>);

    <span class="hljs-keyword">await</span> page.fill(<span class="hljs-string">'[data-testid="todo-input"]'</span>, <span class="hljs-string">"Second todo"</span>);
    <span class="hljs-keyword">await</span> page.press(<span class="hljs-string">'[data-testid="todo-input"]'</span>, <span class="hljs-string">"Enter"</span>);

    <span class="hljs-comment">// Check todos are visible</span>
    <span class="hljs-keyword">await</span> expect(page.locator(<span class="hljs-string">'[data-testid="todo-item"]'</span>)).toHaveCount(<span class="hljs-number">2</span>);

    <span class="hljs-comment">// Complete first todo</span>
    <span class="hljs-keyword">await</span> page.click(<span class="hljs-string">'[data-testid="todo-checkbox"]:first-child'</span>);

    <span class="hljs-comment">// Filter completed todos</span>
    <span class="hljs-keyword">await</span> page.click(<span class="hljs-string">'[data-testid="filter-completed"]'</span>);
    <span class="hljs-keyword">await</span> expect(page.locator(<span class="hljs-string">'[data-testid="todo-item"]'</span>)).toHaveCount(<span class="hljs-number">1</span>);
  });
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%84-test-driven-development-tdd">🔄 Test-Driven Development (TDD)</h2>
<h3 id="tdd-cycle-red-green-refactor">TDD Cycle: Red-Green-Refactor</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. RED: Write a failing test</span>
test(<span class="hljs-string">"should calculate area of rectangle"</span>, () =&gt; {
  expect(calculateArea(<span class="hljs-number">5</span>, <span class="hljs-number">3</span>)).toBe(<span class="hljs-number">15</span>);
});

<span class="hljs-comment">// 2. GREEN: Write minimal code to pass</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateArea</span>(<span class="hljs-params">width, height</span>) </span>{
  <span class="hljs-keyword">return</span> width * height;
}

<span class="hljs-comment">// 3. REFACTOR: Improve the code</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateArea</span>(<span class="hljs-params">width, height</span>) </span>{
  <span class="hljs-keyword">if</span> (width &lt;= <span class="hljs-number">0</span> || height &lt;= <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Dimensions must be positive"</span>);
  }
  <span class="hljs-keyword">return</span> width * height;
}

<span class="hljs-comment">// Add more tests</span>
test(<span class="hljs-string">"should throw error for negative dimensions"</span>, () =&gt; {
  expect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> calculateArea(<span class="hljs-number">-5</span>, <span class="hljs-number">3</span>)).toThrow(<span class="hljs-string">"Dimensions must be positive"</span>);
  expect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> calculateArea(<span class="hljs-number">5</span>, <span class="hljs-number">-3</span>)).toThrow(<span class="hljs-string">"Dimensions must be positive"</span>);
});
</div></code></pre>
<h3 id="tdd-example-building-a-shopping-cart">TDD Example: Building a Shopping Cart</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Step 1: Write tests first</span>
describe(<span class="hljs-string">"ShoppingCart"</span>, () =&gt; {
  <span class="hljs-keyword">let</span> cart;

  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    cart = <span class="hljs-keyword">new</span> ShoppingCart();
  });

  test(<span class="hljs-string">"should start empty"</span>, () =&gt; {
    expect(cart.getItems()).toEqual([]);
    expect(cart.getTotal()).toBe(<span class="hljs-number">0</span>);
  });

  test(<span class="hljs-string">"should add items"</span>, () =&gt; {
    cart.addItem({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Apple"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">1.5</span> });
    expect(cart.getItems()).toHaveLength(<span class="hljs-number">1</span>);
    expect(cart.getTotal()).toBe(<span class="hljs-number">1.5</span>);
  });

  test(<span class="hljs-string">"should handle quantity"</span>, () =&gt; {
    cart.addItem({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Apple"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">1.5</span> }, <span class="hljs-number">3</span>);
    expect(cart.getTotal()).toBe(<span class="hljs-number">4.5</span>);
  });
});

<span class="hljs-comment">// Step 2: Implement to pass tests</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShoppingCart</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.items = [];
  }

  getItems() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.items;
  }

  addItem(item, quantity = <span class="hljs-number">1</span>) {
    <span class="hljs-keyword">this</span>.items.push({ ...item, quantity });
  }

  getTotal() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.items.reduce(<span class="hljs-function">(<span class="hljs-params">total, item</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> total + item.price * item.quantity;
    }, <span class="hljs-number">0</span>);
  }
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%90%9B-debugging-techniques">🐛 Debugging Techniques</h2>
<h3 id="console-debugging">Console Debugging</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Basic logging</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Variable value:"</span>, myVariable);
<span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error occurred:"</span>, error);
<span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Warning:"</span>, warning);

<span class="hljs-comment">// Advanced console methods</span>
<span class="hljs-built_in">console</span>.table(arrayOfObjects); <span class="hljs-comment">// Display as table</span>
<span class="hljs-built_in">console</span>.group(<span class="hljs-string">"User Operations"</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Creating user..."</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Validating data..."</span>);
<span class="hljs-built_in">console</span>.groupEnd();

<span class="hljs-comment">// Conditional logging</span>
<span class="hljs-built_in">console</span>.assert(user.age &gt;= <span class="hljs-number">18</span>, <span class="hljs-string">"User must be 18 or older"</span>);

<span class="hljs-comment">// Performance timing</span>
<span class="hljs-built_in">console</span>.time(<span class="hljs-string">"API Call"</span>);
<span class="hljs-keyword">await</span> fetchUserData();
<span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"API Call"</span>);

<span class="hljs-comment">// Stack trace</span>
<span class="hljs-built_in">console</span>.trace(<span class="hljs-string">"Execution path"</span>);
</div></code></pre>
<h3 id="debugger-statement">Debugger Statement</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUserData</span>(<span class="hljs-params">userData</span>) </span>{
  <span class="hljs-comment">// Execution will pause here when DevTools is open</span>
  <span class="hljs-keyword">debugger</span>;

  <span class="hljs-keyword">const</span> processed = userData.map(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-keyword">debugger</span>; <span class="hljs-comment">// Pause for each iteration</span>
    <span class="hljs-keyword">return</span> {
      ...user,
      <span class="hljs-attr">fullName</span>: <span class="hljs-string">`<span class="hljs-subst">${user.firstName}</span> <span class="hljs-subst">${user.lastName}</span>`</span>,
    };
  });

  <span class="hljs-keyword">return</span> processed;
}
</div></code></pre>
<h3 id="error-handling-for-debugging">Error Handling for Debugging</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Custom error with context</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidationError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>{
  <span class="hljs-keyword">constructor</span>(message, field, value) {
    <span class="hljs-keyword">super</span>(message);
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">"ValidationError"</span>;
    <span class="hljs-keyword">this</span>.field = field;
    <span class="hljs-keyword">this</span>.value = value;
    <span class="hljs-keyword">this</span>.timestamp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString();
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateUser</span>(<span class="hljs-params">user</span>) </span>{
  <span class="hljs-keyword">if</span> (!user.email) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ValidationError(<span class="hljs-string">"Email is required"</span>, <span class="hljs-string">"email"</span>, user.email);
  }
}

<span class="hljs-comment">// Global error handler</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"error"</span>, (event) =&gt; {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Global error:"</span>, {
    <span class="hljs-attr">message</span>: event.message,
    <span class="hljs-attr">filename</span>: event.filename,
    <span class="hljs-attr">lineno</span>: event.lineno,
    <span class="hljs-attr">colno</span>: event.colno,
    <span class="hljs-attr">error</span>: event.error,
  });
});

<span class="hljs-comment">// Unhandled promise rejection handler</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unhandledrejection"</span>, (event) =&gt; {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Unhandled promise rejection:"</span>, event.reason);
  event.preventDefault(); <span class="hljs-comment">// Prevent default browser behavior</span>
});
</div></code></pre>
<h3 id="debugging-async-code">Debugging Async Code</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Debug async/await</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserData</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Fetching user:"</span>, userId);

    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Response status:"</span>, response.status);

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>`</span>);
    }

    <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User data received:"</span>, userData);

    <span class="hljs-keyword">return</span> userData;
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error fetching user:"</span>, error);
    <span class="hljs-keyword">throw</span> error;
  }
}

<span class="hljs-comment">// Debug promises</span>
fetchUserData(<span class="hljs-number">123</span>)
  .then(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Success:"</span>, user);
    <span class="hljs-keyword">return</span> user;
  })
  .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed:"</span>, error);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  });
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%A7-browser-devtools">🔧 Browser DevTools</h2>
<h3 id="sources-panel-debugging">Sources Panel Debugging</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Set breakpoints programmatically</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complexCalculation</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-comment">// Set conditional breakpoint: i === 5</span>
    result += data[i] * <span class="hljs-number">2</span>;

    <span class="hljs-keyword">if</span> (result &gt; <span class="hljs-number">100</span>) {
      <span class="hljs-comment">// Logpoint: console.log('Result exceeded 100:', result)</span>
      <span class="hljs-keyword">break</span>;
    }
  }

  <span class="hljs-keyword">return</span> result;
}
</div></code></pre>
<h3 id="network-panel-debugging">Network Panel Debugging</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Monitor network requests</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">APIClient</span> </span>{
  <span class="hljs-keyword">async</span> request(url, options = {}) {
    <span class="hljs-keyword">const</span> startTime = performance.now();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, {
        ...options,
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
          ...options.headers,
        },
      });

      <span class="hljs-keyword">const</span> endTime = performance.now();
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Request to <span class="hljs-subst">${url}</span> took <span class="hljs-subst">${endTime - startTime}</span>ms`</span>);

      <span class="hljs-keyword">return</span> response;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Request to <span class="hljs-subst">${url}</span> failed:`</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }
}
</div></code></pre>
<h3 id="performance-panel-debugging">Performance Panel Debugging</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Mark performance events</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expensiveOperation</span>(<span class="hljs-params"></span>) </span>{
  performance.mark(<span class="hljs-string">"expensive-start"</span>);

  <span class="hljs-comment">// Simulate heavy computation</span>
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
    result += <span class="hljs-built_in">Math</span>.random();
  }

  performance.mark(<span class="hljs-string">"expensive-end"</span>);
  performance.measure(
    <span class="hljs-string">"expensive-operation"</span>,
    <span class="hljs-string">"expensive-start"</span>,
    <span class="hljs-string">"expensive-end"</span>
  );

  <span class="hljs-comment">// Get measurements</span>
  <span class="hljs-keyword">const</span> measures = performance.getEntriesByType(<span class="hljs-string">"measure"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Performance measures:"</span>, measures);

  <span class="hljs-keyword">return</span> result;
}
</div></code></pre>
<h3 id="memory-debugging">Memory Debugging</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Detect memory leaks</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryTracker</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.objects = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();
  }

  track(obj) {
    <span class="hljs-keyword">this</span>.objects.add(obj);
    <span class="hljs-keyword">return</span> obj;
  }

  untrack(obj) {
    <span class="hljs-keyword">this</span>.objects.delete(obj);
  }

  getTrackedCount() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.objects.size;
  }

  logMemoryUsage() {
    <span class="hljs-keyword">if</span> (performance.memory) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Memory usage:"</span>, {
        <span class="hljs-attr">used</span>: performance.memory.usedJSHeapSize,
        <span class="hljs-attr">total</span>: performance.memory.totalJSHeapSize,
        <span class="hljs-attr">limit</span>: performance.memory.jsHeapSizeLimit,
        <span class="hljs-attr">tracked</span>: <span class="hljs-keyword">this</span>.getTrackedCount(),
      });
    }
  }
}

<span class="hljs-keyword">const</span> memoryTracker = <span class="hljs-keyword">new</span> MemoryTracker();

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> user = memoryTracker.track(<span class="hljs-keyword">new</span> User());
<span class="hljs-comment">// ... use user</span>
memoryTracker.untrack(user);
</div></code></pre>
<hr>
<h2 id="%E2%9A%A1-performance-testing">⚡ Performance Testing</h2>
<h3 id="benchmarking">Benchmarking</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Simple benchmark</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">benchmark</span>(<span class="hljs-params">fn, iterations = <span class="hljs-number">1000</span></span>) </span>{
  <span class="hljs-keyword">const</span> start = performance.now();

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; iterations; i++) {
    fn();
  }

  <span class="hljs-keyword">const</span> end = performance.now();
  <span class="hljs-keyword">return</span> end - start;
}

<span class="hljs-comment">// Compare implementations</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">compareImplementations</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, (_, i) =&gt; i);

  <span class="hljs-keyword">const</span> forLoopTime = benchmark(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> sum = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
      sum += data[i];
    }
    <span class="hljs-keyword">return</span> sum;
  });

  <span class="hljs-keyword">const</span> reduceTime = benchmark(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> data.reduce(<span class="hljs-function">(<span class="hljs-params">sum, num</span>) =&gt;</span> sum + num, <span class="hljs-number">0</span>);
  });

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"For loop:"</span>, forLoopTime + <span class="hljs-string">"ms"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Reduce:"</span>, reduceTime + <span class="hljs-string">"ms"</span>);
}
</div></code></pre>
<h3 id="load-testing">Load Testing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Simulate concurrent users</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadTest</span>(<span class="hljs-params">url, concurrentUsers = <span class="hljs-number">10</span>, requestsPerUser = <span class="hljs-number">100</span></span>) </span>{
  <span class="hljs-keyword">const</span> results = [];

  <span class="hljs-keyword">const</span> userPromises = <span class="hljs-built_in">Array</span>.from(
    { <span class="hljs-attr">length</span>: concurrentUsers },
    <span class="hljs-keyword">async</span> (_, userId) =&gt; {
      <span class="hljs-keyword">const</span> userResults = [];

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; requestsPerUser; i++) {
        <span class="hljs-keyword">const</span> start = performance.now();

        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url);
          <span class="hljs-keyword">const</span> end = performance.now();

          userResults.push({
            userId,
            <span class="hljs-attr">requestId</span>: i,
            <span class="hljs-attr">status</span>: response.status,
            <span class="hljs-attr">duration</span>: end - start,
            <span class="hljs-attr">success</span>: response.ok,
          });
        } <span class="hljs-keyword">catch</span> (error) {
          userResults.push({
            userId,
            <span class="hljs-attr">requestId</span>: i,
            <span class="hljs-attr">error</span>: error.message,
            <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
          });
        }
      }

      <span class="hljs-keyword">return</span> userResults;
    }
  );

  <span class="hljs-keyword">const</span> allResults = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(userPromises);
  <span class="hljs-keyword">const</span> flatResults = allResults.flat();

  <span class="hljs-comment">// Analyze results</span>
  <span class="hljs-keyword">const</span> successRate =
    flatResults.filter(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.success).length / flatResults.length;
  <span class="hljs-keyword">const</span> avgDuration =
    flatResults
      .filter(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.duration)
      .reduce(<span class="hljs-function">(<span class="hljs-params">sum, r</span>) =&gt;</span> sum + r.duration, <span class="hljs-number">0</span>) / flatResults.length;

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Load test results:"</span>, {
    <span class="hljs-attr">totalRequests</span>: flatResults.length,
    <span class="hljs-attr">successRate</span>: (successRate * <span class="hljs-number">100</span>).toFixed(<span class="hljs-number">2</span>) + <span class="hljs-string">"%"</span>,
    <span class="hljs-attr">averageDuration</span>: avgDuration.toFixed(<span class="hljs-number">2</span>) + <span class="hljs-string">"ms"</span>,
  });

  <span class="hljs-keyword">return</span> flatResults;
}
</div></code></pre>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-testing-implementation-details">1. Testing Implementation Details</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Testing internal implementation</span>
test(<span class="hljs-string">"should call internal method"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> spy = jest.spyOn(calculator, <span class="hljs-string">"_internalCalculation"</span>);
  calculator.add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>);
  expect(spy).toHaveBeenCalled();
});

<span class="hljs-comment">// ✅ Test behavior, not implementation</span>
test(<span class="hljs-string">"should add numbers correctly"</span>, () =&gt; {
  expect(calculator.add(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>)).toBe(<span class="hljs-number">5</span>);
});
</div></code></pre>
<h3 id="2-flaky-tests">2. Flaky Tests</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Time-dependent test</span>
test(<span class="hljs-string">"should process within 100ms"</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> start = <span class="hljs-built_in">Date</span>.now();
  <span class="hljs-keyword">await</span> processData();
  <span class="hljs-keyword">const</span> duration = <span class="hljs-built_in">Date</span>.now() - start;
  expect(duration).toBeLessThan(<span class="hljs-number">100</span>); <span class="hljs-comment">// Flaky!</span>
});

<span class="hljs-comment">// ✅ Mock time or use proper async testing</span>
test(<span class="hljs-string">"should process data correctly"</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> processData();
  expect(result).toEqual(expectedResult);
});
</div></code></pre>
<h3 id="3-not-cleaning-up">3. Not Cleaning Up</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Not cleaning up after tests</span>
test(<span class="hljs-string">"should handle user login"</span>, () =&gt; {
  localStorage.setItem(<span class="hljs-string">"user"</span>, <span class="hljs-built_in">JSON</span>.stringify(user));
  <span class="hljs-comment">// Test logic...</span>
  <span class="hljs-comment">// localStorage still contains data!</span>
});

<span class="hljs-comment">// ✅ Clean up properly</span>
test(<span class="hljs-string">"should handle user login"</span>, () =&gt; {
  localStorage.setItem(<span class="hljs-string">"user"</span>, <span class="hljs-built_in">JSON</span>.stringify(user));
  <span class="hljs-comment">// Test logic...</span>

  <span class="hljs-comment">// Cleanup</span>
  localStorage.clear();
});

<span class="hljs-comment">// Better: Use beforeEach/afterEach</span>
afterEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  localStorage.clear();
  jest.clearAllMocks();
});
</div></code></pre>
<h3 id="4-over-mocking">4. Over-mocking</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Mocking everything</span>
test(<span class="hljs-string">"should process user data"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> mockUser = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span> };
  <span class="hljs-keyword">const</span> mockProcessor = jest.fn().mockReturnValue(<span class="hljs-string">"processed"</span>);
  <span class="hljs-keyword">const</span> mockValidator = jest.fn().mockReturnValue(<span class="hljs-literal">true</span>);

  <span class="hljs-comment">// Test becomes meaningless</span>
});

<span class="hljs-comment">// ✅ Mock only external dependencies</span>
test(<span class="hljs-string">"should process user data"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> mockApiCall = jest.fn().mockResolvedValue(userData);
  <span class="hljs-comment">// Test actual processing logic</span>
});
</div></code></pre>
<h3 id="5-debugging-in-production">5. Debugging in Production</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Leaving debug code in production</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processPayment</span>(<span class="hljs-params">amount</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Processing payment:"</span>, amount); <span class="hljs-comment">// Remove this!</span>
  <span class="hljs-keyword">debugger</span>; <span class="hljs-comment">// Remove this!</span>

  <span class="hljs-comment">// Payment logic</span>
}

<span class="hljs-comment">// ✅ Use environment-aware logging</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processPayment</span>(<span class="hljs-params">amount</span>) </span>{
  <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"development"</span>) {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Processing payment:"</span>, amount);
  }

  <span class="hljs-comment">// Payment logic</span>
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-test-a-user-registration-system">Problem 1: Test a User Registration System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement and test a user registration system</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserRegistration</span> </span>{
  <span class="hljs-keyword">constructor</span>(userService, emailService) {
    <span class="hljs-keyword">this</span>.userService = userService;
    <span class="hljs-keyword">this</span>.emailService = emailService;
  }

  <span class="hljs-keyword">async</span> register(userData) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Should:</span>
    <span class="hljs-comment">// - Validate user data</span>
    <span class="hljs-comment">// - Check if user already exists</span>
    <span class="hljs-comment">// - Create user account</span>
    <span class="hljs-comment">// - Send welcome email</span>
    <span class="hljs-comment">// - Return user object</span>
  }
}

<span class="hljs-comment">// Write comprehensive tests for:</span>
<span class="hljs-comment">// - Valid registration</span>
<span class="hljs-comment">// - Invalid data handling</span>
<span class="hljs-comment">// - Duplicate user handling</span>
<span class="hljs-comment">// - Email service failures</span>
<span class="hljs-comment">// - Database errors</span>
</div></code></pre>
<h3 id="problem-2-debug-a-shopping-cart-bug">Problem 2: Debug a Shopping Cart Bug</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// This shopping cart has bugs - find and fix them</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ShoppingCart</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.items = [];
  }

  addItem(product, quantity) {
    <span class="hljs-keyword">const</span> existingItem = <span class="hljs-keyword">this</span>.items.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === product.id);

    <span class="hljs-keyword">if</span> (existingItem) {
      existingItem.quantity += quantity;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.items.push({ ...product, quantity });
    }
  }

  removeItem(productId) {
    <span class="hljs-keyword">this</span>.items = <span class="hljs-keyword">this</span>.items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== productId);
  }

  getTotal() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.items.reduce(<span class="hljs-function">(<span class="hljs-params">total, item</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> total + item.price * item.quantity;
    }, <span class="hljs-number">0</span>);
  }

  applyDiscount(percentage) {
    <span class="hljs-keyword">this</span>.items.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      item.price = item.price * (<span class="hljs-number">1</span> - percentage / <span class="hljs-number">100</span>);
    });
  }
}

<span class="hljs-comment">// Issues to find:</span>
<span class="hljs-comment">// 1. What happens with negative quantities?</span>
<span class="hljs-comment">// 2. What if product price is not a number?</span>
<span class="hljs-comment">// 3. What if discount is applied multiple times?</span>
<span class="hljs-comment">// 4. What about floating point precision?</span>
<span class="hljs-comment">// 5. What if items array is modified during iteration?</span>
</div></code></pre>
<h3 id="problem-3-performance-test-a-data-processing-function">Problem 3: Performance Test a Data Processing Function</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Test and optimize this data processing function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processLargeDataset</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-keyword">const</span> result = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-keyword">const</span> item = data[i];

    <span class="hljs-keyword">if</span> (item.active &amp;&amp; item.score &gt; <span class="hljs-number">50</span>) {
      <span class="hljs-keyword">const</span> processed = {
        <span class="hljs-attr">id</span>: item.id,
        <span class="hljs-attr">name</span>: item.name.toUpperCase(),
        <span class="hljs-attr">category</span>: item.category,
        <span class="hljs-attr">normalizedScore</span>: item.score / <span class="hljs-number">100</span>,
        <span class="hljs-attr">tags</span>: item.tags.filter(<span class="hljs-function">(<span class="hljs-params">tag</span>) =&gt;</span> tag.length &gt; <span class="hljs-number">3</span>),
      };

      result.push(processed);
    }
  }

  <span class="hljs-keyword">return</span> result.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.normalizedScore - a.normalizedScore);
}

<span class="hljs-comment">// Tasks:</span>
<span class="hljs-comment">// 1. Write performance benchmarks</span>
<span class="hljs-comment">// 2. Identify bottlenecks</span>
<span class="hljs-comment">// 3. Optimize the function</span>
<span class="hljs-comment">// 4. Compare before/after performance</span>
<span class="hljs-comment">// 5. Test with different data sizes</span>
</div></code></pre>
<h3 id="problem-4-e2e-test-a-todo-application">Problem 4: E2E Test a Todo Application</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Write comprehensive E2E tests for a todo app</span>
<span class="hljs-comment">// Features to test:</span>
<span class="hljs-comment">// - Add new todos</span>
<span class="hljs-comment">// - Mark todos as complete</span>
<span class="hljs-comment">// - Edit existing todos</span>
<span class="hljs-comment">// - Delete todos</span>
<span class="hljs-comment">// - Filter todos (all, active, completed)</span>
<span class="hljs-comment">// - Clear completed todos</span>
<span class="hljs-comment">// - Persist data across page reloads</span>
<span class="hljs-comment">// - Handle empty states</span>
<span class="hljs-comment">// - Validate input constraints</span>

<span class="hljs-comment">// Use Cypress or Playwright to implement:</span>
describe(<span class="hljs-string">"Todo Application E2E"</span>, () =&gt; {
  <span class="hljs-comment">// Your test implementations here</span>
});
</div></code></pre>
<h3 id="problem-5-debug-memory-leaks">Problem 5: Debug Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// This code has memory leaks - find and fix them</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.listeners = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.timers = [];
  }

  addEventListener(element, event, handler) {
    element.addEventListener(event, handler);

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.listeners.has(element)) {
      <span class="hljs-keyword">this</span>.listeners.set(element, []);
    }

    <span class="hljs-keyword">this</span>.listeners.get(element).push({ event, handler });
  }

  startPeriodicTask(callback, interval) {
    <span class="hljs-keyword">const</span> timerId = setInterval(callback, interval);
    <span class="hljs-keyword">this</span>.timers.push(timerId);
    <span class="hljs-keyword">return</span> timerId;
  }

  createDOMElements() {
    <span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000</span>; i++) {
      <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
      element.innerHTML = <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>;

      <span class="hljs-keyword">this</span>.addEventListener(element, <span class="hljs-string">"click"</span>, () =&gt; {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Clicked item <span class="hljs-subst">${i}</span>`</span>);
      });

      container.appendChild(element);
    }

    <span class="hljs-keyword">return</span> container;
  }
}

<span class="hljs-comment">// Issues to identify:</span>
<span class="hljs-comment">// 1. Event listeners not being removed</span>
<span class="hljs-comment">// 2. Timers not being cleared</span>
<span class="hljs-comment">// 3. DOM references being held</span>
<span class="hljs-comment">// 4. Closure memory retention</span>
<span class="hljs-comment">// 5. Missing cleanup methods</span>
</div></code></pre>
<hr>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What's the difference between unit, integration, and E2E tests?</strong></p>
<ul>
<li><strong>Unit</strong>: Test individual functions/components in isolation</li>
<li><strong>Integration</strong>: Test how components work together</li>
<li><strong>E2E</strong>: Test complete user workflows from start to finish</li>
<li><strong>Pyramid</strong>: Many unit tests, some integration tests, few E2E tests</li>
</ul>
<p><strong>Q: How do you test async code?</strong></p>
<ul>
<li>Use <code>async/await</code> in test functions</li>
<li>Return promises from test functions</li>
<li>Use <code>done</code> callback for callback-based code</li>
<li>Mock async dependencies appropriately</li>
</ul>
<p><strong>Q: What are mocks, stubs, and spies?</strong></p>
<ul>
<li><strong>Mock</strong>: Replace entire object/function with fake implementation</li>
<li><strong>Stub</strong>: Replace specific method with predetermined behavior</li>
<li><strong>Spy</strong>: Monitor calls to existing function without replacing it</li>
</ul>
<p><strong>Q: How do you debug JavaScript in production?</strong></p>
<ul>
<li>Use proper logging (not console.log)</li>
<li>Implement error tracking (Sentry, Bugsnag)</li>
<li>Use source maps for meaningful stack traces</li>
<li>Monitor performance metrics</li>
<li>Implement feature flags for safe rollbacks</li>
</ul>
<p><strong>Q: What's Test-Driven Development (TDD)?</strong></p>
<ul>
<li>Write failing test first (Red)</li>
<li>Write minimal code to pass (Green)</li>
<li>Refactor while keeping tests green (Refactor)</li>
<li>Benefits: Better design, fewer bugs, confidence in changes</li>
</ul>
<p><strong>Q: How do you handle flaky tests?</strong></p>
<ul>
<li>Identify root cause (timing, dependencies, environment)</li>
<li>Use proper async testing patterns</li>
<li>Mock external dependencies</li>
<li>Avoid time-dependent assertions</li>
<li>Implement proper test isolation</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;How would you test a complex React component with multiple async operations?&quot;</li>
<li><strong>Facebook</strong>: &quot;Debug this performance issue in a large dataset processing function&quot;</li>
<li><strong>Amazon</strong>: &quot;Design a testing strategy for a microservices architecture&quot;</li>
<li><strong>Microsoft</strong>: &quot;How do you ensure code quality in a large team?&quot;</li>
<li><strong>Netflix</strong>: &quot;Test a video streaming component with various network conditions&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Test behavior, not implementation</strong> - Focus on what the code does, not how</li>
<li><strong>Follow the testing pyramid</strong> - Many unit tests, fewer integration/E2E tests</li>
<li><strong>Write tests first</strong> - TDD leads to better design and fewer bugs</li>
<li><strong>Mock external dependencies</strong> - Keep tests fast and reliable</li>
<li><strong>Use proper debugging tools</strong> - Browser DevTools, debugger statements, logging</li>
<li><strong>Clean up after tests</strong> - Prevent test pollution and flaky tests</li>
<li><strong>Test edge cases</strong> - Empty inputs, error conditions, boundary values</li>
<li><strong>Monitor performance</strong> - Use benchmarks and profiling tools</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./15-browser-apis.md">← Browser APIs</a><br>
<strong>Next Chapter</strong>: <a href="./17-performance-optimization.md">Performance Optimization →</a></p>
<p><strong>Practice</strong>: Write comprehensive tests for a real project and use debugging tools to optimize performance!</p>
<h1 id="chapter-17-performance-optimization-%E2%9A%A1">Chapter 17: Performance Optimization ⚡</h1>
<h2 id="%F0%9F%93%9A-table-of-contents">📚 Table of Contents</h2>
<ul>
<li><a href="#performance-fundamentals">Performance Fundamentals</a></li>
<li><a href="#memory-management">Memory Management</a></li>
<li><a href="#code-optimization">Code Optimization</a></li>
<li><a href="#dom-performance">DOM Performance</a></li>
<li><a href="#network-optimization">Network Optimization</a></li>
<li><a href="#async-performance">Async Performance</a></li>
<li><a href="#bundle-optimization">Bundle Optimization</a></li>
<li><a href="#monitoring--profiling">Monitoring &amp; Profiling</a></li>
<li><a href="#common-pitfalls">Common Pitfalls</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
<li><a href="#interview-notes">Interview Notes</a></li>
</ul>
<hr>
<h2 id="%F0%9F%8E%AF-performance-fundamentals">🎯 Performance Fundamentals</h2>
<h3 id="understanding-performance-metrics">Understanding Performance Metrics</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Core Web Vitals</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">measureCoreWebVitals</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Largest Contentful Paint (LCP)</span>
  <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">entryList</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> entries = entryList.getEntries();
    <span class="hljs-keyword">const</span> lastEntry = entries[entries.length - <span class="hljs-number">1</span>];
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"LCP:"</span>, lastEntry.startTime);
  }).observe({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"largest-contentful-paint"</span>] });

  <span class="hljs-comment">// First Input Delay (FID)</span>
  <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">entryList</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> entries = entryList.getEntries();
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"FID:"</span>, entry.processingStart - entry.startTime);
    });
  }).observe({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"first-input"</span>] });

  <span class="hljs-comment">// Cumulative Layout Shift (CLS)</span>
  <span class="hljs-keyword">let</span> clsValue = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">entryList</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> entries = entryList.getEntries();
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!entry.hadRecentInput) {
        clsValue += entry.value;
      }
    });
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"CLS:"</span>, clsValue);
  }).observe({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"layout-shift"</span>] });
}
</div></code></pre>
<h3 id="performance-timing-api">Performance Timing API</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Measure custom performance</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceTracker</span> </span>{
  <span class="hljs-keyword">static</span> mark(name) {
    performance.mark(name);
  }

  <span class="hljs-keyword">static</span> measure(name, startMark, endMark) {
    performance.measure(name, startMark, endMark);
    <span class="hljs-keyword">const</span> measure = performance.getEntriesByName(name)[<span class="hljs-number">0</span>];
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${name}</span>: <span class="hljs-subst">${measure.duration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
    <span class="hljs-keyword">return</span> measure.duration;
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> timeFunction(fn, label) {
    <span class="hljs-keyword">const</span> start = performance.now();
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> fn();
    <span class="hljs-keyword">const</span> end = performance.now();
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${label}</span>: <span class="hljs-subst">${(end - start).toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
    <span class="hljs-keyword">return</span> result;
  }

  <span class="hljs-keyword">static</span> getNavigationTiming() {
    <span class="hljs-keyword">const</span> timing = performance.getEntriesByType(<span class="hljs-string">"navigation"</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">dns</span>: timing.domainLookupEnd - timing.domainLookupStart,
      <span class="hljs-attr">tcp</span>: timing.connectEnd - timing.connectStart,
      <span class="hljs-attr">request</span>: timing.responseStart - timing.requestStart,
      <span class="hljs-attr">response</span>: timing.responseEnd - timing.responseStart,
      <span class="hljs-attr">domParsing</span>: timing.domInteractive - timing.responseEnd,
      <span class="hljs-attr">domReady</span>:
        timing.domContentLoadedEventEnd - timing.domContentLoadedEventStart,
      <span class="hljs-attr">loadComplete</span>: timing.loadEventEnd - timing.loadEventStart,
    };
  }
}

<span class="hljs-comment">// Usage</span>
PerformanceTracker.mark(<span class="hljs-string">"data-fetch-start"</span>);
<span class="hljs-keyword">await</span> fetchData();
PerformanceTracker.mark(<span class="hljs-string">"data-fetch-end"</span>);
PerformanceTracker.measure(<span class="hljs-string">"data-fetch"</span>, <span class="hljs-string">"data-fetch-start"</span>, <span class="hljs-string">"data-fetch-end"</span>);
</div></code></pre>
<hr>
<h2 id="%F0%9F%A7%A0-memory-management">🧠 Memory Management</h2>
<h3 id="understanding-memory-leaks">Understanding Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Common memory leak patterns</span>

<span class="hljs-comment">// 1. Global variables</span>
<span class="hljs-comment">// ❌ Memory leak</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createUser</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Accidentally creates global variable</span>
  user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>) };
  <span class="hljs-keyword">return</span> user;
}

<span class="hljs-comment">// ✅ Proper scoping</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createUser</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">data</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>(<span class="hljs-number">1000000</span>) };
  <span class="hljs-keyword">return</span> user;
}

<span class="hljs-comment">// 2. Event listeners not removed</span>
<span class="hljs-comment">// ❌ Memory leak</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.handleClick = <span class="hljs-keyword">this</span>.handleClick.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.handleClick);
  }

  handleClick() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Clicked"</span>);
  }

  <span class="hljs-comment">// Missing cleanup!</span>
}

<span class="hljs-comment">// ✅ Proper cleanup</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.handleClick = <span class="hljs-keyword">this</span>.handleClick.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.handleClick);
  }

  handleClick() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Clicked"</span>);
  }

  destroy() {
    <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.handleClick);
  }
}

<span class="hljs-comment">// 3. Timers not cleared</span>
<span class="hljs-comment">// ❌ Memory leak</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Timer</span> </span>{
  start() {
    <span class="hljs-keyword">this</span>.interval = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Timer tick"</span>);
    }, <span class="hljs-number">1000</span>);
  }

  <span class="hljs-comment">// Missing cleanup!</span>
}

<span class="hljs-comment">// ✅ Proper cleanup</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Timer</span> </span>{
  start() {
    <span class="hljs-keyword">this</span>.interval = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Timer tick"</span>);
    }, <span class="hljs-number">1000</span>);
  }

  stop() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.interval) {
      clearInterval(<span class="hljs-keyword">this</span>.interval);
      <span class="hljs-keyword">this</span>.interval = <span class="hljs-literal">null</span>;
    }
  }
}
</div></code></pre>
<h3 id="memory-optimization-techniques">Memory Optimization Techniques</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Object pooling</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ObjectPool</span> </span>{
  <span class="hljs-keyword">constructor</span>(createFn, resetFn, initialSize = 10) {
    <span class="hljs-keyword">this</span>.createFn = createFn;
    <span class="hljs-keyword">this</span>.resetFn = resetFn;
    <span class="hljs-keyword">this</span>.pool = [];

    <span class="hljs-comment">// Pre-populate pool</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; initialSize; i++) {
      <span class="hljs-keyword">this</span>.pool.push(<span class="hljs-keyword">this</span>.createFn());
    }
  }

  acquire() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pool.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pool.pop();
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.createFn();
  }

  release(obj) {
    <span class="hljs-keyword">this</span>.resetFn(obj);
    <span class="hljs-keyword">this</span>.pool.push(obj);
  }

  size() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pool.length;
  }
}

<span class="hljs-comment">// Usage for expensive objects</span>
<span class="hljs-keyword">const</span> particlePool = <span class="hljs-keyword">new</span> ObjectPool(
  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">vx</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">vy</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">life</span>: <span class="hljs-number">1</span> }),
  (particle) =&gt; {
    particle.x = <span class="hljs-number">0</span>;
    particle.y = <span class="hljs-number">0</span>;
    particle.vx = <span class="hljs-number">0</span>;
    particle.vy = <span class="hljs-number">0</span>;
    particle.life = <span class="hljs-number">1</span>;
  },
  <span class="hljs-number">100</span>
);

<span class="hljs-comment">// WeakMap for private data</span>
<span class="hljs-keyword">const</span> privateData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakMap</span>();

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{
  <span class="hljs-keyword">constructor</span>(name) {
    <span class="hljs-keyword">this</span>.name = name;
    privateData.set(<span class="hljs-keyword">this</span>, {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Math</span>.random(),
      <span class="hljs-attr">secret</span>: <span class="hljs-string">"private-data"</span>,
    });
  }

  getPrivateData() {
    <span class="hljs-keyword">return</span> privateData.get(<span class="hljs-keyword">this</span>);
  }
}

<span class="hljs-comment">// When User instance is garbage collected,</span>
<span class="hljs-comment">// its private data is automatically removed from WeakMap</span>
</div></code></pre>
<h3 id="memory-monitoring">Memory Monitoring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Memory usage monitoring</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryMonitor</span> </span>{
  <span class="hljs-keyword">static</span> getMemoryUsage() {
    <span class="hljs-keyword">if</span> (performance.memory) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">used</span>: <span class="hljs-built_in">Math</span>.round(performance.memory.usedJSHeapSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>),
        <span class="hljs-attr">total</span>: <span class="hljs-built_in">Math</span>.round(performance.memory.totalJSHeapSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>),
        <span class="hljs-attr">limit</span>: <span class="hljs-built_in">Math</span>.round(performance.memory.jsHeapSizeLimit / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>),
      };
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">static</span> startMonitoring(interval = <span class="hljs-number">5000</span>) {
    <span class="hljs-keyword">return</span> setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> memory = <span class="hljs-keyword">this</span>.getMemoryUsage();
      <span class="hljs-keyword">if</span> (memory) {
        <span class="hljs-built_in">console</span>.log(
          <span class="hljs-string">`Memory: <span class="hljs-subst">${memory.used}</span>MB / <span class="hljs-subst">${memory.total}</span>MB (limit: <span class="hljs-subst">${memory.limit}</span>MB)`</span>
        );

        <span class="hljs-comment">// Alert if memory usage is high</span>
        <span class="hljs-keyword">if</span> (memory.used / memory.limit &gt; <span class="hljs-number">0.8</span>) {
          <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"High memory usage detected!"</span>);
        }
      }
    }, interval);
  }

  <span class="hljs-keyword">static</span> measureFunction(fn, label) {
    <span class="hljs-keyword">const</span> beforeMemory = <span class="hljs-keyword">this</span>.getMemoryUsage();
    <span class="hljs-keyword">const</span> start = performance.now();

    <span class="hljs-keyword">const</span> result = fn();

    <span class="hljs-keyword">const</span> end = performance.now();
    <span class="hljs-keyword">const</span> afterMemory = <span class="hljs-keyword">this</span>.getMemoryUsage();

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${label}</span>:`</span>, {
      <span class="hljs-attr">duration</span>: <span class="hljs-string">`<span class="hljs-subst">${(end - start).toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>,
      <span class="hljs-attr">memoryDelta</span>:
        beforeMemory &amp;&amp; afterMemory
          ? <span class="hljs-string">`<span class="hljs-subst">${afterMemory.used - beforeMemory.used}</span>MB`</span>
          : <span class="hljs-string">"N/A"</span>,
    });

    <span class="hljs-keyword">return</span> result;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> monitorId = MemoryMonitor.startMonitoring();

<span class="hljs-comment">// Later...</span>
clearInterval(monitorId);
</div></code></pre>
<hr>
<h2 id="%F0%9F%9A%80-code-optimization">🚀 Code Optimization</h2>
<h3 id="algorithm-optimization">Algorithm Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Optimize loops</span>
<span class="hljs-comment">// ❌ Inefficient</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processItems</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">const</span> results = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; items.length; i++) {
    <span class="hljs-keyword">if</span> (items[i].active) {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; items[i].tags.length; j++) {
        <span class="hljs-keyword">if</span> (items[i].tags[j].length &gt; <span class="hljs-number">3</span>) {
          results.push({
            <span class="hljs-attr">id</span>: items[i].id,
            <span class="hljs-attr">tag</span>: items[i].tags[j].toUpperCase(),
          });
        }
      }
    }
  }
  <span class="hljs-keyword">return</span> results;
}

<span class="hljs-comment">// ✅ Optimized</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processItemsOptimized</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">const</span> results = [];
  <span class="hljs-keyword">const</span> itemsLength = items.length;

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; itemsLength; i++) {
    <span class="hljs-keyword">const</span> item = items[i];
    <span class="hljs-keyword">if</span> (!item.active) <span class="hljs-keyword">continue</span>;

    <span class="hljs-keyword">const</span> tags = item.tags;
    <span class="hljs-keyword">const</span> tagsLength = tags.length;
    <span class="hljs-keyword">const</span> itemId = item.id;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> j = <span class="hljs-number">0</span>; j &lt; tagsLength; j++) {
      <span class="hljs-keyword">const</span> tag = tags[j];
      <span class="hljs-keyword">if</span> (tag.length &gt; <span class="hljs-number">3</span>) {
        results.push({
          <span class="hljs-attr">id</span>: itemId,
          <span class="hljs-attr">tag</span>: tag.toUpperCase(),
        });
      }
    }
  }

  <span class="hljs-keyword">return</span> results;
}

<span class="hljs-comment">// Even better: Use functional approach with early returns</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processItemsFunctional</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">return</span> items
    .filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.active)
    .flatMap(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
      item.tags
        .filter(<span class="hljs-function">(<span class="hljs-params">tag</span>) =&gt;</span> tag.length &gt; <span class="hljs-number">3</span>)
        .map(<span class="hljs-function">(<span class="hljs-params">tag</span>) =&gt;</span> ({
          <span class="hljs-attr">id</span>: item.id,
          <span class="hljs-attr">tag</span>: tag.toUpperCase(),
        }))
    );
}
</div></code></pre>
<h3 id="data-structure-optimization">Data Structure Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Use appropriate data structures</span>

<span class="hljs-comment">// ❌ Array for lookups (O(n))</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserManagerSlow</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.users = [];
  }

  addUser(user) {
    <span class="hljs-keyword">this</span>.users.push(user);
  }

  findUser(id) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.users.find(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id === id); <span class="hljs-comment">// O(n)</span>
  }

  removeUser(id) {
    <span class="hljs-keyword">const</span> index = <span class="hljs-keyword">this</span>.users.findIndex(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id === id); <span class="hljs-comment">// O(n)</span>
    <span class="hljs-keyword">if</span> (index !== <span class="hljs-number">-1</span>) {
      <span class="hljs-keyword">this</span>.users.splice(index, <span class="hljs-number">1</span>); <span class="hljs-comment">// O(n)</span>
    }
  }
}

<span class="hljs-comment">// ✅ Map for lookups (O(1))</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserManagerFast</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.users = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  addUser(user) {
    <span class="hljs-keyword">this</span>.users.set(user.id, user); <span class="hljs-comment">// O(1)</span>
  }

  findUser(id) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.users.get(id); <span class="hljs-comment">// O(1)</span>
  }

  removeUser(id) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.users.delete(id); <span class="hljs-comment">// O(1)</span>
  }

  getAllUsers() {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.from(<span class="hljs-keyword">this</span>.users.values());
  }
}

<span class="hljs-comment">// Set for unique values</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TagManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.tags = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();
  }

  addTag(tag) {
    <span class="hljs-keyword">this</span>.tags.add(tag.toLowerCase());
  }

  hasTag(tag) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tags.has(tag.toLowerCase());
  }

  getUniqueTagCount() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.tags.size;
  }
}
</div></code></pre>
<h3 id="function-optimization">Function Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Memoization</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">memoize</span>(<span class="hljs-params">fn</span>) </span>{
  <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-keyword">const</span> key = <span class="hljs-built_in">JSON</span>.stringify(args);

    <span class="hljs-keyword">if</span> (cache.has(key)) {
      <span class="hljs-keyword">return</span> cache.get(key);
    }

    <span class="hljs-keyword">const</span> result = fn.apply(<span class="hljs-keyword">this</span>, args);
    cache.set(key, result);
    <span class="hljs-keyword">return</span> result;
  };
}

<span class="hljs-comment">// Expensive function</span>
<span class="hljs-keyword">const</span> fibonacci = memoize(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">n</span>) </span>{
  <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> n;
  <span class="hljs-keyword">return</span> fibonacci(n - <span class="hljs-number">1</span>) + fibonacci(n - <span class="hljs-number">2</span>);
});

<span class="hljs-comment">// Debouncing</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>(<span class="hljs-params">func, wait</span>) </span>{
  <span class="hljs-keyword">let</span> timeout;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">executedFunction</span>(<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-keyword">const</span> later = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      clearTimeout(timeout);
      func(...args);
    };

    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

<span class="hljs-comment">// Throttling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">func, limit</span>) </span>{
  <span class="hljs-keyword">let</span> inThrottle;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">...args</span>) </span>{
    <span class="hljs-keyword">if</span> (!inThrottle) {
      func.apply(<span class="hljs-keyword">this</span>, args);
      inThrottle = <span class="hljs-literal">true</span>;
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> (inThrottle = <span class="hljs-literal">false</span>), limit);
    }
  };
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> debouncedSearch = debounce(searchFunction, <span class="hljs-number">300</span>);
<span class="hljs-keyword">const</span> throttledScroll = throttle(scrollHandler, <span class="hljs-number">100</span>);
</div></code></pre>
<hr>
<h2 id="%F0%9F%8E%A8-dom-performance">🎨 DOM Performance</h2>
<h3 id="efficient-dom-manipulation">Efficient DOM Manipulation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Inefficient DOM updates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateListSlow</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">const</span> list = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"list"</span>);
  list.innerHTML = <span class="hljs-string">""</span>; <span class="hljs-comment">// Triggers reflow</span>

  items.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> li = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"li"</span>);
    li.textContent = item.name;
    list.appendChild(li); <span class="hljs-comment">// Triggers reflow for each item</span>
  });
}

<span class="hljs-comment">// ✅ Batch DOM updates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateListFast</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">const</span> list = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"list"</span>);
  <span class="hljs-keyword">const</span> fragment = <span class="hljs-built_in">document</span>.createDocumentFragment();

  items.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> li = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"li"</span>);
    li.textContent = item.name;
    fragment.appendChild(li); <span class="hljs-comment">// No reflow</span>
  });

  list.innerHTML = <span class="hljs-string">""</span>;
  list.appendChild(fragment); <span class="hljs-comment">// Single reflow</span>
}

<span class="hljs-comment">// Even better: Use template strings</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateListTemplate</span>(<span class="hljs-params">items</span>) </span>{
  <span class="hljs-keyword">const</span> list = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"list"</span>);
  <span class="hljs-keyword">const</span> html = items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="hljs-string">`&lt;li&gt;<span class="hljs-subst">${item.name}</span>&lt;/li&gt;`</span>).join(<span class="hljs-string">""</span>);
  list.innerHTML = html; <span class="hljs-comment">// Single reflow</span>
}
</div></code></pre>
<h3 id="virtual-scrolling">Virtual Scrolling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Virtual scrolling for large lists</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">VirtualList</span> </span>{
  <span class="hljs-keyword">constructor</span>(container, items, itemHeight = 50) {
    <span class="hljs-keyword">this</span>.container = container;
    <span class="hljs-keyword">this</span>.items = items;
    <span class="hljs-keyword">this</span>.itemHeight = itemHeight;
    <span class="hljs-keyword">this</span>.visibleCount = <span class="hljs-built_in">Math</span>.ceil(container.clientHeight / itemHeight) + <span class="hljs-number">2</span>;
    <span class="hljs-keyword">this</span>.startIndex = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">this</span>.setupContainer();
    <span class="hljs-keyword">this</span>.render();
    <span class="hljs-keyword">this</span>.bindEvents();
  }

  setupContainer() {
    <span class="hljs-keyword">this</span>.container.style.overflow = <span class="hljs-string">"auto"</span>;
    <span class="hljs-keyword">this</span>.container.style.position = <span class="hljs-string">"relative"</span>;

    <span class="hljs-comment">// Create scrollable area</span>
    <span class="hljs-keyword">this</span>.scrollArea = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    <span class="hljs-keyword">this</span>.scrollArea.style.height = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.items.length * <span class="hljs-keyword">this</span>.itemHeight}</span>px`</span>;
    <span class="hljs-keyword">this</span>.container.appendChild(<span class="hljs-keyword">this</span>.scrollArea);

    <span class="hljs-comment">// Create visible items container</span>
    <span class="hljs-keyword">this</span>.itemsContainer = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    <span class="hljs-keyword">this</span>.itemsContainer.style.position = <span class="hljs-string">"absolute"</span>;
    <span class="hljs-keyword">this</span>.itemsContainer.style.top = <span class="hljs-string">"0"</span>;
    <span class="hljs-keyword">this</span>.itemsContainer.style.width = <span class="hljs-string">"100%"</span>;
    <span class="hljs-keyword">this</span>.scrollArea.appendChild(<span class="hljs-keyword">this</span>.itemsContainer);
  }

  render() {
    <span class="hljs-keyword">const</span> endIndex = <span class="hljs-built_in">Math</span>.min(
      <span class="hljs-keyword">this</span>.startIndex + <span class="hljs-keyword">this</span>.visibleCount,
      <span class="hljs-keyword">this</span>.items.length
    );
    <span class="hljs-keyword">const</span> visibleItems = <span class="hljs-keyword">this</span>.items.slice(<span class="hljs-keyword">this</span>.startIndex, endIndex);

    <span class="hljs-keyword">this</span>.itemsContainer.innerHTML = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">this</span>.itemsContainer.style.transform = <span class="hljs-string">`translateY(<span class="hljs-subst">${
      <span class="hljs-keyword">this</span>.startIndex * <span class="hljs-keyword">this</span>.itemHeight
    }</span>px)`</span>;

    visibleItems.forEach(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
      element.style.height = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.itemHeight}</span>px`</span>;
      element.textContent = item.name;
      element.dataset.index = <span class="hljs-keyword">this</span>.startIndex + index;
      <span class="hljs-keyword">this</span>.itemsContainer.appendChild(element);
    });
  }

  bindEvents() {
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"scroll"</span>, () =&gt; {
      <span class="hljs-keyword">const</span> newStartIndex = <span class="hljs-built_in">Math</span>.floor(
        <span class="hljs-keyword">this</span>.container.scrollTop / <span class="hljs-keyword">this</span>.itemHeight
      );

      <span class="hljs-keyword">if</span> (newStartIndex !== <span class="hljs-keyword">this</span>.startIndex) {
        <span class="hljs-keyword">this</span>.startIndex = newStartIndex;
        <span class="hljs-keyword">this</span>.render();
      }
    });
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> items = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, (_, i) =&gt; ({ <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span> }));
<span class="hljs-keyword">const</span> virtualList = <span class="hljs-keyword">new</span> VirtualList(
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"list-container"</span>),
  items
);
</div></code></pre>
<h3 id="event-delegation">Event Delegation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Multiple event listeners</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attachEventsSlow</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> buttons = <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">".button"</span>);
  buttons.forEach(<span class="hljs-function">(<span class="hljs-params">button</span>) =&gt;</span> {
    button.addEventListener(<span class="hljs-string">"click"</span>, handleButtonClick);
  });
}

<span class="hljs-comment">// ✅ Event delegation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">attachEventsFast</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, (event) =&gt; {
    <span class="hljs-keyword">if</span> (event.target.matches(<span class="hljs-string">".button"</span>)) {
      handleButtonClick(event);
    }
  });
}

<span class="hljs-comment">// Advanced event delegation</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EventDelegator</span> </span>{
  <span class="hljs-keyword">constructor</span>(container) {
    <span class="hljs-keyword">this</span>.container = container;
    <span class="hljs-keyword">this</span>.handlers = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.bindEvents();
  }

  on(selector, eventType, handler) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${eventType}</span>:<span class="hljs-subst">${selector}</span>`</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.handlers.has(key)) {
      <span class="hljs-keyword">this</span>.handlers.set(key, []);
    }
    <span class="hljs-keyword">this</span>.handlers.get(key).push(handler);
  }

  off(selector, eventType, handler) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${eventType}</span>:<span class="hljs-subst">${selector}</span>`</span>;
    <span class="hljs-keyword">const</span> handlers = <span class="hljs-keyword">this</span>.handlers.get(key);
    <span class="hljs-keyword">if</span> (handlers) {
      <span class="hljs-keyword">const</span> index = handlers.indexOf(handler);
      <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
        handlers.splice(index, <span class="hljs-number">1</span>);
      }
    }
  }

  bindEvents() {
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.handleEvent.bind(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"change"</span>, <span class="hljs-keyword">this</span>.handleEvent.bind(<span class="hljs-keyword">this</span>));
    <span class="hljs-keyword">this</span>.container.addEventListener(<span class="hljs-string">"input"</span>, <span class="hljs-keyword">this</span>.handleEvent.bind(<span class="hljs-keyword">this</span>));
  }

  handleEvent(event) {
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${event.type}</span>:`</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [handlerKey, handlers] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.handlers) {
      <span class="hljs-keyword">if</span> (handlerKey.startsWith(key)) {
        <span class="hljs-keyword">const</span> selector = handlerKey.substring(key.length);
        <span class="hljs-keyword">if</span> (event.target.matches(selector)) {
          handlers.forEach(<span class="hljs-function">(<span class="hljs-params">handler</span>) =&gt;</span> handler(event));
        }
      }
    }
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> delegator = <span class="hljs-keyword">new</span> EventDelegator(<span class="hljs-built_in">document</span>.body);
delegator.on(<span class="hljs-string">".button"</span>, <span class="hljs-string">"click"</span>, handleButtonClick);
delegator.on(<span class="hljs-string">".input"</span>, <span class="hljs-string">"input"</span>, handleInputChange);
</div></code></pre>
<hr>
<h2 id="%F0%9F%8C%90-network-optimization">🌐 Network Optimization</h2>
<h3 id="request-optimization">Request Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Request batching</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RequestBatcher</span> </span>{
  <span class="hljs-keyword">constructor</span>(batchSize = 10, delay = 100) {
    <span class="hljs-keyword">this</span>.batchSize = batchSize;
    <span class="hljs-keyword">this</span>.delay = delay;
    <span class="hljs-keyword">this</span>.queue = [];
    <span class="hljs-keyword">this</span>.timeoutId = <span class="hljs-literal">null</span>;
  }

  add(request) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.queue.push({ request, resolve, reject });

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.queue.length &gt;= <span class="hljs-keyword">this</span>.batchSize) {
        <span class="hljs-keyword">this</span>.flush();
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.timeoutId) {
        <span class="hljs-keyword">this</span>.timeoutId = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">this</span>.flush(), <span class="hljs-keyword">this</span>.delay);
      }
    });
  }

  <span class="hljs-keyword">async</span> flush() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.queue.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> batch = <span class="hljs-keyword">this</span>.queue.splice(<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.batchSize);

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.timeoutId) {
      clearTimeout(<span class="hljs-keyword">this</span>.timeoutId);
      <span class="hljs-keyword">this</span>.timeoutId = <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> requests = batch.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.request);
      <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.processBatch(requests);

      batch.forEach(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> {
        item.resolve(results[index]);
      });
    } <span class="hljs-keyword">catch</span> (error) {
      batch.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.reject(error));
    }
  }

  <span class="hljs-keyword">async</span> processBatch(requests) {
    <span class="hljs-comment">// Send all requests in a single API call</span>
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/batch"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ requests }),
    });

    <span class="hljs-keyword">return</span> response.json();
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> batcher = <span class="hljs-keyword">new</span> RequestBatcher();

<span class="hljs-comment">// These will be batched together</span>
<span class="hljs-keyword">const</span> user1 = <span class="hljs-keyword">await</span> batcher.add({ <span class="hljs-attr">type</span>: <span class="hljs-string">"getUser"</span>, <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> });
<span class="hljs-keyword">const</span> user2 = <span class="hljs-keyword">await</span> batcher.add({ <span class="hljs-attr">type</span>: <span class="hljs-string">"getUser"</span>, <span class="hljs-attr">id</span>: <span class="hljs-number">2</span> });
<span class="hljs-keyword">const</span> user3 = <span class="hljs-keyword">await</span> batcher.add({ <span class="hljs-attr">type</span>: <span class="hljs-string">"getUser"</span>, <span class="hljs-attr">id</span>: <span class="hljs-number">3</span> });
</div></code></pre>
<h3 id="caching-strategies">Caching Strategies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// HTTP cache with TTL</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HTTPCache</span> </span>{
  <span class="hljs-keyword">constructor</span>(defaultTTL = 300000) {
    <span class="hljs-comment">// 5 minutes</span>
    <span class="hljs-keyword">this</span>.cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.defaultTTL = defaultTTL;
  }

  <span class="hljs-keyword">set</span>(key, value, ttl = this.defaultTTL) {
    <span class="hljs-keyword">const</span> expiry = <span class="hljs-built_in">Date</span>.now() + ttl;
    <span class="hljs-keyword">this</span>.cache.set(key, { value, expiry });
  }

  <span class="hljs-keyword">get</span>(key) {
    <span class="hljs-keyword">const</span> item = <span class="hljs-keyword">this</span>.cache.get(key);

    <span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Date</span>.now() &gt; item.expiry) {
      <span class="hljs-keyword">this</span>.cache.delete(key);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-keyword">return</span> item.value;
  }

  clear() {
    <span class="hljs-keyword">this</span>.cache.clear();
  }

  cleanup() {
    <span class="hljs-keyword">const</span> now = <span class="hljs-built_in">Date</span>.now();
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, item] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.cache) {
      <span class="hljs-keyword">if</span> (now &gt; item.expiry) {
        <span class="hljs-keyword">this</span>.cache.delete(key);
      }
    }
  }
}

<span class="hljs-comment">// API client with caching</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CachedAPIClient</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.cache = <span class="hljs-keyword">new</span> HTTPCache();
    <span class="hljs-keyword">this</span>.pendingRequests = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">get</span>(url, options = {}) {
    <span class="hljs-keyword">const</span> cacheKey = <span class="hljs-keyword">this</span>.getCacheKey(url, options);

    <span class="hljs-comment">// Check cache first</span>
    <span class="hljs-keyword">const</span> cached = <span class="hljs-keyword">this</span>.cache.get(cacheKey);
    <span class="hljs-keyword">if</span> (cached) {
      <span class="hljs-keyword">return</span> cached;
    }

    <span class="hljs-comment">// Check if request is already pending</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.pendingRequests.has(cacheKey)) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.pendingRequests.get(cacheKey);
    }

    <span class="hljs-comment">// Make request</span>
    <span class="hljs-keyword">const</span> requestPromise = <span class="hljs-keyword">this</span>.makeRequest(url, options)
      .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {
        <span class="hljs-keyword">this</span>.cache.set(cacheKey, response, options.ttl);
        <span class="hljs-keyword">this</span>.pendingRequests.delete(cacheKey);
        <span class="hljs-keyword">return</span> response;
      })
      .catch(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-keyword">this</span>.pendingRequests.delete(cacheKey);
        <span class="hljs-keyword">throw</span> error;
      });

    <span class="hljs-keyword">this</span>.pendingRequests.set(cacheKey, requestPromise);
    <span class="hljs-keyword">return</span> requestPromise;
  }

  <span class="hljs-keyword">async</span> makeRequest(url, options) {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, options);
    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>`</span>);
    }
    <span class="hljs-keyword">return</span> response.json();
  }

  getCacheKey(url, options) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${url}</span>:<span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(options)}</span>`</span>;
  }
}
</div></code></pre>
<h3 id="resource-loading">Resource Loading</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Lazy loading with Intersection Observer</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LazyLoader</span> </span>{
  <span class="hljs-keyword">constructor</span>(options = {}) {
    <span class="hljs-keyword">this</span>.options = {
      <span class="hljs-attr">rootMargin</span>: <span class="hljs-string">"50px"</span>,
      <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.1</span>,
      ...options,
    };

    <span class="hljs-keyword">this</span>.observer = <span class="hljs-keyword">new</span> IntersectionObserver(
      <span class="hljs-keyword">this</span>.handleIntersection.bind(<span class="hljs-keyword">this</span>),
      <span class="hljs-keyword">this</span>.options
    );
  }

  observe(element) {
    <span class="hljs-keyword">this</span>.observer.observe(element);
  }

  unobserve(element) {
    <span class="hljs-keyword">this</span>.observer.unobserve(element);
  }

  handleIntersection(entries) {
    entries.forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (entry.isIntersecting) {
        <span class="hljs-keyword">this</span>.loadElement(entry.target);
        <span class="hljs-keyword">this</span>.observer.unobserve(entry.target);
      }
    });
  }

  loadElement(element) {
    <span class="hljs-keyword">if</span> (element.dataset.src) {
      element.src = element.dataset.src;
      element.removeAttribute(<span class="hljs-string">"data-src"</span>);
    }

    <span class="hljs-keyword">if</span> (element.dataset.srcset) {
      element.srcset = element.dataset.srcset;
      element.removeAttribute(<span class="hljs-string">"data-srcset"</span>);
    }

    element.classList.add(<span class="hljs-string">"loaded"</span>);
  }
}

<span class="hljs-comment">// Preloading critical resources</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResourcePreloader</span> </span>{
  <span class="hljs-keyword">static</span> preloadImage(src) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();
      img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> resolve(img);
      img.onerror = reject;
      img.src = src;
    });
  }

  <span class="hljs-keyword">static</span> preloadScript(src) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);
      script.onload = resolve;
      script.onerror = reject;
      script.src = src;
      <span class="hljs-built_in">document</span>.head.appendChild(script);
    });
  }

  <span class="hljs-keyword">static</span> preloadCSS(href) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> link = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"link"</span>);
      link.rel = <span class="hljs-string">"stylesheet"</span>;
      link.onload = resolve;
      link.onerror = reject;
      link.href = href;
      <span class="hljs-built_in">document</span>.head.appendChild(link);
    });
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> preloadCriticalResources(resources) {
    <span class="hljs-keyword">const</span> promises = resources.map(<span class="hljs-function">(<span class="hljs-params">resource</span>) =&gt;</span> {
      <span class="hljs-keyword">switch</span> (resource.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"image"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preloadImage(resource.src);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"script"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preloadScript(resource.src);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"css"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.preloadCSS(resource.href);
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve();
      }
    });

    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(promises);
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> lazyLoader = <span class="hljs-keyword">new</span> LazyLoader();
<span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"img[data-src]"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">img</span>) =&gt;</span> {
  lazyLoader.observe(img);
});

<span class="hljs-comment">// Preload critical resources</span>
ResourcePreloader.preloadCriticalResources([
  { <span class="hljs-attr">type</span>: <span class="hljs-string">"image"</span>, <span class="hljs-attr">src</span>: <span class="hljs-string">"/hero-image.jpg"</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">"script"</span>, <span class="hljs-attr">src</span>: <span class="hljs-string">"/critical.js"</span> },
  { <span class="hljs-attr">type</span>: <span class="hljs-string">"css"</span>, <span class="hljs-attr">href</span>: <span class="hljs-string">"/critical.css"</span> },
]);
</div></code></pre>
<hr>
<h2 id="%E2%9A%A1-async-performance">⚡ Async Performance</h2>
<h3 id="parallel-vs-sequential-execution">Parallel vs Sequential Execution</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Sequential execution (slow)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserDataSequential</span>(<span class="hljs-params">userIds</span>) </span>{
  <span class="hljs-keyword">const</span> users = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> id <span class="hljs-keyword">of</span> userIds) {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> fetchUser(id); <span class="hljs-comment">// Waits for each request</span>
    users.push(user);
  }

  <span class="hljs-keyword">return</span> users;
}

<span class="hljs-comment">// ✅ Parallel execution (fast)</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserDataParallel</span>(<span class="hljs-params">userIds</span>) </span>{
  <span class="hljs-keyword">const</span> promises = userIds.map(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> fetchUser(id));
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.all(promises);
}

<span class="hljs-comment">// ✅ Controlled concurrency</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUserDataConcurrent</span>(<span class="hljs-params">userIds, concurrency = <span class="hljs-number">3</span></span>) </span>{
  <span class="hljs-keyword">const</span> results = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; userIds.length; i += concurrency) {
    <span class="hljs-keyword">const</span> batch = userIds.slice(i, i + concurrency);
    <span class="hljs-keyword">const</span> batchPromises = batch.map(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> fetchUser(id));
    <span class="hljs-keyword">const</span> batchResults = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(batchPromises);
    results.push(...batchResults);
  }

  <span class="hljs-keyword">return</span> results;
}

<span class="hljs-comment">// Advanced: Promise pool with retry</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PromisePool</span> </span>{
  <span class="hljs-keyword">constructor</span>(concurrency = 3) {
    <span class="hljs-keyword">this</span>.concurrency = concurrency;
    <span class="hljs-keyword">this</span>.running = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.queue = [];
  }

  <span class="hljs-keyword">async</span> add(promiseFactory, retries = <span class="hljs-number">3</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.queue.push({
        promiseFactory,
        resolve,
        reject,
        retries,
      });

      <span class="hljs-keyword">this</span>.process();
    });
  }

  <span class="hljs-keyword">async</span> process() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.running &gt;= <span class="hljs-keyword">this</span>.concurrency || <span class="hljs-keyword">this</span>.queue.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">this</span>.running++;
    <span class="hljs-keyword">const</span> { promiseFactory, resolve, reject, retries } = <span class="hljs-keyword">this</span>.queue.shift();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> promiseFactory();
      resolve(result);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">if</span> (retries &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// Retry with exponential backoff</span>
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          <span class="hljs-keyword">this</span>.queue.unshift({
            promiseFactory,
            resolve,
            reject,
            <span class="hljs-attr">retries</span>: retries - <span class="hljs-number">1</span>,
          });
          <span class="hljs-keyword">this</span>.process();
        }, <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-number">3</span> - retries) * <span class="hljs-number">1000</span>);
      } <span class="hljs-keyword">else</span> {
        reject(error);
      }
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-keyword">this</span>.running--;
      <span class="hljs-keyword">this</span>.process();
    }
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> pool = <span class="hljs-keyword">new</span> PromisePool(<span class="hljs-number">5</span>);
<span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(
  userIds.map(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> pool.add(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> fetchUser(id)))
);
</div></code></pre>
<h3 id="web-workers-for-heavy-tasks">Web Workers for Heavy Tasks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Main thread</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WorkerPool</span> </span>{
  <span class="hljs-keyword">constructor</span>(workerScript, poolSize = navigator.hardwareConcurrency || 4) {
    <span class="hljs-keyword">this</span>.workers = [];
    <span class="hljs-keyword">this</span>.queue = [];
    <span class="hljs-keyword">this</span>.taskId = <span class="hljs-number">0</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; poolSize; i++) {
      <span class="hljs-keyword">this</span>.workers.push({
        <span class="hljs-attr">worker</span>: <span class="hljs-keyword">new</span> Worker(workerScript),
        <span class="hljs-attr">busy</span>: <span class="hljs-literal">false</span>,
      });
    }
  }

  execute(data) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> taskId = ++<span class="hljs-keyword">this</span>.taskId;

      <span class="hljs-keyword">this</span>.queue.push({
        taskId,
        data,
        resolve,
        reject,
      });

      <span class="hljs-keyword">this</span>.processQueue();
    });
  }

  processQueue() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.queue.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> availableWorker = <span class="hljs-keyword">this</span>.workers.find(<span class="hljs-function">(<span class="hljs-params">w</span>) =&gt;</span> !w.busy);
    <span class="hljs-keyword">if</span> (!availableWorker) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> task = <span class="hljs-keyword">this</span>.queue.shift();
    availableWorker.busy = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">const</span> handleMessage = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (event.data.taskId === task.taskId) {
        availableWorker.worker.removeEventListener(<span class="hljs-string">"message"</span>, handleMessage);
        availableWorker.worker.removeEventListener(<span class="hljs-string">"error"</span>, handleError);
        availableWorker.busy = <span class="hljs-literal">false</span>;

        <span class="hljs-keyword">if</span> (event.data.error) {
          task.reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(event.data.error));
        } <span class="hljs-keyword">else</span> {
          task.resolve(event.data.result);
        }

        <span class="hljs-keyword">this</span>.processQueue();
      }
    };

    <span class="hljs-keyword">const</span> handleError = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      availableWorker.worker.removeEventListener(<span class="hljs-string">"message"</span>, handleMessage);
      availableWorker.worker.removeEventListener(<span class="hljs-string">"error"</span>, handleError);
      availableWorker.busy = <span class="hljs-literal">false</span>;
      task.reject(error);
      <span class="hljs-keyword">this</span>.processQueue();
    };

    availableWorker.worker.addEventListener(<span class="hljs-string">"message"</span>, handleMessage);
    availableWorker.worker.addEventListener(<span class="hljs-string">"error"</span>, handleError);

    availableWorker.worker.postMessage({
      <span class="hljs-attr">taskId</span>: task.taskId,
      <span class="hljs-attr">data</span>: task.data,
    });
  }

  terminate() {
    <span class="hljs-keyword">this</span>.workers.forEach(<span class="hljs-function">(<span class="hljs-params">w</span>) =&gt;</span> w.worker.terminate());
  }
}

<span class="hljs-comment">// worker.js</span>
self.addEventListener(<span class="hljs-string">"message"</span>, (event) =&gt; {
  <span class="hljs-keyword">const</span> { taskId, data } = event.data;

  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// Heavy computation</span>
    <span class="hljs-keyword">const</span> result = processLargeDataset(data);

    self.postMessage({
      taskId,
      result,
    });
  } <span class="hljs-keyword">catch</span> (error) {
    self.postMessage({
      taskId,
      <span class="hljs-attr">error</span>: error.message,
    });
  }
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processLargeDataset</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-comment">// CPU-intensive task</span>
  <span class="hljs-keyword">return</span> data.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-comment">// Complex calculations</span>
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.sqrt(item * item + item);
  });
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> workerPool = <span class="hljs-keyword">new</span> WorkerPool(<span class="hljs-string">"worker.js"</span>, <span class="hljs-number">4</span>);
<span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> workerPool.execute(largeDataArray);
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%A6-bundle-optimization">📦 Bundle Optimization</h2>
<h3 id="code-splitting">Code Splitting</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Dynamic imports for code splitting</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ModuleLoader</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.loadedModules = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  <span class="hljs-keyword">async</span> loadModule(moduleName) {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.loadedModules.has(moduleName)) {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.loadedModules.get(moduleName);
    }

    <span class="hljs-keyword">let</span> modulePromise;

    <span class="hljs-keyword">switch</span> (moduleName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"chart"</span>:
        modulePromise = <span class="hljs-keyword">import</span>(<span class="hljs-string">"./modules/chart.js"</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"editor"</span>:
        modulePromise = <span class="hljs-keyword">import</span>(<span class="hljs-string">"./modules/editor.js"</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"calendar"</span>:
        modulePromise = <span class="hljs-keyword">import</span>(<span class="hljs-string">"./modules/calendar.js"</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Unknown module: <span class="hljs-subst">${moduleName}</span>`</span>);
    }

    <span class="hljs-keyword">this</span>.loadedModules.set(moduleName, modulePromise);
    <span class="hljs-keyword">return</span> modulePromise;
  }

  <span class="hljs-keyword">async</span> loadModuleOnDemand(moduleName, trigger) {
    <span class="hljs-keyword">const</span> loadModule = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> <span class="hljs-built_in">module</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.loadModule(moduleName);
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">module</span>.default || <span class="hljs-built_in">module</span>;
    };

    <span class="hljs-comment">// Load on user interaction</span>
    <span class="hljs-keyword">if</span> (trigger) {
      trigger.addEventListener(<span class="hljs-string">"click"</span>, loadModule, { <span class="hljs-attr">once</span>: <span class="hljs-literal">true</span> });
    }

    <span class="hljs-keyword">return</span> loadModule;
  }
}

<span class="hljs-comment">// Route-based code splitting</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Router</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.routes = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.moduleLoader = <span class="hljs-keyword">new</span> ModuleLoader();
  }

  addRoute(path, moduleFactory) {
    <span class="hljs-keyword">this</span>.routes.set(path, moduleFactory);
  }

  <span class="hljs-keyword">async</span> navigate(path) {
    <span class="hljs-keyword">const</span> moduleFactory = <span class="hljs-keyword">this</span>.routes.get(path);

    <span class="hljs-keyword">if</span> (!moduleFactory) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Route not found: <span class="hljs-subst">${path}</span>`</span>);
    }

    <span class="hljs-comment">// Show loading indicator</span>
    <span class="hljs-keyword">this</span>.showLoading();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-built_in">module</span> = <span class="hljs-keyword">await</span> moduleFactory();
      <span class="hljs-keyword">const</span> component = <span class="hljs-keyword">new</span> <span class="hljs-built_in">module</span>.default();
      <span class="hljs-keyword">this</span>.render(component);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">this</span>.showError(error);
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-keyword">this</span>.hideLoading();
    }
  }

  showLoading() {
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"loading"</span>).style.display = <span class="hljs-string">"block"</span>;
  }

  hideLoading() {
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"loading"</span>).style.display = <span class="hljs-string">"none"</span>;
  }

  render(component) {
    <span class="hljs-keyword">const</span> container = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"app"</span>);
    container.innerHTML = <span class="hljs-string">""</span>;
    container.appendChild(component.render());
  }

  showError(error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Route loading error:"</span>, error);
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> router = <span class="hljs-keyword">new</span> Router();

router.addRoute(<span class="hljs-string">"/dashboard"</span>, () =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-string">"./pages/Dashboard.js"</span>));
router.addRoute(<span class="hljs-string">"/profile"</span>, () =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-string">"./pages/Profile.js"</span>));
router.addRoute(<span class="hljs-string">"/settings"</span>, () =&gt; <span class="hljs-keyword">import</span>(<span class="hljs-string">"./pages/Settings.js"</span>));
</div></code></pre>
<h3 id="tree-shaking-optimization">Tree Shaking Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Imports entire library</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> utils <span class="hljs-keyword">from</span> <span class="hljs-string">"./utils.js"</span>;
utils.debounce(fn, <span class="hljs-number">300</span>);

<span class="hljs-comment">// ✅ Import only what you need</span>
<span class="hljs-keyword">import</span> { debounce } <span class="hljs-keyword">from</span> <span class="hljs-string">"./utils.js"</span>;
debounce(fn, <span class="hljs-number">300</span>);

<span class="hljs-comment">// Create tree-shakable modules</span>
<span class="hljs-comment">// utils.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>(<span class="hljs-params">func, wait</span>) </span>{
  <span class="hljs-comment">// Implementation</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throttle</span>(<span class="hljs-params">func, limit</span>) </span>{
  <span class="hljs-comment">// Implementation</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">memoize</span>(<span class="hljs-params">func</span>) </span>{
  <span class="hljs-comment">// Implementation</span>
}

<span class="hljs-comment">// Don't export default objects</span>
<span class="hljs-comment">// ❌ Not tree-shakable</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  debounce,
  throttle,
  memoize,
};

<span class="hljs-comment">// ✅ Tree-shakable</span>
<span class="hljs-keyword">export</span> { debounce, throttle, memoize };
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%8A-monitoring--profiling">📊 Monitoring &amp; Profiling</h2>
<h3 id="performance-monitoring">Performance Monitoring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Comprehensive performance monitor</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceMonitor</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.metrics = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.observers = [];
    <span class="hljs-keyword">this</span>.setupObservers();
  }

  setupObservers() {
    <span class="hljs-comment">// Long tasks</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"PerformanceObserver"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) {
      <span class="hljs-keyword">const</span> longTaskObserver = <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
        list.getEntries().forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
          <span class="hljs-keyword">this</span>.recordMetric(<span class="hljs-string">"longTask"</span>, {
            <span class="hljs-attr">duration</span>: entry.duration,
            <span class="hljs-attr">startTime</span>: entry.startTime,
          });
        });
      });

      <span class="hljs-keyword">try</span> {
        longTaskObserver.observe({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"longtask"</span>] });
        <span class="hljs-keyword">this</span>.observers.push(longTaskObserver);
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Long task observer not supported"</span>);
      }
    }

    <span class="hljs-comment">// Layout shifts</span>
    <span class="hljs-keyword">const</span> layoutShiftObserver = <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
      list.getEntries().forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (!entry.hadRecentInput) {
          <span class="hljs-keyword">this</span>.recordMetric(<span class="hljs-string">"layoutShift"</span>, {
            <span class="hljs-attr">value</span>: entry.value,
            <span class="hljs-attr">startTime</span>: entry.startTime,
          });
        }
      });
    });

    layoutShiftObserver.observe({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"layout-shift"</span>] });
    <span class="hljs-keyword">this</span>.observers.push(layoutShiftObserver);
  }

  recordMetric(name, data) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.metrics.has(name)) {
      <span class="hljs-keyword">this</span>.metrics.set(name, []);
    }

    <span class="hljs-keyword">this</span>.metrics.get(name).push({
      ...data,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
    });
  }

  getMetrics(name) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.metrics.get(name) || [];
  }

  getAverageMetric(name, property) {
    <span class="hljs-keyword">const</span> metrics = <span class="hljs-keyword">this</span>.getMetrics(name);
    <span class="hljs-keyword">if</span> (metrics.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

    <span class="hljs-keyword">const</span> sum = metrics.reduce(<span class="hljs-function">(<span class="hljs-params">acc, metric</span>) =&gt;</span> acc + metric[property], <span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> sum / metrics.length;
  }

  generateReport() {
    <span class="hljs-keyword">const</span> report = {
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      <span class="hljs-attr">navigation</span>: <span class="hljs-keyword">this</span>.getNavigationTiming(),
      <span class="hljs-attr">longTasks</span>: <span class="hljs-keyword">this</span>.getMetrics(<span class="hljs-string">"longTask"</span>),
      <span class="hljs-attr">layoutShifts</span>: <span class="hljs-keyword">this</span>.getMetrics(<span class="hljs-string">"layoutShift"</span>),
      <span class="hljs-attr">memory</span>: <span class="hljs-keyword">this</span>.getMemoryInfo(),
      <span class="hljs-attr">averages</span>: {
        <span class="hljs-attr">longTaskDuration</span>: <span class="hljs-keyword">this</span>.getAverageMetric(<span class="hljs-string">"longTask"</span>, <span class="hljs-string">"duration"</span>),
        <span class="hljs-attr">layoutShiftValue</span>: <span class="hljs-keyword">this</span>.getAverageMetric(<span class="hljs-string">"layoutShift"</span>, <span class="hljs-string">"value"</span>),
      },
    };

    <span class="hljs-keyword">return</span> report;
  }

  getNavigationTiming() {
    <span class="hljs-keyword">const</span> timing = performance.getEntriesByType(<span class="hljs-string">"navigation"</span>)[<span class="hljs-number">0</span>];
    <span class="hljs-keyword">if</span> (!timing) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">dns</span>: timing.domainLookupEnd - timing.domainLookupStart,
      <span class="hljs-attr">tcp</span>: timing.connectEnd - timing.connectStart,
      <span class="hljs-attr">request</span>: timing.responseStart - timing.requestStart,
      <span class="hljs-attr">response</span>: timing.responseEnd - timing.responseStart,
      <span class="hljs-attr">domParsing</span>: timing.domInteractive - timing.responseEnd,
      <span class="hljs-attr">domReady</span>:
        timing.domContentLoadedEventEnd - timing.domContentLoadedEventStart,
      <span class="hljs-attr">loadComplete</span>: timing.loadEventEnd - timing.loadEventStart,
    };
  }

  getMemoryInfo() {
    <span class="hljs-keyword">if</span> (performance.memory) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">used</span>: <span class="hljs-built_in">Math</span>.round(performance.memory.usedJSHeapSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>),
        <span class="hljs-attr">total</span>: <span class="hljs-built_in">Math</span>.round(performance.memory.totalJSHeapSize / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>),
        <span class="hljs-attr">limit</span>: <span class="hljs-built_in">Math</span>.round(performance.memory.jsHeapSizeLimit / <span class="hljs-number">1024</span> / <span class="hljs-number">1024</span>),
      };
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  sendReport(endpoint) {
    <span class="hljs-keyword">const</span> report = <span class="hljs-keyword">this</span>.generateReport();

    <span class="hljs-comment">// Use sendBeacon for reliability</span>
    <span class="hljs-keyword">if</span> (navigator.sendBeacon) {
      navigator.sendBeacon(endpoint, <span class="hljs-built_in">JSON</span>.stringify(report));
    } <span class="hljs-keyword">else</span> {
      fetch(endpoint, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(report),
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
        <span class="hljs-attr">keepalive</span>: <span class="hljs-literal">true</span>,
      }).catch(<span class="hljs-built_in">console</span>.error);
    }
  }

  disconnect() {
    <span class="hljs-keyword">this</span>.observers.forEach(<span class="hljs-function">(<span class="hljs-params">observer</span>) =&gt;</span> observer.disconnect());
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> monitor = <span class="hljs-keyword">new</span> PerformanceMonitor();

<span class="hljs-comment">// Send report every 30 seconds</span>
setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  monitor.sendReport(<span class="hljs-string">"/api/performance"</span>);
}, <span class="hljs-number">30000</span>);

<span class="hljs-comment">// Send report before page unload</span>
<span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"beforeunload"</span>, () =&gt; {
  monitor.sendReport(<span class="hljs-string">"/api/performance"</span>);
});
</div></code></pre>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-premature-optimization">1. Premature Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Optimizing before measuring</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processData</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-comment">// Complex optimization that may not be needed</span>
  <span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  <span class="hljs-keyword">const</span> pool = <span class="hljs-keyword">new</span> ObjectPool();
  <span class="hljs-comment">// ... overly complex code</span>
}

<span class="hljs-comment">// ✅ Measure first, then optimize</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processData</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-comment">// Simple, readable implementation first</span>
  <span class="hljs-keyword">return</span> data.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> transform(item));
}

<span class="hljs-comment">// Profile and optimize only if needed</span>
</div></code></pre>
<h3 id="2-memory-leaks-in-event-listeners">2. Memory Leaks in Event Listeners</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Memory leak</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.handleClick = <span class="hljs-keyword">this</span>.handleClick.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.handleClick);
  }

  handleClick() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Clicked"</span>);
  }

  <span class="hljs-comment">// Missing cleanup!</span>
}

<span class="hljs-comment">// ✅ Proper cleanup</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.handleClick = <span class="hljs-keyword">this</span>.handleClick.bind(<span class="hljs-keyword">this</span>);
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.handleClick);
  }

  handleClick() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Clicked"</span>);
  }

  destroy() {
    <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"click"</span>, <span class="hljs-keyword">this</span>.handleClick);
  }
}
</div></code></pre>
<h3 id="3-blocking-the-main-thread">3. Blocking the Main Thread</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Blocking operation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processLargeArray</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; data.length; i++) {
    <span class="hljs-comment">// Heavy computation blocks UI</span>
    heavyCalculation(data[i]);
  }
}

<span class="hljs-comment">// ✅ Non-blocking with time slicing</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processLargeArrayNonBlocking</span>(<span class="hljs-params">data, callback</span>) </span>{
  <span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> batchSize = <span class="hljs-number">1000</span>;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processBatch</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> endIndex = <span class="hljs-built_in">Math</span>.min(index + batchSize, data.length);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = index; i &lt; endIndex; i++) {
      heavyCalculation(data[i]);
    }

    index = endIndex;

    <span class="hljs-keyword">if</span> (index &lt; data.length) {
      setTimeout(processBatch, <span class="hljs-number">0</span>); <span class="hljs-comment">// Yield to browser</span>
    } <span class="hljs-keyword">else</span> {
      callback();
    }
  }

  processBatch();
}
</div></code></pre>
<h3 id="4-inefficient-dom-queries">4. Inefficient DOM Queries</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Repeated DOM queries</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateElements</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"item-"</span> + i).textContent = <span class="hljs-string">"Updated"</span>;
    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"item-"</span> + i).classList.add(<span class="hljs-string">"active"</span>);
  }
}

<span class="hljs-comment">// ✅ Cache DOM references</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">updateElementsOptimized</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> elements = [];
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100</span>; i++) {
    elements[i] = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"item-"</span> + i);
  }

  elements.forEach(<span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> {
    element.textContent = <span class="hljs-string">"Updated"</span>;
    element.classList.add(<span class="hljs-string">"active"</span>);
  });
}
</div></code></pre>
<h3 id="5-not-using-requestanimationframe">5. Not Using RequestAnimationFrame</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Using setTimeout for animations</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateElement</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">let</span> position = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> animate = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    position += <span class="hljs-number">1</span>;
    element.style.left = position + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">if</span> (position &lt; <span class="hljs-number">100</span>) {
      setTimeout(animate, <span class="hljs-number">16</span>); <span class="hljs-comment">// Not synced with display</span>
    }
  };
  animate();
}

<span class="hljs-comment">// ✅ Using requestAnimationFrame</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">animateElementOptimized</span>(<span class="hljs-params">element</span>) </span>{
  <span class="hljs-keyword">let</span> position = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> animate = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    position += <span class="hljs-number">1</span>;
    element.style.left = position + <span class="hljs-string">"px"</span>;
    <span class="hljs-keyword">if</span> (position &lt; <span class="hljs-number">100</span>) {
      requestAnimationFrame(animate); <span class="hljs-comment">// Synced with display</span>
    }
  };
  requestAnimationFrame(animate);
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-mini-practice-problems">🏋️ Mini Practice Problems</h2>
<h3 id="problem-1-optimize-a-data-processing-pipeline">Problem 1: Optimize a Data Processing Pipeline</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Optimize this slow data processing function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUserData</span>(<span class="hljs-params">users</span>) </span>{
  <span class="hljs-keyword">const</span> results = [];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; users.length; i++) {
    <span class="hljs-keyword">const</span> user = users[i];

    <span class="hljs-keyword">if</span> (user.active) {
      <span class="hljs-keyword">const</span> profile = getUserProfile(user.id); <span class="hljs-comment">// Sync API call</span>
      <span class="hljs-keyword">const</span> permissions = getUserPermissions(user.id); <span class="hljs-comment">// Sync API call</span>
      <span class="hljs-keyword">const</span> preferences = getUserPreferences(user.id); <span class="hljs-comment">// Sync API call</span>

      <span class="hljs-keyword">const</span> processed = {
        <span class="hljs-attr">id</span>: user.id,
        <span class="hljs-attr">name</span>: user.name.toUpperCase(),
        <span class="hljs-attr">email</span>: user.email.toLowerCase(),
        <span class="hljs-attr">profile</span>: profile,
        <span class="hljs-attr">permissions</span>: permissions,
        <span class="hljs-attr">preferences</span>: preferences,
        <span class="hljs-attr">score</span>: calculateUserScore(user, profile, permissions),
      };

      results.push(processed);
    }
  }

  <span class="hljs-keyword">return</span> results.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> b.score - a.score);
}

<span class="hljs-comment">// Tasks:</span>
<span class="hljs-comment">// 1. Make API calls parallel</span>
<span class="hljs-comment">// 2. Implement caching</span>
<span class="hljs-comment">// 3. Add batch processing</span>
<span class="hljs-comment">// 4. Use Web Workers for heavy calculations</span>
<span class="hljs-comment">// 5. Implement progress tracking</span>
</div></code></pre>
<h3 id="problem-2-create-a-high-performance-virtual-list">Problem 2: Create a High-Performance Virtual List</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement a virtual list that can handle 100,000+ items smoothly</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HighPerformanceVirtualList</span> </span>{
  <span class="hljs-keyword">constructor</span>(container, items, itemHeight, renderItem) {
    <span class="hljs-comment">// Your implementation here</span>
    <span class="hljs-comment">// Requirements:</span>
    <span class="hljs-comment">// - Smooth scrolling with 100k+ items</span>
    <span class="hljs-comment">// - Dynamic item heights support</span>
    <span class="hljs-comment">// - Horizontal scrolling support</span>
    <span class="hljs-comment">// - Search and filtering</span>
    <span class="hljs-comment">// - Memory efficient</span>
    <span class="hljs-comment">// - Keyboard navigation</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// render()</span>
  <span class="hljs-comment">// scrollToIndex(index)</span>
  <span class="hljs-comment">// updateItems(newItems)</span>
  <span class="hljs-comment">// filter(predicate)</span>
  <span class="hljs-comment">// search(query)</span>
  <span class="hljs-comment">// destroy()</span>
}
</div></code></pre>
<h3 id="problem-3-build-a-performance-budget-monitor">Problem 3: Build a Performance Budget Monitor</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a system that monitors and enforces performance budgets</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceBudgetMonitor</span> </span>{
  <span class="hljs-keyword">constructor</span>(budgets) {
    <span class="hljs-comment">// budgets = {</span>
    <span class="hljs-comment">//     bundleSize: 250000, // 250KB</span>
    <span class="hljs-comment">//     firstContentfulPaint: 1500, // 1.5s</span>
    <span class="hljs-comment">//     largestContentfulPaint: 2500, // 2.5s</span>
    <span class="hljs-comment">//     cumulativeLayoutShift: 0.1,</span>
    <span class="hljs-comment">//     firstInputDelay: 100 // 100ms</span>
    <span class="hljs-comment">// }</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// startMonitoring()</span>
  <span class="hljs-comment">// checkBudgets()</span>
  <span class="hljs-comment">// reportViolations()</span>
  <span class="hljs-comment">// generateReport()</span>
  <span class="hljs-comment">// setupAlerts()</span>
}
</div></code></pre>
<h3 id="problem-4-optimize-image-loading">Problem 4: Optimize Image Loading</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create an advanced image loading system</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ImageOptimizer</span> </span>{
  <span class="hljs-keyword">constructor</span>(options) {
    <span class="hljs-comment">// Features to implement:</span>
    <span class="hljs-comment">// - Lazy loading with intersection observer</span>
    <span class="hljs-comment">// - Progressive image loading (blur-up)</span>
    <span class="hljs-comment">// - WebP/AVIF format detection and serving</span>
    <span class="hljs-comment">// - Responsive images based on device</span>
    <span class="hljs-comment">// - Image compression on the fly</span>
    <span class="hljs-comment">// - Preloading critical images</span>
    <span class="hljs-comment">// - Error handling and fallbacks</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// loadImage(src, options)</span>
  <span class="hljs-comment">// preloadImages(srcs)</span>
  <span class="hljs-comment">// generateResponsiveSrc(src, sizes)</span>
  <span class="hljs-comment">// compressImage(file, quality)</span>
  <span class="hljs-comment">// convertToWebP(file)</span>
}
</div></code></pre>
<h3 id="problem-5-memory-leak-detector">Problem 5: Memory Leak Detector</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Build a tool to detect and report memory leaks</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MemoryLeakDetector</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Features:</span>
    <span class="hljs-comment">// - Track object creation and destruction</span>
    <span class="hljs-comment">// - Monitor DOM node leaks</span>
    <span class="hljs-comment">// - Detect event listener leaks</span>
    <span class="hljs-comment">// - Monitor closure leaks</span>
    <span class="hljs-comment">// - Generate leak reports</span>
    <span class="hljs-comment">// - Suggest fixes</span>
  }

  <span class="hljs-comment">// Methods to implement:</span>
  <span class="hljs-comment">// startTracking()</span>
  <span class="hljs-comment">// trackObject(obj, label)</span>
  <span class="hljs-comment">// detectLeaks()</span>
  <span class="hljs-comment">// generateReport()</span>
  <span class="hljs-comment">// suggestFixes()</span>
  <span class="hljs-comment">// cleanup()</span>
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%92%BC-interview-notes">💼 Interview Notes</h2>
<h3 id="common-questions">Common Questions:</h3>
<p><strong>Q: What are the main performance bottlenecks in web applications?</strong></p>
<ul>
<li><strong>Network</strong>: Large bundles, too many requests, no caching</li>
<li><strong>Rendering</strong>: Layout thrashing, unnecessary repaints, large DOM</li>
<li><strong>JavaScript</strong>: Blocking main thread, memory leaks, inefficient algorithms</li>
<li><strong>Images</strong>: Large file sizes, no optimization, blocking loading</li>
</ul>
<p><strong>Q: How do you measure web performance?</strong></p>
<ul>
<li><strong>Core Web Vitals</strong>: LCP, FID, CLS</li>
<li><strong>Performance API</strong>: Navigation timing, resource timing</li>
<li><strong>Tools</strong>: Lighthouse, WebPageTest, Chrome DevTools</li>
<li><strong>Real User Monitoring</strong>: Track actual user experience</li>
</ul>
<p><strong>Q: What's the difference between throttling and debouncing?</strong></p>
<ul>
<li><strong>Throttling</strong>: Limits function execution to once per time period</li>
<li><strong>Debouncing</strong>: Delays function execution until after a quiet period</li>
<li><strong>Use cases</strong>: Throttle for scroll events, debounce for search input</li>
</ul>
<p><strong>Q: How do you optimize JavaScript bundle size?</strong></p>
<ul>
<li><strong>Tree shaking</strong>: Remove unused code</li>
<li><strong>Code splitting</strong>: Load code on demand</li>
<li><strong>Minification</strong>: Compress code</li>
<li><strong>Compression</strong>: Gzip/Brotli</li>
<li><strong>Dynamic imports</strong>: Lazy load modules</li>
</ul>
<p><strong>Q: What causes memory leaks in JavaScript?</strong></p>
<ul>
<li><strong>Global variables</strong>: Unintentional global scope pollution</li>
<li><strong>Event listeners</strong>: Not removed when elements are destroyed</li>
<li><strong>Timers</strong>: setInterval/setTimeout not cleared</li>
<li><strong>Closures</strong>: Retaining references to large objects</li>
<li><strong>DOM references</strong>: Keeping references to removed DOM nodes</li>
</ul>
<p><strong>Q: How do you optimize DOM manipulation?</strong></p>
<ul>
<li><strong>Batch updates</strong>: Use DocumentFragment</li>
<li><strong>Minimize reflows</strong>: Change styles in batches</li>
<li><strong>Use CSS transforms</strong>: For animations instead of changing layout properties</li>
<li><strong>Virtual DOM</strong>: For complex UIs</li>
<li><strong>Event delegation</strong>: Instead of multiple event listeners</li>
</ul>
<h3 id="%F0%9F%8F%A2-asked-at-companies">🏢 Asked at Companies:</h3>
<ul>
<li><strong>Google</strong>: &quot;Optimize a React component that renders 10,000 items&quot;</li>
<li><strong>Facebook</strong>: &quot;Debug and fix performance issues in a large JavaScript application&quot;</li>
<li><strong>Amazon</strong>: &quot;Design a caching strategy for a high-traffic e-commerce site&quot;</li>
<li><strong>Microsoft</strong>: &quot;Implement lazy loading for a complex dashboard&quot;</li>
<li><strong>Netflix</strong>: &quot;Optimize video streaming performance across different devices&quot;</li>
</ul>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Measure before optimizing</strong> - Use profiling tools to identify bottlenecks</li>
<li><strong>Optimize for the critical path</strong> - Focus on what affects user experience most</li>
<li><strong>Use appropriate data structures</strong> - Map for lookups, Set for unique values</li>
<li><strong>Minimize DOM manipulation</strong> - Batch updates, use virtual scrolling</li>
<li><strong>Implement proper caching</strong> - HTTP cache, memory cache, service workers</li>
<li><strong>Avoid memory leaks</strong> - Clean up event listeners, timers, and references</li>
<li><strong>Use Web Workers</strong> - For CPU-intensive tasks</li>
<li><strong>Monitor performance continuously</strong> - Set up alerts and budgets</li>
</ol>
<hr>
<p><strong>Previous Chapter</strong>: <a href="./16-testing-debugging.md">← Testing &amp; Debugging</a><br>
<strong>Next Chapter</strong>: <a href="./18-security-best-practices.md">Security Best Practices →</a></p>
<p><strong>Practice</strong>: Profile a real application, identify bottlenecks, and implement optimizations!</p>
<h1 id="chapter-18-security-best-practices-%F0%9F%94%92">Chapter 18: Security Best Practices 🔒</h1>
<h2 id="%F0%9F%93%9A-table-of-contents">📚 Table of Contents</h2>
<ul>
<li><a href="#security-fundamentals">Security Fundamentals</a></li>
<li><a href="#input-validation--sanitization">Input Validation &amp; Sanitization</a></li>
<li><a href="#cross-site-scripting-xss">Cross-Site Scripting (XSS)</a></li>
<li><a href="#cross-site-request-forgery-csrf">Cross-Site Request Forgery (CSRF)</a></li>
<li><a href="#content-security-policy-csp">Content Security Policy (CSP)</a></li>
<li><a href="#authentication--authorization">Authentication &amp; Authorization</a></li>
<li><a href="#secure-communication">Secure Communication</a></li>
<li><a href="#data-protection">Data Protection</a></li>
<li><a href="#common-pitfalls">Common Pitfalls</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
<li><a href="#interview-notes">Interview Notes</a></li>
</ul>
<hr>
<h2 id="%F0%9F%8E%AF-security-fundamentals">🎯 Security Fundamentals</h2>
<h3 id="security-principles">Security Principles</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// CIA Triad: Confidentiality, Integrity, Availability</span>

<span class="hljs-comment">// 1. Confidentiality - Protect sensitive data</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureDataHandler</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.sensitiveData = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  <span class="hljs-comment">// Never log sensitive data</span>
  processUserData(userData) {
    <span class="hljs-comment">// ❌ Don't do this</span>
    <span class="hljs-comment">// console.log('Processing user:', userData); // May contain passwords</span>

    <span class="hljs-comment">// ✅ Log safely</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Processing user:"</span>, {
      <span class="hljs-attr">id</span>: userData.id,
      <span class="hljs-attr">email</span>: userData.email.replace(<span class="hljs-regexp">/(.{2}).*(@.*)/</span>, <span class="hljs-string">"$1***$2"</span>),
    });
  }

  <span class="hljs-comment">// Store sensitive data securely</span>
  storeSensitiveData(key, value) {
    <span class="hljs-comment">// Encrypt before storing</span>
    <span class="hljs-keyword">const</span> encrypted = <span class="hljs-keyword">this</span>.encrypt(value);
    <span class="hljs-keyword">this</span>.sensitiveData.set(key, encrypted);
  }

  encrypt(data) {
    <span class="hljs-comment">// Use proper encryption (this is just an example)</span>
    <span class="hljs-keyword">return</span> btoa(<span class="hljs-built_in">JSON</span>.stringify(data));
  }
}

<span class="hljs-comment">// 2. Integrity - Ensure data hasn't been tampered with</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DataIntegrityChecker</span> </span>{
  <span class="hljs-keyword">static</span> generateHash(data) {
    <span class="hljs-comment">// Use crypto API for real hashing</span>
    <span class="hljs-keyword">return</span> crypto.subtle
      .digest(<span class="hljs-string">"SHA-256"</span>, <span class="hljs-keyword">new</span> TextEncoder().encode(data))
      .then(<span class="hljs-function">(<span class="hljs-params">hashBuffer</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> hashArray = <span class="hljs-built_in">Array</span>.from(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(hashBuffer));
        <span class="hljs-keyword">return</span> hashArray.map(<span class="hljs-function">(<span class="hljs-params">b</span>) =&gt;</span> b.toString(<span class="hljs-number">16</span>).padStart(<span class="hljs-number">2</span>, <span class="hljs-string">"0"</span>)).join(<span class="hljs-string">""</span>);
      });
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> verifyIntegrity(data, expectedHash) {
    <span class="hljs-keyword">const</span> actualHash = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.generateHash(data);
    <span class="hljs-keyword">return</span> actualHash === expectedHash;
  }
}

<span class="hljs-comment">// 3. Availability - Ensure service remains accessible</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RateLimiter</span> </span>{
  <span class="hljs-keyword">constructor</span>(maxRequests = 100, windowMs = 60000) {
    <span class="hljs-keyword">this</span>.requests = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.maxRequests = maxRequests;
    <span class="hljs-keyword">this</span>.windowMs = windowMs;
  }

  isAllowed(clientId) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-built_in">Date</span>.now();
    <span class="hljs-keyword">const</span> clientRequests = <span class="hljs-keyword">this</span>.requests.get(clientId) || [];

    <span class="hljs-comment">// Remove old requests</span>
    <span class="hljs-keyword">const</span> validRequests = clientRequests.filter(
      <span class="hljs-function">(<span class="hljs-params">timestamp</span>) =&gt;</span> now - timestamp &lt; <span class="hljs-keyword">this</span>.windowMs
    );

    <span class="hljs-keyword">if</span> (validRequests.length &gt;= <span class="hljs-keyword">this</span>.maxRequests) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    validRequests.push(now);
    <span class="hljs-keyword">this</span>.requests.set(clientId, validRequests);
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
}
</div></code></pre>
<h3 id="threat-modeling">Threat Modeling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// STRIDE Threat Model</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThreatAnalyzer</span> </span>{
  <span class="hljs-keyword">static</span> analyzeThreat(component, data) {
    <span class="hljs-keyword">const</span> threats = {
      <span class="hljs-attr">spoofing</span>: <span class="hljs-keyword">this</span>.checkSpoofing(component, data),
      <span class="hljs-attr">tampering</span>: <span class="hljs-keyword">this</span>.checkTampering(component, data),
      <span class="hljs-attr">repudiation</span>: <span class="hljs-keyword">this</span>.checkRepudiation(component, data),
      <span class="hljs-attr">informationDisclosure</span>: <span class="hljs-keyword">this</span>.checkInformationDisclosure(component, data),
      <span class="hljs-attr">denialOfService</span>: <span class="hljs-keyword">this</span>.checkDenialOfService(component, data),
      <span class="hljs-attr">elevationOfPrivilege</span>: <span class="hljs-keyword">this</span>.checkElevationOfPrivilege(component, data),
    };

    <span class="hljs-keyword">return</span> threats;
  }

  <span class="hljs-keyword">static</span> checkSpoofing(component, data) {
    <span class="hljs-comment">// Check for authentication mechanisms</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">risk</span>: component.hasAuthentication ? <span class="hljs-string">"low"</span> : <span class="hljs-string">"high"</span>,
      <span class="hljs-attr">mitigations</span>: [
        <span class="hljs-string">"Implement strong authentication"</span>,
        <span class="hljs-string">"Use multi-factor authentication"</span>,
      ],
    };
  }

  <span class="hljs-keyword">static</span> checkTampering(component, data) {
    <span class="hljs-comment">// Check for data integrity measures</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">risk</span>: component.hasIntegrityChecks ? <span class="hljs-string">"low"</span> : <span class="hljs-string">"medium"</span>,
      <span class="hljs-attr">mitigations</span>: [<span class="hljs-string">"Implement checksums"</span>, <span class="hljs-string">"Use digital signatures"</span>],
    };
  }

  <span class="hljs-comment">// ... other threat checks</span>
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%9B%A1%EF%B8%8F-input-validation--sanitization">🛡️ Input Validation &amp; Sanitization</h2>
<h3 id="input-validation">Input Validation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Comprehensive input validator</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">InputValidator</span> </span>{
  <span class="hljs-keyword">static</span> validateEmail(email) {
    <span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;

    <span class="hljs-keyword">if</span> (!email || <span class="hljs-keyword">typeof</span> email !== <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Email must be a non-empty string"</span>);
    }

    <span class="hljs-keyword">if</span> (email.length &gt; <span class="hljs-number">254</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Email too long"</span>);
    }

    <span class="hljs-keyword">if</span> (!emailRegex.test(email)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid email format"</span>);
    }

    <span class="hljs-keyword">return</span> email.toLowerCase().trim();
  }

  <span class="hljs-keyword">static</span> validatePassword(password) {
    <span class="hljs-keyword">if</span> (!password || <span class="hljs-keyword">typeof</span> password !== <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Password must be a non-empty string"</span>);
    }

    <span class="hljs-keyword">if</span> (password.length &lt; <span class="hljs-number">8</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Password must be at least 8 characters"</span>);
    }

    <span class="hljs-keyword">if</span> (password.length &gt; <span class="hljs-number">128</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Password too long"</span>);
    }

    <span class="hljs-keyword">const</span> hasUppercase = <span class="hljs-regexp">/[A-Z]/</span>.test(password);
    <span class="hljs-keyword">const</span> hasLowercase = <span class="hljs-regexp">/[a-z]/</span>.test(password);
    <span class="hljs-keyword">const</span> hasNumbers = <span class="hljs-regexp">/\d/</span>.test(password);
    <span class="hljs-keyword">const</span> hasSpecialChar = <span class="hljs-regexp">/[!@#$%^&amp;*(),.?":{}|&lt;&gt;]/</span>.test(password);

    <span class="hljs-keyword">if</span> (!hasUppercase || !hasLowercase || !hasNumbers || !hasSpecialChar) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">"Password must contain uppercase, lowercase, numbers, and special characters"</span>
      );
    }

    <span class="hljs-keyword">return</span> password;
  }

  <span class="hljs-keyword">static</span> validateUsername(username) {
    <span class="hljs-keyword">if</span> (!username || <span class="hljs-keyword">typeof</span> username !== <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Username must be a non-empty string"</span>);
    }

    <span class="hljs-keyword">const</span> trimmed = username.trim();

    <span class="hljs-keyword">if</span> (trimmed.length &lt; <span class="hljs-number">3</span> || trimmed.length &gt; <span class="hljs-number">30</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Username must be 3-30 characters"</span>);
    }

    <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z0-9_-]+$/</span>.test(trimmed)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
        <span class="hljs-string">"Username can only contain letters, numbers, underscores, and hyphens"</span>
      );
    }

    <span class="hljs-keyword">return</span> trimmed;
  }

  <span class="hljs-keyword">static</span> validateURL(url) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> parsed = <span class="hljs-keyword">new</span> URL(url);

      <span class="hljs-comment">// Only allow HTTP and HTTPS</span>
      <span class="hljs-keyword">if</span> (![<span class="hljs-string">"http:"</span>, <span class="hljs-string">"https:"</span>].includes(parsed.protocol)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Only HTTP and HTTPS URLs are allowed"</span>);
      }

      <span class="hljs-comment">// Prevent localhost and private IPs in production</span>
      <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"production"</span>) {
        <span class="hljs-keyword">const</span> hostname = parsed.hostname;
        <span class="hljs-keyword">if</span> (
          hostname === <span class="hljs-string">"localhost"</span> ||
          hostname.startsWith(<span class="hljs-string">"127."</span>) ||
          hostname.startsWith(<span class="hljs-string">"192.168."</span>) ||
          hostname.startsWith(<span class="hljs-string">"10."</span>) ||
          <span class="hljs-regexp">/^172\.(1[6-9]|2[0-9]|3[0-1])\./</span>.test(hostname)
        ) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Private IP addresses not allowed"</span>);
        }
      }

      <span class="hljs-keyword">return</span> parsed.toString();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid URL format"</span>);
    }
  }

  <span class="hljs-keyword">static</span> sanitizeHTML(input) {
    <span class="hljs-keyword">if</span> (!input || <span class="hljs-keyword">typeof</span> input !== <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    }

    <span class="hljs-comment">// Basic HTML sanitization (use DOMPurify in real applications)</span>
    <span class="hljs-keyword">return</span> input
      .replace(<span class="hljs-regexp">/&amp;/g</span>, <span class="hljs-string">"&amp;amp;"</span>)
      .replace(<span class="hljs-regexp">/&lt;/g</span>, <span class="hljs-string">"&amp;lt;"</span>)
      .replace(<span class="hljs-regexp">/&gt;/g</span>, <span class="hljs-string">"&amp;gt;"</span>)
      .replace(<span class="hljs-regexp">/"/g</span>, <span class="hljs-string">"&amp;quot;"</span>)
      .replace(<span class="hljs-regexp">/'/g</span>, <span class="hljs-string">"&amp;#x27;"</span>)
      .replace(<span class="hljs-regexp">/\//g</span>, <span class="hljs-string">"&amp;#x2F;"</span>);
  }

  <span class="hljs-keyword">static</span> validateAndSanitizeInput(input, type, options = {}) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">switch</span> (type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"email"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validateEmail(input);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"password"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validatePassword(input);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"username"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validateUsername(input);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"url"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validateURL(input);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"html"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.sanitizeHTML(input);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.validateNumber(input, options);
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Unknown validation type: <span class="hljs-subst">${type}</span>`</span>);
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Validation error for <span class="hljs-subst">${type}</span>:`</span>, error.message);
      <span class="hljs-keyword">throw</span> error;
    }
  }

  <span class="hljs-keyword">static</span> validateNumber(
    input,
    { min = -<span class="hljs-literal">Infinity</span>, max = <span class="hljs-literal">Infinity</span>, integer = <span class="hljs-literal">false</span> } = {}
  ) {
    <span class="hljs-keyword">const</span> num = <span class="hljs-built_in">Number</span>(input);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(num)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid number"</span>);
    }

    <span class="hljs-keyword">if</span> (num &lt; min || num &gt; max) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Number must be between <span class="hljs-subst">${min}</span> and <span class="hljs-subst">${max}</span>`</span>);
    }

    <span class="hljs-keyword">if</span> (integer &amp;&amp; !<span class="hljs-built_in">Number</span>.isInteger(num)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Number must be an integer"</span>);
    }

    <span class="hljs-keyword">return</span> num;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> email = InputValidator.validateEmail(<span class="hljs-string">"user@example.com"</span>);
  <span class="hljs-keyword">const</span> password = InputValidator.validatePassword(<span class="hljs-string">"SecurePass123!"</span>);
  <span class="hljs-keyword">const</span> safeHTML = InputValidator.sanitizeHTML(<span class="hljs-string">'&lt;script&gt;alert("xss")&lt;/script&gt;'</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Validation successful"</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Validation failed:"</span>, error.message);
}
</div></code></pre>
<h3 id="schema-validation">Schema Validation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Schema-based validation</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SchemaValidator</span> </span>{
  <span class="hljs-keyword">static</span> createSchema(definition) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Schema(definition);
  }

  <span class="hljs-keyword">static</span> validate(data, schema) {
    <span class="hljs-keyword">return</span> schema.validate(data);
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Schema</span> </span>{
  <span class="hljs-keyword">constructor</span>(definition) {
    <span class="hljs-keyword">this</span>.definition = definition;
  }

  validate(data) {
    <span class="hljs-keyword">const</span> errors = [];
    <span class="hljs-keyword">const</span> sanitized = {};

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [field, rules] <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.entries(<span class="hljs-keyword">this</span>.definition)) {
      <span class="hljs-keyword">try</span> {
        sanitized[field] = <span class="hljs-keyword">this</span>.validateField(data[field], rules, field);
      } <span class="hljs-keyword">catch</span> (error) {
        errors.push({ field, <span class="hljs-attr">message</span>: error.message });
      }
    }

    <span class="hljs-keyword">if</span> (errors.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> ValidationError(<span class="hljs-string">"Validation failed"</span>, errors);
    }

    <span class="hljs-keyword">return</span> sanitized;
  }

  validateField(value, rules, fieldName) {
    <span class="hljs-comment">// Required check</span>
    <span class="hljs-keyword">if</span> (
      rules.required &amp;&amp;
      (value === <span class="hljs-literal">undefined</span> || value === <span class="hljs-literal">null</span> || value === <span class="hljs-string">""</span>)
    ) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`<span class="hljs-subst">${fieldName}</span> is required`</span>);
    }

    <span class="hljs-comment">// Skip validation if value is empty and not required</span>
    <span class="hljs-keyword">if</span> (
      !rules.required &amp;&amp;
      (value === <span class="hljs-literal">undefined</span> || value === <span class="hljs-literal">null</span> || value === <span class="hljs-string">""</span>)
    ) {
      <span class="hljs-keyword">return</span> rules.default || <span class="hljs-literal">null</span>;
    }

    <span class="hljs-comment">// Type validation</span>
    <span class="hljs-keyword">if</span> (rules.type) {
      value = <span class="hljs-keyword">this</span>.validateType(value, rules.type, fieldName);
    }

    <span class="hljs-comment">// Custom validation</span>
    <span class="hljs-keyword">if</span> (rules.validate) {
      value = rules.validate(value);
    }

    <span class="hljs-keyword">return</span> value;
  }

  validateType(value, type, fieldName) {
    <span class="hljs-keyword">switch</span> (type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">"string"</span>) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`<span class="hljs-subst">${fieldName}</span> must be a string`</span>);
        }
        <span class="hljs-keyword">return</span> value;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:
        <span class="hljs-keyword">const</span> num = <span class="hljs-built_in">Number</span>(value);
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(num)) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`<span class="hljs-subst">${fieldName}</span> must be a number`</span>);
        }
        <span class="hljs-keyword">return</span> num;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"boolean"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">Boolean</span>(value);
      <span class="hljs-keyword">case</span> <span class="hljs-string">"email"</span>:
        <span class="hljs-keyword">return</span> InputValidator.validateEmail(value);
      <span class="hljs-keyword">case</span> <span class="hljs-string">"url"</span>:
        <span class="hljs-keyword">return</span> InputValidator.validateURL(value);
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> value;
    }
  }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidationError</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>{
  <span class="hljs-keyword">constructor</span>(message, errors) {
    <span class="hljs-keyword">super</span>(message);
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">"ValidationError"</span>;
    <span class="hljs-keyword">this</span>.errors = errors;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> userSchema = SchemaValidator.createSchema({
  <span class="hljs-attr">username</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">validate</span>: InputValidator.validateUsername,
  },
  <span class="hljs-attr">email</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"email"</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
  },
  <span class="hljs-attr">age</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"number"</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">validate</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span>
      InputValidator.validateNumber(value, {
        <span class="hljs-attr">min</span>: <span class="hljs-number">13</span>,
        <span class="hljs-attr">max</span>: <span class="hljs-number">120</span>,
        <span class="hljs-attr">integer</span>: <span class="hljs-literal">true</span>,
      }),
  },
  <span class="hljs-attr">website</span>: {
    <span class="hljs-attr">type</span>: <span class="hljs-string">"url"</span>,
    <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span>,
  },
});

<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> validatedUser = userSchema.validate({
    <span class="hljs-attr">username</span>: <span class="hljs-string">"john_doe"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,
    <span class="hljs-attr">website</span>: <span class="hljs-string">"https://johndoe.com"</span>,
  });
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User data validated:"</span>, validatedUser);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Validation errors:"</span>, error.errors);
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%9A%A8-cross-site-scripting-xss">🚨 Cross-Site Scripting (XSS)</h2>
<h3 id="xss-prevention">XSS Prevention</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// XSS Protection utilities</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">XSSProtection</span> </span>{
  <span class="hljs-comment">// HTML encoding</span>
  <span class="hljs-keyword">static</span> encodeHTML(str) {
    <span class="hljs-keyword">if</span> (!str) <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;

    <span class="hljs-keyword">const</span> div = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    div.textContent = str;
    <span class="hljs-keyword">return</span> div.innerHTML;
  }

  <span class="hljs-comment">// More comprehensive HTML sanitization</span>
  <span class="hljs-keyword">static</span> sanitizeHTML(
    html,
    allowedTags = [<span class="hljs-string">"b"</span>, <span class="hljs-string">"i"</span>, <span class="hljs-string">"em"</span>, <span class="hljs-string">"strong"</span>, <span class="hljs-string">"p"</span>, <span class="hljs-string">"br"</span>]
  ) {
    <span class="hljs-keyword">if</span> (!html) <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;

    <span class="hljs-comment">// Create a temporary DOM element</span>
    <span class="hljs-keyword">const</span> temp = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"div"</span>);
    temp.innerHTML = html;

    <span class="hljs-comment">// Remove all script tags</span>
    <span class="hljs-keyword">const</span> scripts = temp.querySelectorAll(<span class="hljs-string">"script"</span>);
    scripts.forEach(<span class="hljs-function">(<span class="hljs-params">script</span>) =&gt;</span> script.remove());

    <span class="hljs-comment">// Remove event handlers</span>
    <span class="hljs-keyword">const</span> allElements = temp.querySelectorAll(<span class="hljs-string">"*"</span>);
    allElements.forEach(<span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> {
      <span class="hljs-comment">// Remove all event attributes</span>
      <span class="hljs-built_in">Array</span>.from(element.attributes).forEach(<span class="hljs-function">(<span class="hljs-params">attr</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (attr.name.startsWith(<span class="hljs-string">"on"</span>)) {
          element.removeAttribute(attr.name);
        }
      });

      <span class="hljs-comment">// Remove javascript: URLs</span>
      [<span class="hljs-string">"href"</span>, <span class="hljs-string">"src"</span>, <span class="hljs-string">"action"</span>].forEach(<span class="hljs-function">(<span class="hljs-params">attr</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> value = element.getAttribute(attr);
        <span class="hljs-keyword">if</span> (value &amp;&amp; value.toLowerCase().startsWith(<span class="hljs-string">"javascript:"</span>)) {
          element.removeAttribute(attr);
        }
      });

      <span class="hljs-comment">// Remove disallowed tags</span>
      <span class="hljs-keyword">if</span> (!allowedTags.includes(element.tagName.toLowerCase())) {
        element.replaceWith(...element.childNodes);
      }
    });

    <span class="hljs-keyword">return</span> temp.innerHTML;
  }

  <span class="hljs-comment">// Safe DOM manipulation</span>
  <span class="hljs-keyword">static</span> safeSetInnerHTML(element, html) {
    element.innerHTML = <span class="hljs-keyword">this</span>.sanitizeHTML(html);
  }

  <span class="hljs-keyword">static</span> safeSetTextContent(element, text) {
    element.textContent = text; <span class="hljs-comment">// Always safe</span>
  }

  <span class="hljs-comment">// Safe URL validation</span>
  <span class="hljs-keyword">static</span> isSafeURL(url) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> parsed = <span class="hljs-keyword">new</span> URL(url);
      <span class="hljs-keyword">return</span> [<span class="hljs-string">"http:"</span>, <span class="hljs-string">"https:"</span>, <span class="hljs-string">"mailto:"</span>].includes(parsed.protocol);
    } <span class="hljs-keyword">catch</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }

  <span class="hljs-comment">// Template literal tag for safe HTML</span>
  <span class="hljs-keyword">static</span> html(strings, ...values) {
    <span class="hljs-keyword">let</span> result = strings[<span class="hljs-number">0</span>];

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; values.length; i++) {
      <span class="hljs-keyword">const</span> value = values[i];
      <span class="hljs-keyword">const</span> encodedValue =
        <span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"string"</span> ? <span class="hljs-keyword">this</span>.encodeHTML(value) : <span class="hljs-built_in">String</span>(value);
      result += encodedValue + strings[i + <span class="hljs-number">1</span>];
    }

    <span class="hljs-keyword">return</span> result;
  }
}

<span class="hljs-comment">// Safe component rendering</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SafeComponent</span> </span>{
  <span class="hljs-keyword">constructor</span>(container) {
    <span class="hljs-keyword">this</span>.container = container;
  }

  render(data) {
    <span class="hljs-comment">// ❌ Dangerous - direct innerHTML</span>
    <span class="hljs-comment">// this.container.innerHTML = `&lt;h1&gt;${data.title}&lt;/h1&gt;&lt;p&gt;${data.content}&lt;/p&gt;`;</span>

    <span class="hljs-comment">// ✅ Safe - using template tag</span>
    <span class="hljs-keyword">this</span>.container.innerHTML = XSSProtection.html<span class="hljs-string">`
            &lt;h1&gt;<span class="hljs-subst">${data.title}</span>&lt;/h1&gt;
            &lt;p&gt;<span class="hljs-subst">${data.content}</span>&lt;/p&gt;
        `</span>;
  }

  renderUserContent(userHTML) {
    <span class="hljs-comment">// ✅ Safe - sanitized HTML</span>
    <span class="hljs-keyword">const</span> safeHTML = XSSProtection.sanitizeHTML(userHTML);
    <span class="hljs-keyword">this</span>.container.innerHTML = safeHTML;
  }

  renderLink(url, text) {
    <span class="hljs-keyword">if</span> (XSSProtection.isSafeURL(url)) {
      <span class="hljs-keyword">this</span>.container.innerHTML = XSSProtection.html<span class="hljs-string">`
                &lt;a href="<span class="hljs-subst">${url}</span>"&gt;<span class="hljs-subst">${text}</span>&lt;/a&gt;
            `</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.container.textContent = text; <span class="hljs-comment">// Fallback to text</span>
    }
  }
}

<span class="hljs-comment">// Content Security Policy helper</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CSPHelper</span> </span>{
  <span class="hljs-keyword">static</span> generateNonce() {
    <span class="hljs-keyword">const</span> array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">16</span>);
    crypto.getRandomValues(array);
    <span class="hljs-keyword">return</span> btoa(<span class="hljs-built_in">String</span>.fromCharCode(...array));
  }

  <span class="hljs-keyword">static</span> createCSPHeader(options = {}) {
    <span class="hljs-keyword">const</span> nonce = <span class="hljs-keyword">this</span>.generateNonce();

    <span class="hljs-keyword">const</span> directives = {
      <span class="hljs-string">"default-src"</span>: [<span class="hljs-string">"'self'"</span>],
      <span class="hljs-string">"script-src"</span>: [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">`'nonce-<span class="hljs-subst">${nonce}</span>'`</span>],
      <span class="hljs-string">"style-src"</span>: [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"'unsafe-inline'"</span>], <span class="hljs-comment">// Consider using nonce for styles too</span>
      <span class="hljs-string">"img-src"</span>: [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"data:"</span>, <span class="hljs-string">"https:"</span>],
      <span class="hljs-string">"font-src"</span>: [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"https:"</span>],
      <span class="hljs-string">"connect-src"</span>: [<span class="hljs-string">"'self'"</span>],
      <span class="hljs-string">"frame-ancestors"</span>: [<span class="hljs-string">"'none'"</span>],
      <span class="hljs-string">"base-uri"</span>: [<span class="hljs-string">"'self'"</span>],
      <span class="hljs-string">"form-action"</span>: [<span class="hljs-string">"'self'"</span>],
      ...options,
    };

    <span class="hljs-keyword">const</span> cspString = <span class="hljs-built_in">Object</span>.entries(directives)
      .map(<span class="hljs-function">(<span class="hljs-params">[directive, sources]</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${directive}</span> <span class="hljs-subst">${sources.join(<span class="hljs-string">" "</span>)}</span>`</span>)
      .join(<span class="hljs-string">"; "</span>);

    <span class="hljs-keyword">return</span> { <span class="hljs-attr">csp</span>: cspString, nonce };
  }
}

<span class="hljs-comment">// Usage examples</span>
<span class="hljs-keyword">const</span> component = <span class="hljs-keyword">new</span> SafeComponent(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"content"</span>));

<span class="hljs-comment">// Safe rendering</span>
component.render({
  <span class="hljs-attr">title</span>: <span class="hljs-string">"User Profile"</span>,
  <span class="hljs-attr">content</span>: <span class="hljs-string">'Welcome &lt;script&gt;alert("xss")&lt;/script&gt; back!'</span>, <span class="hljs-comment">// Will be encoded</span>
});

<span class="hljs-comment">// Safe user content</span>
<span class="hljs-keyword">const</span> userHTML = <span class="hljs-string">'&lt;p&gt;Hello &lt;script&gt;alert("xss")&lt;/script&gt; world!&lt;/p&gt;'</span>;
component.renderUserContent(userHTML); <span class="hljs-comment">// Script will be removed</span>
</div></code></pre>
<h3 id="dom-based-xss-prevention">DOM-based XSS Prevention</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Secure DOM manipulation</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureDOM</span> </span>{
  <span class="hljs-keyword">static</span> createElement(tagName, attributes = {}, textContent = <span class="hljs-string">""</span>) {
    <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.createElement(tagName);

    <span class="hljs-comment">// Safely set attributes</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.entries(attributes)) {
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isSafeAttribute(key, value)) {
        element.setAttribute(key, value);
      }
    }

    <span class="hljs-comment">// Safely set text content</span>
    <span class="hljs-keyword">if</span> (textContent) {
      element.textContent = textContent;
    }

    <span class="hljs-keyword">return</span> element;
  }

  <span class="hljs-keyword">static</span> isSafeAttribute(name, value) {
    <span class="hljs-comment">// Blacklist dangerous attributes</span>
    <span class="hljs-keyword">const</span> dangerousAttributes = [
      <span class="hljs-string">"onload"</span>,
      <span class="hljs-string">"onerror"</span>,
      <span class="hljs-string">"onclick"</span>,
      <span class="hljs-string">"onmouseover"</span>,
      <span class="hljs-string">"onfocus"</span>,
      <span class="hljs-string">"onblur"</span>,
      <span class="hljs-string">"onchange"</span>,
      <span class="hljs-string">"onsubmit"</span>,
    ];

    <span class="hljs-keyword">if</span> (dangerousAttributes.includes(name.toLowerCase())) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-comment">// Check for javascript: URLs</span>
    <span class="hljs-keyword">if</span> ([<span class="hljs-string">"href"</span>, <span class="hljs-string">"src"</span>, <span class="hljs-string">"action"</span>].includes(name.toLowerCase())) {
      <span class="hljs-keyword">return</span> !<span class="hljs-built_in">String</span>(value).toLowerCase().startsWith(<span class="hljs-string">"javascript:"</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-keyword">static</span> safeAppendChild(parent, child) {
    <span class="hljs-keyword">if</span> (child <span class="hljs-keyword">instanceof</span> Node) {
      parent.appendChild(child);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// If it's a string, create a text node</span>
      parent.appendChild(<span class="hljs-built_in">document</span>.createTextNode(<span class="hljs-built_in">String</span>(child)));
    }
  }

  <span class="hljs-keyword">static</span> updateURL(newURL) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> url = <span class="hljs-keyword">new</span> URL(newURL, <span class="hljs-built_in">window</span>.location.origin);

      <span class="hljs-comment">// Only allow same-origin URLs</span>
      <span class="hljs-keyword">if</span> (url.origin === <span class="hljs-built_in">window</span>.location.origin) {
        <span class="hljs-built_in">window</span>.history.pushState({}, <span class="hljs-string">""</span>, url.pathname + url.search + url.hash);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Cross-origin URL not allowed:"</span>, newURL);
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Invalid URL:"</span>, newURL);
    }
  }
}

<span class="hljs-comment">// Secure event handling</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureEventHandler</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.handlers = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  addEventListener(element, eventType, handler, options = {}) {
    <span class="hljs-comment">// Validate event type</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isValidEventType(eventType)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Invalid event type: <span class="hljs-subst">${eventType}</span>`</span>);
    }

    <span class="hljs-comment">// Wrap handler for security</span>
    <span class="hljs-keyword">const</span> secureHandler = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Prevent default for potentially dangerous events</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isDangerousEvent(event)) {
          event.preventDefault();
          <span class="hljs-keyword">return</span>;
        }

        handler(event);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Event handler error:"</span>, error);
      }
    };

    element.addEventListener(eventType, secureHandler, options);

    <span class="hljs-comment">// Store for cleanup</span>
    <span class="hljs-keyword">const</span> key = <span class="hljs-string">`<span class="hljs-subst">${element.id || <span class="hljs-string">"anonymous"</span>}</span>-<span class="hljs-subst">${eventType}</span>`</span>;
    <span class="hljs-keyword">this</span>.handlers.set(key, { element, eventType, <span class="hljs-attr">handler</span>: secureHandler });
  }

  isValidEventType(eventType) {
    <span class="hljs-keyword">const</span> validEvents = [
      <span class="hljs-string">"click"</span>,
      <span class="hljs-string">"submit"</span>,
      <span class="hljs-string">"change"</span>,
      <span class="hljs-string">"input"</span>,
      <span class="hljs-string">"focus"</span>,
      <span class="hljs-string">"blur"</span>,
      <span class="hljs-string">"mouseenter"</span>,
      <span class="hljs-string">"mouseleave"</span>,
      <span class="hljs-string">"keydown"</span>,
      <span class="hljs-string">"keyup"</span>,
    ];
    <span class="hljs-keyword">return</span> validEvents.includes(eventType);
  }

  isDangerousEvent(event) {
    <span class="hljs-comment">// Check for suspicious event properties</span>
    <span class="hljs-keyword">if</span> (event.isTrusted === <span class="hljs-literal">false</span>) {
      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Untrusted event detected"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
  }

  removeAllListeners() {
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, { element, eventType, handler }] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.handlers) {
      element.removeEventListener(eventType, handler);
    }
    <span class="hljs-keyword">this</span>.handlers.clear();
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> secureEvents = <span class="hljs-keyword">new</span> SecureEventHandler();

<span class="hljs-comment">// Safe event binding</span>
secureEvents.addEventListener(
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"myButton"</span>),
  <span class="hljs-string">"click"</span>,
  (event) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked safely"</span>);
  }
);

<span class="hljs-comment">// Safe DOM creation</span>
<span class="hljs-keyword">const</span> safeDiv = SecureDOM.createElement(
  <span class="hljs-string">"div"</span>,
  {
    <span class="hljs-attr">class</span>: <span class="hljs-string">"user-content"</span>,
    <span class="hljs-string">"data-user-id"</span>: <span class="hljs-string">"123"</span>,
  },
  <span class="hljs-string">"This is safe text content"</span>
);

<span class="hljs-built_in">document</span>.body.appendChild(safeDiv);
</div></code></pre>
<hr>
<h2 id="%F0%9F%9B%A1%EF%B8%8F-cross-site-request-forgery-csrf">🛡️ Cross-Site Request Forgery (CSRF)</h2>
<h3 id="csrf-protection">CSRF Protection</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// CSRF Token management</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CSRFProtection</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.token = <span class="hljs-keyword">this</span>.generateToken();
    <span class="hljs-keyword">this</span>.tokenName = <span class="hljs-string">"csrf_token"</span>;
  }

  generateToken() {
    <span class="hljs-keyword">const</span> array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">32</span>);
    crypto.getRandomValues(array);
    <span class="hljs-keyword">return</span> btoa(<span class="hljs-built_in">String</span>.fromCharCode(...array));
  }

  getToken() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.token;
  }

  setTokenInForm(form) {
    <span class="hljs-comment">// Remove existing CSRF token</span>
    <span class="hljs-keyword">const</span> existingToken = form.querySelector(<span class="hljs-string">`input[name="<span class="hljs-subst">${<span class="hljs-keyword">this</span>.tokenName}</span>"]`</span>);
    <span class="hljs-keyword">if</span> (existingToken) {
      existingToken.remove();
    }

    <span class="hljs-comment">// Add new CSRF token</span>
    <span class="hljs-keyword">const</span> tokenInput = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"input"</span>);
    tokenInput.type = <span class="hljs-string">"hidden"</span>;
    tokenInput.name = <span class="hljs-keyword">this</span>.tokenName;
    tokenInput.value = <span class="hljs-keyword">this</span>.token;
    form.appendChild(tokenInput);
  }

  setTokenInHeaders(headers = {}) {
    <span class="hljs-keyword">return</span> {
      ...headers,
      <span class="hljs-string">"X-CSRF-Token"</span>: <span class="hljs-keyword">this</span>.token,
    };
  }

  validateToken(receivedToken) {
    <span class="hljs-keyword">return</span> receivedToken === <span class="hljs-keyword">this</span>.token;
  }

  refreshToken() {
    <span class="hljs-keyword">this</span>.token = <span class="hljs-keyword">this</span>.generateToken();

    <span class="hljs-comment">// Update all forms</span>
    <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"form"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">form</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.setTokenInForm(form);
    });

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.token;
  }
}

<span class="hljs-comment">// Secure API client with CSRF protection</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureAPIClient</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.csrfProtection = <span class="hljs-keyword">new</span> CSRFProtection();
    <span class="hljs-keyword">this</span>.baseURL = <span class="hljs-string">"/api"</span>;
  }

  <span class="hljs-keyword">async</span> request(endpoint, options = {}) {
    <span class="hljs-keyword">const</span> url = <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.baseURL}</span><span class="hljs-subst">${endpoint}</span>`</span>;

    <span class="hljs-keyword">const</span> defaultOptions = {
      <span class="hljs-attr">credentials</span>: <span class="hljs-string">"same-origin"</span>, <span class="hljs-comment">// Include cookies</span>
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        ...this.csrfProtection.setTokenInHeaders(),
      },
    };

    <span class="hljs-keyword">const</span> mergedOptions = {
      ...defaultOptions,
      ...options,
      <span class="hljs-attr">headers</span>: {
        ...defaultOptions.headers,
        ...options.headers,
      },
    };

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, mergedOptions);

      <span class="hljs-keyword">if</span> (response.status === <span class="hljs-number">403</span>) {
        <span class="hljs-comment">// CSRF token might be invalid, refresh it</span>
        <span class="hljs-keyword">this</span>.csrfProtection.refreshToken();
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"CSRF token invalid, please retry"</span>);
      }

      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>);
      }

      <span class="hljs-keyword">return</span> response.json();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"API request failed:"</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">get</span>(endpoint) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, { <span class="hljs-attr">method</span>: <span class="hljs-string">"GET"</span> });
  }

  <span class="hljs-keyword">async</span> post(endpoint, data) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(data),
    });
  }

  <span class="hljs-keyword">async</span> put(endpoint, data) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"PUT"</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(data),
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">delete</span>(endpoint) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, { <span class="hljs-attr">method</span>: <span class="hljs-string">"DELETE"</span> });
  }
}

<span class="hljs-comment">// Secure form handler</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureFormHandler</span> </span>{
  <span class="hljs-keyword">constructor</span>(csrfProtection) {
    <span class="hljs-keyword">this</span>.csrfProtection = csrfProtection;
    <span class="hljs-keyword">this</span>.setupFormProtection();
  }

  setupFormProtection() {
    <span class="hljs-comment">// Add CSRF tokens to all forms</span>
    <span class="hljs-built_in">document</span>.querySelectorAll(<span class="hljs-string">"form"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">form</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.protectForm(form);
    });

    <span class="hljs-comment">// Monitor for new forms</span>
    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> MutationObserver(<span class="hljs-function">(<span class="hljs-params">mutations</span>) =&gt;</span> {
      mutations.forEach(<span class="hljs-function">(<span class="hljs-params">mutation</span>) =&gt;</span> {
        mutation.addedNodes.forEach(<span class="hljs-function">(<span class="hljs-params">node</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (node.nodeType === Node.ELEMENT_NODE) {
            <span class="hljs-keyword">if</span> (node.tagName === <span class="hljs-string">"FORM"</span>) {
              <span class="hljs-keyword">this</span>.protectForm(node);
            } <span class="hljs-keyword">else</span> {
              node.querySelectorAll(<span class="hljs-string">"form"</span>).forEach(<span class="hljs-function">(<span class="hljs-params">form</span>) =&gt;</span> {
                <span class="hljs-keyword">this</span>.protectForm(form);
              });
            }
          }
        });
      });
    });

    observer.observe(<span class="hljs-built_in">document</span>.body, {
      <span class="hljs-attr">childList</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">subtree</span>: <span class="hljs-literal">true</span>,
    });
  }

  protectForm(form) {
    <span class="hljs-comment">// Skip if already protected</span>
    <span class="hljs-keyword">if</span> (form.dataset.csrfProtected) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Add CSRF token</span>
    <span class="hljs-keyword">this</span>.csrfProtection.setTokenInForm(form);

    <span class="hljs-comment">// Add submit handler for validation</span>
    form.addEventListener(<span class="hljs-string">"submit"</span>, (event) =&gt; {
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.validateFormSubmission(form)) {
        event.preventDefault();
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Form submission blocked: CSRF validation failed"</span>);
      }
    });

    <span class="hljs-comment">// Mark as protected</span>
    form.dataset.csrfProtected = <span class="hljs-string">"true"</span>;
  }

  validateFormSubmission(form) {
    <span class="hljs-keyword">const</span> tokenInput = form.querySelector(
      <span class="hljs-string">`input[name="<span class="hljs-subst">${<span class="hljs-keyword">this</span>.csrfProtection.tokenName}</span>"]`</span>
    );

    <span class="hljs-keyword">if</span> (!tokenInput) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"CSRF token missing from form"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.csrfProtection.validateToken(tokenInput.value);
  }
}

<span class="hljs-comment">// SameSite cookie helper</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureCookieManager</span> </span>{
  <span class="hljs-keyword">static</span> setCookie(name, value, options = {}) {
    <span class="hljs-keyword">const</span> defaults = {
      <span class="hljs-attr">secure</span>: <span class="hljs-built_in">window</span>.location.protocol === <span class="hljs-string">"https:"</span>,
      <span class="hljs-attr">sameSite</span>: <span class="hljs-string">"Strict"</span>,
      <span class="hljs-attr">httpOnly</span>: <span class="hljs-literal">false</span>, <span class="hljs-comment">// Can't set httpOnly from JavaScript</span>
      <span class="hljs-attr">maxAge</span>: <span class="hljs-number">86400</span>, <span class="hljs-comment">// 24 hours</span>
    };

    <span class="hljs-keyword">const</span> settings = { ...defaults, ...options };

    <span class="hljs-keyword">let</span> cookieString = <span class="hljs-string">`<span class="hljs-subst">${name}</span>=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(value)}</span>`</span>;

    <span class="hljs-keyword">if</span> (settings.maxAge) {
      cookieString += <span class="hljs-string">`; Max-Age=<span class="hljs-subst">${settings.maxAge}</span>`</span>;
    }

    <span class="hljs-keyword">if</span> (settings.secure) {
      cookieString += <span class="hljs-string">"; Secure"</span>;
    }

    <span class="hljs-keyword">if</span> (settings.sameSite) {
      cookieString += <span class="hljs-string">`; SameSite=<span class="hljs-subst">${settings.sameSite}</span>`</span>;
    }

    <span class="hljs-keyword">if</span> (settings.path) {
      cookieString += <span class="hljs-string">`; Path=<span class="hljs-subst">${settings.path}</span>`</span>;
    }

    <span class="hljs-built_in">document</span>.cookie = cookieString;
  }

  <span class="hljs-keyword">static</span> getCookie(name) {
    <span class="hljs-keyword">const</span> value = <span class="hljs-string">`; <span class="hljs-subst">${<span class="hljs-built_in">document</span>.cookie}</span>`</span>;
    <span class="hljs-keyword">const</span> parts = value.split(<span class="hljs-string">`; <span class="hljs-subst">${name}</span>=`</span>);
    <span class="hljs-keyword">if</span> (parts.length === <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">decodeURIComponent</span>(parts.pop().split(<span class="hljs-string">";"</span>).shift());
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">static</span> deleteCookie(name, path = <span class="hljs-string">"/"</span>) {
    <span class="hljs-built_in">document</span>.cookie = <span class="hljs-string">`<span class="hljs-subst">${name}</span>=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=<span class="hljs-subst">${path}</span>`</span>;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> apiClient = <span class="hljs-keyword">new</span> SecureAPIClient();
<span class="hljs-keyword">const</span> formHandler = <span class="hljs-keyword">new</span> SecureFormHandler(apiClient.csrfProtection);

<span class="hljs-comment">// Make secure API calls</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> apiClient.get(<span class="hljs-string">"/user/profile"</span>);
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User data:"</span>, userData);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to fetch user data:"</span>, error);
}

<span class="hljs-comment">// Set secure cookies</span>
SecureCookieManager.setCookie(<span class="hljs-string">"session_id"</span>, <span class="hljs-string">"abc123"</span>, {
  <span class="hljs-attr">secure</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">sameSite</span>: <span class="hljs-string">"Strict"</span>,
  <span class="hljs-attr">maxAge</span>: <span class="hljs-number">3600</span>,
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%92-content-security-policy-csp">🔒 Content Security Policy (CSP)</h2>
<h3 id="csp-implementation">CSP Implementation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// CSP policy builder</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CSPBuilder</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.directives = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.nonces = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();
  }

  addDirective(directive, sources) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.directives.has(directive)) {
      <span class="hljs-keyword">this</span>.directives.set(directive, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());
    }

    <span class="hljs-keyword">const</span> directiveSet = <span class="hljs-keyword">this</span>.directives.get(directive);
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Array</span>.isArray(sources)) {
      sources.forEach(<span class="hljs-function">(<span class="hljs-params">source</span>) =&gt;</span> directiveSet.add(source));
    } <span class="hljs-keyword">else</span> {
      directiveSet.add(sources);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  }

  generateNonce() {
    <span class="hljs-keyword">const</span> array = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">16</span>);
    crypto.getRandomValues(array);
    <span class="hljs-keyword">const</span> nonce = btoa(<span class="hljs-built_in">String</span>.fromCharCode(...array));
    <span class="hljs-keyword">this</span>.nonces.add(nonce);
    <span class="hljs-keyword">return</span> nonce;
  }

  allowInlineScript(nonce) {
    <span class="hljs-keyword">if</span> (!nonce) {
      nonce = <span class="hljs-keyword">this</span>.generateNonce();
    }

    <span class="hljs-keyword">this</span>.addDirective(<span class="hljs-string">"script-src"</span>, <span class="hljs-string">`'nonce-<span class="hljs-subst">${nonce}</span>'`</span>);
    <span class="hljs-keyword">return</span> nonce;
  }

  allowInlineStyle(nonce) {
    <span class="hljs-keyword">if</span> (!nonce) {
      nonce = <span class="hljs-keyword">this</span>.generateNonce();
    }

    <span class="hljs-keyword">this</span>.addDirective(<span class="hljs-string">"style-src"</span>, <span class="hljs-string">`'nonce-<span class="hljs-subst">${nonce}</span>'`</span>);
    <span class="hljs-keyword">return</span> nonce;
  }

  build() {
    <span class="hljs-keyword">const</span> policyParts = [];

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [directive, sources] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.directives) {
      <span class="hljs-keyword">const</span> sourceList = <span class="hljs-built_in">Array</span>.from(sources).join(<span class="hljs-string">" "</span>);
      policyParts.push(<span class="hljs-string">`<span class="hljs-subst">${directive}</span> <span class="hljs-subst">${sourceList}</span>`</span>);
    }

    <span class="hljs-keyword">return</span> policyParts.join(<span class="hljs-string">"; "</span>);
  }

  <span class="hljs-keyword">static</span> createStrictPolicy() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CSPBuilder()
      .addDirective(<span class="hljs-string">"default-src"</span>, <span class="hljs-string">"'self'"</span>)
      .addDirective(<span class="hljs-string">"script-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"'strict-dynamic'"</span>])
      .addDirective(<span class="hljs-string">"style-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"'unsafe-inline'"</span>])
      .addDirective(<span class="hljs-string">"img-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"data:"</span>, <span class="hljs-string">"https:"</span>])
      .addDirective(<span class="hljs-string">"font-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"https:"</span>])
      .addDirective(<span class="hljs-string">"connect-src"</span>, <span class="hljs-string">"'self'"</span>)
      .addDirective(<span class="hljs-string">"frame-ancestors"</span>, <span class="hljs-string">"'none'"</span>)
      .addDirective(<span class="hljs-string">"base-uri"</span>, <span class="hljs-string">"'self'"</span>)
      .addDirective(<span class="hljs-string">"form-action"</span>, <span class="hljs-string">"'self'"</span>);
  }

  <span class="hljs-keyword">static</span> createDevelopmentPolicy() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> CSPBuilder()
      .addDirective(<span class="hljs-string">"default-src"</span>, <span class="hljs-string">"'self'"</span>)
      .addDirective(<span class="hljs-string">"script-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"'unsafe-eval'"</span>, <span class="hljs-string">"localhost:*"</span>])
      .addDirective(<span class="hljs-string">"style-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"'unsafe-inline'"</span>])
      .addDirective(<span class="hljs-string">"img-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"data:"</span>, <span class="hljs-string">"https:"</span>, <span class="hljs-string">"http:"</span>])
      .addDirective(<span class="hljs-string">"connect-src"</span>, [<span class="hljs-string">"'self'"</span>, <span class="hljs-string">"ws:"</span>, <span class="hljs-string">"wss:"</span>, <span class="hljs-string">"localhost:*"</span>]);
  }
}

<span class="hljs-comment">// CSP violation reporter</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CSPViolationReporter</span> </span>{
  <span class="hljs-keyword">constructor</span>(reportEndpoint) {
    <span class="hljs-keyword">this</span>.reportEndpoint = reportEndpoint;
    <span class="hljs-keyword">this</span>.setupViolationListener();
  }

  setupViolationListener() {
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"securitypolicyviolation"</span>, (event) =&gt; {
      <span class="hljs-keyword">this</span>.handleViolation(event);
    });
  }

  handleViolation(event) {
    <span class="hljs-keyword">const</span> violation = {
      <span class="hljs-attr">documentURI</span>: event.documentURI,
      <span class="hljs-attr">referrer</span>: event.referrer,
      <span class="hljs-attr">blockedURI</span>: event.blockedURI,
      <span class="hljs-attr">violatedDirective</span>: event.violatedDirective,
      <span class="hljs-attr">effectiveDirective</span>: event.effectiveDirective,
      <span class="hljs-attr">originalPolicy</span>: event.originalPolicy,
      <span class="hljs-attr">sourceFile</span>: event.sourceFile,
      <span class="hljs-attr">lineNumber</span>: event.lineNumber,
      <span class="hljs-attr">columnNumber</span>: event.columnNumber,
      <span class="hljs-attr">statusCode</span>: event.statusCode,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      <span class="hljs-attr">userAgent</span>: navigator.userAgent,
    };

    <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"CSP Violation:"</span>, violation);

    <span class="hljs-comment">// Report to server</span>
    <span class="hljs-keyword">this</span>.reportViolation(violation);
  }

  <span class="hljs-keyword">async</span> reportViolation(violation) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> fetch(<span class="hljs-keyword">this</span>.reportEndpoint, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(violation),
      });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to report CSP violation:"</span>, error);
    }
  }
}

<span class="hljs-comment">// Secure script loader with CSP</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureScriptLoader</span> </span>{
  <span class="hljs-keyword">constructor</span>(cspBuilder) {
    <span class="hljs-keyword">this</span>.cspBuilder = cspBuilder;
  }

  loadScript(src, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);

      <span class="hljs-comment">// Generate nonce for inline scripts</span>
      <span class="hljs-keyword">if</span> (options.inline) {
        <span class="hljs-keyword">const</span> nonce = <span class="hljs-keyword">this</span>.cspBuilder.allowInlineScript();
        script.nonce = nonce;
        script.textContent = src;
      } <span class="hljs-keyword">else</span> {
        script.src = src;

        <span class="hljs-comment">// Add integrity check if provided</span>
        <span class="hljs-keyword">if</span> (options.integrity) {
          script.integrity = options.integrity;
          script.crossOrigin = <span class="hljs-string">"anonymous"</span>;
        }
      }

      script.onload = resolve;
      script.onerror = reject;

      <span class="hljs-comment">// Set other attributes</span>
      <span class="hljs-keyword">if</span> (options.async !== <span class="hljs-literal">undefined</span>) {
        script.async = options.async;
      }

      <span class="hljs-keyword">if</span> (options.defer !== <span class="hljs-literal">undefined</span>) {
        script.defer = options.defer;
      }

      <span class="hljs-built_in">document</span>.head.appendChild(script);
    });
  }

  loadStylesheet(href, options = {}) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> link = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"link"</span>);
      link.rel = <span class="hljs-string">"stylesheet"</span>;
      link.href = href;

      <span class="hljs-comment">// Add integrity check if provided</span>
      <span class="hljs-keyword">if</span> (options.integrity) {
        link.integrity = options.integrity;
        link.crossOrigin = <span class="hljs-string">"anonymous"</span>;
      }

      link.onload = resolve;
      link.onerror = reject;

      <span class="hljs-built_in">document</span>.head.appendChild(link);
    });
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> cspBuilder = CSPBuilder.createStrictPolicy();
<span class="hljs-keyword">const</span> scriptNonce = cspBuilder.allowInlineScript();
<span class="hljs-keyword">const</span> policy = cspBuilder.build();

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"CSP Policy:"</span>, policy);

<span class="hljs-comment">// Set CSP header (this would typically be done server-side)</span>
<span class="hljs-comment">// For client-side, you can use meta tag</span>
<span class="hljs-keyword">const</span> metaCSP = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"meta"</span>);
metaCSP.httpEquiv = <span class="hljs-string">"Content-Security-Policy"</span>;
metaCSP.content = policy;
<span class="hljs-built_in">document</span>.head.appendChild(metaCSP);

<span class="hljs-comment">// Setup violation reporting</span>
<span class="hljs-keyword">const</span> violationReporter = <span class="hljs-keyword">new</span> CSPViolationReporter(<span class="hljs-string">"/api/csp-violations"</span>);

<span class="hljs-comment">// Load scripts securely</span>
<span class="hljs-keyword">const</span> scriptLoader = <span class="hljs-keyword">new</span> SecureScriptLoader(cspBuilder);

<span class="hljs-comment">// Load external script with integrity</span>
scriptLoader.loadScript(<span class="hljs-string">"https://cdn.example.com/library.js"</span>, {
  <span class="hljs-attr">integrity</span>: <span class="hljs-string">"sha384-abc123..."</span>,
  <span class="hljs-attr">async</span>: <span class="hljs-literal">true</span>,
});

<span class="hljs-comment">// Load inline script with nonce</span>
scriptLoader.loadScript(<span class="hljs-string">'console.log("Safe inline script");'</span>, {
  <span class="hljs-attr">inline</span>: <span class="hljs-literal">true</span>,
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%90-authentication--authorization">🔐 Authentication &amp; Authorization</h2>
<h3 id="jwt-token-management">JWT Token Management</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Secure JWT token manager</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">JWTManager</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.tokenKey = <span class="hljs-string">"auth_token"</span>;
    <span class="hljs-keyword">this</span>.refreshTokenKey = <span class="hljs-string">"refresh_token"</span>;
  }

  <span class="hljs-comment">// Store token securely</span>
  setToken(token, refreshToken = <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Validate token format</span>
      <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isValidJWT(token)) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid JWT format"</span>);
      }

      <span class="hljs-comment">// Store in memory (most secure for access tokens)</span>
      <span class="hljs-keyword">this</span>.accessToken = token;

      <span class="hljs-comment">// Store refresh token in httpOnly cookie (server-side)</span>
      <span class="hljs-keyword">if</span> (refreshToken) {
        <span class="hljs-keyword">this</span>.refreshToken = refreshToken;
      }

      <span class="hljs-comment">// Set expiration timer</span>
      <span class="hljs-keyword">this</span>.setTokenExpirationTimer(token);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to set token:"</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }

  getToken() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.accessToken;
  }

  isValidJWT(token) {
    <span class="hljs-keyword">if</span> (!token || <span class="hljs-keyword">typeof</span> token !== <span class="hljs-string">"string"</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    <span class="hljs-keyword">const</span> parts = token.split(<span class="hljs-string">"."</span>);
    <span class="hljs-keyword">return</span> parts.length === <span class="hljs-number">3</span>;
  }

  parseJWT(token) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> parts = token.split(<span class="hljs-string">"."</span>);
      <span class="hljs-keyword">const</span> payload = <span class="hljs-built_in">JSON</span>.parse(atob(parts[<span class="hljs-number">1</span>]));
      <span class="hljs-keyword">return</span> payload;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to parse JWT:"</span>, error);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }

  isTokenExpired(token = <span class="hljs-keyword">this</span>.accessToken) {
    <span class="hljs-keyword">if</span> (!token) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">const</span> payload = <span class="hljs-keyword">this</span>.parseJWT(token);
    <span class="hljs-keyword">if</span> (!payload || !payload.exp) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">const</span> currentTime = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Date</span>.now() / <span class="hljs-number">1000</span>);
    <span class="hljs-keyword">return</span> payload.exp &lt; currentTime;
  }

  setTokenExpirationTimer(token) {
    <span class="hljs-keyword">const</span> payload = <span class="hljs-keyword">this</span>.parseJWT(token);
    <span class="hljs-keyword">if</span> (!payload || !payload.exp) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> expirationTime = payload.exp * <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">const</span> currentTime = <span class="hljs-built_in">Date</span>.now();
    <span class="hljs-keyword">const</span> timeUntilExpiration = expirationTime - currentTime;

    <span class="hljs-comment">// Refresh token 5 minutes before expiration</span>
    <span class="hljs-keyword">const</span> refreshTime = <span class="hljs-built_in">Math</span>.max(timeUntilExpiration - <span class="hljs-number">300000</span>, <span class="hljs-number">0</span>);

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.refreshTimer) {
      clearTimeout(<span class="hljs-keyword">this</span>.refreshTimer);
    }

    <span class="hljs-keyword">this</span>.refreshTimer = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">this</span>.refreshAccessToken();
    }, refreshTime);
  }

  <span class="hljs-keyword">async</span> refreshAccessToken() {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/refresh"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">credentials</span>: <span class="hljs-string">"include"</span>, <span class="hljs-comment">// Include httpOnly refresh token cookie</span>
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        },
      });

      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Token refresh failed"</span>);
      }

      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
      <span class="hljs-keyword">this</span>.setToken(data.accessToken, data.refreshToken);

      <span class="hljs-comment">// Notify listeners</span>
      <span class="hljs-keyword">this</span>.notifyTokenRefresh(data.accessToken);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Token refresh failed:"</span>, error);
      <span class="hljs-keyword">this</span>.logout();
    }
  }

  logout() {
    <span class="hljs-keyword">this</span>.accessToken = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.refreshToken = <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.refreshTimer) {
      clearTimeout(<span class="hljs-keyword">this</span>.refreshTimer);
    }

    <span class="hljs-comment">// Clear refresh token cookie</span>
    fetch(<span class="hljs-string">"/api/auth/logout"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">credentials</span>: <span class="hljs-string">"include"</span>,
    }).catch(<span class="hljs-built_in">console</span>.error);

    <span class="hljs-comment">// Redirect to login</span>
    <span class="hljs-built_in">window</span>.location.href = <span class="hljs-string">"/login"</span>;
  }

  notifyTokenRefresh(newToken) {
    <span class="hljs-comment">// Notify other tabs/windows</span>
    localStorage.setItem(<span class="hljs-string">"token_refreshed"</span>, <span class="hljs-built_in">Date</span>.now().toString());
    localStorage.removeItem(<span class="hljs-string">"token_refreshed"</span>);
  }

  <span class="hljs-comment">// Listen for token refresh in other tabs</span>
  setupCrossTabSync() {
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"storage"</span>, (event) =&gt; {
      <span class="hljs-keyword">if</span> (event.key === <span class="hljs-string">"token_refreshed"</span>) {
        <span class="hljs-comment">// Token was refreshed in another tab</span>
        <span class="hljs-keyword">this</span>.refreshAccessToken();
      }
    });
  }
}

<span class="hljs-comment">// Role-based access control</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RBACManager</span> </span>{
  <span class="hljs-keyword">constructor</span>(jwtManager) {
    <span class="hljs-keyword">this</span>.jwtManager = jwtManager;
  }

  getCurrentUser() {
    <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">this</span>.jwtManager.getToken();
    <span class="hljs-keyword">if</span> (!token) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.jwtManager.parseJWT(token);
  }

  hasRole(role) {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">this</span>.getCurrentUser();
    <span class="hljs-keyword">if</span> (!user || !user.roles) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">return</span> user.roles.includes(role);
  }

  hasPermission(permission) {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">this</span>.getCurrentUser();
    <span class="hljs-keyword">if</span> (!user || !user.permissions) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">return</span> user.permissions.includes(permission);
  }

  hasAnyRole(roles) {
    <span class="hljs-keyword">return</span> roles.some(<span class="hljs-function">(<span class="hljs-params">role</span>) =&gt;</span> <span class="hljs-keyword">this</span>.hasRole(role));
  }

  hasAllRoles(roles) {
    <span class="hljs-keyword">return</span> roles.every(<span class="hljs-function">(<span class="hljs-params">role</span>) =&gt;</span> <span class="hljs-keyword">this</span>.hasRole(role));
  }

  canAccess(resource, action = <span class="hljs-string">"read"</span>) {
    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">this</span>.getCurrentUser();
    <span class="hljs-keyword">if</span> (!user) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-comment">// Check if user is admin</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.hasRole(<span class="hljs-string">"admin"</span>)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;

    <span class="hljs-comment">// Check specific permissions</span>
    <span class="hljs-keyword">const</span> permission = <span class="hljs-string">`<span class="hljs-subst">${resource}</span>:<span class="hljs-subst">${action}</span>`</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.hasPermission(permission);
  }

  requireAuth() {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.getCurrentUser()) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Authentication required"</span>);
    }
  }

  requireRole(role) {
    <span class="hljs-keyword">this</span>.requireAuth();
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasRole(role)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Role '<span class="hljs-subst">${role}</span>' required`</span>);
    }
  }

  requirePermission(permission) {
    <span class="hljs-keyword">this</span>.requireAuth();
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.hasPermission(permission)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Permission '<span class="hljs-subst">${permission}</span>' required`</span>);
    }
  }
}

<span class="hljs-comment">// Secure API client with authentication</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthenticatedAPIClient</span> </span>{
  <span class="hljs-keyword">constructor</span>(jwtManager, rbacManager) {
    <span class="hljs-keyword">this</span>.jwtManager = jwtManager;
    <span class="hljs-keyword">this</span>.rbacManager = rbacManager;
    <span class="hljs-keyword">this</span>.baseURL = <span class="hljs-string">"/api"</span>;
  }

  <span class="hljs-keyword">async</span> request(endpoint, options = {}) {
    <span class="hljs-keyword">const</span> token = <span class="hljs-keyword">this</span>.jwtManager.getToken();

    <span class="hljs-keyword">if</span> (!token || <span class="hljs-keyword">this</span>.jwtManager.isTokenExpired()) {
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.jwtManager.refreshAccessToken();
    }

    <span class="hljs-keyword">const</span> headers = {
      <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
      <span class="hljs-attr">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-keyword">this</span>.jwtManager.getToken()}</span>`</span>,
      ...options.headers,
    };

    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.baseURL}</span><span class="hljs-subst">${endpoint}</span>`</span>, {
      ...options,
      headers,
    });

    <span class="hljs-keyword">if</span> (response.status === <span class="hljs-number">401</span>) {
      <span class="hljs-comment">// Token might be invalid, try to refresh</span>
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.jwtManager.refreshAccessToken();

      <span class="hljs-comment">// Retry with new token</span>
      headers.Authorization = <span class="hljs-string">`Bearer <span class="hljs-subst">${<span class="hljs-keyword">this</span>.jwtManager.getToken()}</span>`</span>;
      <span class="hljs-keyword">const</span> retryResponse = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-keyword">this</span>.baseURL}</span><span class="hljs-subst">${endpoint}</span>`</span>, {
        ...options,
        headers,
      });

      <span class="hljs-keyword">if</span> (retryResponse.status === <span class="hljs-number">401</span>) {
        <span class="hljs-keyword">this</span>.jwtManager.logout();
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Authentication failed"</span>);
      }

      <span class="hljs-keyword">return</span> retryResponse;
    }

    <span class="hljs-keyword">if</span> (response.status === <span class="hljs-number">403</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Access denied"</span>);
    }

    <span class="hljs-keyword">if</span> (!response.ok) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>);
    }

    <span class="hljs-keyword">return</span> response.json();
  }

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">get</span>(endpoint, requiredPermission = null) {
    <span class="hljs-keyword">if</span> (requiredPermission) {
      <span class="hljs-keyword">this</span>.rbacManager.requirePermission(requiredPermission);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, { <span class="hljs-attr">method</span>: <span class="hljs-string">"GET"</span> });
  }

  <span class="hljs-keyword">async</span> post(endpoint, data, requiredPermission = <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (requiredPermission) {
      <span class="hljs-keyword">this</span>.rbacManager.requirePermission(requiredPermission);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(data),
    });
  }

  <span class="hljs-keyword">async</span> put(endpoint, data, requiredPermission = <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (requiredPermission) {
      <span class="hljs-keyword">this</span>.rbacManager.requirePermission(requiredPermission);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"PUT"</span>,
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(data),
    });
  }

  <span class="hljs-keyword">async</span> <span class="hljs-keyword">delete</span>(endpoint, requiredPermission = <span class="hljs-literal">null</span>) {
    <span class="hljs-keyword">if</span> (requiredPermission) {
      <span class="hljs-keyword">this</span>.rbacManager.requirePermission(requiredPermission);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.request(endpoint, { <span class="hljs-attr">method</span>: <span class="hljs-string">"DELETE"</span> });
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> jwtManager = <span class="hljs-keyword">new</span> JWTManager();
<span class="hljs-keyword">const</span> rbacManager = <span class="hljs-keyword">new</span> RBACManager(jwtManager);
<span class="hljs-keyword">const</span> apiClient = <span class="hljs-keyword">new</span> AuthenticatedAPIClient(jwtManager, rbacManager);

<span class="hljs-comment">// Setup cross-tab token sync</span>
jwtManager.setupCrossTabSync();

<span class="hljs-comment">// Login</span>
<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">login</span>(<span class="hljs-params">email, password</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/login"</span>, {
      <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
      <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
      <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ email, password }),
    });

    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
    jwtManager.setToken(data.accessToken, data.refreshToken);

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Login successful"</span>);
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Login failed:"</span>, error);
  }
}

<span class="hljs-comment">// Protected API calls</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> apiClient.get(<span class="hljs-string">"/user/profile"</span>, <span class="hljs-string">"user:read"</span>);
  <span class="hljs-keyword">const</span> adminData = <span class="hljs-keyword">await</span> apiClient.get(<span class="hljs-string">"/admin/users"</span>, <span class="hljs-string">"admin:read"</span>);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"API call failed:"</span>, error);
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%90-secure-communication">🔐 Secure Communication</h2>
<h3 id="https-and-certificate-validation">HTTPS and Certificate Validation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Certificate pinning for critical requests</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureHTTPClient</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.pinnedCertificates = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.trustedDomains = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>();
  }

  addTrustedDomain(domain) {
    <span class="hljs-keyword">this</span>.trustedDomains.add(domain);
  }

  pinCertificate(domain, fingerprint) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.pinnedCertificates.has(domain)) {
      <span class="hljs-keyword">this</span>.pinnedCertificates.set(domain, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());
    }
    <span class="hljs-keyword">this</span>.pinnedCertificates.get(domain).add(fingerprint);
  }

  <span class="hljs-keyword">async</span> secureRequest(url, options = {}) {
    <span class="hljs-keyword">const</span> parsedURL = <span class="hljs-keyword">new</span> URL(url);

    <span class="hljs-comment">// Ensure HTTPS</span>
    <span class="hljs-keyword">if</span> (parsedURL.protocol !== <span class="hljs-string">"https:"</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Only HTTPS requests are allowed"</span>);
    }

    <span class="hljs-comment">// Check if domain is trusted</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.trustedDomains.has(parsedURL.hostname)) {
      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`Untrusted domain: <span class="hljs-subst">${parsedURL.hostname}</span>`</span>);
    }

    <span class="hljs-comment">// Add security headers</span>
    <span class="hljs-keyword">const</span> secureOptions = {
      ...options,
      <span class="hljs-attr">headers</span>: {
        <span class="hljs-string">"Strict-Transport-Security"</span>: <span class="hljs-string">"max-age=31536000; includeSubDomains"</span>,
        <span class="hljs-string">"X-Content-Type-Options"</span>: <span class="hljs-string">"nosniff"</span>,
        <span class="hljs-string">"X-Frame-Options"</span>: <span class="hljs-string">"DENY"</span>,
        <span class="hljs-string">"X-XSS-Protection"</span>: <span class="hljs-string">"1; mode=block"</span>,
        ...options.headers,
      },
    };

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, secureOptions);

      <span class="hljs-comment">// Validate response headers</span>
      <span class="hljs-keyword">this</span>.validateResponseHeaders(response);

      <span class="hljs-keyword">return</span> response;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Secure request failed:"</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }

  validateResponseHeaders(response) {
    <span class="hljs-keyword">const</span> requiredHeaders = [
      <span class="hljs-string">"strict-transport-security"</span>,
      <span class="hljs-string">"x-content-type-options"</span>,
      <span class="hljs-string">"x-frame-options"</span>,
    ];

    <span class="hljs-keyword">const</span> missingHeaders = requiredHeaders.filter(
      <span class="hljs-function">(<span class="hljs-params">header</span>) =&gt;</span> !response.headers.has(header)
    );

    <span class="hljs-keyword">if</span> (missingHeaders.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Missing security headers:"</span>, missingHeaders);
    }
  }

  <span class="hljs-keyword">async</span> validateCertificate(domain) {
    <span class="hljs-comment">// Note: Certificate validation is typically handled by the browser</span>
    <span class="hljs-comment">// This is a conceptual example</span>
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`https://<span class="hljs-subst">${domain}</span>`</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">"HEAD"</span> });
      <span class="hljs-keyword">return</span> response.ok;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Certificate validation failed:"</span>, error);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
}

<span class="hljs-comment">// Secure WebSocket communication</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureWebSocket</span> </span>{
  <span class="hljs-keyword">constructor</span>(url, protocols = []) {
    <span class="hljs-keyword">this</span>.url = url;
    <span class="hljs-keyword">this</span>.protocols = protocols;
    <span class="hljs-keyword">this</span>.ws = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.reconnectAttempts = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>.maxReconnectAttempts = <span class="hljs-number">5</span>;
    <span class="hljs-keyword">this</span>.reconnectDelay = <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">this</span>.messageQueue = [];
  }

  connect() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Ensure WSS (secure WebSocket)</span>
        <span class="hljs-keyword">const</span> wsURL = <span class="hljs-keyword">new</span> URL(<span class="hljs-keyword">this</span>.url);
        <span class="hljs-keyword">if</span> (wsURL.protocol !== <span class="hljs-string">"wss:"</span>) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
            <span class="hljs-string">"Only secure WebSocket connections (wss://) are allowed"</span>
          );
        }

        <span class="hljs-keyword">this</span>.ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-keyword">this</span>.url, <span class="hljs-keyword">this</span>.protocols);

        <span class="hljs-keyword">this</span>.ws.onopen = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Secure WebSocket connected"</span>);
          <span class="hljs-keyword">this</span>.reconnectAttempts = <span class="hljs-number">0</span>;

          <span class="hljs-comment">// Send queued messages</span>
          <span class="hljs-keyword">this</span>.flushMessageQueue();

          resolve(event);
        };

        <span class="hljs-keyword">this</span>.ws.onmessage = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-keyword">this</span>.handleMessage(event);
        };

        <span class="hljs-keyword">this</span>.ws.onclose = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"WebSocket closed:"</span>, event.code, event.reason);
          <span class="hljs-keyword">this</span>.handleReconnect();
        };

        <span class="hljs-keyword">this</span>.ws.onerror = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"WebSocket error:"</span>, error);
          reject(error);
        };
      } <span class="hljs-keyword">catch</span> (error) {
        reject(error);
      }
    });
  }

  handleMessage(event) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Validate message format</span>
      <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">JSON</span>.parse(event.data);

      <span class="hljs-comment">// Verify message integrity if needed</span>
      <span class="hljs-keyword">if</span> (data.signature) {
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.verifyMessageSignature(data)) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Message signature verification failed"</span>);
          <span class="hljs-keyword">return</span>;
        }
      }

      <span class="hljs-comment">// Process message</span>
      <span class="hljs-keyword">this</span>.onMessage(data);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to process WebSocket message:"</span>, error);
    }
  }

  verifyMessageSignature(data) {
    <span class="hljs-comment">// Implement message signature verification</span>
    <span class="hljs-comment">// This would typically use HMAC or digital signatures</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-comment">// Placeholder</span>
  }

  send(data) {
    <span class="hljs-keyword">const</span> message = {
      ...data,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
      <span class="hljs-attr">id</span>: <span class="hljs-keyword">this</span>.generateMessageId(),
    };

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ws &amp;&amp; <span class="hljs-keyword">this</span>.ws.readyState === WebSocket.OPEN) {
      <span class="hljs-keyword">this</span>.ws.send(<span class="hljs-built_in">JSON</span>.stringify(message));
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// Queue message for later</span>
      <span class="hljs-keyword">this</span>.messageQueue.push(message);
    }
  }

  generateMessageId() {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>);
  }

  flushMessageQueue() {
    <span class="hljs-keyword">while</span> (<span class="hljs-keyword">this</span>.messageQueue.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> message = <span class="hljs-keyword">this</span>.messageQueue.shift();
      <span class="hljs-keyword">this</span>.ws.send(<span class="hljs-built_in">JSON</span>.stringify(message));
    }
  }

  handleReconnect() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.reconnectAttempts &lt; <span class="hljs-keyword">this</span>.maxReconnectAttempts) {
      <span class="hljs-keyword">this</span>.reconnectAttempts++;
      <span class="hljs-keyword">const</span> delay =
        <span class="hljs-keyword">this</span>.reconnectDelay * <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, <span class="hljs-keyword">this</span>.reconnectAttempts - <span class="hljs-number">1</span>);

      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Reconnecting in <span class="hljs-subst">${delay}</span>ms...`</span>);

      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-keyword">this</span>.connect().catch(<span class="hljs-built_in">console</span>.error);
      }, delay);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Max reconnection attempts reached"</span>);
    }
  }

  close() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.ws) {
      <span class="hljs-keyword">this</span>.ws.close();
    }
  }

  onMessage(data) {
    <span class="hljs-comment">// Override this method to handle messages</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Received message:"</span>, data);
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> secureClient = <span class="hljs-keyword">new</span> SecureHTTPClient();
secureClient.addTrustedDomain(<span class="hljs-string">"api.example.com"</span>);
secureClient.pinCertificate(<span class="hljs-string">"api.example.com"</span>, <span class="hljs-string">"sha256-fingerprint"</span>);

<span class="hljs-comment">// Secure WebSocket</span>
<span class="hljs-keyword">const</span> secureWS = <span class="hljs-keyword">new</span> SecureWebSocket(<span class="hljs-string">"wss://api.example.com/ws"</span>);
secureWS.onMessage = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Secure message received:"</span>, data);
};

secureWS.connect().then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  secureWS.send({ <span class="hljs-attr">type</span>: <span class="hljs-string">"hello"</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Secure connection established"</span> });
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%92-data-protection">🔒 Data Protection</h2>
<h3 id="client-side-encryption">Client-Side Encryption</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Client-side encryption utilities</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ClientEncryption</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> generateKey() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> crypto.subtle.generateKey(
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-GCM"</span>,
        <span class="hljs-attr">length</span>: <span class="hljs-number">256</span>,
      },
      <span class="hljs-literal">true</span>,
      [<span class="hljs-string">"encrypt"</span>, <span class="hljs-string">"decrypt"</span>]
    );
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> encryptData(data, key) {
    <span class="hljs-keyword">const</span> encoder = <span class="hljs-keyword">new</span> TextEncoder();
    <span class="hljs-keyword">const</span> encodedData = encoder.encode(<span class="hljs-built_in">JSON</span>.stringify(data));

    <span class="hljs-keyword">const</span> iv = crypto.getRandomValues(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">12</span>));

    <span class="hljs-keyword">const</span> encryptedData = <span class="hljs-keyword">await</span> crypto.subtle.encrypt(
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-GCM"</span>,
        <span class="hljs-attr">iv</span>: iv,
      },
      key,
      encodedData
    );

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">data</span>: <span class="hljs-built_in">Array</span>.from(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(encryptedData)),
      <span class="hljs-attr">iv</span>: <span class="hljs-built_in">Array</span>.from(iv),
    };
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> decryptData(encryptedData, key) {
    <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(encryptedData.data);
    <span class="hljs-keyword">const</span> iv = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(encryptedData.iv);

    <span class="hljs-keyword">const</span> decryptedData = <span class="hljs-keyword">await</span> crypto.subtle.decrypt(
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-GCM"</span>,
        <span class="hljs-attr">iv</span>: iv,
      },
      key,
      data
    );

    <span class="hljs-keyword">const</span> decoder = <span class="hljs-keyword">new</span> TextDecoder();
    <span class="hljs-keyword">const</span> jsonString = decoder.decode(decryptedData);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(jsonString);
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> exportKey(key) {
    <span class="hljs-keyword">const</span> exported = <span class="hljs-keyword">await</span> crypto.subtle.exportKey(<span class="hljs-string">"jwk"</span>, key);
    <span class="hljs-keyword">return</span> exported;
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> importKey(keyData) {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> crypto.subtle.importKey(
      <span class="hljs-string">"jwk"</span>,
      keyData,
      {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"AES-GCM"</span>,
        <span class="hljs-attr">length</span>: <span class="hljs-number">256</span>,
      },
      <span class="hljs-literal">true</span>,
      [<span class="hljs-string">"encrypt"</span>, <span class="hljs-string">"decrypt"</span>]
    );
  }
}

<span class="hljs-comment">// Secure local storage</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureStorage</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.encryptionKey = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.initializeKey();
  }

  <span class="hljs-keyword">async</span> initializeKey() {
    <span class="hljs-comment">// Try to get existing key from secure storage</span>
    <span class="hljs-keyword">const</span> storedKey = localStorage.getItem(<span class="hljs-string">"encryption_key"</span>);

    <span class="hljs-keyword">if</span> (storedKey) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>.encryptionKey = <span class="hljs-keyword">await</span> ClientEncryption.importKey(
          <span class="hljs-built_in">JSON</span>.parse(storedKey)
        );
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to import stored key:"</span>, error);
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.generateNewKey();
      }
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.generateNewKey();
    }
  }

  <span class="hljs-keyword">async</span> generateNewKey() {
    <span class="hljs-keyword">this</span>.encryptionKey = <span class="hljs-keyword">await</span> ClientEncryption.generateKey();
    <span class="hljs-keyword">const</span> exportedKey = <span class="hljs-keyword">await</span> ClientEncryption.exportKey(<span class="hljs-keyword">this</span>.encryptionKey);
    localStorage.setItem(<span class="hljs-string">"encryption_key"</span>, <span class="hljs-built_in">JSON</span>.stringify(exportedKey));
  }

  <span class="hljs-keyword">async</span> setItem(key, value) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.encryptionKey) {
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializeKey();
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> encryptedData = <span class="hljs-keyword">await</span> ClientEncryption.encryptData(
        value,
        <span class="hljs-keyword">this</span>.encryptionKey
      );
      localStorage.setItem(key, <span class="hljs-built_in">JSON</span>.stringify(encryptedData));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to encrypt and store data:"</span>, error);
      <span class="hljs-keyword">throw</span> error;
    }
  }

  <span class="hljs-keyword">async</span> getItem(key) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.encryptionKey) {
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.initializeKey();
    }

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> storedData = localStorage.getItem(key);
      <span class="hljs-keyword">if</span> (!storedData) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">const</span> encryptedData = <span class="hljs-built_in">JSON</span>.parse(storedData);
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> ClientEncryption.decryptData(
        encryptedData,
        <span class="hljs-keyword">this</span>.encryptionKey
      );
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to decrypt stored data:"</span>, error);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }

  removeItem(key) {
    localStorage.removeItem(key);
  }

  clear() {
    localStorage.clear();
    <span class="hljs-keyword">this</span>.encryptionKey = <span class="hljs-literal">null</span>;
  }
}

<span class="hljs-comment">// Sensitive data handler</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SensitiveDataHandler</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.secureStorage = <span class="hljs-keyword">new</span> SecureStorage();
    <span class="hljs-keyword">this</span>.dataClassifications = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  classifyData(key, classification) {
    <span class="hljs-comment">// Classifications: public, internal, confidential, restricted</span>
    <span class="hljs-keyword">this</span>.dataClassifications.set(key, classification);
  }

  <span class="hljs-keyword">async</span> storeData(key, data, classification = <span class="hljs-string">"internal"</span>) {
    <span class="hljs-keyword">this</span>.classifyData(key, classification);

    <span class="hljs-keyword">switch</span> (classification) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"public"</span>:
        <span class="hljs-comment">// Store in regular localStorage</span>
        localStorage.setItem(key, <span class="hljs-built_in">JSON</span>.stringify(data));
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"internal"</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">"confidential"</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">"restricted"</span>:
        <span class="hljs-comment">// Store encrypted</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.secureStorage.setItem(key, data);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Unknown classification: <span class="hljs-subst">${classification}</span>`</span>);
    }
  }

  <span class="hljs-keyword">async</span> retrieveData(key) {
    <span class="hljs-keyword">const</span> classification = <span class="hljs-keyword">this</span>.dataClassifications.get(key) || <span class="hljs-string">"internal"</span>;

    <span class="hljs-keyword">switch</span> (classification) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"public"</span>:
        <span class="hljs-keyword">const</span> publicData = localStorage.getItem(key);
        <span class="hljs-keyword">return</span> publicData ? <span class="hljs-built_in">JSON</span>.parse(publicData) : <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"internal"</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">"confidential"</span>:
      <span class="hljs-keyword">case</span> <span class="hljs-string">"restricted"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.secureStorage.getItem(key);
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Unknown classification: <span class="hljs-subst">${classification}</span>`</span>);
    }
  }

  sanitizeForLogging(data, classification = <span class="hljs-string">"internal"</span>) {
    <span class="hljs-keyword">if</span> (classification === <span class="hljs-string">"public"</span>) {
      <span class="hljs-keyword">return</span> data;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> data === <span class="hljs-string">"object"</span> &amp;&amp; data !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">const</span> sanitized = {};
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [key, value] <span class="hljs-keyword">of</span> <span class="hljs-built_in">Object</span>.entries(data)) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isSensitiveField(key)) {
          sanitized[key] = <span class="hljs-string">"[REDACTED]"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value === <span class="hljs-string">"string"</span> &amp;&amp; value.length &gt; <span class="hljs-number">10</span>) {
          sanitized[key] =
            value.substring(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>) + <span class="hljs-string">"***"</span> + value.substring(value.length - <span class="hljs-number">3</span>);
        } <span class="hljs-keyword">else</span> {
          sanitized[key] = value;
        }
      }
      <span class="hljs-keyword">return</span> sanitized;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-string">"[REDACTED]"</span>;
  }

  isSensitiveField(fieldName) {
    <span class="hljs-keyword">const</span> sensitiveFields = [
      <span class="hljs-string">"password"</span>,
      <span class="hljs-string">"token"</span>,
      <span class="hljs-string">"secret"</span>,
      <span class="hljs-string">"key"</span>,
      <span class="hljs-string">"ssn"</span>,
      <span class="hljs-string">"credit_card"</span>,
      <span class="hljs-string">"bank_account"</span>,
      <span class="hljs-string">"api_key"</span>,
    ];

    <span class="hljs-keyword">return</span> sensitiveFields.some(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span>
      fieldName.toLowerCase().includes(field)
    );
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> dataHandler = <span class="hljs-keyword">new</span> SensitiveDataHandler();

<span class="hljs-comment">// Store different types of data</span>
<span class="hljs-keyword">await</span> dataHandler.storeData(
  <span class="hljs-string">"user_preferences"</span>,
  {
    <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
    <span class="hljs-attr">language</span>: <span class="hljs-string">"en"</span>,
  },
  <span class="hljs-string">"public"</span>
);

<span class="hljs-keyword">await</span> dataHandler.storeData(
  <span class="hljs-string">"user_profile"</span>,
  {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
    <span class="hljs-attr">api_key</span>: <span class="hljs-string">"secret123"</span>,
  },
  <span class="hljs-string">"confidential"</span>
);

<span class="hljs-comment">// Retrieve data</span>
<span class="hljs-keyword">const</span> preferences = <span class="hljs-keyword">await</span> dataHandler.retrieveData(<span class="hljs-string">"user_preferences"</span>);
<span class="hljs-keyword">const</span> profile = <span class="hljs-keyword">await</span> dataHandler.retrieveData(<span class="hljs-string">"user_profile"</span>);

<span class="hljs-comment">// Safe logging</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User preferences:"</span>, preferences); <span class="hljs-comment">// Safe to log</span>
<span class="hljs-built_in">console</span>.log(
  <span class="hljs-string">"User profile:"</span>,
  dataHandler.sanitizeForLogging(profile, <span class="hljs-string">"confidential"</span>)
);
</div></code></pre>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-trusting-client-side-data">1. <strong>Trusting Client-Side Data</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Never trust client-side validation alone</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateAge</span>(<span class="hljs-params">age</span>) </span>{
  <span class="hljs-keyword">if</span> (age &gt;= <span class="hljs-number">18</span>) {
    <span class="hljs-comment">// This can be bypassed by modifying client code</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">// ✅ Always validate on server-side too</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clientSideValidation</span>(<span class="hljs-params">age</span>) </span>{
  <span class="hljs-comment">// Client-side for UX only</span>
  <span class="hljs-keyword">return</span> age &gt;= <span class="hljs-number">18</span>;
}

<span class="hljs-comment">// Server-side validation is mandatory</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">serverSideValidation</span>(<span class="hljs-params">age</span>) </span>{
  <span class="hljs-comment">// This runs on the server and cannot be bypassed</span>
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> age === <span class="hljs-string">"number"</span> &amp;&amp; age &gt;= <span class="hljs-number">18</span>;
}
</div></code></pre>
<h3 id="2-storing-secrets-in-client-code">2. <strong>Storing Secrets in Client Code</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Never store secrets in client-side code</span>
<span class="hljs-keyword">const</span> API_SECRET = <span class="hljs-string">"secret123"</span>; <span class="hljs-comment">// Visible to anyone</span>
<span class="hljs-keyword">const</span> DATABASE_PASSWORD = <span class="hljs-string">"password"</span>; <span class="hljs-comment">// Exposed in source</span>

<span class="hljs-comment">// ✅ Use environment variables and server-side configuration</span>
<span class="hljs-keyword">const</span> API_ENDPOINT = process.env.REACT_APP_API_ENDPOINT; <span class="hljs-comment">// Public config only</span>

<span class="hljs-comment">// Secrets should be on server-side only</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureAPIClient</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-comment">// Only store public configuration</span>
    <span class="hljs-keyword">this</span>.baseURL = <span class="hljs-string">"/api"</span>; <span class="hljs-comment">// Relative URL</span>
  }

  <span class="hljs-keyword">async</span> authenticatedRequest(endpoint, options = {}) {
    <span class="hljs-comment">// Let server handle authentication</span>
    <span class="hljs-keyword">return</span> fetch(endpoint, {
      ...options,
      <span class="hljs-attr">credentials</span>: <span class="hljs-string">"include"</span>, <span class="hljs-comment">// Include httpOnly cookies</span>
    });
  }
}
</div></code></pre>
<h3 id="3-improper-error-handling">3. <strong>Improper Error Handling</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Exposing sensitive information in errors</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loginUser</span>(<span class="hljs-params">email, password</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ... authentication logic</span>
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Don't expose internal details</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Database connection failed: <span class="hljs-subst">${error.message}</span>`</span>);
  }
}

<span class="hljs-comment">// ✅ Generic error messages for security</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secureLoginUser</span>(<span class="hljs-params">email, password</span>) </span>{
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// ... authentication logic</span>
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Log detailed error server-side</span>
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Login error:"</span>, error);

    <span class="hljs-comment">// Return generic message to client</span>
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid credentials"</span>);
  }
}
</div></code></pre>
<h3 id="4-insufficient-input-validation">4. <strong>Insufficient Input Validation</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Weak validation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">processUserInput</span>(<span class="hljs-params">input</span>) </span>{
  <span class="hljs-keyword">if</span> (input.length &gt; <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> input;
  }
}

<span class="hljs-comment">// ✅ Comprehensive validation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secureProcessUserInput</span>(<span class="hljs-params">input</span>) </span>{
  <span class="hljs-comment">// Type check</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> input !== <span class="hljs-string">"string"</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Input must be a string"</span>);
  }

  <span class="hljs-comment">// Length check</span>
  <span class="hljs-keyword">if</span> (input.length === <span class="hljs-number">0</span> || input.length &gt; <span class="hljs-number">1000</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Input length must be between 1 and 1000 characters"</span>);
  }

  <span class="hljs-comment">// Content validation</span>
  <span class="hljs-keyword">const</span> sanitized = input.trim();
  <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z0-9\s\-_.,!?]+$/</span>.test(sanitized)) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Input contains invalid characters"</span>);
  }

  <span class="hljs-comment">// XSS prevention</span>
  <span class="hljs-keyword">return</span> XSSProtection.sanitizeHTML(sanitized);
}
</div></code></pre>
<h3 id="5-insecure-direct-object-references">5. <strong>Insecure Direct Object References</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Exposing internal IDs</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getUserData</span>(<span class="hljs-params">userId</span>) </span>{
  <span class="hljs-comment">// Anyone can guess user IDs</span>
  <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
}

<span class="hljs-comment">// ✅ Use authorization checks</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">secureGetUserData</span>(<span class="hljs-params">userToken</span>) </span>{
  <span class="hljs-comment">// Server validates token and returns appropriate data</span>
  <span class="hljs-keyword">return</span> fetch(<span class="hljs-string">"/api/user/profile"</span>, {
    <span class="hljs-attr">headers</span>: {
      <span class="hljs-attr">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${userToken}</span>`</span>,
    },
  });
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%8E%AF-mini-practice-problems">🎯 Mini Practice Problems</h2>
<h3 id="problem-1-secure-user-registration-form">Problem 1: Secure User Registration Form</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a secure user registration system</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureRegistration</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.validator = <span class="hljs-keyword">new</span> InputValidator();
    <span class="hljs-keyword">this</span>.csrfProtection = <span class="hljs-keyword">new</span> CSRFProtection();
  }

  <span class="hljs-keyword">async</span> registerUser(formData) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Validate all inputs</span>
      <span class="hljs-keyword">const</span> validatedData = {
        <span class="hljs-attr">username</span>: <span class="hljs-keyword">this</span>.validator.validateUsername(formData.username),
        <span class="hljs-attr">email</span>: <span class="hljs-keyword">this</span>.validator.validateEmail(formData.email),
        <span class="hljs-attr">password</span>: <span class="hljs-keyword">this</span>.validator.validatePassword(formData.password),
      };

      <span class="hljs-comment">// Check password confirmation</span>
      <span class="hljs-keyword">if</span> (formData.password !== formData.confirmPassword) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Passwords do not match"</span>);
      }

      <span class="hljs-comment">// Add CSRF protection</span>
      <span class="hljs-keyword">const</span> requestData = {
        ...validatedData,
        <span class="hljs-attr">csrf_token</span>: <span class="hljs-keyword">this</span>.csrfProtection.getToken(),
      };

      <span class="hljs-comment">// Send to server</span>
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/register"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(requestData),
      });

      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Registration failed"</span>);
      }

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.json();
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Registration error:"</span>, error.message);
      <span class="hljs-keyword">throw</span> error;
    }
  }
}
</div></code></pre>
<h3 id="problem-2-secure-file-upload">Problem 2: Secure File Upload</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Implement secure file upload with validation</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureFileUpload</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.allowedTypes = [<span class="hljs-string">"image/jpeg"</span>, <span class="hljs-string">"image/png"</span>, <span class="hljs-string">"image/gif"</span>];
    <span class="hljs-keyword">this</span>.maxFileSize = <span class="hljs-number">5</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>; <span class="hljs-comment">// 5MB</span>
  }

  validateFile(file) {
    <span class="hljs-comment">// Check file type</span>
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.allowedTypes.includes(file.type)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"File type not allowed"</span>);
    }

    <span class="hljs-comment">// Check file size</span>
    <span class="hljs-keyword">if</span> (file.size &gt; <span class="hljs-keyword">this</span>.maxFileSize) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"File too large"</span>);
    }

    <span class="hljs-comment">// Check file name</span>
    <span class="hljs-keyword">const</span> fileName = file.name;
    <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z0-9._-]+$/</span>.test(fileName)) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid file name"</span>);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }

  <span class="hljs-keyword">async</span> uploadFile(file, progressCallback) {
    <span class="hljs-keyword">this</span>.validateFile(file);

    <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData();
    formData.append(<span class="hljs-string">"file"</span>, file);
    formData.append(<span class="hljs-string">"csrf_token"</span>, csrfToken);

    <span class="hljs-keyword">const</span> xhr = <span class="hljs-keyword">new</span> XMLHttpRequest();

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
      xhr.upload.addEventListener(<span class="hljs-string">"progress"</span>, (event) =&gt; {
        <span class="hljs-keyword">if</span> (event.lengthComputable) {
          <span class="hljs-keyword">const</span> progress = (event.loaded / event.total) * <span class="hljs-number">100</span>;
          progressCallback(progress);
        }
      });

      xhr.addEventListener(<span class="hljs-string">"load"</span>, () =&gt; {
        <span class="hljs-keyword">if</span> (xhr.status === <span class="hljs-number">200</span>) {
          resolve(<span class="hljs-built_in">JSON</span>.parse(xhr.responseText));
        } <span class="hljs-keyword">else</span> {
          reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Upload failed"</span>));
        }
      });

      xhr.addEventListener(<span class="hljs-string">"error"</span>, () =&gt; {
        reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Upload error"</span>));
      });

      xhr.open(<span class="hljs-string">"POST"</span>, <span class="hljs-string">"/api/upload"</span>);
      xhr.send(formData);
    });
  }
}
</div></code></pre>
<h3 id="problem-3-secure-chat-application">Problem 3: Secure Chat Application</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Build a secure real-time chat with message encryption</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecureChat</span> </span>{
  <span class="hljs-keyword">constructor</span>(userId) {
    <span class="hljs-keyword">this</span>.userId = userId;
    <span class="hljs-keyword">this</span>.encryptionKey = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.ws = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">this</span>.messageHistory = [];
    <span class="hljs-keyword">this</span>.initializeEncryption();
  }

  <span class="hljs-keyword">async</span> initializeEncryption() {
    <span class="hljs-keyword">this</span>.encryptionKey = <span class="hljs-keyword">await</span> ClientEncryption.generateKey();
  }

  connect() {
    <span class="hljs-keyword">this</span>.ws = <span class="hljs-keyword">new</span> SecureWebSocket(<span class="hljs-string">"wss://chat.example.com/ws"</span>);

    <span class="hljs-keyword">this</span>.ws.onMessage = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.handleMessage(data);
    };

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.ws.connect();
  }

  <span class="hljs-keyword">async</span> sendMessage(text, recipientId) {
    <span class="hljs-comment">// Validate message</span>
    <span class="hljs-keyword">if</span> (!text || text.trim().length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Message cannot be empty"</span>);
    }

    <span class="hljs-keyword">if</span> (text.length &gt; <span class="hljs-number">1000</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Message too long"</span>);
    }

    <span class="hljs-comment">// Sanitize message</span>
    <span class="hljs-keyword">const</span> sanitizedText = XSSProtection.sanitizeHTML(text.trim());

    <span class="hljs-comment">// Encrypt message</span>
    <span class="hljs-keyword">const</span> encryptedMessage = <span class="hljs-keyword">await</span> ClientEncryption.encryptData(
      {
        <span class="hljs-attr">text</span>: sanitizedText,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
        <span class="hljs-attr">senderId</span>: <span class="hljs-keyword">this</span>.userId,
        <span class="hljs-attr">recipientId</span>: recipientId,
      },
      <span class="hljs-keyword">this</span>.encryptionKey
    );

    <span class="hljs-comment">// Send through WebSocket</span>
    <span class="hljs-keyword">this</span>.ws.send({
      <span class="hljs-attr">type</span>: <span class="hljs-string">"message"</span>,
      <span class="hljs-attr">data</span>: encryptedMessage,
    });
  }

  <span class="hljs-keyword">async</span> handleMessage(data) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">if</span> (data.type === <span class="hljs-string">"message"</span>) {
        <span class="hljs-comment">// Decrypt message</span>
        <span class="hljs-keyword">const</span> decryptedMessage = <span class="hljs-keyword">await</span> ClientEncryption.decryptData(
          data.data,
          <span class="hljs-keyword">this</span>.encryptionKey
        );

        <span class="hljs-comment">// Validate message structure</span>
        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isValidMessage(decryptedMessage)) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Invalid message format"</span>);
          <span class="hljs-keyword">return</span>;
        }

        <span class="hljs-comment">// Add to history</span>
        <span class="hljs-keyword">this</span>.messageHistory.push(decryptedMessage);

        <span class="hljs-comment">// Display message</span>
        <span class="hljs-keyword">this</span>.displayMessage(decryptedMessage);
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to handle message:"</span>, error);
    }
  }

  isValidMessage(message) {
    <span class="hljs-keyword">return</span> (
      message &amp;&amp;
      <span class="hljs-keyword">typeof</span> message.text === <span class="hljs-string">"string"</span> &amp;&amp;
      <span class="hljs-keyword">typeof</span> message.timestamp === <span class="hljs-string">"number"</span> &amp;&amp;
      <span class="hljs-keyword">typeof</span> message.senderId === <span class="hljs-string">"string"</span> &amp;&amp;
      <span class="hljs-keyword">typeof</span> message.recipientId === <span class="hljs-string">"string"</span>
    );
  }

  displayMessage(message) {
    <span class="hljs-keyword">const</span> messageElement = SecureDOM.createElement(<span class="hljs-string">"div"</span>, {
      <span class="hljs-attr">class</span>: <span class="hljs-string">"chat-message"</span>,
      <span class="hljs-string">"data-sender"</span>: message.senderId,
    });

    <span class="hljs-keyword">const</span> timeElement = SecureDOM.createElement(
      <span class="hljs-string">"span"</span>,
      {
        <span class="hljs-attr">class</span>: <span class="hljs-string">"message-time"</span>,
      },
      <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(message.timestamp).toLocaleTimeString()
    );

    <span class="hljs-keyword">const</span> textElement = SecureDOM.createElement(
      <span class="hljs-string">"p"</span>,
      {
        <span class="hljs-attr">class</span>: <span class="hljs-string">"message-text"</span>,
      },
      message.text
    );

    messageElement.appendChild(timeElement);
    messageElement.appendChild(textElement);

    <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"chat-messages"</span>).appendChild(messageElement);
  }
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%9D-interview-notes">📝 Interview Notes</h2>
<h3 id="common-security-questions">Common Security Questions</h3>
<p><strong>Q: What is XSS and how do you prevent it?</strong>
A: Cross-Site Scripting (XSS) is when malicious scripts are injected into web pages. Prevention includes:</p>
<ul>
<li>Input validation and sanitization</li>
<li>Output encoding</li>
<li>Content Security Policy (CSP)</li>
<li>Using textContent instead of innerHTML</li>
<li>Validating and sanitizing user-generated content</li>
</ul>
<p><strong>Q: Explain CSRF and its mitigation strategies.</strong>
A: Cross-Site Request Forgery tricks users into performing unwanted actions. Mitigation:</p>
<ul>
<li>CSRF tokens in forms</li>
<li>SameSite cookie attributes</li>
<li>Checking Referer headers</li>
<li>Double-submit cookies</li>
<li>Custom headers for AJAX requests</li>
</ul>
<p><strong>Q: How do you securely store sensitive data on the client-side?</strong>
A:</p>
<ul>
<li>Never store secrets in client-side code</li>
<li>Use encryption for sensitive data in localStorage</li>
<li>Prefer httpOnly cookies for authentication tokens</li>
<li>Implement proper key management</li>
<li>Use secure storage APIs when available</li>
</ul>
<p><strong>Q: What are the security considerations for JWT tokens?</strong>
A:</p>
<ul>
<li>Store access tokens in memory, not localStorage</li>
<li>Use httpOnly cookies for refresh tokens</li>
<li>Implement proper token expiration</li>
<li>Validate token signatures</li>
<li>Use HTTPS for token transmission</li>
<li>Implement token refresh mechanisms</li>
</ul>
<h3 id="company-specific-questions">Company-Specific Questions</h3>
<p><strong>Frontend Security (React/Vue/Angular):</strong></p>
<ul>
<li>How do you prevent XSS in component-based frameworks?</li>
<li>What are the security implications of dangerouslySetInnerHTML?</li>
<li>How do you implement secure routing and authentication?</li>
</ul>
<p><strong>API Security:</strong></p>
<ul>
<li>How do you secure API communications?</li>
<li>What is API rate limiting and how do you implement it?</li>
<li>How do you handle API authentication and authorization?</li>
</ul>
<p><strong>Performance vs Security:</strong></p>
<ul>
<li>How do you balance security measures with performance?</li>
<li>What are the trade-offs of client-side encryption?</li>
<li>How do you optimize secure communication?</li>
</ul>
<h3 id="key-takeaways">Key Takeaways</h3>
<ol>
<li><strong>Defense in Depth</strong>: Implement multiple layers of security</li>
<li><strong>Input Validation</strong>: Never trust user input, validate everything</li>
<li><strong>Principle of Least Privilege</strong>: Grant minimum necessary permissions</li>
<li><strong>Secure by Default</strong>: Make secure choices the default option</li>
<li><strong>Regular Updates</strong>: Keep dependencies and libraries updated</li>
<li><strong>Security Testing</strong>: Include security testing in your development process</li>
<li><strong>Incident Response</strong>: Have a plan for security incidents</li>
<li><strong>Education</strong>: Stay informed about latest security threats and best practices</li>
</ol>
<hr>
<p><em>Remember: Security is not a feature you add at the end—it should be built into every aspect of your application from the beginning. Always assume that attackers will find the most creative ways to exploit vulnerabilities, so be proactive in your security measures.</em></p>
<h1 id="chapter-19-modern-javascript-frameworks-%F0%9F%9A%80">Chapter 19: Modern JavaScript Frameworks 🚀</h1>
<h2 id="%F0%9F%93%9A-table-of-contents">📚 Table of Contents</h2>
<ul>
<li><a href="#framework-overview">Framework Overview</a></li>
<li><a href="#react-fundamentals">React Fundamentals</a></li>
<li><a href="#vuejs-essentials">Vue.js Essentials</a></li>
<li><a href="#angular-basics">Angular Basics</a></li>
<li><a href="#state-management">State Management</a></li>
<li><a href="#component-architecture">Component Architecture</a></li>
<li><a href="#routing--navigation">Routing &amp; Navigation</a></li>
<li><a href="#performance-optimization">Performance Optimization</a></li>
<li><a href="#common-pitfalls">Common Pitfalls</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
<li><a href="#interview-notes">Interview Notes</a></li>
</ul>
<hr>
<h2 id="%F0%9F%8E%AF-framework-overview">🎯 Framework Overview</h2>
<h3 id="why-use-frameworks">Why Use Frameworks?</h3>
<pre class="hljs"><code><div>
---

## 🧭 Routing &amp; Navigation

### React Router
```javascript
// App.js with React Router
import { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
import { useContext } from 'react';
import { UserContext } from './contexts/UserContext';

// Protected Route Component
function ProtectedRoute({ children }) {
    const { user, loading } = useContext(UserContext);

    if (loading) {
        return &lt;div&gt;Loading...&lt;/div&gt;;
    }

    return user ? children : &lt;Navigate to=&quot;/login&quot; replace /&gt;;
}

// Layout with Navigation
function Layout({ children }) {
    const { user, logout } = useContext(UserContext);

    return (
        &lt;div className=&quot;app-layout&quot;&gt;
            &lt;nav className=&quot;navbar&quot;&gt;
                &lt;Link to=&quot;/&quot; className=&quot;nav-brand&quot;&gt;MyApp&lt;/Link&gt;
                &lt;div className=&quot;nav-links&quot;&gt;
                    {user ? (
                        &lt;&gt;
                            &lt;Link to=&quot;/dashboard&quot;&gt;Dashboard&lt;/Link&gt;
                            &lt;Link to=&quot;/profile&quot;&gt;Profile&lt;/Link&gt;
                            &lt;button onClick={logout}&gt;Logout&lt;/button&gt;
                        &lt;/&gt;
                    ) : (
                        &lt;&gt;
                            &lt;Link to=&quot;/login&quot;&gt;Login&lt;/Link&gt;
                            &lt;Link to=&quot;/register&quot;&gt;Register&lt;/Link&gt;
                        &lt;/&gt;
                    )}
                &lt;/div&gt;
            &lt;/nav&gt;
            &lt;main className=&quot;main-content&quot;&gt;
                {children}
            &lt;/main&gt;
        &lt;/div&gt;
    );
}

function App() {
    return (
        &lt;UserProvider&gt;
            &lt;Router&gt;
                &lt;Layout&gt;
                    &lt;Routes&gt;
                        &lt;Route path=&quot;/&quot; element={&lt;Home /&gt;} /&gt;
                        &lt;Route path=&quot;/login&quot; element={&lt;Login /&gt;} /&gt;
                        &lt;Route path=&quot;/register&quot; element={&lt;Register /&gt;} /&gt;
                        &lt;Route
                            path=&quot;/dashboard&quot;
                            element={
                                &lt;ProtectedRoute&gt;
                                    &lt;Dashboard /&gt;
                                &lt;/ProtectedRoute&gt;
                            }
                        /&gt;
                        &lt;Route
                            path=&quot;/profile&quot;
                            element={
                                &lt;ProtectedRoute&gt;
                                    &lt;Profile /&gt;
                                &lt;/ProtectedRoute&gt;
                            }
                        /&gt;
                        &lt;Route path=&quot;/users/:id&quot; element={&lt;UserDetail /&gt;} /&gt;
                        &lt;Route path=&quot;*&quot; element={&lt;NotFound /&gt;} /&gt;
                    &lt;/Routes&gt;
                &lt;/Layout&gt;
            &lt;/Router&gt;
        &lt;/UserProvider&gt;
    );
}

// Component with URL parameters and navigation
function UserDetail() {
    const { id } = useParams();
    const navigate = useNavigate();
    const location = useLocation();
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);

    useEffect(() =&gt; {
        fetchUser(id);
    }, [id]);

    const fetchUser = async (userId) =&gt; {
        try {
            setLoading(true);
            const response = await fetch(`/api/users/${userId}`);
            if (response.ok) {
                const userData = await response.json();
                setUser(userData);
            } else {
                navigate('/404', { replace: true });
            }
        } catch (error) {
            console.error('Error fetching user:', error);
            navigate('/error', { state: { error: error.message } });
        } finally {
            setLoading(false);
        }
    };

    const handleEdit = () =&gt; {
        navigate(`/users/${id}/edit`, {
            state: { from: location.pathname }
        });
    };

    if (loading) return &lt;div&gt;Loading user...&lt;/div&gt;;
    if (!user) return &lt;div&gt;User not found&lt;/div&gt;;

    return (
        &lt;div className=&quot;user-detail&quot;&gt;
            &lt;button onClick={() =&gt; navigate(-1)}&gt;← Back&lt;/button&gt;
            &lt;h1&gt;{user.name}&lt;/h1&gt;
            &lt;p&gt;{user.email}&lt;/p&gt;
            &lt;button onClick={handleEdit}&gt;Edit User&lt;/button&gt;
        &lt;/div&gt;
    );
}
</div></code></pre>
<h3 id="vue-router">Vue Router</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// router/index.js</span>
<span class="hljs-keyword">import</span> { createRouter, createWebHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;
<span class="hljs-keyword">import</span> { useUserStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'../stores/user'</span>;

<span class="hljs-keyword">const</span> routes = [
    {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'Home'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/Home.vue'</span>)
    },
    {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/login'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'Login'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/Login.vue'</span>),
        <span class="hljs-attr">meta</span>: { <span class="hljs-attr">requiresGuest</span>: <span class="hljs-literal">true</span> }
    },
    {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/dashboard'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'Dashboard'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/Dashboard.vue'</span>),
        <span class="hljs-attr">meta</span>: { <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span> }
    },
    {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/users/:id'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'UserDetail'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/UserDetail.vue'</span>),
        <span class="hljs-attr">props</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">meta</span>: { <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span> }
    },
    {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/users/:id/edit'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'UserEdit'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/UserEdit.vue'</span>),
        <span class="hljs-attr">props</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">meta</span>: { <span class="hljs-attr">requiresAuth</span>: <span class="hljs-literal">true</span> }
    },
    {
        <span class="hljs-attr">path</span>: <span class="hljs-string">'/:pathMatch(.*)*'</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">'NotFound'</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">'../views/NotFound.vue'</span>)
    }
];

<span class="hljs-keyword">const</span> router = createRouter({
    <span class="hljs-attr">history</span>: createWebHistory(),
    routes
});

<span class="hljs-comment">// Navigation guards</span>
router.beforeEach(<span class="hljs-function">(<span class="hljs-params">to, <span class="hljs-keyword">from</span>, next</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> userStore = useUserStore();

    <span class="hljs-keyword">if</span> (to.meta.requiresAuth &amp;&amp; !userStore.isAuthenticated) {
        next({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Login'</span>, <span class="hljs-attr">query</span>: { <span class="hljs-attr">redirect</span>: to.fullPath } });
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (to.meta.requiresGuest &amp;&amp; userStore.isAuthenticated) {
        next({ <span class="hljs-attr">name</span>: <span class="hljs-string">'Dashboard'</span> });
    } <span class="hljs-keyword">else</span> {
        next();
    }
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> router;

<span class="hljs-comment">// UserDetail.vue</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-detail"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">"$router.go(-1)"</span>&gt;</span>← Back<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">"loading"</span>&gt;</span>Loading user...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">"error"</span>&gt;</span>Error: {{ error }}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">v-else-if</span>=<span class="hljs-string">"user"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{{ user.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ user.email }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">router-link</span> <span class="hljs-attr">:to</span>=<span class="hljs-string">"`/users/${user.id}/edit`"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn"</span>&gt;</span>
                Edit User
            <span class="hljs-tag">&lt;/<span class="hljs-name">router-link</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span>

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
<span class="hljs-keyword">import</span> { ref, onMounted, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;
<span class="hljs-keyword">import</span> { useRoute, useRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue-router'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'UserDetail'</span>,
    <span class="hljs-attr">props</span>: {
        <span class="hljs-attr">id</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>
        }
    },
    setup(props) {
        <span class="hljs-keyword">const</span> route = useRoute();
        <span class="hljs-keyword">const</span> router = useRouter();
        <span class="hljs-keyword">const</span> user = ref(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">const</span> loading = ref(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">const</span> error = ref(<span class="hljs-literal">null</span>);

        <span class="hljs-keyword">const</span> fetchUser = <span class="hljs-keyword">async</span> (userId) =&gt; {
            <span class="hljs-keyword">try</span> {
                loading.value = <span class="hljs-literal">true</span>;
                error.value = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
                <span class="hljs-keyword">if</span> (response.ok) {
                    user.value = <span class="hljs-keyword">await</span> response.json();
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'User not found'</span>);
                }
            } <span class="hljs-keyword">catch</span> (err) {
                error.value = err.message;
            } <span class="hljs-keyword">finally</span> {
                loading.value = <span class="hljs-literal">false</span>;
            }
        };

        <span class="hljs-comment">// Watch for route parameter changes</span>
        watch(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> props.id, (newId) =&gt; {
            <span class="hljs-keyword">if</span> (newId) {
                fetchUser(newId);
            }
        }, { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> });

        <span class="hljs-keyword">return</span> {
            user,
            loading,
            error
        };
    }
};
</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span>
</div></code></pre>
<h3 id="angular-routing">Angular Routing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// app-routing.module.ts</span>
<span class="hljs-keyword">import</span> { NgModule } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/core"</span>;
<span class="hljs-keyword">import</span> { RouterModule, Routes } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/router"</span>;
<span class="hljs-keyword">import</span> { AuthGuard } <span class="hljs-keyword">from</span> <span class="hljs-string">"./guards/auth.guard"</span>;
<span class="hljs-keyword">import</span> { GuestGuard } <span class="hljs-keyword">from</span> <span class="hljs-string">"./guards/guest.guard"</span>;

<span class="hljs-keyword">const</span> routes: Routes = [
  { path: <span class="hljs-string">""</span>, component: HomeComponent },
  {
    path: <span class="hljs-string">"login"</span>,
    component: LoginComponent,
    canActivate: [GuestGuard],
  },
  {
    path: <span class="hljs-string">"dashboard"</span>,
    component: DashboardComponent,
    canActivate: [AuthGuard],
  },
  {
    path: <span class="hljs-string">"users/:id"</span>,
    component: UserDetailComponent,
    canActivate: [AuthGuard],
  },
  {
    path: <span class="hljs-string">"users/:id/edit"</span>,
    component: UserEditComponent,
    canActivate: [AuthGuard],
  },
  { path: <span class="hljs-string">"**"</span>, component: NotFoundComponent },
];

<span class="hljs-meta">@NgModule</span>({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> AppRoutingModule {}

<span class="hljs-comment">// auth.guard.ts</span>
<span class="hljs-keyword">import</span> { Injectable } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/core"</span>;
<span class="hljs-keyword">import</span> { CanActivate, Router } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/router"</span>;
<span class="hljs-keyword">import</span> { UserService } <span class="hljs-keyword">from</span> <span class="hljs-string">"../services/user.service"</span>;

<span class="hljs-meta">@Injectable</span>({
  providedIn: <span class="hljs-string">"root"</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> AuthGuard <span class="hljs-keyword">implements</span> CanActivate {
  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userService: UserService, <span class="hljs-keyword">private</span> router: Router</span>) {}

  canActivate(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.userService.isAuthenticated()) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.router.navigate([<span class="hljs-string">"/login"</span>]);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }
  }
}

<span class="hljs-comment">// user-detail.component.ts</span>
<span class="hljs-keyword">import</span> { Component, OnInit, OnDestroy } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/core"</span>;
<span class="hljs-keyword">import</span> { ActivatedRoute, Router } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/router"</span>;
<span class="hljs-keyword">import</span> { Subject } <span class="hljs-keyword">from</span> <span class="hljs-string">"rxjs"</span>;
<span class="hljs-keyword">import</span> { takeUntil } <span class="hljs-keyword">from</span> <span class="hljs-string">"rxjs/operators"</span>;

<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">"app-user-detail"</span>,
  template: <span class="hljs-string">`
    &lt;div class="user-detail"&gt;
      &lt;button (click)="goBack()"&gt;← Back&lt;/button&gt;

      &lt;div *ngIf="loading"&gt;Loading user...&lt;/div&gt;
      &lt;div *ngIf="error"&gt;Error: {{ error }}&lt;/div&gt;
      &lt;div *ngIf="user"&gt;
        &lt;h1&gt;{{ user.name }}&lt;/h1&gt;
        &lt;p&gt;{{ user.email }}&lt;/p&gt;
        &lt;button [routerLink]="['/users', user.id, 'edit']"&gt;Edit User&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  `</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserDetailComponent <span class="hljs-keyword">implements</span> OnInit, OnDestroy {
  user: <span class="hljs-built_in">any</span> = <span class="hljs-literal">null</span>;
  loading = <span class="hljs-literal">false</span>;
  error: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">private</span> destroy$ = <span class="hljs-keyword">new</span> Subject&lt;<span class="hljs-built_in">void</span>&gt;();

  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> route: ActivatedRoute, <span class="hljs-keyword">private</span> router: Router</span>) {}

  ngOnInit(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.route.params.pipe(takeUntil(<span class="hljs-keyword">this</span>.destroy$)).subscribe(<span class="hljs-function">(<span class="hljs-params">params</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> userId = params[<span class="hljs-string">"id"</span>];
      <span class="hljs-keyword">if</span> (userId) {
        <span class="hljs-keyword">this</span>.fetchUser(userId);
      }
    });
  }

  ngOnDestroy(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.destroy$.next();
    <span class="hljs-keyword">this</span>.destroy$.complete();
  }

  <span class="hljs-keyword">private</span> <span class="hljs-keyword">async</span> fetchUser(userId: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">Promise</span>&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">this</span>.loading = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.error = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
      <span class="hljs-keyword">if</span> (response.ok) {
        <span class="hljs-keyword">this</span>.user = <span class="hljs-keyword">await</span> response.json();
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"User not found"</span>);
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">this</span>.error = error.message;
    } <span class="hljs-keyword">finally</span> {
      <span class="hljs-keyword">this</span>.loading = <span class="hljs-literal">false</span>;
    }
  }

  goBack(): <span class="hljs-built_in">void</span> {
    <span class="hljs-built_in">window</span>.history.back();
  }
}
</div></code></pre>
<hr>
<h2 id="%E2%9A%A1-performance-optimization">⚡ Performance Optimization</h2>
<h3 id="react-performance">React Performance</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. React.memo for component memoization</span>
<span class="hljs-keyword">const</span> UserCard = React.memo(
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserCard</span>(<span class="hljs-params">{ user, onEdit, onDelete }</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"UserCard rendered for:"</span>, user.name);

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-card"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{user.avatar}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{user.name}</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-actions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onEdit(user.id)}&gt;Edit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onDelete(user.id)}&gt;Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  },
  (prevProps, nextProps) =&gt; {
    <span class="hljs-comment">// Custom comparison function</span>
    <span class="hljs-keyword">return</span> (
      prevProps.user.id === nextProps.user.id &amp;&amp;
      prevProps.user.name === nextProps.user.name &amp;&amp;
      prevProps.user.email === nextProps.user.email &amp;&amp;
      prevProps.user.avatar === nextProps.user.avatar
    );
  }
);

<span class="hljs-comment">// 2. useMemo and useCallback</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserList</span>(<span class="hljs-params">{ users, searchTerm, sortBy }</span>) </span>{
  <span class="hljs-comment">// Memoize expensive calculations</span>
  <span class="hljs-keyword">const</span> filteredAndSortedUsers = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Filtering and sorting users"</span>);

    <span class="hljs-keyword">let</span> filtered = users.filter(
      <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span>
        user.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
        user.email.toLowerCase().includes(searchTerm.toLowerCase())
    );

    <span class="hljs-keyword">return</span> filtered.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">switch</span> (sortBy) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"name"</span>:
          <span class="hljs-keyword">return</span> a.name.localeCompare(b.name);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"email"</span>:
          <span class="hljs-keyword">return</span> a.email.localeCompare(b.email);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"date"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(b.createdAt) - <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(a.createdAt);
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
    });
  }, [users, searchTerm, sortBy]);

  <span class="hljs-comment">// Memoize callback functions</span>
  <span class="hljs-keyword">const</span> handleEdit = useCallback(<span class="hljs-function">(<span class="hljs-params">userId</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Edit user:"</span>, userId);
    <span class="hljs-comment">// Edit logic here</span>
  }, []);

  <span class="hljs-keyword">const</span> handleDelete = useCallback(<span class="hljs-function">(<span class="hljs-params">userId</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Delete user:"</span>, userId);
    <span class="hljs-comment">// Delete logic here</span>
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-list"</span>&gt;</span>
      {filteredAndSortedUsers.map((user) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>
          <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span>
          <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{handleEdit}</span>
          <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{handleDelete}</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 3. Virtual scrolling for large lists</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">VirtualizedUserList</span>(<span class="hljs-params">{ users }</span>) </span>{
  <span class="hljs-keyword">const</span> [visibleRange, setVisibleRange] = useState({ <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">end</span>: <span class="hljs-number">20</span> });
  <span class="hljs-keyword">const</span> containerRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> itemHeight = <span class="hljs-number">100</span>;
  <span class="hljs-keyword">const</span> containerHeight = <span class="hljs-number">600</span>;
  <span class="hljs-keyword">const</span> visibleCount = <span class="hljs-built_in">Math</span>.ceil(containerHeight / itemHeight);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> container = containerRef.current;
    <span class="hljs-keyword">if</span> (!container) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> handleScroll = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> scrollTop = container.scrollTop;
      <span class="hljs-keyword">const</span> start = <span class="hljs-built_in">Math</span>.floor(scrollTop / itemHeight);
      <span class="hljs-keyword">const</span> end = <span class="hljs-built_in">Math</span>.min(start + visibleCount + <span class="hljs-number">5</span>, users.length);

      setVisibleRange({ start, end });
    };

    container.addEventListener(<span class="hljs-string">"scroll"</span>, handleScroll);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> container.removeEventListener(<span class="hljs-string">"scroll"</span>, handleScroll);
  }, [users.length, itemHeight, visibleCount]);

  <span class="hljs-keyword">const</span> visibleUsers = users.slice(visibleRange.start, visibleRange.end);
  <span class="hljs-keyword">const</span> totalHeight = users.length * itemHeight;
  <span class="hljs-keyword">const</span> offsetY = visibleRange.start * itemHeight;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">ref</span>=<span class="hljs-string">{containerRef}</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">"virtual-list-container"</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">containerHeight</span>, <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>" }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">totalHeight</span>, <span class="hljs-attr">position:</span> "<span class="hljs-attr">relative</span>" }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">transform:</span> `<span class="hljs-attr">translateY</span>(${<span class="hljs-attr">offsetY</span>}<span class="hljs-attr">px</span>)`,
            <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
            <span class="hljs-attr">top:</span> <span class="hljs-attr">0</span>,
            <span class="hljs-attr">left:</span> <span class="hljs-attr">0</span>,
            <span class="hljs-attr">right:</span> <span class="hljs-attr">0</span>,
          }}
        &gt;</span>
          {visibleUsers.map((user, index) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
              <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>
              <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">itemHeight</span> }}
              <span class="hljs-attr">className</span>=<span class="hljs-string">"virtual-list-item"</span>
            &gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 4. Code splitting with React.lazy</span>
<span class="hljs-keyword">const</span> Dashboard = React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./components/Dashboard"</span>));
<span class="hljs-keyword">const</span> UserProfile = React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./components/UserProfile"</span>));
<span class="hljs-keyword">const</span> Settings = React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./components/Settings"</span>));

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/dashboard"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Dashboard</span> /&gt;</span>} /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/profile"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">UserProfile</span> /&gt;</span>} /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/settings"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Settings</span> /&gt;</span>} /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 5. Error boundaries</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> };
  }

  <span class="hljs-keyword">static</span> getDerivedStateFromError(error) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span>, error };
  }

  componentDidCatch(error, errorInfo) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error caught by boundary:"</span>, error, errorInfo);
    <span class="hljs-comment">// Log to error reporting service</span>
  }

  render() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.state.hasError) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-boundary"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Something went wrong<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{this.state.error?.message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> this.setState({ hasError: false, error: null })}
          &gt;
            Try again
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      );
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.props.children;
  }
}
</div></code></pre>
<h3 id="vue-performance">Vue Performance</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. v-memo directive for expensive renders</span>
&lt;template&gt;
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"user-list"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">v-for</span>=<span class="hljs-string">"user in users"</span>
            <span class="hljs-attr">:key</span>=<span class="hljs-string">"user.id"</span>
            <span class="hljs-attr">v-memo</span>=<span class="hljs-string">"[user.id, user.name, user.email]"</span>
            <span class="hljs-attr">class</span>=<span class="hljs-string">"user-card"</span>
        &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">"user.avatar"</span> <span class="hljs-attr">:alt</span>=<span class="hljs-string">"user.name"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{{ user.name }}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{{ user.email }}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
&lt;<span class="hljs-regexp">/template&gt;

/</span><span class="hljs-regexp">/ 2. Computed properties for expensive operations
export default {
    setup() {
        const users = ref([]);
        const searchTerm = ref('');
        const sortBy = ref('name');

        /</span><span class="hljs-regexp">/ Computed property automatically memoizes
        const filteredUsers = computed(() =&gt; {
            console.log('Filtering users');
            return users.value.filter(user =&gt;
                user.name.toLowerCase().includes(searchTerm.value.toLowerCase())
            );
        });

        const sortedUsers = computed(() =&gt; {
            console.log('Sorting users');
            return [...filteredUsers.value].sort((a, b) =&gt; {
                switch (sortBy.value) {
                    case 'name':
                        return a.name.localeCompare(b.name);
                    case 'email':
                        return a.email.localeCompare(b.email);
                    default:
                        return 0;
                }
            });
        });

        return {
            users,
            searchTerm,
            sortBy,
            sortedUsers
        };
    }
};

/</span><span class="hljs-regexp">/ 3. Async components
const AsyncDashboard = defineAsyncComponent({
    loader: () =&gt; import('./</span>Dashboard.vue<span class="hljs-string">'),
    loadingComponent: LoadingSpinner,
    errorComponent: ErrorComponent,
    delay: 200,
    timeout: 3000
});

// 4. Virtual scrolling with vue-virtual-scroller
&lt;template&gt;
    &lt;RecycleScroller
        class="scroller"
        :items="users"
        :item-size="100"
        key-field="id"
        v-slot="{ item }"
    &gt;
        &lt;UserCard :user="item" /&gt;
    &lt;/RecycleScroller&gt;
&lt;/template&gt;

&lt;script&gt;
import { RecycleScroller } from '</span>vue-virtual-scroller<span class="hljs-string">';
import UserCard from '</span>./UserCard.vue<span class="hljs-string">';

export default {
    components: {
        RecycleScroller,
        UserCard
    },
    props: {
        users: {
            type: Array,
            required: true
        }
    }
};
&lt;/script&gt;
</span></div></code></pre>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="react-pitfalls">React Pitfalls</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ BAD: Mutating state directly</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([]);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    <span class="hljs-comment">// DON'T DO THIS - mutates state</span>
    todos.push({ <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(), text });
    setTodos(todos);
  };

  <span class="hljs-keyword">const</span> toggleTodo = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-comment">// DON'T DO THIS - mutates state</span>
    <span class="hljs-keyword">const</span> todo = todos.find(<span class="hljs-function">(<span class="hljs-params">t</span>) =&gt;</span> t.id === id);
    todo.completed = !todo.completed;
    setTodos(todos);
  };
}

<span class="hljs-comment">// ✅ GOOD: Creating new state objects</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([]);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prevTodos</span>) =&gt;</span> [
      ...prevTodos,
      { <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(), text, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    ]);
  };

  <span class="hljs-keyword">const</span> toggleTodo = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prevTodos</span>) =&gt;</span>
      prevTodos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
        todo.id === id ? { ...todo, <span class="hljs-attr">completed</span>: !todo.completed } : todo
      )
    );
  };
}

<span class="hljs-comment">// ❌ BAD: Missing dependencies in useEffect</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ userId }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetchUser(userId).then(setUser);
  }, []); <span class="hljs-comment">// Missing userId dependency!</span>
}

<span class="hljs-comment">// ✅ GOOD: Including all dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ userId }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetchUser(userId).then(setUser);
  }, [userId]); <span class="hljs-comment">// Include userId dependency</span>
}

<span class="hljs-comment">// ❌ BAD: Creating objects/functions in render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserList</span>(<span class="hljs-params">{ users }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {users.map((user) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>
          <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span>
          <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{()</span> =&gt;</span> editUser(user.id)} // New function every render
          style={{ margin: 10 }} // New object every render
        /&gt;
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ GOOD: Memoizing callbacks and objects</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserList</span>(<span class="hljs-params">{ users }</span>) </span>{
  <span class="hljs-keyword">const</span> handleEdit = useCallback(<span class="hljs-function">(<span class="hljs-params">userId</span>) =&gt;</span> {
    editUser(userId);
  }, []);

  <span class="hljs-keyword">const</span> cardStyle = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ <span class="hljs-attr">margin</span>: <span class="hljs-number">10</span> }), []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {users.map((user) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>
          <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span>
          <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{handleEdit}</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{cardStyle}</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ❌ BAD: Not cleaning up subscriptions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChatComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [messages, setMessages] = useState([]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> socket = io();
    socket.on(<span class="hljs-string">"message"</span>, (message) =&gt; {
      setMessages(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, message]);
    });
    <span class="hljs-comment">// Missing cleanup!</span>
  }, []);
}

<span class="hljs-comment">// ✅ GOOD: Cleaning up subscriptions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChatComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [messages, setMessages] = useState([]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> socket = io();
    socket.on(<span class="hljs-string">"message"</span>, (message) =&gt; {
      setMessages(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, message]);
    });

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      socket.disconnect();
    };
  }, []);
}
</div></code></pre>
<h3 id="vue-pitfalls">Vue Pitfalls</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ BAD: Mutating props</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">props</span>: [<span class="hljs-string">'user'</span>],
    setup(props) {
        <span class="hljs-keyword">const</span> updateUser = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-comment">// DON'T DO THIS - mutates prop</span>
            props.user.name = <span class="hljs-string">'New Name'</span>;
        };
    }
};

<span class="hljs-comment">// ✅ GOOD: Emitting events to parent</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">props</span>: [<span class="hljs-string">'user'</span>],
    <span class="hljs-attr">emits</span>: [<span class="hljs-string">'update-user'</span>],
    setup(props, { emit }) {
        <span class="hljs-keyword">const</span> updateUser = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            emit(<span class="hljs-string">'update-user'</span>, { ...props.user, <span class="hljs-attr">name</span>: <span class="hljs-string">'New Name'</span> });
        };
    }
};

<span class="hljs-comment">// ❌ BAD: Not using reactive properly</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    setup() {
        <span class="hljs-keyword">let</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> }; <span class="hljs-comment">// Not reactive</span>

        <span class="hljs-keyword">const</span> updateAge = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            user.age++; <span class="hljs-comment">// Won't trigger reactivity</span>
        };

        <span class="hljs-keyword">return</span> { user, updateAge };
    }
};

<span class="hljs-comment">// ✅ GOOD: Using reactive/ref properly</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    setup() {
        <span class="hljs-keyword">const</span> user = reactive({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });
        <span class="hljs-comment">// OR</span>
        <span class="hljs-keyword">const</span> user = ref({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });

        <span class="hljs-keyword">const</span> updateAge = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            user.age++; <span class="hljs-comment">// Will trigger reactivity</span>
            <span class="hljs-comment">// OR for ref: user.value.age++;</span>
        };

        <span class="hljs-keyword">return</span> { user, updateAge };
    }
};

<span class="hljs-comment">// ❌ BAD: Memory leaks with watchers</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    setup() {
        <span class="hljs-keyword">const</span> count = ref(<span class="hljs-number">0</span>);

        watch(count, (newVal) =&gt; {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Count changed:'</span>, newVal);
        });

        <span class="hljs-comment">// Watcher not cleaned up!</span>
    }
};

<span class="hljs-comment">// ✅ GOOD: Cleaning up watchers</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    setup() {
        <span class="hljs-keyword">const</span> count = ref(<span class="hljs-number">0</span>);

        <span class="hljs-keyword">const</span> stopWatcher = watch(count, (newVal) =&gt; {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Count changed:'</span>, newVal);
        });

        onUnmounted(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            stopWatcher();
        });
    }
};
</div></code></pre>
<h3 id="angular-pitfalls">Angular Pitfalls</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ BAD: Not unsubscribing from observables</span>
<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">"app-user-list"</span>,
  template: <span class="hljs-string">`&lt;div&gt;{{ users.length }} users&lt;/div&gt;`</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserListComponent <span class="hljs-keyword">implements</span> OnInit {
  users: User[] = [];

  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userService: UserService</span>) {}

  ngOnInit(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// Memory leak - subscription not cleaned up</span>
    <span class="hljs-keyword">this</span>.userService.getUsers().subscribe(<span class="hljs-function">(<span class="hljs-params">users</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.users = users;
    });
  }
}

<span class="hljs-comment">// ✅ GOOD: Unsubscribing properly</span>
<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">"app-user-list"</span>,
  template: <span class="hljs-string">`&lt;div&gt;{{ users.length }} users&lt;/div&gt;`</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserListComponent <span class="hljs-keyword">implements</span> OnInit, OnDestroy {
  users: User[] = [];
  <span class="hljs-keyword">private</span> destroy$ = <span class="hljs-keyword">new</span> Subject&lt;<span class="hljs-built_in">void</span>&gt;();

  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userService: UserService</span>) {}

  ngOnInit(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.userService
      .getUsers()
      .pipe(takeUntil(<span class="hljs-keyword">this</span>.destroy$))
      .subscribe(<span class="hljs-function">(<span class="hljs-params">users</span>) =&gt;</span> {
        <span class="hljs-keyword">this</span>.users = users;
      });
  }

  ngOnDestroy(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.destroy$.next();
    <span class="hljs-keyword">this</span>.destroy$.complete();
  }
}

<span class="hljs-comment">// ❌ BAD: Mutating input properties</span>
<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">"app-user-card"</span>,
  template: <span class="hljs-string">`
    &lt;div&gt;
      &lt;h3&gt;{{ user.name }}&lt;/h3&gt;
      &lt;button (click)="updateUser()"&gt;Update&lt;/button&gt;
    &lt;/div&gt;
  `</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserCardComponent {
  <span class="hljs-meta">@Input</span>() user!: User;

  updateUser(): <span class="hljs-built_in">void</span> {
    <span class="hljs-comment">// DON'T DO THIS - mutates input</span>
    <span class="hljs-keyword">this</span>.user.name = <span class="hljs-string">"Updated Name"</span>;
  }
}

<span class="hljs-comment">// ✅ GOOD: Emitting events</span>
<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">"app-user-card"</span>,
  template: <span class="hljs-string">`
    &lt;div&gt;
      &lt;h3&gt;{{ user.name }}&lt;/h3&gt;
      &lt;button (click)="updateUser()"&gt;Update&lt;/button&gt;
    &lt;/div&gt;
  `</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserCardComponent {
  <span class="hljs-meta">@Input</span>() user!: User;
  <span class="hljs-meta">@Output</span>() userUpdate = <span class="hljs-keyword">new</span> EventEmitter&lt;User&gt;();

  updateUser(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">const</span> updatedUser = { ...this.user, name: <span class="hljs-string">"Updated Name"</span> };
    <span class="hljs-keyword">this</span>.userUpdate.emit(updatedUser);
  }
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%8F%8B%EF%B8%8F-practice-problems">🏋️ Practice Problems</h2>
<h3 id="mini-practice-problems">Mini Practice Problems</h3>
<h4 id="1-real-time-chat-application">1. <strong>Real-time Chat Application</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Build a real-time chat app with:</span>
<span class="hljs-comment">// - User authentication</span>
<span class="hljs-comment">// - Multiple chat rooms</span>
<span class="hljs-comment">// - Message history</span>
<span class="hljs-comment">// - Online user status</span>
<span class="hljs-comment">// - Typing indicators</span>
<span class="hljs-comment">// - File sharing</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// - WebSocket connection management</span>
<span class="hljs-comment">// - Message state management</span>
<span class="hljs-comment">// - Optimistic updates</span>
<span class="hljs-comment">// - Error handling and reconnection</span>
<span class="hljs-comment">// - Message pagination</span>
<span class="hljs-comment">// - Emoji support</span>

<span class="hljs-comment">// Example structure:</span>
<span class="hljs-keyword">const</span> ChatApp = {
  <span class="hljs-attr">components</span>: [
    <span class="hljs-string">"ChatRoomList"</span>,
    <span class="hljs-string">"MessageList"</span>,
    <span class="hljs-string">"MessageInput"</span>,
    <span class="hljs-string">"UserList"</span>,
    <span class="hljs-string">"TypingIndicator"</span>,
  ],
  <span class="hljs-attr">features</span>: [
    <span class="hljs-string">"Real-time messaging"</span>,
    <span class="hljs-string">"User presence"</span>,
    <span class="hljs-string">"Message persistence"</span>,
    <span class="hljs-string">"File uploads"</span>,
    <span class="hljs-string">"Message search"</span>,
  ],
};
</div></code></pre>
<h4 id="2-e-commerce-product-catalog">2. <strong>E-commerce Product Catalog</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a product catalog with:</span>
<span class="hljs-comment">// - Product listing with filters</span>
<span class="hljs-comment">// - Search functionality</span>
<span class="hljs-comment">// - Shopping cart</span>
<span class="hljs-comment">// - Wishlist</span>
<span class="hljs-comment">// - Product comparison</span>
<span class="hljs-comment">// - Reviews and ratings</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// - Advanced filtering (price, category, brand, ratings)</span>
<span class="hljs-comment">// - Infinite scrolling or pagination</span>
<span class="hljs-comment">// - Product image gallery</span>
<span class="hljs-comment">// - Cart state management</span>
<span class="hljs-comment">// - Local storage persistence</span>
<span class="hljs-comment">// - Responsive design</span>

<span class="hljs-comment">// Example structure:</span>
<span class="hljs-keyword">const</span> EcommerceApp = {
  <span class="hljs-attr">pages</span>: [<span class="hljs-string">"ProductList"</span>, <span class="hljs-string">"ProductDetail"</span>, <span class="hljs-string">"Cart"</span>, <span class="hljs-string">"Checkout"</span>, <span class="hljs-string">"UserProfile"</span>],
  <span class="hljs-attr">features</span>: [
    <span class="hljs-string">"Product filtering"</span>,
    <span class="hljs-string">"Search with autocomplete"</span>,
    <span class="hljs-string">"Cart management"</span>,
    <span class="hljs-string">"Wishlist functionality"</span>,
    <span class="hljs-string">"Order history"</span>,
  ],
};
</div></code></pre>
<h4 id="3-task-management-dashboard">3. <strong>Task Management Dashboard</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Build a project management tool with:</span>
<span class="hljs-comment">// - Kanban board</span>
<span class="hljs-comment">// - Task creation and editing</span>
<span class="hljs-comment">// - Team collaboration</span>
<span class="hljs-comment">// - Time tracking</span>
<span class="hljs-comment">// - Progress analytics</span>
<span class="hljs-comment">// - File attachments</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// - Drag and drop functionality</span>
<span class="hljs-comment">// - Real-time collaboration</span>
<span class="hljs-comment">// - Task dependencies</span>
<span class="hljs-comment">// - Gantt chart view</span>
<span class="hljs-comment">// - Team member assignment</span>
<span class="hljs-comment">// - Notification system</span>

<span class="hljs-comment">// Example structure:</span>
<span class="hljs-keyword">const</span> TaskManager = {
  <span class="hljs-attr">views</span>: [<span class="hljs-string">"KanbanBoard"</span>, <span class="hljs-string">"ListView"</span>, <span class="hljs-string">"CalendarView"</span>, <span class="hljs-string">"GanttChart"</span>, <span class="hljs-string">"Analytics"</span>],
  <span class="hljs-attr">features</span>: [
    <span class="hljs-string">"Drag and drop"</span>,
    <span class="hljs-string">"Real-time updates"</span>,
    <span class="hljs-string">"Task filtering"</span>,
    <span class="hljs-string">"Time tracking"</span>,
    <span class="hljs-string">"Team collaboration"</span>,
  ],
};
</div></code></pre>
<h4 id="4-social-media-feed">4. <strong>Social Media Feed</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a social media platform with:</span>
<span class="hljs-comment">// - User profiles</span>
<span class="hljs-comment">// - Post creation (text, images, videos)</span>
<span class="hljs-comment">// - News feed with infinite scroll</span>
<span class="hljs-comment">// - Like, comment, share functionality</span>
<span class="hljs-comment">// - Follow/unfollow users</span>
<span class="hljs-comment">// - Real-time notifications</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// - Image/video upload and preview</span>
<span class="hljs-comment">// - Feed algorithm (chronological/algorithmic)</span>
<span class="hljs-comment">// - Comment threading</span>
<span class="hljs-comment">// - Real-time likes and comments</span>
<span class="hljs-comment">// - User search and discovery</span>
<span class="hljs-comment">// - Content moderation</span>

<span class="hljs-comment">// Example structure:</span>
<span class="hljs-keyword">const</span> SocialMedia = {
  <span class="hljs-attr">components</span>: [
    <span class="hljs-string">"NewsFeed"</span>,
    <span class="hljs-string">"PostCreator"</span>,
    <span class="hljs-string">"UserProfile"</span>,
    <span class="hljs-string">"NotificationCenter"</span>,
    <span class="hljs-string">"SearchResults"</span>,
  ],
  <span class="hljs-attr">features</span>: [
    <span class="hljs-string">"Infinite scrolling"</span>,
    <span class="hljs-string">"Real-time updates"</span>,
    <span class="hljs-string">"Media uploads"</span>,
    <span class="hljs-string">"Social interactions"</span>,
    <span class="hljs-string">"User discovery"</span>,
  ],
};
</div></code></pre>
<h4 id="5-data-visualization-dashboard">5. <strong>Data Visualization Dashboard</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Build an analytics dashboard with:</span>
<span class="hljs-comment">// - Multiple chart types (line, bar, pie, scatter)</span>
<span class="hljs-comment">// - Real-time data updates</span>
<span class="hljs-comment">// - Interactive filters</span>
<span class="hljs-comment">// - Export functionality</span>
<span class="hljs-comment">// - Responsive design</span>
<span class="hljs-comment">// - Custom date ranges</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// - Chart.js or D3.js integration</span>
<span class="hljs-comment">// - Data transformation and aggregation</span>
<span class="hljs-comment">// - Real-time WebSocket updates</span>
<span class="hljs-comment">// - CSV/PDF export</span>
<span class="hljs-comment">// - Dashboard customization</span>
<span class="hljs-comment">// - Performance optimization for large datasets</span>

<span class="hljs-comment">// Example structure:</span>
<span class="hljs-keyword">const</span> Dashboard = {
  <span class="hljs-attr">charts</span>: [<span class="hljs-string">"LineChart"</span>, <span class="hljs-string">"BarChart"</span>, <span class="hljs-string">"PieChart"</span>, <span class="hljs-string">"ScatterPlot"</span>, <span class="hljs-string">"HeatMap"</span>],
  <span class="hljs-attr">features</span>: [
    <span class="hljs-string">"Real-time updates"</span>,
    <span class="hljs-string">"Interactive filtering"</span>,
    <span class="hljs-string">"Data export"</span>,
    <span class="hljs-string">"Custom layouts"</span>,
    <span class="hljs-string">"Performance optimization"</span>,
  ],
};
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%9D-interview-notes">📝 Interview Notes</h2>
<h3 id="common-framework-questions">Common Framework Questions</h3>
<h4 id="react-interview-questions">React Interview Questions</h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Q1: What is the Virtual DOM and how does it work?</span>
<span class="hljs-comment">// A: The Virtual DOM is a JavaScript representation of the real DOM.</span>
<span class="hljs-comment">// React uses it to optimize updates by:</span>
<span class="hljs-comment">// 1. Creating a virtual representation of the UI</span>
<span class="hljs-comment">// 2. Comparing (diffing) the new virtual DOM with the previous one</span>
<span class="hljs-comment">// 3. Updating only the changed parts in the real DOM</span>

<span class="hljs-comment">// Q2: Explain the difference between useState and useReducer</span>
<span class="hljs-comment">// A: useState is for simple state, useReducer is for complex state logic</span>
<span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>); <span class="hljs-comment">// Simple state</span>

<span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialState); <span class="hljs-comment">// Complex state</span>

<span class="hljs-comment">// Q3: What are React keys and why are they important?</span>
<span class="hljs-comment">// A: Keys help React identify which items have changed, are added, or removed</span>
<span class="hljs-comment">// They should be stable, predictable, and unique among siblings</span>

<span class="hljs-comment">// ❌ BAD: Using array index as key</span>
{
  items.map(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Item</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{item}</span> /&gt;</span></span>);
}

<span class="hljs-comment">// ✅ GOOD: Using unique identifier</span>
{
  items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Item</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{item}</span> /&gt;</span></span>);
}

<span class="hljs-comment">// Q4: Explain React's reconciliation process</span>
<span class="hljs-comment">// A: Reconciliation is the process React uses to update the DOM efficiently:</span>
<span class="hljs-comment">// 1. Element type comparison</span>
<span class="hljs-comment">// 2. Props comparison</span>
<span class="hljs-comment">// 3. Children comparison</span>
<span class="hljs-comment">// 4. Key-based reconciliation for lists</span>

<span class="hljs-comment">// Q5: What is prop drilling and how can you avoid it?</span>
<span class="hljs-comment">// A: Prop drilling is passing props through multiple component levels</span>
<span class="hljs-comment">// Solutions: Context API, State management libraries, Component composition</span>

<span class="hljs-comment">// Prop drilling example:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span> };
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Parent</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Child</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">GrandChild</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GrandChild</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// Solution with Context:</span>
<span class="hljs-keyword">const</span> UserContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span> };
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{user}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Parent</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GrandChild</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = useContext(UserContext);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h4 id="vue-interview-questions">Vue Interview Questions</h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Q1: What is Vue's reactivity system?</span>
<span class="hljs-comment">// A: Vue uses a reactive system based on ES6 Proxies (Vue 3) or Object.defineProperty (Vue 2)</span>
<span class="hljs-comment">// It automatically tracks dependencies and updates the DOM when data changes</span>

<span class="hljs-comment">// Q2: Explain the difference between ref and reactive</span>
<span class="hljs-comment">// A: ref is for primitive values, reactive is for objects</span>
<span class="hljs-keyword">const</span> count = ref(<span class="hljs-number">0</span>); <span class="hljs-comment">// Primitive</span>
<span class="hljs-keyword">const</span> user = reactive({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> }); <span class="hljs-comment">// Object</span>

<span class="hljs-comment">// Q3: What are Vue directives?</span>
<span class="hljs-comment">// A: Directives are special attributes that apply reactive behavior to the DOM</span>
<span class="hljs-comment">// Examples: v-if, v-for, v-model, v-show, v-on, v-bind</span>

<span class="hljs-comment">// Q4: Explain Vue's component lifecycle</span>
<span class="hljs-comment">// A: Vue 3 Composition API lifecycle hooks:</span>
<span class="hljs-comment">// - onBeforeMount</span>
<span class="hljs-comment">// - onMounted</span>
<span class="hljs-comment">// - onBeforeUpdate</span>
<span class="hljs-comment">// - onUpdated</span>
<span class="hljs-comment">// - onBeforeUnmount</span>
<span class="hljs-comment">// - onUnmounted</span>

<span class="hljs-comment">// Q5: What is the difference between computed and watch?</span>
<span class="hljs-comment">// A: Computed is for derived state, watch is for side effects</span>
<span class="hljs-keyword">const</span> fullName = computed(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${firstName.value}</span> <span class="hljs-subst">${lastName.value}</span>`</span>);

watch(searchTerm, (newTerm) =&gt; {
  <span class="hljs-comment">// Side effect: API call</span>
  fetchSearchResults(newTerm);
});
</div></code></pre>
<h4 id="angular-interview-questions">Angular Interview Questions</h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Q1: What is dependency injection in Angular?</span>
<span class="hljs-comment">// A: DI is a design pattern where dependencies are provided to a class</span>
<span class="hljs-comment">// rather than the class creating them itself</span>

<span class="hljs-meta">@Injectable</span>({
    providedIn: <span class="hljs-string">'root'</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserService {
    <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> http: HttpClient</span>) {}
}

<span class="hljs-meta">@Component</span>({
    selector: <span class="hljs-string">'app-user'</span>
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserComponent {
    <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userService: UserService</span>) {} <span class="hljs-comment">// DI</span>
}

<span class="hljs-comment">// Q2: Explain Angular's change detection</span>
<span class="hljs-comment">// A: Angular uses Zone.js to detect changes and update the view</span>
<span class="hljs-comment">// It runs change detection on:</span>
<span class="hljs-comment">// - DOM events</span>
<span class="hljs-comment">// - HTTP requests</span>
<span class="hljs-comment">// - Timers (setTimeout, setInterval)</span>

<span class="hljs-comment">// Q3: What are Angular pipes?</span>
<span class="hljs-comment">// A: Pipes transform data in templates</span>
{{ user.name | uppercase }}
{{ user.birthDate | date:<span class="hljs-string">'short'</span> }}
{{ user.salary | currency:<span class="hljs-string">'USD'</span> }}

<span class="hljs-comment">// Q4: Explain the difference between template-driven and reactive forms</span>
<span class="hljs-comment">// A: Template-driven forms use directives in templates,</span>
<span class="hljs-comment">// reactive forms use FormControl and FormGroup in components</span>

<span class="hljs-comment">// Template-driven:</span>
&lt;form #userForm=<span class="hljs-string">"ngForm"</span>&gt;
    &lt;input name=<span class="hljs-string">"name"</span> ngModel required&gt;
&lt;<span class="hljs-regexp">/form&gt;

/</span><span class="hljs-regexp">/ Reactive:
this.userForm = this.fb.group({
    name: ['', Validators.required]
});

/</span><span class="hljs-regexp">/ Q5: What are Angular guards?
/</span><span class="hljs-regexp">/ A: Guards control navigation to/</span><span class="hljs-keyword">from</span> routes
<span class="hljs-comment">// Types: CanActivate, CanDeactivate, CanLoad, Resolve</span>
</div></code></pre>
<h3 id="company-specific-questions">Company-Specific Questions</h3>
<h4 id="frontend-heavy-companies-netflix-airbnb-facebook"><strong>Frontend-Heavy Companies (Netflix, Airbnb, Facebook)</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Performance optimization questions:</span>
<span class="hljs-comment">// - How would you optimize a large list rendering?</span>
<span class="hljs-comment">// - Explain code splitting strategies</span>
<span class="hljs-comment">// - How do you handle memory leaks in SPAs?</span>
<span class="hljs-comment">// - What are your strategies for reducing bundle size?</span>

<span class="hljs-comment">// Architecture questions:</span>
<span class="hljs-comment">// - How would you structure a large-scale React application?</span>
<span class="hljs-comment">// - Explain your approach to state management</span>
<span class="hljs-comment">// - How do you handle error boundaries?</span>
<span class="hljs-comment">// - What's your testing strategy for components?</span>

<span class="hljs-comment">// Real-world scenarios:</span>
<span class="hljs-comment">// - How would you implement infinite scrolling?</span>
<span class="hljs-comment">// - Design a reusable component library</span>
<span class="hljs-comment">// - Handle real-time updates in a chat application</span>
<span class="hljs-comment">// - Implement offline functionality</span>
</div></code></pre>
<h4 id="e-commerce-companies-amazon-shopify-ebay"><strong>E-commerce Companies (Amazon, Shopify, eBay)</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Business logic questions:</span>
<span class="hljs-comment">// - How would you implement a shopping cart?</span>
<span class="hljs-comment">// - Design a product search with filters</span>
<span class="hljs-comment">// - Handle inventory updates in real-time</span>
<span class="hljs-comment">// - Implement A/B testing for UI components</span>

<span class="hljs-comment">// Performance questions:</span>
<span class="hljs-comment">// - Optimize product image loading</span>
<span class="hljs-comment">// - Handle large product catalogs</span>
<span class="hljs-comment">// - Implement caching strategies</span>
<span class="hljs-comment">// - Design for mobile performance</span>
</div></code></pre>
<h4 id="fintech-companies-stripe-paypal-square"><strong>Fintech Companies (Stripe, PayPal, Square)</strong></h4>
<pre class="hljs"><code><div><span class="hljs-comment">// Security questions:</span>
<span class="hljs-comment">// - How do you handle sensitive data in frontend?</span>
<span class="hljs-comment">// - Implement secure form handling</span>
<span class="hljs-comment">// - Handle authentication tokens</span>
<span class="hljs-comment">// - Prevent XSS and CSRF attacks</span>

<span class="hljs-comment">// Reliability questions:</span>
<span class="hljs-comment">// - Handle network failures gracefully</span>
<span class="hljs-comment">// - Implement retry mechanisms</span>
<span class="hljs-comment">// - Design error handling strategies</span>
<span class="hljs-comment">// - Ensure data consistency</span>
</div></code></pre>
<h3 id="key-takeaways">Key Takeaways</h3>
<ol>
<li>
<p><strong>Choose the Right Tool</strong>: Each framework has its strengths - React for flexibility, Vue for ease of use, Angular for enterprise applications</p>
</li>
<li>
<p><strong>Performance Matters</strong>: Always consider performance implications of your architectural decisions</p>
</li>
<li>
<p><strong>State Management</strong>: Understand when to use local state vs global state management</p>
</li>
<li>
<p><strong>Component Design</strong>: Focus on reusability, composability, and maintainability</p>
</li>
<li>
<p><strong>Testing Strategy</strong>: Write testable components and implement proper testing strategies</p>
</li>
<li>
<p><strong>Security First</strong>: Always consider security implications, especially for user data</p>
</li>
<li>
<p><strong>Developer Experience</strong>: Choose tools and patterns that improve developer productivity</p>
</li>
<li>
<p><strong>Stay Updated</strong>: Frontend frameworks evolve rapidly - stay current with best practices</p>
</li>
</ol>
<hr>
<p><em>Next: Chapter 20 - Node.js &amp; Backend Development</em> 🚀javascript
// Without Framework - Vanilla JavaScript
class VanillaTodoApp {
constructor() {
this.todos = [];
this.container = document.getElementById('app');
this.render();
}</p>
<pre><code>addTodo(text) {
    this.todos.push({ id: Date.now(), text, completed: false });
    this.render(); // Manual re-render
}

toggleTodo(id) {
    const todo = this.todos.find(t =&gt; t.id === id);
    if (todo) {
        todo.completed = !todo.completed;
        this.render(); // Manual re-render
    }
}

render() {
    // Manual DOM manipulation
    this.container.innerHTML = `
        &lt;div&gt;
            &lt;input id=&quot;todoInput&quot; type=&quot;text&quot; placeholder=&quot;Add todo...&quot;&gt;
            &lt;button onclick=&quot;app.addTodo(document.getElementById('todoInput').value)&quot;&gt;Add&lt;/button&gt;
            &lt;ul&gt;
                ${this.todos.map(todo =&gt; `
                    &lt;li&gt;
                        &lt;input type=&quot;checkbox&quot; ${todo.completed ? 'checked' : ''}
                               onchange=&quot;app.toggleTodo(${todo.id})&quot;&gt;
                        &lt;span style=&quot;${todo.completed ? 'text-decoration: line-through' : ''}&quot;&gt;
                            ${todo.text}
                        &lt;/span&gt;
                    &lt;/li&gt;
                `).join('')}
            &lt;/ul&gt;
        &lt;/div&gt;
    `;
}
</code></pre>
<p>}</p>
<p>// Framework Benefits:
// 1. Declarative UI
// 2. Component reusability
// 3. State management
// 4. Virtual DOM (React)
// 5. Reactive data binding (Vue/Angular)
// 6. Developer tools
// 7. Community ecosystem</p>
<pre class="hljs"><code><div>
### Framework Comparison
```javascript
// Framework characteristics comparison
const frameworkComparison = {
    React: {
        paradigm: 'Component-based library',
        learningCurve: 'Moderate',
        stateManagement: 'useState, useReducer, Redux, Zustand',
        rendering: 'Virtual DOM',
        strengths: ['Large ecosystem', 'Flexibility', 'Job market'],
        weaknesses: ['Boilerplate', 'Decision fatigue'],
        bestFor: 'Large applications, SPAs, mobile (React Native)'
    },
    Vue: {
        paradigm: 'Progressive framework',
        learningCurve: 'Easy',
        stateManagement: 'Vuex, Pinia',
        rendering: 'Virtual DOM with reactive system',
        strengths: ['Easy to learn', 'Great documentation', 'Template syntax'],
        weaknesses: ['Smaller ecosystem', 'Less job opportunities'],
        bestFor: 'Rapid prototyping, small to medium apps'
    },
    Angular: {
        paradigm: 'Full framework',
        learningCurve: 'Steep',
        stateManagement: 'Services, NgRx',
        rendering: 'Real DOM with change detection',
        strengths: ['Complete solution', 'TypeScript', 'Enterprise ready'],
        weaknesses: ['Complex', 'Heavy', 'Steep learning curve'],
        bestFor: 'Enterprise applications, large teams'
    }
};
</div></code></pre>
<hr>
<h2 id="%E2%9A%9B%EF%B8%8F-react-fundamentals">⚛️ React Fundamentals</h2>
<h3 id="components-and-jsx">Components and JSX</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Functional Components</span>
<span class="hljs-keyword">import</span> React, { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-comment">// Basic functional component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Welcome</span>(<span class="hljs-params">{ name }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, {name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;
}

<span class="hljs-comment">// Component with state</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count - 1)}&gt;Decrement<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Component with effects</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ userId }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchUser</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">try</span> {
        setLoading(<span class="hljs-literal">true</span>);
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>);
        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed to fetch user"</span>);
        }
        <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
        setUser(userData);
      } <span class="hljs-keyword">catch</span> (err) {
        setError(err.message);
      } <span class="hljs-keyword">finally</span> {
        setLoading(<span class="hljs-literal">false</span>);
      }
    }

    fetchUser();
  }, [userId]); <span class="hljs-comment">// Dependency array</span>

  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (!user) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>User not found<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-profile"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{user.avatar}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{user.name}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="custom-hooks">Custom Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Custom hook for API calls</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useApi</span>(<span class="hljs-params">url</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fetchData</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">try</span> {
        setLoading(<span class="hljs-literal">true</span>);
        setError(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url);
        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>`</span>);
        }
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
        setData(result);
      } <span class="hljs-keyword">catch</span> (err) {
        setError(err.message);
      } <span class="hljs-keyword">finally</span> {
        setLoading(<span class="hljs-literal">false</span>);
      }
    }

    fetchData();
  }, [url]);

  <span class="hljs-keyword">return</span> { data, loading, error };
}

<span class="hljs-comment">// Custom hook for local storage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useLocalStorage</span>(<span class="hljs-params">key, initialValue</span>) </span>{
  <span class="hljs-keyword">const</span> [storedValue, setStoredValue] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> item = <span class="hljs-built_in">window</span>.localStorage.getItem(key);
      <span class="hljs-keyword">return</span> item ? <span class="hljs-built_in">JSON</span>.parse(item) : initialValue;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error reading from localStorage:"</span>, error);
      <span class="hljs-keyword">return</span> initialValue;
    }
  });

  <span class="hljs-keyword">const</span> setValue = <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> valueToStore =
        value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Function</span> ? value(storedValue) : value;
      setStoredValue(valueToStore);
      <span class="hljs-built_in">window</span>.localStorage.setItem(key, <span class="hljs-built_in">JSON</span>.stringify(valueToStore));
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error writing to localStorage:"</span>, error);
    }
  };

  <span class="hljs-keyword">return</span> [storedValue, setValue];
}

<span class="hljs-comment">// Custom hook for debounced values</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDebounce</span>(<span class="hljs-params">value, delay</span>) </span>{
  <span class="hljs-keyword">const</span> [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handler = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setDebouncedValue(value);
    }, delay);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      clearTimeout(handler);
    };
  }, [value, delay]);

  <span class="hljs-keyword">return</span> debouncedValue;
}

<span class="hljs-comment">// Usage of custom hooks</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SearchComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> debouncedSearchTerm = useDebounce(searchTerm, <span class="hljs-number">300</span>);
  <span class="hljs-keyword">const</span> {
    <span class="hljs-attr">data</span>: searchResults,
    loading,
    error,
  } = useApi(
    debouncedSearchTerm ? <span class="hljs-string">`/api/search?q=<span class="hljs-subst">${debouncedSearchTerm}</span>`</span> : <span class="hljs-literal">null</span>
  );
  <span class="hljs-keyword">const</span> [favorites, setFavorites] = useLocalStorage(<span class="hljs-string">"favorites"</span>, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSearchTerm(e.target.value)}
        placeholder="Search..."
      /&gt;

      {loading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Searching...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
      {error &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {searchResults &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          {searchResults.map((result) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{result.id}</span>&gt;</span>
              {result.title}
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFavorites([...favorites, result])}&gt;
                Add to Favorites
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="context-api">Context API</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Theme context</span>
<span class="hljs-keyword">const</span> ThemeContext = React.createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThemeProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [theme, setTheme] = useState(<span class="hljs-string">"light"</span>);

  <span class="hljs-keyword">const</span> toggleTheme = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTheme(<span class="hljs-function">(<span class="hljs-params">prevTheme</span>) =&gt;</span> (prevTheme === <span class="hljs-string">"light"</span> ? <span class="hljs-string">"dark"</span> : <span class="hljs-string">"light"</span>));
  };

  <span class="hljs-keyword">const</span> value = {
    theme,
    toggleTheme,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Custom hook to use theme</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useTheme</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(ThemeContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useTheme must be used within a ThemeProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// User context with authentication</span>
<span class="hljs-keyword">const</span> UserContext = React.createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Check for existing session</span>
    checkAuthStatus();
  }, []);

  <span class="hljs-keyword">const</span> checkAuthStatus = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/me"</span>);
      <span class="hljs-keyword">if</span> (response.ok) {
        <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
        setUser(userData);
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Auth check failed:"</span>, error);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-keyword">const</span> login = <span class="hljs-keyword">async</span> (email, password) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/login"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ email, password }),
      });

      <span class="hljs-keyword">if</span> (response.ok) {
        <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
        setUser(userData);
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">"Invalid credentials"</span> };
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: error.message };
    }
  };

  <span class="hljs-keyword">const</span> logout = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/logout"</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span> });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Logout error:"</span>, error);
    } <span class="hljs-keyword">finally</span> {
      setUser(<span class="hljs-literal">null</span>);
    }
  };

  <span class="hljs-keyword">const</span> value = {
    user,
    loading,
    login,
    logout,
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useUser</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(UserContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useUser must be used within a UserProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// App with providers</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Main</span> /&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">UserProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span></span>
  );
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%9F%A2-vuejs-essentials">🟢 Vue.js Essentials</h2>
<h3 id="vue-components">Vue Components</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Vue 3 Composition API</span>
<span class="hljs-keyword">import</span> { ref, computed, onMounted, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">'vue'</span>;

<span class="hljs-comment">// Basic component</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'Counter'</span>,
    setup() {
        <span class="hljs-keyword">const</span> count = ref(<span class="hljs-number">0</span>);

        <span class="hljs-keyword">const</span> increment = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            count.value++;
        };

        <span class="hljs-keyword">const</span> decrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            count.value--;
        };

        <span class="hljs-keyword">const</span> doubleCount = computed(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> count.value * <span class="hljs-number">2</span>);

        <span class="hljs-keyword">return</span> {
            count,
            increment,
            decrement,
            doubleCount
        };
    },
    <span class="hljs-attr">template</span>: <span class="hljs-string">`
        &lt;div&gt;
            &lt;p&gt;Count: {{ count }}&lt;/p&gt;
            &lt;p&gt;Double: {{ doubleCount }}&lt;/p&gt;
            &lt;button @click="increment"&gt;+&lt;/button&gt;
            &lt;button @click="decrement"&gt;-&lt;/button&gt;
        &lt;/div&gt;
    `</span>
};

<span class="hljs-comment">// Component with lifecycle and watchers</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
    <span class="hljs-attr">name</span>: <span class="hljs-string">'UserProfile'</span>,
    <span class="hljs-attr">props</span>: {
        <span class="hljs-attr">userId</span>: {
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>
        }
    },
    setup(props) {
        <span class="hljs-keyword">const</span> user = ref(<span class="hljs-literal">null</span>);
        <span class="hljs-keyword">const</span> loading = ref(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">const</span> error = ref(<span class="hljs-literal">null</span>);

        <span class="hljs-keyword">const</span> fetchUser = <span class="hljs-keyword">async</span> (id) =&gt; {
            <span class="hljs-keyword">try</span> {
                loading.value = <span class="hljs-literal">true</span>;
                error.value = <span class="hljs-literal">null</span>;
                <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${id}</span>`</span>);
                <span class="hljs-keyword">if</span> (!response.ok) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Failed to fetch user'</span>);
                }
                user.value = <span class="hljs-keyword">await</span> response.json();
            } <span class="hljs-keyword">catch</span> (err) {
                error.value = err.message;
            } <span class="hljs-keyword">finally</span> {
                loading.value = <span class="hljs-literal">false</span>;
            }
        };

        <span class="hljs-comment">// Watch for prop changes</span>
        watch(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> props.userId, (newId) =&gt; {
            <span class="hljs-keyword">if</span> (newId) {
                fetchUser(newId);
            }
        }, { <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span> });

        onMounted(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'UserProfile mounted'</span>);
        });

        <span class="hljs-keyword">return</span> {
            user,
            loading,
            error
        };
    },
    <span class="hljs-attr">template</span>: <span class="hljs-string">`
        &lt;div class="user-profile"&gt;
            &lt;div v-if="loading"&gt;Loading...&lt;/div&gt;
            &lt;div v-else-if="error"&gt;Error: {{ error }}&lt;/div&gt;
            &lt;div v-else-if="user"&gt;
                &lt;img :src="user.avatar" :alt="user.name" /&gt;
                &lt;h2&gt;{{ user.name }}&lt;/h2&gt;
                &lt;p&gt;{{ user.email }}&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    `</span>
};
</div></code></pre>
<h3 id="vue-composables-custom-composition-functions">Vue Composables (Custom Composition Functions)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// useApi composable</span>
<span class="hljs-keyword">import</span> { ref, watchEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useApi</span>(<span class="hljs-params">url</span>) </span>{
  <span class="hljs-keyword">const</span> data = ref(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> loading = ref(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> error = ref(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      loading.value = <span class="hljs-literal">true</span>;
      error.value = <span class="hljs-literal">null</span>;
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url.value || url);
      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>`</span>);
      }
      data.value = <span class="hljs-keyword">await</span> response.json();
    } <span class="hljs-keyword">catch</span> (err) {
      error.value = err.message;
    } <span class="hljs-keyword">finally</span> {
      loading.value = <span class="hljs-literal">false</span>;
    }
  };

  watchEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (url.value || url) {
      fetchData();
    }
  });

  <span class="hljs-keyword">return</span> { data, loading, error, <span class="hljs-attr">refetch</span>: fetchData };
}

<span class="hljs-comment">// useLocalStorage composable</span>
<span class="hljs-keyword">import</span> { ref, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useLocalStorage</span>(<span class="hljs-params">key, defaultValue</span>) </span>{
  <span class="hljs-keyword">const</span> storedValue = localStorage.getItem(key);
  <span class="hljs-keyword">const</span> initial = storedValue ? <span class="hljs-built_in">JSON</span>.parse(storedValue) : defaultValue;

  <span class="hljs-keyword">const</span> value = ref(initial);

  watch(
    value,
    (newValue) =&gt; {
      localStorage.setItem(key, <span class="hljs-built_in">JSON</span>.stringify(newValue));
    },
    { <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span> }
  );

  <span class="hljs-keyword">return</span> value;
}

<span class="hljs-comment">// useDebounce composable</span>
<span class="hljs-keyword">import</span> { ref, watch } <span class="hljs-keyword">from</span> <span class="hljs-string">"vue"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDebounce</span>(<span class="hljs-params">source, delay</span>) </span>{
  <span class="hljs-keyword">const</span> debounced = ref(source.value);

  watch(source, (newValue) =&gt; {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      debounced.value = newValue;
    }, delay);
  });

  <span class="hljs-keyword">return</span> debounced;
}

<span class="hljs-comment">// Usage in component</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"SearchComponent"</span>,
  setup() {
    <span class="hljs-keyword">const</span> searchTerm = ref(<span class="hljs-string">""</span>);
    <span class="hljs-keyword">const</span> debouncedSearch = useDebounce(searchTerm, <span class="hljs-number">300</span>);
    <span class="hljs-keyword">const</span> searchUrl = computed(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
      debouncedSearch.value ? <span class="hljs-string">`/api/search?q=<span class="hljs-subst">${debouncedSearch.value}</span>`</span> : <span class="hljs-literal">null</span>
    );
    <span class="hljs-keyword">const</span> { <span class="hljs-attr">data</span>: searchResults, loading, error } = useApi(searchUrl);
    <span class="hljs-keyword">const</span> favorites = useLocalStorage(<span class="hljs-string">"favorites"</span>, []);

    <span class="hljs-keyword">const</span> addToFavorites = <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      favorites.value.push(item);
    };

    <span class="hljs-keyword">return</span> {
      searchTerm,
      searchResults,
      loading,
      error,
      favorites,
      addToFavorites,
    };
  },
  <span class="hljs-attr">template</span>: <span class="hljs-string">`
        &lt;div&gt;
            &lt;input v-model="searchTerm" placeholder="Search..." /&gt;
            
            &lt;div v-if="loading"&gt;Searching...&lt;/div&gt;
            &lt;div v-if="error"&gt;Error: {{ error }}&lt;/div&gt;
            
            &lt;ul v-if="searchResults"&gt;
                &lt;li v-for="result in searchResults" :key="result.id"&gt;
                    {{ result.title }}
                    &lt;button @click="addToFavorites(result)"&gt;
                        Add to Favorites
                    &lt;/button&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
    `</span>,
};
</div></code></pre>
<h3 id="vue-store-pinia">Vue Store (Pinia)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// stores/user.js</span>
<span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"pinia"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = defineStore(<span class="hljs-string">"user"</span>, {
  <span class="hljs-attr">state</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
  }),

  <span class="hljs-attr">getters</span>: {
    <span class="hljs-attr">isAuthenticated</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> !!state.user,
    <span class="hljs-attr">userName</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.user?.name || <span class="hljs-string">"Guest"</span>,
  },

  <span class="hljs-attr">actions</span>: {
    <span class="hljs-keyword">async</span> login(email, password) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>.loading = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">this</span>.error = <span class="hljs-literal">null</span>;

        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/login"</span>, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
          <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
          <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ email, password }),
        });

        <span class="hljs-keyword">if</span> (response.ok) {
          <span class="hljs-keyword">this</span>.user = <span class="hljs-keyword">await</span> response.json();
          <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> };
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Invalid credentials"</span>);
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">this</span>.error = error.message;
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: error.message };
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">this</span>.loading = <span class="hljs-literal">false</span>;
      }
    },

    <span class="hljs-keyword">async</span> logout() {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/logout"</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span> });
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Logout error:"</span>, error);
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">this</span>.user = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">this</span>.error = <span class="hljs-literal">null</span>;
      }
    },

    <span class="hljs-keyword">async</span> checkAuth() {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/auth/me"</span>);
        <span class="hljs-keyword">if</span> (response.ok) {
          <span class="hljs-keyword">this</span>.user = <span class="hljs-keyword">await</span> response.json();
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Auth check failed:"</span>, error);
      }
    },
  },
});

<span class="hljs-comment">// stores/todos.js</span>
<span class="hljs-keyword">import</span> { defineStore } <span class="hljs-keyword">from</span> <span class="hljs-string">"pinia"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useTodosStore = defineStore(<span class="hljs-string">"todos"</span>, {
  <span class="hljs-attr">state</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">todos</span>: [],
    <span class="hljs-attr">filter</span>: <span class="hljs-string">"all"</span>, <span class="hljs-comment">// all, active, completed</span>
  }),

  <span class="hljs-attr">getters</span>: {
    <span class="hljs-attr">filteredTodos</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
      <span class="hljs-keyword">switch</span> (state.filter) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"active"</span>:
          <span class="hljs-keyword">return</span> state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> !todo.completed);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"completed"</span>:
          <span class="hljs-keyword">return</span> state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.completed);
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">return</span> state.todos;
      }
    },

    <span class="hljs-attr">todoCount</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> state.todos.length,
    <span class="hljs-attr">activeCount</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span>
      state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> !todo.completed).length,
    <span class="hljs-attr">completedCount</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span>
      state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.completed).length,
  },

  <span class="hljs-attr">actions</span>: {
    addTodo(text) {
      <span class="hljs-keyword">this</span>.todos.push({
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
        text,
        <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(),
      });
    },

    toggleTodo(id) {
      <span class="hljs-keyword">const</span> todo = <span class="hljs-keyword">this</span>.todos.find(<span class="hljs-function">(<span class="hljs-params">t</span>) =&gt;</span> t.id === id);
      <span class="hljs-keyword">if</span> (todo) {
        todo.completed = !todo.completed;
      }
    },

    removeTodo(id) {
      <span class="hljs-keyword">const</span> index = <span class="hljs-keyword">this</span>.todos.findIndex(<span class="hljs-function">(<span class="hljs-params">t</span>) =&gt;</span> t.id === id);
      <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">this</span>.todos.splice(index, <span class="hljs-number">1</span>);
      }
    },

    setFilter(filter) {
      <span class="hljs-keyword">this</span>.filter = filter;
    },

    clearCompleted() {
      <span class="hljs-keyword">this</span>.todos = <span class="hljs-keyword">this</span>.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> !todo.completed);
    },
  },
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%85%B0%EF%B8%8F-angular-basics">🅰️ Angular Basics</h2>
<h3 id="components-and-services">Components and Services</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// user.service.ts</span>
<span class="hljs-keyword">import</span> { Injectable } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/core"</span>;
<span class="hljs-keyword">import</span> { HttpClient } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/common/http"</span>;
<span class="hljs-keyword">import</span> { Observable, BehaviorSubject } <span class="hljs-keyword">from</span> <span class="hljs-string">"rxjs"</span>;
<span class="hljs-keyword">import</span> { map, catchError } <span class="hljs-keyword">from</span> <span class="hljs-string">"rxjs/operators"</span>;

<span class="hljs-keyword">interface</span> User {
  id: <span class="hljs-built_in">string</span>;
  name: <span class="hljs-built_in">string</span>;
  email: <span class="hljs-built_in">string</span>;
  avatar?: <span class="hljs-built_in">string</span>;
}

<span class="hljs-meta">@Injectable</span>({
  providedIn: <span class="hljs-string">"root"</span>,
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserService {
  <span class="hljs-keyword">private</span> userSubject = <span class="hljs-keyword">new</span> BehaviorSubject&lt;User | <span class="hljs-literal">null</span>&gt;(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">public</span> user$ = <span class="hljs-keyword">this</span>.userSubject.asObservable();

  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> http: HttpClient</span>) {
    <span class="hljs-keyword">this</span>.checkAuthStatus();
  }

  login(
    email: <span class="hljs-built_in">string</span>,
    password: <span class="hljs-built_in">string</span>
  ): Observable&lt;{ success: <span class="hljs-built_in">boolean</span>; error?: <span class="hljs-built_in">string</span> }&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.http.post&lt;User&gt;(<span class="hljs-string">"/api/auth/login"</span>, { email, password }).pipe(
      map(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
        <span class="hljs-keyword">this</span>.userSubject.next(user);
        <span class="hljs-keyword">return</span> { success: <span class="hljs-literal">true</span> };
      }),
      catchError(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> [{ success: <span class="hljs-literal">false</span>, error: error.message }];
      })
    );
  }

  logout(): Observable&lt;<span class="hljs-built_in">void</span>&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.http.post&lt;<span class="hljs-built_in">void</span>&gt;(<span class="hljs-string">"/api/auth/logout"</span>, {}).pipe(
      map(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-keyword">this</span>.userSubject.next(<span class="hljs-literal">null</span>);
      })
    );
  }

  <span class="hljs-keyword">private</span> checkAuthStatus(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.http.get&lt;User&gt;(<span class="hljs-string">"/api/auth/me"</span>).subscribe({
      next: <span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> <span class="hljs-keyword">this</span>.userSubject.next(user),
      error: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">this</span>.userSubject.next(<span class="hljs-literal">null</span>),
    });
  }

  getCurrentUser(): User | <span class="hljs-literal">null</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.userSubject.value;
  }

  isAuthenticated(): <span class="hljs-built_in">boolean</span> {
    <span class="hljs-keyword">return</span> !!<span class="hljs-keyword">this</span>.userSubject.value;
  }
}

<span class="hljs-comment">// user-profile.component.ts</span>
<span class="hljs-keyword">import</span> { Component, Input, OnInit, OnDestroy } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/core"</span>;
<span class="hljs-keyword">import</span> { Subject } <span class="hljs-keyword">from</span> <span class="hljs-string">"rxjs"</span>;
<span class="hljs-keyword">import</span> { takeUntil } <span class="hljs-keyword">from</span> <span class="hljs-string">"rxjs/operators"</span>;
<span class="hljs-keyword">import</span> { UserService } <span class="hljs-keyword">from</span> <span class="hljs-string">"./user.service"</span>;

<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">"app-user-profile"</span>,
  template: <span class="hljs-string">`
    &lt;div class="user-profile" *ngIf="user; else loading"&gt;
      &lt;img [src]="user.avatar" [alt]="user.name" /&gt;
      &lt;h2&gt;{{ user.name }}&lt;/h2&gt;
      &lt;p&gt;{{ user.email }}&lt;/p&gt;
      &lt;button (click)="logout()" [disabled]="loggingOut"&gt;
        {{ loggingOut ? "Logging out..." : "Logout" }}
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;ng-template #loading&gt;
      &lt;div&gt;Loading user profile...&lt;/div&gt;
    &lt;/ng-template&gt;
  `</span>,
  styles: [
    <span class="hljs-string">`
      .user-profile {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 20px;
      }

      img {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        margin-bottom: 10px;
      }
    `</span>,
  ],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> UserProfileComponent <span class="hljs-keyword">implements</span> OnInit, OnDestroy {
  user: User | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;
  loggingOut = <span class="hljs-literal">false</span>;
  <span class="hljs-keyword">private</span> destroy$ = <span class="hljs-keyword">new</span> Subject&lt;<span class="hljs-built_in">void</span>&gt;();

  <span class="hljs-keyword">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">private</span> userService: UserService</span>) {}

  ngOnInit(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.userService.user$.pipe(takeUntil(<span class="hljs-keyword">this</span>.destroy$)).subscribe(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
      <span class="hljs-keyword">this</span>.user = user;
    });
  }

  ngOnDestroy(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.destroy$.next();
    <span class="hljs-keyword">this</span>.destroy$.complete();
  }

  logout(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.loggingOut = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">this</span>.userService
      .logout()
      .pipe(takeUntil(<span class="hljs-keyword">this</span>.destroy$))
      .subscribe({
        next: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          <span class="hljs-keyword">this</span>.loggingOut = <span class="hljs-literal">false</span>;
        },
        error: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          <span class="hljs-keyword">this</span>.loggingOut = <span class="hljs-literal">false</span>;
        },
      });
  }
}
</div></code></pre>
<h3 id="angular-reactive-forms">Angular Reactive Forms</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// login.component.ts</span>
<span class="hljs-keyword">import</span> { Component, OnInit } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/core"</span>;
<span class="hljs-keyword">import</span> { FormBuilder, FormGroup, Validators } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/forms"</span>;
<span class="hljs-keyword">import</span> { Router } <span class="hljs-keyword">from</span> <span class="hljs-string">"@angular/router"</span>;
<span class="hljs-keyword">import</span> { UserService } <span class="hljs-keyword">from</span> <span class="hljs-string">"./user.service"</span>;

<span class="hljs-meta">@Component</span>({
  selector: <span class="hljs-string">"app-login"</span>,
  template: <span class="hljs-string">`
    &lt;form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form"&gt;
      &lt;h2&gt;Login&lt;/h2&gt;

      &lt;div class="form-group"&gt;
        &lt;label for="email"&gt;Email:&lt;/label&gt;
        &lt;input
          id="email"
          type="email"
          formControlName="email"
          [class.error]="email?.invalid &amp;&amp; email?.touched"
        /&gt;
        &lt;div *ngIf="email?.invalid &amp;&amp; email?.touched" class="error-message"&gt;
          &lt;span *ngIf="email?.errors?.['required']"&gt;Email is required&lt;/span&gt;
          &lt;span *ngIf="email?.errors?.['email']"
            &gt;Please enter a valid email&lt;/span
          &gt;
        &lt;/div&gt;
      &lt;/div&gt;

      &lt;div class="form-group"&gt;
        &lt;label for="password"&gt;Password:&lt;/label&gt;
        &lt;input
          id="password"
          type="password"
          formControlName="password"
          [class.error]="password?.invalid &amp;&amp; password?.touched"
        /&gt;
        &lt;div
          *ngIf="password?.invalid &amp;&amp; password?.touched"
          class="error-message"
        &gt;
          &lt;span *ngIf="password?.errors?.['required']"
            &gt;Password is required&lt;/span
          &gt;
          &lt;span *ngIf="password?.errors?.['minlength']"
            &gt;Password must be at least 6 characters&lt;/span
          &gt;
        &lt;/div&gt;
      &lt;/div&gt;

      &lt;button
        type="submit"
        [disabled]="loginForm.invalid || loading"
        class="submit-button"
      &gt;
        {{ loading ? "Logging in..." : "Login" }}
      &lt;/button&gt;

      &lt;div *ngIf="error" class="error-message"&gt;
        {{ error }}
      &lt;/div&gt;
    &lt;/form&gt;
  `</span>,
  styles: [
    <span class="hljs-string">`
      .login-form {
        max-width: 400px;
        margin: 0 auto;
        padding: 20px;
      }

      .form-group {
        margin-bottom: 15px;
      }

      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
      }

      input {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
      }

      input.error {
        border-color: #ff0000;
      }

      .error-message {
        color: #ff0000;
        font-size: 14px;
        margin-top: 5px;
      }

      .submit-button {
        width: 100%;
        padding: 10px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }

      .submit-button:disabled {
        background-color: #ccc;
        cursor: not-allowed;
      }
    `</span>,
  ],
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> LoginComponent <span class="hljs-keyword">implements</span> OnInit {
  loginForm!: FormGroup;
  loading = <span class="hljs-literal">false</span>;
  error: <span class="hljs-built_in">string</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">constructor</span>(<span class="hljs-params">
    <span class="hljs-keyword">private</span> fb: FormBuilder,
    <span class="hljs-keyword">private</span> userService: UserService,
    <span class="hljs-keyword">private</span> router: Router
  </span>) {}

  ngOnInit(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">this</span>.loginForm = <span class="hljs-keyword">this</span>.fb.group({
      email: [<span class="hljs-string">""</span>, [Validators.required, Validators.email]],
      password: [<span class="hljs-string">""</span>, [Validators.required, Validators.minLength(<span class="hljs-number">6</span>)]],
    });
  }

  <span class="hljs-keyword">get</span> email() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.loginForm.get(<span class="hljs-string">"email"</span>);
  }

  <span class="hljs-keyword">get</span> password() {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.loginForm.get(<span class="hljs-string">"password"</span>);
  }

  onSubmit(): <span class="hljs-built_in">void</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.loginForm.valid) {
      <span class="hljs-keyword">this</span>.loading = <span class="hljs-literal">true</span>;
      <span class="hljs-keyword">this</span>.error = <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">const</span> { email, password } = <span class="hljs-keyword">this</span>.loginForm.value;

      <span class="hljs-keyword">this</span>.userService.login(email, password).subscribe({
        next: <span class="hljs-function">(<span class="hljs-params">result</span>) =&gt;</span> {
          <span class="hljs-keyword">this</span>.loading = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">if</span> (result.success) {
            <span class="hljs-keyword">this</span>.router.navigate([<span class="hljs-string">"/dashboard"</span>]);
          } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">this</span>.error = result.error || <span class="hljs-string">"Login failed"</span>;
          }
        },
        error: <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
          <span class="hljs-keyword">this</span>.loading = <span class="hljs-literal">false</span>;
          <span class="hljs-keyword">this</span>.error = <span class="hljs-string">"An error occurred during login"</span>;
        },
      });
    }
  }
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%97%83%EF%B8%8F-state-management">🗃️ State Management</h2>
<h3 id="redux-with-react">Redux with React</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// store/userSlice.js</span>
<span class="hljs-keyword">import</span> { createSlice, createAsyncThunk } <span class="hljs-keyword">from</span> <span class="hljs-string">'@reduxjs/toolkit'</span>;

<span class="hljs-comment">// Async thunks</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> loginUser = createAsyncThunk(
    <span class="hljs-string">'user/login'</span>,
    <span class="hljs-keyword">async</span> ({ email, password }, { rejectWithValue }) =&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">'/api/auth/login'</span>, {
                <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
                <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ email, password })
            });

            <span class="hljs-keyword">if</span> (!response.ok) {
                <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid credentials'</span>);
            }

            <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> response.json();
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-keyword">return</span> rejectWithValue(error.message);
        }
    }
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> logoutUser = createAsyncThunk(
    <span class="hljs-string">'user/logout'</span>,
    <span class="hljs-keyword">async</span> (_, { rejectWithValue }) =&gt; {
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">'/api/auth/logout'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span> });
        } <span class="hljs-keyword">catch</span> (error) {
            <span class="hljs-keyword">return</span> rejectWithValue(error.message);
        }
    }
);

<span class="hljs-keyword">const</span> userSlice = createSlice({
    <span class="hljs-attr">name</span>: <span class="hljs-string">'user'</span>,
    <span class="hljs-attr">initialState</span>: {
        <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>
    },
    <span class="hljs-attr">reducers</span>: {
        <span class="hljs-attr">clearError</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> {
            state.error = <span class="hljs-literal">null</span>;
        },
        <span class="hljs-attr">updateUser</span>: <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
            state.user = { ...state.user, ...action.payload };
        }
    },
    <span class="hljs-attr">extraReducers</span>: <span class="hljs-function">(<span class="hljs-params">builder</span>) =&gt;</span> {
        builder
            <span class="hljs-comment">// Login</span>
            .addCase(loginUser.pending, (state) =&gt; {
                state.loading = <span class="hljs-literal">true</span>;
                state.error = <span class="hljs-literal">null</span>;
            })
            .addCase(loginUser.fulfilled, (state, action) =&gt; {
                state.loading = <span class="hljs-literal">false</span>;
                state.user = action.payload;
            })
            .addCase(loginUser.rejected, (state, action) =&gt; {
                state.loading = <span class="hljs-literal">false</span>;
                state.error = action.payload;
            })
            <span class="hljs-comment">// Logout</span>
            .addCase(logoutUser.fulfilled, (state) =&gt; {
                state.user = <span class="hljs-literal">null</span>;
                state.error = <span class="hljs-literal">null</span>;
            });
    }
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> { clearError, updateUser } = userSlice.actions;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> userSlice.reducer;

<span class="hljs-comment">// store/index.js</span>
<span class="hljs-keyword">import</span> { configureStore } <span class="hljs-keyword">from</span> <span class="hljs-string">'@reduxjs/toolkit'</span>;
<span class="hljs-keyword">import</span> userReducer <span class="hljs-keyword">from</span> <span class="hljs-string">'./userSlice'</span>;
<span class="hljs-keyword">import</span> todosReducer <span class="hljs-keyword">from</span> <span class="hljs-string">'./todosSlice'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> store = configureStore({
    <span class="hljs-attr">reducer</span>: {
        <span class="hljs-attr">user</span>: userReducer,
        <span class="hljs-attr">todos</span>: todosReducer
    },
    <span class="hljs-attr">middleware</span>: <span class="hljs-function">(<span class="hljs-params">getDefaultMiddleware</span>) =&gt;</span>
        getDefaultMiddleware({
            <span class="hljs-attr">serializableCheck</span>: {
                <span class="hljs-attr">ignoredActions</span>: [<span class="hljs-string">'persist/PERSIST'</span>]
            }
        })
});

<span class="hljs-keyword">export</span> type RootState = ReturnType&lt;<span class="hljs-keyword">typeof</span> store.getState&gt;;
<span class="hljs-keyword">export</span> type AppDispatch = <span class="hljs-keyword">typeof</span> store.dispatch;

<span class="hljs-comment">// hooks/redux.ts</span>
<span class="hljs-keyword">import</span> { useDispatch, useSelector, TypedUseSelectorHook } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;
<span class="hljs-keyword">import</span> type { RootState, AppDispatch } <span class="hljs-keyword">from</span> <span class="hljs-string">'../store'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useAppDispatch = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useDispatch&lt;AppDispatch&gt;();
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useAppSelector: TypedUseSelectorHook&lt;RootState&gt; = useSelector;

<span class="hljs-comment">// components/LoginForm.jsx</span>
<span class="hljs-keyword">import</span> React, { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> { useAppDispatch, useAppSelector } <span class="hljs-keyword">from</span> <span class="hljs-string">'../hooks/redux'</span>;
<span class="hljs-keyword">import</span> { loginUser, clearError } <span class="hljs-keyword">from</span> <span class="hljs-string">'../store/userSlice'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LoginForm</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> [email, setEmail] = useState(<span class="hljs-string">''</span>);
    <span class="hljs-keyword">const</span> [password, setPassword] = useState(<span class="hljs-string">''</span>);
    <span class="hljs-keyword">const</span> dispatch = useAppDispatch();
    <span class="hljs-keyword">const</span> { loading, error } = useAppSelector(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.user);

    <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> (e) =&gt; {
        e.preventDefault();
        dispatch(clearError());

        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> dispatch(loginUser({ email, password }));
        <span class="hljs-keyword">if</span> (loginUser.fulfilled.match(result)) {
            <span class="hljs-comment">// Login successful</span>
            <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Login successful'</span>);
        }
    };

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{email}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setEmail(e.target.value)}
                placeholder="Email"
                required
            /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{password}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setPassword(e.target.value)}
                placeholder="Password"
                required
            /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{loading}</span>&gt;</span>
                {loading ? 'Logging in...' : 'Login'}
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            {error &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
        <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
    );
}
</div></code></pre>
<h3 id="zustand-lightweight-state-management">Zustand (Lightweight State Management)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// stores/useUserStore.js</span>
<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { persist } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand/middleware'</span>;

<span class="hljs-keyword">const</span> useUserStore = create(
    persist(
        <span class="hljs-function">(<span class="hljs-params">set, get</span>) =&gt;</span> ({
            <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
            <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,

            <span class="hljs-attr">login</span>: <span class="hljs-keyword">async</span> (email, password) =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">set</span>({ loading: <span class="hljs-literal">true</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });

                    <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">'/api/auth/login'</span>, {
                        <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span>,
                        <span class="hljs-attr">headers</span>: { <span class="hljs-string">'Content-Type'</span>: <span class="hljs-string">'application/json'</span> },
                        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({ email, password })
                    });

                    <span class="hljs-keyword">if</span> (!response.ok) {
                        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'Invalid credentials'</span>);
                    }

                    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> response.json();
                    <span class="hljs-keyword">set</span>({ user, <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });
                    <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> };
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-keyword">set</span>({ error: error.message, <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span> });
                    <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: error.message };
                }
            },

            <span class="hljs-attr">logout</span>: <span class="hljs-keyword">async</span> () =&gt; {
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">'/api/auth/logout'</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">'POST'</span> });
                } <span class="hljs-keyword">catch</span> (error) {
                    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'Logout error:'</span>, error);
                } <span class="hljs-keyword">finally</span> {
                    <span class="hljs-keyword">set</span>({ user: <span class="hljs-literal">null</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> });
                }
            },

            <span class="hljs-attr">updateUser</span>: <span class="hljs-function">(<span class="hljs-params">updates</span>) =&gt;</span> {
                <span class="hljs-keyword">set</span>((state) =&gt; ({
                    <span class="hljs-attr">user</span>: state.user ? { ...state.user, ...updates } : <span class="hljs-literal">null</span>
                }));
            },

            <span class="hljs-attr">clearError</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">set</span>({ error: <span class="hljs-literal">null</span> })
        }),
        {
            <span class="hljs-attr">name</span>: <span class="hljs-string">'user-storage'</span>,
            <span class="hljs-attr">partialize</span>: <span class="hljs-function">(<span class="hljs-params">state</span>) =&gt;</span> ({ <span class="hljs-attr">user</span>: state.user }) <span class="hljs-comment">// Only persist user data</span>
        }
    )
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useUserStore;

<span class="hljs-comment">// stores/useTodosStore.js</span>
<span class="hljs-keyword">import</span> { create } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand'</span>;
<span class="hljs-keyword">import</span> { immer } <span class="hljs-keyword">from</span> <span class="hljs-string">'zustand/middleware/immer'</span>;

<span class="hljs-keyword">const</span> useTodosStore = create(
    immer(<span class="hljs-function">(<span class="hljs-params">set</span>) =&gt;</span> ({
        <span class="hljs-attr">todos</span>: [],
        <span class="hljs-attr">filter</span>: <span class="hljs-string">'all'</span>,

        <span class="hljs-attr">addTodo</span>: <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> <span class="hljs-keyword">set</span>((state) =&gt; {
            state.todos.push({
                <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
                text,
                <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()
            });
        }),

        <span class="hljs-attr">toggleTodo</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> <span class="hljs-keyword">set</span>((state) =&gt; {
            <span class="hljs-keyword">const</span> todo = state.todos.find(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> t.id === id);
            <span class="hljs-keyword">if</span> (todo) {
                todo.completed = !todo.completed;
            }
        }),

        <span class="hljs-attr">removeTodo</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> <span class="hljs-keyword">set</span>((state) =&gt; {
            <span class="hljs-keyword">const</span> index = state.todos.findIndex(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> t.id === id);
            <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-number">-1</span>) {
                state.todos.splice(index, <span class="hljs-number">1</span>);
            }
        }),

        <span class="hljs-attr">setFilter</span>: <span class="hljs-function">(<span class="hljs-params">filter</span>) =&gt;</span> <span class="hljs-keyword">set</span>({ filter }),

        <span class="hljs-attr">clearCompleted</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">set</span>((state) =&gt; {
            state.todos = state.todos.filter(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.completed);
        }),

        <span class="hljs-comment">// Computed values</span>
        <span class="hljs-keyword">get</span> filteredTodos() {
            <span class="hljs-keyword">const</span> { todos, filter } = useTodosStore.getState();
            <span class="hljs-keyword">switch</span> (filter) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'active'</span>:
                    <span class="hljs-keyword">return</span> todos.filter(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> !todo.completed);
                <span class="hljs-keyword">case</span> <span class="hljs-string">'completed'</span>:
                    <span class="hljs-keyword">return</span> todos.filter(<span class="hljs-function"><span class="hljs-params">todo</span> =&gt;</span> todo.completed);
                <span class="hljs-keyword">default</span>:
                    <span class="hljs-keyword">return</span> todos;
            }
        },

        <span class="hljs-keyword">get</span> stats() {
            <span class="hljs-keyword">const</span> { todos } = useTodosStore.getState();
            <span class="hljs-keyword">return</span> {
                <span class="hljs-attr">total</span>: todos.length,
                <span class="hljs-attr">active</span>: todos.filter(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> !t.completed).length,
                <span class="hljs-attr">completed</span>: todos.filter(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> t.completed).length
            };
        }
    }))
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useTodosStore;

<span class="hljs-comment">// Usage in component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoApp</span>(<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">const</span> {
        todos,
        filter,
        addTodo,
        toggleTodo,
        removeTodo,
        setFilter,
        clearCompleted,
        filteredTodos,
        stats
    } = useTodosStore();

    <span class="hljs-keyword">const</span> [newTodo, setNewTodo] = useState(<span class="hljs-string">''</span>);

    <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
        e.preventDefault();
        <span class="hljs-keyword">if</span> (newTodo.trim()) {
            addTodo(newTodo.trim());
            setNewTodo(<span class="hljs-string">''</span>);
        }
    };

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-app"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                    <span class="hljs-attr">value</span>=<span class="hljs-string">{newTodo}</span>
                    <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setNewTodo(e.target.value)}
                    placeholder="Add a new todo..."
                /&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Add<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filters"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                    <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFilter('all')}
                    className={filter === 'all' ? 'active' : ''}
                &gt;
                    All ({stats.total})
                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                    <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFilter('active')}
                    className={filter === 'active' ? 'active' : ''}
                &gt;
                    Active ({stats.active})
                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                    <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFilter('completed')}
                    className={filter === 'completed' ? 'active' : ''}
                &gt;
                    Completed ({stats.completed})
                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-list"</span>&gt;</span>
                {filteredTodos.map(todo =&gt; (
                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{todo.completed</span> ? '<span class="hljs-attr">completed</span>' <span class="hljs-attr">:</span> ''}&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                            <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
                            <span class="hljs-attr">checked</span>=<span class="hljs-string">{todo.completed}</span>
                            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleTodo(todo.id)}
                        /&gt;
                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeTodo(todo.id)}&gt;Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                ))}
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>

            {stats.completed &gt; 0 &amp;&amp; (
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearCompleted}</span>&gt;</span>
                    Clear Completed ({stats.completed})
                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
}
</div></code></pre>
<hr>
<h2 id="%F0%9F%8F%97%EF%B8%8F-component-architecture">🏗️ Component Architecture</h2>
<h3 id="design-patterns">Design Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. Container/Presentational Pattern</span>
<span class="hljs-comment">// Container Component (Smart)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserListContainer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [users, setUsers] = useState([]);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetchUsers();
  }, []);

  <span class="hljs-keyword">const</span> fetchUsers = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      setLoading(<span class="hljs-literal">true</span>);
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/users"</span>);
      <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
      setUsers(userData);
    } <span class="hljs-keyword">catch</span> (err) {
      setError(err.message);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-keyword">const</span> handleUserDelete = <span class="hljs-keyword">async</span> (userId) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>, { <span class="hljs-attr">method</span>: <span class="hljs-string">"DELETE"</span> });
      setUsers(users.filter(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id !== userId));
    } <span class="hljs-keyword">catch</span> (err) {
      setError(err.message);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserListPresentation</span>
      <span class="hljs-attr">users</span>=<span class="hljs-string">{users}</span>
      <span class="hljs-attr">loading</span>=<span class="hljs-string">{loading}</span>
      <span class="hljs-attr">error</span>=<span class="hljs-string">{error}</span>
      <span class="hljs-attr">onUserDelete</span>=<span class="hljs-string">{handleUserDelete}</span>
      <span class="hljs-attr">onRetry</span>=<span class="hljs-string">{fetchUsers}</span>
    /&gt;</span></span>
  );
}

<span class="hljs-comment">// Presentational Component (Dumb)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserListPresentation</span>(<span class="hljs-params">{
  users,
  loading,
  error,
  onUserDelete,
  onRetry,
}</span>) </span>{
  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoadingSpinner</span> /&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorMessage</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{error}</span> <span class="hljs-attr">onRetry</span>=<span class="hljs-string">{onRetry}</span> /&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-list"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Users ({users.length})<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      {users.map((user) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>
          <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span>
          <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{()</span> =&gt;</span> onUserDelete(user.id)}
        /&gt;
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 2. Higher-Order Component (HOC) Pattern</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withLoading</span>(<span class="hljs-params">WrappedComponent</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WithLoadingComponent</span>(<span class="hljs-params">props</span>) </span>{
    <span class="hljs-keyword">if</span> (props.loading) {
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoadingSpinner</span> /&gt;</span></span>;
    }
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...props</span>} /&gt;</span></span>;
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withErrorHandling</span>(<span class="hljs-params">WrappedComponent</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WithErrorHandlingComponent</span>(<span class="hljs-params">props</span>) </span>{
    <span class="hljs-keyword">if</span> (props.error) {
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorMessage</span> <span class="hljs-attr">message</span>=<span class="hljs-string">{props.error}</span> /&gt;</span></span>;
    }
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...props</span>} /&gt;</span></span>;
  };
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> EnhancedUserList = withLoading(withErrorHandling(UserListPresentation));

<span class="hljs-comment">// 3. Render Props Pattern</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataFetcher</span>(<span class="hljs-params">{ url, children }</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetchData();
  }, [url]);

  <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      setLoading(<span class="hljs-literal">true</span>);
      setError(<span class="hljs-literal">null</span>);
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url);
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
      setData(result);
    } <span class="hljs-keyword">catch</span> (err) {
      setError(err.message);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-keyword">return</span> children({ data, loading, error, <span class="hljs-attr">refetch</span>: fetchData });
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DataFetcher</span> <span class="hljs-attr">url</span>=<span class="hljs-string">"/api/users"</span>&gt;</span>
      {({ data: users, loading, error, refetch }) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          {loading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
          {error &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
              Error: {error} <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{refetch}</span>&gt;</span>Retry<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          )}
          {users &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
              {users.map((user) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
              ))}
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">DataFetcher</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 4. Compound Component Pattern</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Accordion</span>(<span class="hljs-params">{ children, ...props }</span>) </span>{
  <span class="hljs-keyword">const</span> [openItems, setOpenItems] = useState(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());

  <span class="hljs-keyword">const</span> toggleItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newOpenItems = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(openItems);
    <span class="hljs-keyword">if</span> (newOpenItems.has(id)) {
      newOpenItems.delete(id);
    } <span class="hljs-keyword">else</span> {
      newOpenItems.add(id);
    }
    setOpenItems(newOpenItems);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"accordion"</span> {<span class="hljs-attr">...props</span>}&gt;</span>
      {React.Children.map(children, (child, index) =&gt; {
        if (React.isValidElement(child)) {
          return React.cloneElement(child, {
            isOpen: openItems.has(index),
            onToggle: () =&gt; toggleItem(index),
            index,
          });
        }
        return child;
      })}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AccordionItem</span>(<span class="hljs-params">{ title, children, isOpen, onToggle }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"accordion-item"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"accordion-header"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onToggle}</span>&gt;</span>
        {title}
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">accordion-icon</span> ${<span class="hljs-attr">isOpen</span> ? "<span class="hljs-attr">open</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>▼<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      {isOpen &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"accordion-content"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FAQ</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Accordion</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AccordionItem</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"What is React?"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>React is a JavaScript library for building user interfaces.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">AccordionItem</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AccordionItem</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"How do I get started?"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You can start by creating a new React app using Create React App.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">AccordionItem</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AccordionItem</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"What are components?"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Components are reusable pieces of UI that can accept props and manage
          state.
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">AccordionItem</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="component-composition">Component Composition</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Flexible Layout Components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Layout</span>(<span class="hljs-params">{ children, sidebar, header, footer }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"layout"</span>&gt;</span>
      {header &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"layout-header"</span>&gt;</span>{header}<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"layout-body"</span>&gt;</span>
        {sidebar &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">aside</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"layout-sidebar"</span>&gt;</span>{sidebar}<span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span>}
        <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"layout-main"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      {footer &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">footer</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"layout-footer"</span>&gt;</span>{footer}<span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Flexible Card Component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Card</span>(<span class="hljs-params">{ children, title, actions, variant = <span class="hljs-string">"default"</span>, ...props }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">card</span> <span class="hljs-attr">card--</span>${<span class="hljs-attr">variant</span>}`} {<span class="hljs-attr">...props</span>}&gt;</span>
      {title &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-header"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-title"</span>&gt;</span>{title}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
          {actions &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-actions"</span>&gt;</span>{actions}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-content"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Modal Component with Portal</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Modal</span>(<span class="hljs-params">{ isOpen, onClose, title, children, size = <span class="hljs-string">"medium"</span> }</span>) </span>{
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleEscape = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">"Escape"</span>) {
        onClose();
      }
    };

    <span class="hljs-keyword">if</span> (isOpen) {
      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleEscape);
      <span class="hljs-built_in">document</span>.body.style.overflow = <span class="hljs-string">"hidden"</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleEscape);
      <span class="hljs-built_in">document</span>.body.style.overflow = <span class="hljs-string">"unset"</span>;
    };
  }, [isOpen, onClose]);

  <span class="hljs-keyword">if</span> (!isOpen) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> ReactDOM.createPortal(
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-overlay"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClose}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">modal</span> <span class="hljs-attr">modal--</span>${<span class="hljs-attr">size</span>}`}
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{(e)</span> =&gt;</span> e.stopPropagation()}
      &gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-title"</span>&gt;</span>{title}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-close"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClose}</span>&gt;</span>
            ×
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>,
    <span class="hljs-built_in">document</span>.body
  );
}

<span class="hljs-comment">// Form Components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Form</span>(<span class="hljs-params">{ onSubmit, children, ...props }</span>) </span>{
  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    e.preventDefault();
    <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(e.target);
    <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">Object</span>.fromEntries(formData.entries());
    onSubmit(data);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span> {<span class="hljs-attr">...props</span>}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormField</span>(<span class="hljs-params">{ label, error, children, required, ...props }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-field"</span>&gt;</span>
      {label &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-label"</span>&gt;</span>
          {label}
          {required &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"required"</span>&gt;</span>*<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
        <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      )}
      {children}
      {error &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-error"</span>&gt;</span>{error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Input</span>(<span class="hljs-params">{ type = <span class="hljs-string">"text"</span>, ...props }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-input"</span> {<span class="hljs-attr">...props</span>} /&gt;</span></span>;
}

<span class="hljs-comment">// Usage Example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserForm</span>(<span class="hljs-params">{ user, onSubmit }</span>) </span>{
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-comment">// Validation</span>
    <span class="hljs-keyword">const</span> newErrors = {};
    <span class="hljs-keyword">if</span> (!data.name) newErrors.name = <span class="hljs-string">"Name is required"</span>;
    <span class="hljs-keyword">if</span> (!data.email) newErrors.email = <span class="hljs-string">"Email is required"</span>;

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(newErrors).length &gt; <span class="hljs-number">0</span>) {
      setErrors(newErrors);
      <span class="hljs-keyword">return</span>;
    }

    setErrors({});
    onSubmit(data);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Card</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"User Information"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"Name"</span> <span class="hljs-attr">error</span>=<span class="hljs-string">{errors.name}</span> <span class="hljs-attr">required</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">{user?.name}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">FormField</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"Email"</span> <span class="hljs-attr">error</span>=<span class="hljs-string">{errors.email}</span> <span class="hljs-attr">required</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">{user?.email}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">FormField</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span> <span class="hljs-attr">label</span>=<span class="hljs-string">"Bio"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"bio"</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">"form-input"</span>
            <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">{user?.bio}</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">FormField</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"btn btn-primary"</span>&gt;</span>
          {user ? "Update" : "Create"} User
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span></span>
  );
}
</div></code></pre>
<h1 id="chapter-20-nodejs--backend-development-%F0%9F%9A%80">Chapter 20: Node.js &amp; Backend Development 🚀</h1>
<h2 id="%F0%9F%93%8B-table-of-contents">📋 Table of Contents</h2>
<ul>
<li><a href="#introduction-to-nodejs">Introduction to Node.js</a></li>
<li><a href="#setting-up-nodejs-environment">Setting Up Node.js Environment</a></li>
<li><a href="#core-modules">Core Modules</a></li>
<li><a href="#expressjs-framework">Express.js Framework</a></li>
<li><a href="#database-integration">Database Integration</a></li>
<li><a href="#authentication--authorization">Authentication &amp; Authorization</a></li>
<li><a href="#api-development">API Development</a></li>
<li><a href="#file-handling">File Handling</a></li>
<li><a href="#real-time-communication">Real-time Communication</a></li>
<li><a href="#testing-backend-applications">Testing Backend Applications</a></li>
<li><a href="#deployment--production">Deployment &amp; Production</a></li>
<li><a href="#common-pitfalls">Common Pitfalls</a></li>
<li><a href="#practice-problems">Practice Problems</a></li>
<li><a href="#interview-notes">Interview Notes</a></li>
</ul>
<hr>
<h2 id="%F0%9F%8C%9F-introduction-to-nodejs">🌟 Introduction to Node.js</h2>
<h3 id="what-is-nodejs">What is Node.js?</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Node.js is a JavaScript runtime built on Chrome's V8 JavaScript engine</span>
<span class="hljs-comment">// It allows you to run JavaScript on the server side</span>

<span class="hljs-comment">// Key Features:</span>
<span class="hljs-comment">// 1. Event-driven, non-blocking I/O</span>
<span class="hljs-comment">// 2. Single-threaded with event loop</span>
<span class="hljs-comment">// 3. NPM (Node Package Manager)</span>
<span class="hljs-comment">// 4. Cross-platform</span>
<span class="hljs-comment">// 5. Fast execution</span>

<span class="hljs-comment">// Event Loop Example</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Start"</span>);

setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Timeout callback"</span>);
}, <span class="hljs-number">0</span>);

setImmediate(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Immediate callback"</span>);
});

process.nextTick(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Next tick callback"</span>);
});

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"End"</span>);

<span class="hljs-comment">// Output:</span>
<span class="hljs-comment">// Start</span>
<span class="hljs-comment">// End</span>
<span class="hljs-comment">// Next tick callback</span>
<span class="hljs-comment">// Immediate callback</span>
<span class="hljs-comment">// Timeout callback</span>
</div></code></pre>
<h3 id="nodejs-vs-browser-javascript">Node.js vs Browser JavaScript</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Browser JavaScript</span>
<span class="hljs-comment">// - DOM manipulation</span>
<span class="hljs-comment">// - Window object</span>
<span class="hljs-comment">// - Limited file system access</span>
<span class="hljs-comment">// - Same-origin policy</span>

<span class="hljs-comment">// Node.js JavaScript</span>
<span class="hljs-comment">// - File system access</span>
<span class="hljs-comment">// - Network operations</span>
<span class="hljs-comment">// - Process management</span>
<span class="hljs-comment">// - Module system (CommonJS/ES Modules)</span>

<span class="hljs-comment">// Node.js Global Objects</span>
<span class="hljs-built_in">console</span>.log(__dirname); <span class="hljs-comment">// Current directory</span>
<span class="hljs-built_in">console</span>.log(__filename); <span class="hljs-comment">// Current file</span>
<span class="hljs-built_in">console</span>.log(process.env); <span class="hljs-comment">// Environment variables</span>
<span class="hljs-built_in">console</span>.log(process.argv); <span class="hljs-comment">// Command line arguments</span>

<span class="hljs-comment">// Module System</span>
<span class="hljs-comment">// CommonJS (traditional)</span>
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fs"</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);

<span class="hljs-comment">// ES Modules (modern)</span>
<span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;
</div></code></pre>
<hr>
<h2 id="%E2%9A%99%EF%B8%8F-setting-up-nodejs-environment">⚙️ Setting Up Node.js Environment</h2>
<h3 id="project-initialization">Project Initialization</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Initialize a new Node.js project</span>
npm init -y

<span class="hljs-comment"># Install dependencies</span>
npm install express mongoose dotenv
npm install -D nodemon jest supertest

<span class="hljs-comment"># Create basic project structure</span>
mkdir src
mkdir src/controllers
mkdir src/models
mkdir src/routes
mkdir src/middleware
mkdir src/utils
mkdir tests
</div></code></pre>
<h3 id="packagejson-configuration">Package.json Configuration</h3>
<pre class="hljs"><code><div>{
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"my-node-app"</span>,
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-attr">"description"</span>: <span class="hljs-string">"A Node.js backend application"</span>,
  <span class="hljs-attr">"main"</span>: <span class="hljs-string">"src/app.js"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"module"</span>,
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"start"</span>: <span class="hljs-string">"node src/app.js"</span>,
    <span class="hljs-attr">"dev"</span>: <span class="hljs-string">"nodemon src/app.js"</span>,
    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"jest"</span>,
    <span class="hljs-attr">"test:watch"</span>: <span class="hljs-string">"jest --watch"</span>,
    <span class="hljs-attr">"lint"</span>: <span class="hljs-string">"eslint src/"</span>,
    <span class="hljs-attr">"build"</span>: <span class="hljs-string">"babel src -d dist"</span>
  },
  <span class="hljs-attr">"dependencies"</span>: {
    <span class="hljs-attr">"express"</span>: <span class="hljs-string">"^4.18.2"</span>,
    <span class="hljs-attr">"mongoose"</span>: <span class="hljs-string">"^7.5.0"</span>,
    <span class="hljs-attr">"dotenv"</span>: <span class="hljs-string">"^16.3.1"</span>,
    <span class="hljs-attr">"bcryptjs"</span>: <span class="hljs-string">"^2.4.3"</span>,
    <span class="hljs-attr">"jsonwebtoken"</span>: <span class="hljs-string">"^9.0.2"</span>,
    <span class="hljs-attr">"cors"</span>: <span class="hljs-string">"^2.8.5"</span>,
    <span class="hljs-attr">"helmet"</span>: <span class="hljs-string">"^7.0.0"</span>,
    <span class="hljs-attr">"express-rate-limit"</span>: <span class="hljs-string">"^6.10.0"</span>
  },
  <span class="hljs-attr">"devDependencies"</span>: {
    <span class="hljs-attr">"nodemon"</span>: <span class="hljs-string">"^3.0.1"</span>,
    <span class="hljs-attr">"jest"</span>: <span class="hljs-string">"^29.6.4"</span>,
    <span class="hljs-attr">"supertest"</span>: <span class="hljs-string">"^6.3.3"</span>,
    <span class="hljs-attr">"eslint"</span>: <span class="hljs-string">"^8.48.0"</span>
  }
}
</div></code></pre>
<h3 id="environment-configuration">Environment Configuration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// .env file</span>
PORT=<span class="hljs-number">3000</span>
MONGODB_URI=mongodb:<span class="hljs-comment">//localhost:27017/myapp</span>
JWT_SECRET=your-<span class="hljs-keyword">super</span>-secret-jwt-key
NODE_ENV=development
API_VERSION=v1

<span class="hljs-comment">// config/database.js</span>
<span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">'mongoose'</span>;
<span class="hljs-keyword">import</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">'dotenv'</span>;

dotenv.config();

<span class="hljs-keyword">const</span> connectDB = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> conn = <span class="hljs-keyword">await</span> mongoose.connect(process.env.MONGODB_URI, {
            <span class="hljs-attr">useNewUrlParser</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">useUnifiedTopology</span>: <span class="hljs-literal">true</span>,
        });

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`MongoDB Connected: <span class="hljs-subst">${conn.connection.host}</span>`</span>);
    } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'Database connection error:'</span>, error.message);
        process.exit(<span class="hljs-number">1</span>);
    }
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connectDB;

<span class="hljs-comment">// config/config.js</span>
<span class="hljs-keyword">import</span> dotenv <span class="hljs-keyword">from</span> <span class="hljs-string">'dotenv'</span>;

dotenv.config();

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> config = {
    <span class="hljs-attr">port</span>: process.env.PORT || <span class="hljs-number">3000</span>,
    <span class="hljs-attr">mongoUri</span>: process.env.MONGODB_URI,
    <span class="hljs-attr">jwtSecret</span>: process.env.JWT_SECRET,
    <span class="hljs-attr">nodeEnv</span>: process.env.NODE_ENV || <span class="hljs-string">'development'</span>,
    <span class="hljs-attr">apiVersion</span>: process.env.API_VERSION || <span class="hljs-string">'v1'</span>
};
</div></code></pre>
<hr>
<h2 id="%F0%9F%94%A7-core-modules">🔧 Core Modules</h2>
<h3 id="file-system-fs">File System (fs)</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> fs <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>;
<span class="hljs-keyword">import</span> { promises <span class="hljs-keyword">as</span> fsPromises } <span class="hljs-keyword">from</span> <span class="hljs-string">"fs"</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">"path"</span>;

<span class="hljs-comment">// Synchronous file operations (blocking)</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> data = fs.readFileSync(<span class="hljs-string">"file.txt"</span>, <span class="hljs-string">"utf8"</span>);
  <span class="hljs-built_in">console</span>.log(data);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error reading file:"</span>, error.message);
}

<span class="hljs-comment">// Asynchronous file operations (non-blocking)</span>
fs.readFile(<span class="hljs-string">"file.txt"</span>, <span class="hljs-string">"utf8"</span>, (err, data) =&gt; {
  <span class="hljs-keyword">if</span> (err) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error reading file:"</span>, err.message);
    <span class="hljs-keyword">return</span>;
  }
  <span class="hljs-built_in">console</span>.log(data);
});

<span class="hljs-comment">// Promise-based file operations</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> fsPromises.readFile(<span class="hljs-string">"file.txt"</span>, <span class="hljs-string">"utf8"</span>);
  <span class="hljs-built_in">console</span>.log(data);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error reading file:"</span>, error.message);
}

<span class="hljs-comment">// File operations utility class</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileManager</span> </span>{
  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> readJSON(filePath) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> fsPromises.readFile(filePath, <span class="hljs-string">"utf8"</span>);
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(data);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Failed to read JSON file: <span class="hljs-subst">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> writeJSON(filePath, data) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> jsonData = <span class="hljs-built_in">JSON</span>.stringify(data, <span class="hljs-literal">null</span>, <span class="hljs-number">2</span>);
      <span class="hljs-keyword">await</span> fsPromises.writeFile(filePath, jsonData, <span class="hljs-string">"utf8"</span>);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Failed to write JSON file: <span class="hljs-subst">${error.message}</span>`</span>);
    }
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> ensureDirectory(dirPath) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> fsPromises.access(dirPath);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">await</span> fsPromises.mkdir(dirPath, { <span class="hljs-attr">recursive</span>: <span class="hljs-literal">true</span> });
    }
  }

  <span class="hljs-keyword">static</span> <span class="hljs-keyword">async</span> deleteFile(filePath) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> fsPromises.unlink(filePath);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">if</span> (error.code !== <span class="hljs-string">"ENOENT"</span>) {
        <span class="hljs-keyword">throw</span> error;
      }
    }
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">try</span> {
  <span class="hljs-keyword">await</span> FileManager.ensureDirectory(<span class="hljs-string">"./uploads"</span>);
  <span class="hljs-keyword">const</span> config = <span class="hljs-keyword">await</span> FileManager.readJSON(<span class="hljs-string">"./config.json"</span>);
  <span class="hljs-keyword">await</span> FileManager.writeJSON(<span class="hljs-string">"./backup.json"</span>, config);
} <span class="hljs-keyword">catch</span> (error) {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"File operation failed:"</span>, error.message);
}
</div></code></pre>
<h3 id="http-module">HTTP Module</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> http <span class="hljs-keyword">from</span> <span class="hljs-string">"http"</span>;
<span class="hljs-keyword">import</span> url <span class="hljs-keyword">from</span> <span class="hljs-string">"url"</span>;
<span class="hljs-keyword">import</span> querystring <span class="hljs-keyword">from</span> <span class="hljs-string">"querystring"</span>;

<span class="hljs-comment">// Basic HTTP server</span>
<span class="hljs-keyword">const</span> server = http.createServer(<span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> parsedUrl = url.parse(req.url, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> { pathname, query } = parsedUrl;
  <span class="hljs-keyword">const</span> method = req.method;

  <span class="hljs-comment">// Set CORS headers</span>
  res.setHeader(<span class="hljs-string">"Access-Control-Allow-Origin"</span>, <span class="hljs-string">"*"</span>);
  res.setHeader(<span class="hljs-string">"Access-Control-Allow-Methods"</span>, <span class="hljs-string">"GET, POST, PUT, DELETE"</span>);
  res.setHeader(<span class="hljs-string">"Access-Control-Allow-Headers"</span>, <span class="hljs-string">"Content-Type, Authorization"</span>);

  <span class="hljs-comment">// Handle preflight requests</span>
  <span class="hljs-keyword">if</span> (method === <span class="hljs-string">"OPTIONS"</span>) {
    res.writeHead(<span class="hljs-number">200</span>);
    res.end();
    <span class="hljs-keyword">return</span>;
  }

  <span class="hljs-comment">// Route handling</span>
  <span class="hljs-keyword">if</span> (pathname === <span class="hljs-string">"/api/users"</span> &amp;&amp; method === <span class="hljs-string">"GET"</span>) {
    res.writeHead(<span class="hljs-number">200</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> });
    res.end(<span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">users</span>: [<span class="hljs-string">"John"</span>, <span class="hljs-string">"Jane"</span>] }));
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (pathname === <span class="hljs-string">"/api/users"</span> &amp;&amp; method === <span class="hljs-string">"POST"</span>) {
    <span class="hljs-keyword">let</span> body = <span class="hljs-string">""</span>;

    req.on(<span class="hljs-string">"data"</span>, (chunk) =&gt; {
      body += chunk.toString();
    });

    req.on(<span class="hljs-string">"end"</span>, () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> userData = <span class="hljs-built_in">JSON</span>.parse(body);
        res.writeHead(<span class="hljs-number">201</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> });
        res.end(<span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">message</span>: <span class="hljs-string">"User created"</span>, <span class="hljs-attr">user</span>: userData }));
      } <span class="hljs-keyword">catch</span> (error) {
        res.writeHead(<span class="hljs-number">400</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> });
        res.end(<span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">error</span>: <span class="hljs-string">"Invalid JSON"</span> }));
      }
    });
  } <span class="hljs-keyword">else</span> {
    res.writeHead(<span class="hljs-number">404</span>, { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> });
    res.end(<span class="hljs-built_in">JSON</span>.stringify({ <span class="hljs-attr">error</span>: <span class="hljs-string">"Not Found"</span> }));
  }
});

<span class="hljs-keyword">const</span> PORT = process.env.PORT || <span class="hljs-number">3000</span>;
server.listen(PORT, () =&gt; {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Server running on port <span class="hljs-subst">${PORT}</span>`</span>);
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%A7%AA-testing-backend-applications">🧪 Testing Backend Applications</h2>
<h3 id="unit-testing-with-jest">Unit Testing with Jest</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// tests/services/userService.test.js</span>
<span class="hljs-keyword">import</span> UserService <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/services/userService.js"</span>;
<span class="hljs-keyword">import</span> User <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/models/User.js"</span>;
<span class="hljs-keyword">import</span> { jest } <span class="hljs-keyword">from</span> <span class="hljs-string">"@jest/globals"</span>;

<span class="hljs-comment">// Mock the User model</span>
jest.mock(<span class="hljs-string">"../../src/models/User.js"</span>);

describe(<span class="hljs-string">"UserService"</span>, () =&gt; {
  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    jest.clearAllMocks();
  });

  describe(<span class="hljs-string">"createUser"</span>, () =&gt; {
    it(<span class="hljs-string">"should create a new user successfully"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> userData = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
        <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
        <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
      };

      <span class="hljs-keyword">const</span> mockUser = {
        <span class="hljs-attr">_id</span>: <span class="hljs-string">"user123"</span>,
        ...userData,
        <span class="hljs-attr">save</span>: jest.fn().mockResolvedValue(<span class="hljs-literal">true</span>),
      };

      User.mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> mockUser);

      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> UserService.createUser(userData);

      expect(User).toHaveBeenCalledWith(userData);
      expect(mockUser.save).toHaveBeenCalled();
      expect(result).toEqual(mockUser);
    });

    it(<span class="hljs-string">"should throw error when user creation fails"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> userData = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
        <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
        <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
      };

      <span class="hljs-keyword">const</span> mockUser = {
        <span class="hljs-attr">save</span>: jest.fn().mockRejectedValue(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Database error"</span>)),
      };

      User.mockImplementation(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> mockUser);

      <span class="hljs-keyword">await</span> expect(UserService.createUser(userData)).rejects.toThrow(
        <span class="hljs-string">"Failed to create user: Database error"</span>
      );
    });
  });

  describe(<span class="hljs-string">"getUserById"</span>, () =&gt; {
    it(<span class="hljs-string">"should return user when found"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> userId = <span class="hljs-string">"user123"</span>;
      <span class="hljs-keyword">const</span> mockUser = {
        <span class="hljs-attr">_id</span>: userId,
        <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
        <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
      };

      User.findById.mockResolvedValue(mockUser);

      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> UserService.getUserById(userId);

      expect(User.findById).toHaveBeenCalledWith(userId);
      expect(result).toEqual(mockUser);
    });

    it(<span class="hljs-string">"should throw error when user not found"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> userId = <span class="hljs-string">"nonexistent"</span>;

      User.findById.mockResolvedValue(<span class="hljs-literal">null</span>);

      <span class="hljs-keyword">await</span> expect(UserService.getUserById(userId)).rejects.toThrow(
        <span class="hljs-string">"Failed to get user: User not found"</span>
      );
    });
  });
});
</div></code></pre>
<h3 id="integration-testing">Integration Testing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// tests/integration/auth.test.js</span>
<span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">"supertest"</span>;
<span class="hljs-keyword">import</span> app <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/app.js"</span>;
<span class="hljs-keyword">import</span> User <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/models/User.js"</span>;
<span class="hljs-keyword">import</span> connectDB <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/config/database.js"</span>;
<span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">"mongoose"</span>;

describe(<span class="hljs-string">"Authentication Integration Tests"</span>, () =&gt; {
  beforeAll(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> connectDB();
  });

  afterAll(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> mongoose.connection.close();
  });

  beforeEach(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> User.deleteMany({});
  });

  describe(<span class="hljs-string">"POST /api/v1/auth/register"</span>, () =&gt; {
    it(<span class="hljs-string">"should register a new user"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> userData = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
        <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
        <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
      };

      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .post(<span class="hljs-string">"/api/v1/auth/register"</span>)
        .send(userData)
        .expect(<span class="hljs-number">201</span>);

      expect(response.body.success).toBe(<span class="hljs-literal">true</span>);
      expect(response.body.user.email).toBe(userData.email);
      expect(response.body.accessToken).toBeDefined();
      expect(response.body.refreshToken).toBeDefined();

      <span class="hljs-comment">// Verify user was created in database</span>
      <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> User.findOne({ <span class="hljs-attr">email</span>: userData.email });
      expect(user).toBeTruthy();
      expect(user.name).toBe(userData.name);
    });

    it(<span class="hljs-string">"should not register user with invalid email"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> userData = {
        <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
        <span class="hljs-attr">email</span>: <span class="hljs-string">"invalid-email"</span>,
        <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
      };

      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .post(<span class="hljs-string">"/api/v1/auth/register"</span>)
        .send(userData)
        .expect(<span class="hljs-number">400</span>);

      expect(response.body.success).toBe(<span class="hljs-literal">false</span>);
      expect(response.body.error).toContain(<span class="hljs-string">"Validation failed"</span>);
    });
  });

  describe(<span class="hljs-string">"POST /api/v1/auth/login"</span>, () =&gt; {
    <span class="hljs-keyword">let</span> user;

    beforeEach(<span class="hljs-keyword">async</span> () =&gt; {
      user = <span class="hljs-keyword">new</span> User({
        <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>,
        <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
        <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
      });
      <span class="hljs-keyword">await</span> user.save();
    });

    it(<span class="hljs-string">"should login with valid credentials"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .post(<span class="hljs-string">"/api/v1/auth/login"</span>)
        .send({
          <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
          <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
        })
        .expect(<span class="hljs-number">200</span>);

      expect(response.body.message).toBe(<span class="hljs-string">"Login successful"</span>);
      expect(response.body.accessToken).toBeDefined();
      expect(response.body.refreshToken).toBeDefined();
    });

    it(<span class="hljs-string">"should not login with invalid credentials"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .post(<span class="hljs-string">"/api/v1/auth/login"</span>)
        .send({
          <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
          <span class="hljs-attr">password</span>: <span class="hljs-string">"wrongpassword"</span>,
        })
        .expect(<span class="hljs-number">401</span>);

      expect(response.body.error).toBe(<span class="hljs-string">"Invalid credentials"</span>);
    });
  });
});
</div></code></pre>
<h3 id="api-testing">API Testing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// tests/api/users.test.js</span>
<span class="hljs-keyword">import</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">"supertest"</span>;
<span class="hljs-keyword">import</span> app <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/app.js"</span>;
<span class="hljs-keyword">import</span> User <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/models/User.js"</span>;
<span class="hljs-keyword">import</span> jwt <span class="hljs-keyword">from</span> <span class="hljs-string">"jsonwebtoken"</span>;
<span class="hljs-keyword">import</span> { config } <span class="hljs-keyword">from</span> <span class="hljs-string">"../../src/config/config.js"</span>;

describe(<span class="hljs-string">"Users API"</span>, () =&gt; {
  <span class="hljs-keyword">let</span> authToken;
  <span class="hljs-keyword">let</span> adminToken;
  <span class="hljs-keyword">let</span> testUser;
  <span class="hljs-keyword">let</span> adminUser;

  beforeEach(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> User.deleteMany({});

    <span class="hljs-comment">// Create test user</span>
    testUser = <span class="hljs-keyword">new</span> User({
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Test User"</span>,
      <span class="hljs-attr">email</span>: <span class="hljs-string">"test@example.com"</span>,
      <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
    });
    <span class="hljs-keyword">await</span> testUser.save();

    <span class="hljs-comment">// Create admin user</span>
    adminUser = <span class="hljs-keyword">new</span> User({
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Admin User"</span>,
      <span class="hljs-attr">email</span>: <span class="hljs-string">"admin@example.com"</span>,
      <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
      <span class="hljs-attr">role</span>: <span class="hljs-string">"admin"</span>,
    });
    <span class="hljs-keyword">await</span> adminUser.save();

    <span class="hljs-comment">// Generate tokens</span>
    authToken = testUser.generateAuthToken();
    adminToken = adminUser.generateAuthToken();
  });

  describe(<span class="hljs-string">"GET /api/v1/users"</span>, () =&gt; {
    it(<span class="hljs-string">"should get all users"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app).get(<span class="hljs-string">"/api/v1/users"</span>).expect(<span class="hljs-number">200</span>);

      expect(response.body.success).toBe(<span class="hljs-literal">true</span>);
      expect(response.body.data).toHaveLength(<span class="hljs-number">2</span>);
      expect(response.body.pagination).toBeDefined();
    });

    it(<span class="hljs-string">"should support pagination"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .get(<span class="hljs-string">"/api/v1/users?page=1&amp;limit=1"</span>)
        .expect(<span class="hljs-number">200</span>);

      expect(response.body.data).toHaveLength(<span class="hljs-number">1</span>);
      expect(response.body.pagination.page).toBe(<span class="hljs-number">1</span>);
      expect(response.body.pagination.limit).toBe(<span class="hljs-number">1</span>);
      expect(response.body.pagination.total).toBe(<span class="hljs-number">2</span>);
    });
  });

  describe(<span class="hljs-string">"PUT /api/v1/users/:id"</span>, () =&gt; {
    it(<span class="hljs-string">"should update user with valid token"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> updateData = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Updated Name"</span> };

      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .put(<span class="hljs-string">`/api/v1/users/<span class="hljs-subst">${testUser._id}</span>`</span>)
        .set(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">`Bearer <span class="hljs-subst">${authToken}</span>`</span>)
        .send(updateData)
        .expect(<span class="hljs-number">200</span>);

      expect(response.body.success).toBe(<span class="hljs-literal">true</span>);
      expect(response.body.data.name).toBe(<span class="hljs-string">"Updated Name"</span>);
    });

    it(<span class="hljs-string">"should not update user without token"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> updateData = { <span class="hljs-attr">name</span>: <span class="hljs-string">"Updated Name"</span> };

      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .put(<span class="hljs-string">`/api/v1/users/<span class="hljs-subst">${testUser._id}</span>`</span>)
        .send(updateData)
        .expect(<span class="hljs-number">401</span>);

      expect(response.body.error).toBe(<span class="hljs-string">"Access denied. No token provided."</span>);
    });
  });

  describe(<span class="hljs-string">"DELETE /api/v1/users/:id"</span>, () =&gt; {
    it(<span class="hljs-string">"should delete user as admin"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .delete(<span class="hljs-string">`/api/v1/users/<span class="hljs-subst">${testUser._id}</span>`</span>)
        .set(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">`Bearer <span class="hljs-subst">${adminToken}</span>`</span>)
        .expect(<span class="hljs-number">200</span>);

      expect(response.body.success).toBe(<span class="hljs-literal">true</span>);
      expect(response.body.message).toBe(<span class="hljs-string">"User deleted successfully"</span>);
    });

    it(<span class="hljs-string">"should not delete user as regular user"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> request(app)
        .delete(<span class="hljs-string">`/api/v1/users/<span class="hljs-subst">${adminUser._id}</span>`</span>)
        .set(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">`Bearer <span class="hljs-subst">${authToken}</span>`</span>)
        .expect(<span class="hljs-number">403</span>);

      expect(response.body.error).toBe(<span class="hljs-string">"Insufficient permissions."</span>);
    });
  });
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%9A%80-deployment--production">🚀 Deployment &amp; Production</h2>
<h3 id="environment-configuration">Environment Configuration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// config/production.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> productionConfig = {
  <span class="hljs-comment">// Database</span>
  <span class="hljs-attr">mongoUri</span>: process.env.MONGODB_URI,

  <span class="hljs-comment">// Security</span>
  <span class="hljs-attr">jwtSecret</span>: process.env.JWT_SECRET,
  <span class="hljs-attr">bcryptRounds</span>: <span class="hljs-number">12</span>,

  <span class="hljs-comment">// Rate limiting</span>
  <span class="hljs-attr">rateLimitWindowMs</span>: <span class="hljs-number">15</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// 15 minutes</span>
  <span class="hljs-attr">rateLimitMax</span>: <span class="hljs-number">100</span>,

  <span class="hljs-comment">// CORS</span>
  <span class="hljs-attr">corsOrigin</span>: process.env.FRONTEND_URL?.split(<span class="hljs-string">","</span>) || [],

  <span class="hljs-comment">// Logging</span>
  <span class="hljs-attr">logLevel</span>: <span class="hljs-string">"info"</span>,

  <span class="hljs-comment">// File uploads</span>
  <span class="hljs-attr">maxFileSize</span>: <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>, <span class="hljs-comment">// 10MB</span>

  <span class="hljs-comment">// Session</span>
  <span class="hljs-attr">sessionSecret</span>: process.env.SESSION_SECRET,
  <span class="hljs-attr">sessionMaxAge</span>: <span class="hljs-number">24</span> * <span class="hljs-number">60</span> * <span class="hljs-number">60</span> * <span class="hljs-number">1000</span>, <span class="hljs-comment">// 24 hours</span>

  <span class="hljs-comment">// Email</span>
  <span class="hljs-attr">emailService</span>: process.env.EMAIL_SERVICE,
  <span class="hljs-attr">emailUser</span>: process.env.EMAIL_USER,
  <span class="hljs-attr">emailPassword</span>: process.env.EMAIL_PASSWORD,
};

<span class="hljs-comment">// Dockerfile</span>
<span class="hljs-comment">/*
FROM node:18-alpine

# Set working directory
WORKDIR /app

# Copy package files
COPY package*.json ./

# Install dependencies
RUN npm ci --only=production

# Copy source code
COPY src/ ./src/
COPY config/ ./config/

# Create non-root user
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nodejs -u 1001

# Change ownership
RUN chown -R nodejs:nodejs /app
USER nodejs

# Expose port
EXPOSE 3000

# Health check
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
    CMD node healthcheck.js

# Start application
CMD ["node", "src/app.js"]
*/</span>

<span class="hljs-comment">// docker-compose.yml</span>
<span class="hljs-comment">/*
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - MONGODB_URI=mongodb://mongo:27017/myapp
      - JWT_SECRET=${JWT_SECRET}
    depends_on:
      - mongo
      - redis
    restart: unless-stopped
    
  mongo:
    image: mongo:6
    ports:
      - "27017:27017"
    volumes:
      - mongo_data:/data/db
    restart: unless-stopped
    
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"
    restart: unless-stopped
    
volumes:
  mongo_data:
*/</span>
</div></code></pre>
<h3 id="process-management-with-pm2">Process Management with PM2</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ecosystem.config.js</span>
<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">apps</span>: [
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"my-app"</span>,
      <span class="hljs-attr">script</span>: <span class="hljs-string">"src/app.js"</span>,
      <span class="hljs-attr">instances</span>: <span class="hljs-string">"max"</span>, <span class="hljs-comment">// Use all CPU cores</span>
      <span class="hljs-attr">exec_mode</span>: <span class="hljs-string">"cluster"</span>,
      <span class="hljs-attr">env</span>: {
        <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">"development"</span>,
        <span class="hljs-attr">PORT</span>: <span class="hljs-number">3000</span>,
      },
      <span class="hljs-attr">env_production</span>: {
        <span class="hljs-attr">NODE_ENV</span>: <span class="hljs-string">"production"</span>,
        <span class="hljs-attr">PORT</span>: <span class="hljs-number">3000</span>,
      },
      <span class="hljs-attr">error_file</span>: <span class="hljs-string">"./logs/err.log"</span>,
      <span class="hljs-attr">out_file</span>: <span class="hljs-string">"./logs/out.log"</span>,
      <span class="hljs-attr">log_file</span>: <span class="hljs-string">"./logs/combined.log"</span>,
      <span class="hljs-attr">time</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">max_memory_restart</span>: <span class="hljs-string">"1G"</span>,
      <span class="hljs-attr">node_args</span>: <span class="hljs-string">"--max-old-space-size=1024"</span>,
    },
  ],
};

<span class="hljs-comment">// Start with PM2</span>
<span class="hljs-comment">// pm2 start ecosystem.config.js --env production</span>
<span class="hljs-comment">// pm2 save</span>
<span class="hljs-comment">// pm2 startup</span>
</div></code></pre>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-common-pitfalls">⚠️ Common Pitfalls</h2>
<h3 id="1-blocking-the-event-loop">1. <strong>Blocking the Event Loop</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Blocking operation</span>
app.get(<span class="hljs-string">"/bad"</span>, (req, res) =&gt; {
  <span class="hljs-comment">// This blocks the event loop</span>
  <span class="hljs-keyword">const</span> result = heavyComputationSync();
  res.json({ result });
});

<span class="hljs-comment">// ✅ Good: Non-blocking operation</span>
app.get(<span class="hljs-string">"/good"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// Use worker threads or async operations</span>
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> heavyComputationAsync();
    res.json({ result });
  } <span class="hljs-keyword">catch</span> (error) {
    res.status(<span class="hljs-number">500</span>).json({ <span class="hljs-attr">error</span>: error.message });
  }
});

<span class="hljs-comment">// ✅ Better: Use worker threads for CPU-intensive tasks</span>
<span class="hljs-keyword">import</span> { Worker, isMainThread, parentPort } <span class="hljs-keyword">from</span> <span class="hljs-string">"worker_threads"</span>;

<span class="hljs-keyword">if</span> (isMainThread) {
  app.get(<span class="hljs-string">"/worker"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> Worker(__filename);
      worker.postMessage(req.body.data);

      worker.on(<span class="hljs-string">"message"</span>, (result) =&gt; {
        res.json({ result });
      });

      worker.on(<span class="hljs-string">"error"</span>, (error) =&gt; {
        res.status(<span class="hljs-number">500</span>).json({ <span class="hljs-attr">error</span>: error.message });
      });
    } <span class="hljs-keyword">catch</span> (error) {
      res.status(<span class="hljs-number">500</span>).json({ <span class="hljs-attr">error</span>: error.message });
    }
  });
} <span class="hljs-keyword">else</span> {
  parentPort.on(<span class="hljs-string">"message"</span>, (data) =&gt; {
    <span class="hljs-keyword">const</span> result = heavyComputationSync(data);
    parentPort.postMessage(result);
  });
}
</div></code></pre>
<h3 id="2-memory-leaks">2. <strong>Memory Leaks</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Memory leaks</span>
<span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();

app.get(<span class="hljs-string">"/leak"</span>, (req, res) =&gt; {
  <span class="hljs-comment">// Cache grows indefinitely</span>
  cache.set(req.url, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>());
  res.json({ <span class="hljs-attr">cached</span>: cache.size });
});

<span class="hljs-comment">// ✅ Good: Proper cache management</span>
<span class="hljs-keyword">import</span> NodeCache <span class="hljs-keyword">from</span> <span class="hljs-string">"node-cache"</span>;

<span class="hljs-keyword">const</span> cache = <span class="hljs-keyword">new</span> NodeCache({
  <span class="hljs-attr">stdTTL</span>: <span class="hljs-number">600</span>, <span class="hljs-comment">// 10 minutes</span>
  <span class="hljs-attr">maxKeys</span>: <span class="hljs-number">1000</span>, <span class="hljs-comment">// Maximum 1000 keys</span>
});

app.get(<span class="hljs-string">"/cached"</span>, (req, res) =&gt; {
  <span class="hljs-keyword">const</span> key = req.url;
  <span class="hljs-keyword">let</span> data = cache.get(key);

  <span class="hljs-keyword">if</span> (!data) {
    data = generateData();
    cache.set(key, data);
  }

  res.json(data);
});

<span class="hljs-comment">// ❌ Bad: Event listener leaks</span>
app.get(<span class="hljs-string">"/events"</span>, (req, res) =&gt; {
  <span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> EventEmitter();

  <span class="hljs-comment">// Listener never removed</span>
  emitter.on(<span class="hljs-string">"data"</span>, (data) =&gt; {
    <span class="hljs-built_in">console</span>.log(data);
  });

  res.json({ <span class="hljs-attr">message</span>: <span class="hljs-string">"Event listener added"</span> });
});

<span class="hljs-comment">// ✅ Good: Proper cleanup</span>
app.get(<span class="hljs-string">"/events-clean"</span>, (req, res) =&gt; {
  <span class="hljs-keyword">const</span> emitter = <span class="hljs-keyword">new</span> EventEmitter();

  <span class="hljs-keyword">const</span> handler = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(data);
  };

  emitter.on(<span class="hljs-string">"data"</span>, handler);

  <span class="hljs-comment">// Cleanup after use</span>
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    emitter.removeListener(<span class="hljs-string">"data"</span>, handler);
  }, <span class="hljs-number">5000</span>);

  res.json({ <span class="hljs-attr">message</span>: <span class="hljs-string">"Event listener added with cleanup"</span> });
});
</div></code></pre>
<h3 id="3-improper-error-handling">3. <strong>Improper Error Handling</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Unhandled promise rejections</span>
app.get(<span class="hljs-string">"/bad-async"</span>, (req, res) =&gt; {
  <span class="hljs-comment">// This can crash the application</span>
  someAsyncOperation();
  res.json({ <span class="hljs-attr">message</span>: <span class="hljs-string">"Started operation"</span> });
});

<span class="hljs-comment">// ✅ Good: Proper error handling</span>
app.get(<span class="hljs-string">"/good-async"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> someAsyncOperation();
    res.json({ result });
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Operation failed:"</span>, error);
    res.status(<span class="hljs-number">500</span>).json({ <span class="hljs-attr">error</span>: <span class="hljs-string">"Operation failed"</span> });
  }
});

<span class="hljs-comment">// Global error handlers</span>
process.on(<span class="hljs-string">"uncaughtException"</span>, (error) =&gt; {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Uncaught Exception:"</span>, error);
  process.exit(<span class="hljs-number">1</span>);
});

process.on(<span class="hljs-string">"unhandledRejection"</span>, (reason, promise) =&gt; {
  <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Unhandled Rejection at:"</span>, promise, <span class="hljs-string">"reason:"</span>, reason);
  process.exit(<span class="hljs-number">1</span>);
});
</div></code></pre>
<h3 id="4-security-issues">4. <strong>Security Issues</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: SQL injection equivalent (NoSQL injection)</span>
app.get(<span class="hljs-string">"/users/:id"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-comment">// Vulnerable to NoSQL injection</span>
  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> User.findOne({ <span class="hljs-attr">_id</span>: req.params.id });
  res.json(user);
});

<span class="hljs-comment">// ✅ Good: Input validation</span>
<span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">"mongoose"</span>;

app.get(<span class="hljs-string">"/users/:id"</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-comment">// Validate ObjectId</span>
    <span class="hljs-keyword">if</span> (!mongoose.Types.ObjectId.isValid(req.params.id)) {
      <span class="hljs-keyword">return</span> res.status(<span class="hljs-number">400</span>).json({ <span class="hljs-attr">error</span>: <span class="hljs-string">"Invalid user ID"</span> });
    }

    <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> User.findById(req.params.id);
    <span class="hljs-keyword">if</span> (!user) {
      <span class="hljs-keyword">return</span> res.status(<span class="hljs-number">404</span>).json({ <span class="hljs-attr">error</span>: <span class="hljs-string">"User not found"</span> });
    }

    res.json(user);
  } <span class="hljs-keyword">catch</span> (error) {
    res.status(<span class="hljs-number">500</span>).json({ <span class="hljs-attr">error</span>: <span class="hljs-string">"Server error"</span> });
  }
});

<span class="hljs-comment">// ❌ Bad: Exposing sensitive information</span>
app.get(<span class="hljs-string">"/error-info"</span>, (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">"Database connection failed: mongodb://admin:password@localhost"</span>
    );
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Exposes sensitive information</span>
    res.status(<span class="hljs-number">500</span>).json({ <span class="hljs-attr">error</span>: error.message });
  }
});

<span class="hljs-comment">// ✅ Good: Safe error messages</span>
app.get(<span class="hljs-string">"/safe-error"</span>, (req, res) =&gt; {
  <span class="hljs-keyword">try</span> {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">"Database connection failed: mongodb://admin:password@localhost"</span>
    );
  } <span class="hljs-keyword">catch</span> (error) {
    <span class="hljs-comment">// Log full error for debugging</span>
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Database error:"</span>, error.message);

    <span class="hljs-comment">// Send safe message to client</span>
    res.status(<span class="hljs-number">500</span>).json({ <span class="hljs-attr">error</span>: <span class="hljs-string">"Internal server error"</span> });
  }
});
</div></code></pre>
<hr>
<h2 id="%F0%9F%92%A1-practice-problems">💡 Practice Problems</h2>
<h3 id="1-real-time-chat-application">1. <strong>Real-time Chat Application</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Build a real-time chat application with:</span>
<span class="hljs-comment">// - User authentication</span>
<span class="hljs-comment">// - Multiple chat rooms</span>
<span class="hljs-comment">// - Private messaging</span>
<span class="hljs-comment">// - Message history</span>
<span class="hljs-comment">// - Online user status</span>
<span class="hljs-comment">// - Typing indicators</span>
<span class="hljs-comment">// - File sharing</span>
<span class="hljs-comment">// - Message reactions</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// 1. WebSocket connection management</span>
<span class="hljs-comment">// 2. Room-based messaging</span>
<span class="hljs-comment">// 3. User presence tracking</span>
<span class="hljs-comment">// 4. Message persistence</span>
<span class="hljs-comment">// 5. Real-time notifications</span>
</div></code></pre>
<h3 id="2-e-commerce-api">2. <strong>E-commerce API</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Create a comprehensive e-commerce API with:</span>
<span class="hljs-comment">// - Product catalog management</span>
<span class="hljs-comment">// - Shopping cart functionality</span>
<span class="hljs-comment">// - Order processing</span>
<span class="hljs-comment">// - Payment integration</span>
<span class="hljs-comment">// - Inventory management</span>
<span class="hljs-comment">// - User reviews and ratings</span>
<span class="hljs-comment">// - Search and filtering</span>
<span class="hljs-comment">// - Admin dashboard</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// 1. Complex database relationships</span>
<span class="hljs-comment">// 2. Transaction handling</span>
<span class="hljs-comment">// 3. Payment gateway integration</span>
<span class="hljs-comment">// 4. Email notifications</span>
<span class="hljs-comment">// 5. File upload for product images</span>
</div></code></pre>
<h3 id="3-task-management-system">3. <strong>Task Management System</strong></h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Develop a task management system with:</span>
<span class="hljs-comment">// - Project organization</span>
<span class="hljs-comment">// - Task assignment</span>
<span class="hljs-comment">// - Due date tracking</span>
<span class="hljs-comment">// - Progress monitoring</span>
<span class="hljs-comment">// - Team collaboration</span>
<span class="hljs-comment">// - File attachments</span>
<span class="hljs-comment">// - Time tracking</span>
<span class="hljs-comment">// - Reporting and analytics</span>

<span class="hljs-comment">// Key features to implement:</span>
<span class="hljs-comment">// 1. Role-based access control</span>
<span class="hljs-comment">// 2. Real-time updates</span>
<span class="hljs-comment">// 3. Email notifications</span>
<span class="hljs-comment">// 4. Data visualization</span>
<span class="hljs-comment">// 5. Export functionality</span>
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%9D-interview-notes">📝 Interview Notes</h2>
<h3 id="common-nodejs-questions">Common Node.js Questions</h3>
<p><strong>Q: What is the Event Loop in Node.js?</strong>
A: The Event Loop is the core mechanism that allows Node.js to perform non-blocking I/O operations. It continuously checks the call stack and processes callbacks from the event queue when the stack is empty.</p>
<p><strong>Q: Explain the difference between <code>process.nextTick()</code> and <code>setImmediate()</code>.</strong>
A: <code>process.nextTick()</code> has higher priority and executes before any other asynchronous operations, while <code>setImmediate()</code> executes after I/O events in the current event loop phase.</p>
<p><strong>Q: How do you handle errors in Node.js?</strong>
A: Use try-catch for synchronous code, .catch() for promises, error-first callbacks for traditional async operations, and global error handlers for uncaught exceptions.</p>
<p><strong>Q: What are streams in Node.js?</strong>
A: Streams are objects that allow reading/writing data in chunks rather than loading everything into memory. Types include Readable, Writable, Duplex, and Transform streams.</p>
<p><strong>Q: How do you scale a Node.js application?</strong>
A: Use clustering to utilize multiple CPU cores, implement load balancing, use caching strategies, optimize database queries, and consider microservices architecture.</p>
<h3 id="company-specific-questions">Company-Specific Questions</h3>
<p><strong>Startup/Scale-up Companies:</strong></p>
<ul>
<li>How would you design a real-time notification system?</li>
<li>Implement a rate limiting middleware</li>
<li>Design a file upload system with progress tracking</li>
</ul>
<p><strong>Enterprise Companies:</strong></p>
<ul>
<li>How do you ensure data consistency in distributed systems?</li>
<li>Implement authentication with multiple providers</li>
<li>Design a logging and monitoring system</li>
</ul>
<p><strong>E-commerce Companies:</strong></p>
<ul>
<li>How would you handle high-traffic product launches?</li>
<li>Implement a shopping cart with session management</li>
<li>Design a payment processing system</li>
</ul>
<hr>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Event-Driven Architecture</strong>: Master the event loop and non-blocking I/O</li>
<li><strong>Security First</strong>: Always validate input and handle errors properly</li>
<li><strong>Performance</strong>: Use clustering, caching, and proper database indexing</li>
<li><strong>Testing</strong>: Write comprehensive unit, integration, and API tests</li>
<li><strong>Monitoring</strong>: Implement logging, error tracking, and performance monitoring</li>
<li><strong>Scalability</strong>: Design for horizontal scaling from the beginning</li>
<li><strong>Best Practices</strong>: Follow security guidelines and coding standards</li>
<li><strong>Real-time Features</strong>: Understand WebSockets and Socket.io for live updates</li>
</ol>
<p>Remember: Node.js excels at I/O-intensive applications but requires careful handling of CPU-intensive tasks. Always consider the event loop and write non-blocking code! 🚀</p>
<pre class="hljs"><code><div>
---

## 🔄 Real-time Communication

### WebSocket with Socket.io
```javascript
// socket/socketHandler.js
import { Server } from 'socket.io';
import jwt from 'jsonwebtoken';
import { config } from '../config/config.js';
import User from '../models/User.js';

class SocketHandler {
    constructor(server) {
        this.io = new Server(server, {
            cors: {
                origin: process.env.FRONTEND_URL || 'http://localhost:3000',
                methods: ['GET', 'POST']
            }
        });

        this.connectedUsers = new Map();
        this.setupMiddleware();
        this.setupEventHandlers();
    }

    setupMiddleware() {
        // Authentication middleware
        this.io.use(async (socket, next) =&gt; {
            try {
                const token = socket.handshake.auth.token;
                if (!token) {
                    throw new Error('No token provided');
                }

                const decoded = jwt.verify(token, config.jwtSecret);
                const user = await User.findById(decoded.id);

                if (!user) {
                    throw new Error('User not found');
                }

                socket.userId = user._id.toString();
                socket.user = user;
                next();
            } catch (error) {
                next(new Error('Authentication failed'));
            }
        });
    }

    setupEventHandlers() {
        this.io.on('connection', (socket) =&gt; {
            console.log(`User ${socket.user.name} connected`);

            // Store connected user
            this.connectedUsers.set(socket.userId, {
                socketId: socket.id,
                user: socket.user,
                connectedAt: new Date()
            });

            // Notify others about user connection
            socket.broadcast.emit('user:online', {
                userId: socket.userId,
                name: socket.user.name
            });

            // Send list of online users
            socket.emit('users:online', this.getOnlineUsers());

            // Join user to their personal room
            socket.join(`user:${socket.userId}`);

            // Chat events
            this.setupChatEvents(socket);

            // Notification events
            this.setupNotificationEvents(socket);

            // Handle disconnection
            socket.on('disconnect', () =&gt; {
                console.log(`User ${socket.user.name} disconnected`);

                // Remove from connected users
                this.connectedUsers.delete(socket.userId);

                // Notify others about user disconnection
                socket.broadcast.emit('user:offline', {
                    userId: socket.userId,
                    name: socket.user.name
                });
            });
        });
    }

    setupChatEvents(socket) {
        // Join chat room
        socket.on('chat:join', (roomId) =&gt; {
            socket.join(`chat:${roomId}`);
            socket.emit('chat:joined', { roomId });
        });

        // Leave chat room
        socket.on('chat:leave', (roomId) =&gt; {
            socket.leave(`chat:${roomId}`);
            socket.emit('chat:left', { roomId });
        });

        // Send message
        socket.on('chat:message', (data) =&gt; {
            const { roomId, message } = data;

            const messageData = {
                id: Date.now().toString(),
                roomId,
                message,
                sender: {
                    id: socket.userId,
                    name: socket.user.name
                },
                timestamp: new Date().toISOString()
            };

            // Send to all users in the room
            this.io.to(`chat:${roomId}`).emit('chat:message', messageData);
        });

        // Typing indicators
        socket.on('chat:typing', (data) =&gt; {
            const { roomId } = data;
            socket.to(`chat:${roomId}`).emit('chat:typing', {
                userId: socket.userId,
                name: socket.user.name
            });
        });

        socket.on('chat:stop-typing', (data) =&gt; {
            const { roomId } = data;
            socket.to(`chat:${roomId}`).emit('chat:stop-typing', {
                userId: socket.userId
            });
        });
    }

    setupNotificationEvents(socket) {
        // Send notification to specific user
        socket.on('notification:send', (data) =&gt; {
            const { userId, notification } = data;

            const notificationData = {
                id: Date.now().toString(),
                ...notification,
                from: {
                    id: socket.userId,
                    name: socket.user.name
                },
                timestamp: new Date().toISOString()
            };

            this.io.to(`user:${userId}`).emit('notification:received', notificationData);
        });
    }

    getOnlineUsers() {
        return Array.from(this.connectedUsers.values()).map(user =&gt; ({
            id: user.user._id,
            name: user.user.name,
            connectedAt: user.connectedAt
        }));
    }

    // Send notification to specific user =&gt; (called from other parts of the app)
    sendNotificationToUser(userId, notification) {
        this.io.to(`user:${userId}`).emit('notification:received', {
            id: Date.now().toString(),
            ...notification,
            timestamp: new Date().toISOString()
        });
    }

    // Broadcast to all connected users
    broadcast(event, data) {
        this.io.emit(event, data);
    }
}

export default SocketHandler;

// app.js integration
import http from 'http';
import SocketHandler from './socket/socketHandler.js';

// Create HTTP server
const server = http.createServer(app);

// Initialize Socket.io
const socketHandler = new SocketHandler(server);

// Make socket handler available globally
app.set('socketHandler', socketHandler);

server.listen(PORT, () =&gt; {
    console.log(`Server running on port ${PORT}`);
});


# 📚 Chapter 21: JavaScript Threading Model &amp; Web Workers

&gt; Understanding JavaScript's single-threaded nature and how to handle complex computations with Web Workers.

## 📖 Plain English Explanation

Imagine JavaScript as a **single chef** in a kitchen:
- **Single-threaded** = One chef doing all tasks one at a time
- **Event Loop** = The chef's to-do list that keeps getting updated
- **Web Workers** = Hiring additional chefs to work in separate kitchens
- **Complex Calculations** = Heavy prep work that can be delegated to other chefs

JavaScript runs on a **single main thread**, but it can delegate heavy work to **Web Workers** (background threads) to prevent blocking the user interface.

## 🧵 JavaScript's Single-Threaded Nature

### Why Single-Threaded?
```javascript
// JavaScript was designed for simple web interactions
// Single-threaded model prevents many concurrency issues

// ❌ This would block everything for 5 seconds
function heavyCalculation() {
    const start = Date.now();
    let result = 0;

    // Simulate heavy computation
    while (Date.now() - start &lt; 5000) {
        result += Math.random();
    }

    return result;
}

console.log('Start');
const result = heavyCalculation(); // Blocks UI for 5 seconds!
console.log('Result:', result);
console.log('End'); // Only runs after 5 seconds
```

### The Event Loop in Action
```javascript
// Understanding execution order
console.log('1: Synchronous code');

// Macrotask (Timer)
setTimeout(() =&gt; {
    console.log('4: setTimeout (macrotask)');
}, 0);

// Microtask (Promise)
Promise.resolve().then(() =&gt; {
    console.log('3: Promise (microtask)');
});

console.log('2: More synchronous code');

// Output:
// 1: Synchronous code
// 2: More synchronous code
// 3: Promise (microtask)
// 4: setTimeout (macrotask)

/*
Execution Order:
1. Call Stack (synchronous code)
2. Microtask Queue (Promises, queueMicrotask)
3. Macrotask Queue (setTimeout, setInterval, I/O)
*/
```

### Problems with Single Threading
```javascript
// ❌ Processing large datasets blocks the UI
function processLargeDataset(data) {
    const results = [];

    // This could take seconds with millions of items
    for (let i = 0; i &lt; data.length; i++) {
        // Complex calculation
        results.push(data[i] * Math.sqrt(data[i]) + Math.sin(data[i]));
    }

    return results;
}

// Simulate billion data points
const billionNumbers = new Array(1000000).fill(0).map(() =&gt; Math.random());

// This will freeze the browser!
// const processed = processLargeDataset(billionNumbers);
```

## 👷 Web Workers: JavaScript's Multi-Threading Solution

### Basic Web Worker Setup
```javascript
// main.js - Main thread
if (typeof Worker !== 'undefined') {
    // Create a new worker
    const worker = new Worker('worker.js');

    // Send data to worker
    worker.postMessage({
        command: 'process',
        data: [1, 2, 3, 4, 5]
    });

    // Receive results from worker
    worker.onmessage = function(e) {
        console.log('Result from worker:', e.data);

        // Clean up when done
        worker.terminate();
    };

    // Handle errors
    worker.onerror = function(error) {
        console.error('Worker error:', error);
    };
} else {
    console.log('Web Workers not supported');
}
```

```javascript
// worker.js - Worker thread
self.onmessage = function(e) {
    const { command, data } = e.data;

    if (command === 'process') {
        // Heavy computation runs in background
        const result = processData(data);

        // Send result back to main thread
        self.postMessage({
            success: true,
            result: result,
            processingTime: Date.now() - startTime
        });
    }
};

function processData(data) {
    const startTime = Date.now();
    const results = [];

    // Complex calculations don't block main thread
    for (let i = 0; i &lt; data.length; i++) {
        results.push(data[i] * Math.sqrt(data[i]) + Math.sin(data[i]));
    }

    return results;
}

// Handle errors in worker
self.onerror = function(error) {
    self.postMessage({
        success: false,
        error: error.message
    });
};
```

## 🔢 Handling Billion Data Points with Workers

### Chunked Processing Strategy
```javascript
// main.js - Processing large datasets efficiently
class BigDataProcessor {
    constructor(workerScript, chunkSize = 100000) {
        this.workerScript = workerScript;
        this.chunkSize = chunkSize;
        this.workers = [];
        this.maxWorkers = navigator.hardwareConcurrency || 4;
    }

    async processBillionDataPoints(data) {
        console.log(`Processing ${data.length} data points...`);
        const startTime = Date.now();

        // Split data into chunks
        const chunks = this.chunkArray(data, this.chunkSize);
        console.log(`Split into ${chunks.length} chunks`);

        // Process chunks in parallel using worker pool
        const results = await this.processChunksInParallel(chunks);

        // Combine results
        const finalResult = results.flat();

        const processingTime = Date.now() - startTime;
        console.log(`Processed ${finalResult.length} items in ${processingTime}ms`);

        return finalResult;
    }

    chunkArray(array, chunkSize) {
        const chunks = [];
        for (let i = 0; i &lt; array.length; i += chunkSize) {
            chunks.push(array.slice(i, i + chunkSize));
        }
        return chunks;
    }

    async processChunksInParallel(chunks) {
        const results = [];
        const workerPromises = [];

        // Process chunks using worker pool
        for (let i = 0; i &lt; chunks.length; i++) {
            const workerIndex = i % this.maxWorkers;

            const promise = this.processChunkWithWorker(chunks[i], workerIndex);
            workerPromises.push(promise);
        }

        // Wait for all workers to complete
        const allResults = await Promise.all(workerPromises);

        // Clean up workers
        this.terminateAllWorkers();

        return allResults;
    }

    processChunkWithWorker(chunk, workerIndex) {
        return new Promise((resolve, reject) =&gt; {
            // Create worker if doesn't exist
            if (!this.workers[workerIndex]) {
                this.workers[workerIndex] = new Worker(this.workerScript);
            }

            const worker = this.workers[workerIndex];

            // Set up message handler
            const messageHandler = (e) =&gt; {
                worker.removeEventListener('message', messageHandler);

                if (e.data.success) {
                    resolve(e.data.result);
                } else {
                    reject(new Error(e.data.error));
                }
            };

            worker.addEventListener('message', messageHandler);

            // Send chunk to worker
            worker.postMessage({
                command: 'processChunk',
                data: chunk,
                chunkIndex: workerIndex
            });
        });
    }

    terminateAllWorkers() {
        this.workers.forEach(worker =&gt; {
            if (worker) {
                worker.terminate();
            }
        });
        this.workers = [];
    }
}

// Usage example
async function demonstrateBigDataProcessing() {
    // Generate billion data points (adjust size for testing)
    const dataSize = 1000000; // 1 million for demo
    const bigData = new Array(dataSize).fill(0).map(() =&gt; Math.random() * 1000);

    console.log('Generated data, starting processing...');

    const processor = new BigDataProcessor('complex-worker.js', 50000);

    try {
        const results = await processor.processBillionDataPoints(bigData);
        console.log('Processing completed!', {
            originalSize: bigData.length,
            resultSize: results.length,
            sampleResults: results.slice(0, 5)
        });
    } catch (error) {
        console.error('Processing failed:', error);
    }
}

// Start processing
// demonstrateBigDataProcessing();
```

### Advanced Worker for Complex Calculations
```javascript
// complex-worker.js - Advanced worker for heavy computations
class ComplexCalculationWorker {
    constructor() {
        this.setupMessageHandler();
    }

    setupMessageHandler() {
        self.onmessage = (e) =&gt; {
            const { command, data, chunkIndex } = e.data;

            try {
                switch (command) {
                    case 'processChunk':
                        this.processChunk(data, chunkIndex);
                        break;
                    case 'complexMath':
                        this.performComplexMath(data);
                        break;
                    case 'dataAnalysis':
                        this.performDataAnalysis(data);
                        break;
                    default:
                        throw new Error(`Unknown command: ${command}`);
                }
            } catch (error) {
                self.postMessage({
                    success: false,
                    error: error.message,
                    chunkIndex
                });
            }
        };
    }

    processChunk(data, chunkIndex) {
        const startTime = Date.now();
        const results = [];

        // Complex mathematical operations
        for (let i = 0; i &lt; data.length; i++) {
            const value = data[i];

            // Simulate complex calculation
            const result = this.complexCalculation(value);
            results.push(result);

            // Report progress for large chunks
            if (i % 10000 === 0 &amp;&amp; i &gt; 0) {
                self.postMessage({
                    type: 'progress',
                    chunkIndex,
                    processed: i,
                    total: data.length,
                    percentage: (i / data.length * 100).toFixed(2)
                });
            }
        }

        const processingTime = Date.now() - startTime;

        self.postMessage({
            success: true,
            result: results,
            chunkIndex,
            processingTime,
            itemsProcessed: data.length
        });
    }

    complexCalculation(value) {
        // Simulate CPU-intensive calculation
        let result = value;

        // Mathematical transformations
        result = Math.sqrt(result * Math.PI);
        result = Math.sin(result) * Math.cos(result);
        result = Math.pow(result, 2);
        result = Math.log(Math.abs(result) + 1);

        // Statistical operations
        result = this.normalizeValue(result);

        return result;
    }

    normalizeValue(value) {
        // Normalize to 0-1 range
        return (value - Math.floor(value));
    }

    performComplexMath(data) {
        const results = {
            sum: 0,
            mean: 0,
            variance: 0,
            standardDeviation: 0,
            min: Infinity,
            max: -Infinity
        };

        // Calculate basic statistics
        for (let value of data) {
            results.sum += value;
            results.min = Math.min(results.min, value);
            results.max = Math.max(results.max, value);
        }

        results.mean = results.sum / data.length;

        // Calculate variance
        let varianceSum = 0;
        for (let value of data) {
            varianceSum += Math.pow(value - results.mean, 2);
        }

        results.variance = varianceSum / data.length;
        results.standardDeviation = Math.sqrt(results.variance);

        self.postMessage({
            success: true,
            result: results
        });
    }

    performDataAnalysis(data) {
        const analysis = {
            histogram: this.createHistogram(data),
            quartiles: this.calculateQuartiles(data),
            outliers: this.detectOutliers(data)
        };

        self.postMessage({
            success: true,
            result: analysis
        });
    }

    createHistogram(data, bins = 10) {
        const min = Math.min(...data);
        const max = Math.max(...data);
        const binSize = (max - min) / bins;
        const histogram = new Array(bins).fill(0);

        for (let value of data) {
            const binIndex = Math.min(Math.floor((value - min) / binSize), bins - 1);
            histogram[binIndex]++;
        }

        return histogram;
    }

    calculateQuartiles(data) {
        const sorted = [...data].sort((a, b) =&gt; a - b);
        const n = sorted.length;

        return {
            q1: sorted[Math.floor(n * 0.25)],
            q2: sorted[Math.floor(n * 0.5)], // median
            q3: sorted[Math.floor(n * 0.75)]
        };
    }

    detectOutliers(data) {
        const quartiles = this.calculateQuartiles(data);
        const iqr = quartiles.q3 - quartiles.q1;
        const lowerBound = quartiles.q1 - 1.5 * iqr;
        const upperBound = quartiles.q3 + 1.5 * iqr;

        return data.filter(value =&gt; value &lt; lowerBound || value &gt; upperBound);
    }
}

// Initialize worker
const worker = new ComplexCalculationWorker();
```

## 🚀 Advanced Worker Patterns

### Worker Pool Manager
```javascript
// worker-pool.js - Efficient worker pool management
class WorkerPool {
    constructor(workerScript, poolSize = navigator.hardwareConcurrency || 4) {
        this.workerScript = workerScript;
        this.poolSize = poolSize;
        this.workers = [];
        this.taskQueue = [];
        this.activeJobs = new Map();

        this.initializeWorkers();
    }

    initializeWorkers() {
        for (let i = 0; i &lt; this.poolSize; i++) {
            const worker = new Worker(this.workerScript);
            worker.id = i;
            worker.busy = false;

            worker.onmessage = (e) =&gt; {
                this.handleWorkerMessage(worker, e);
            };

            worker.onerror = (error) =&gt; {
                this.handleWorkerError(worker, error);
            };

            this.workers.push(worker);
        }
    }

    execute(data, transferable = []) {
        return new Promise((resolve, reject) =&gt; {
            const job = {
                data,
                transferable,
                resolve,
                reject,
                id: Date.now() + Math.random()
            };

            const availableWorker = this.workers.find(w =&gt; !w.busy);

            if (availableWorker) {
                this.assignJob(availableWorker, job);
            } else {
                this.taskQueue.push(job);
            }
        });
    }

    assignJob(worker, job) {
        worker.busy = true;
        this.activeJobs.set(worker.id, job);
        worker.postMessage(job.data, job.transferable);
    }

    handleWorkerMessage(worker, e) {
        const job = this.activeJobs.get(worker.id);

        if (job) {
            job.resolve(e.data);
            this.activeJobs.delete(worker.id);
            worker.busy = false;

            // Process next job in queue
            if (this.taskQueue.length &gt; 0) {
                const nextJob = this.taskQueue.shift();
                this.assignJob(worker, nextJob);
            }
        }
    }

    handleWorkerError(worker, error) {
        const job = this.activeJobs.get(worker.id);

        if (job) {
            job.reject(error);
            this.activeJobs.delete(worker.id);
            worker.busy = false;
        }
    }

    terminate() {
        this.workers.forEach(worker =&gt; worker.terminate());
        this.workers = [];
        this.taskQueue = [];
        this.activeJobs.clear();
    }

    getStats() {
        return {
            totalWorkers: this.workers.length,
            busyWorkers: this.workers.filter(w =&gt; w.busy).length,
            queuedJobs: this.taskQueue.length,
            activeJobs: this.activeJobs.size
        };
    }
}

// Usage example
async function demonstrateWorkerPool() {
    const workerPool = new WorkerPool('complex-worker.js', 4);

    // Create multiple large tasks
    const tasks = [];
    for (let i = 0; i &lt; 10; i++) {
        const data = new Array(100000).fill(0).map(() =&gt; Math.random());
        tasks.push(data);
    }

    console.log('Starting parallel processing...');
    const startTime = Date.now();

    try {
        // Process all tasks in parallel
        const results = await Promise.all(
            tasks.map(task =&gt; workerPool.execute({
                command: 'processChunk',
                data: task
            }))
        );

        const processingTime = Date.now() - startTime;
        console.log(`Processed ${tasks.length} tasks in ${processingTime}ms`);
        console.log('Worker stats:', workerPool.getStats());

    } catch (error) {
        console.error('Processing failed:', error);
    } finally {
        workerPool.terminate();
    }
}
```

## 🔄 Transferable Objects for Performance

### Using ArrayBuffers for Large Data
```javascript
// main.js - Efficient data transfer
function processLargeArrayWithTransfer() {
    // Create large array buffer (simulating billion data points)
    const size = 1000000; // 1 million numbers
    const buffer = new ArrayBuffer(size * 4); // 4 bytes per float32
    const data = new Float32Array(buffer);

    // Fill with random data
    for (let i = 0; i &lt; size; i++) {
        data[i] = Math.random() * 1000;
    }

    console.log('Original buffer size:', buffer.byteLength, 'bytes');

    const worker = new Worker('transfer-worker.js');

    worker.onmessage = (e) =&gt; {
        const { result, processingTime } = e.data;
        console.log(`Processing completed in ${processingTime}ms`);
        console.log('Result buffer size:', result.byteLength, 'bytes');

        // Convert back to typed array
        const resultArray = new Float32Array(result);
        console.log('Sample results:', resultArray.slice(0, 5));

        worker.terminate();
    };

    // Transfer ownership of buffer to worker (zero-copy)
    worker.postMessage({
        command: 'processLargeArray',
        buffer: buffer
    }, [buffer]); // Transfer list

    // buffer is now neutered (unusable) in main thread
    console.log('Buffer transferred, main thread buffer size:', buffer.byteLength);
}

// transfer-worker.js
self.onmessage = function(e) {
    const { command, buffer } = e.data;

    if (command === 'processLargeArray') {
        const startTime = Date.now();

        // Work directly with transferred buffer
        const data = new Float32Array(buffer);

        // Process data in-place
        for (let i = 0; i &lt; data.length; i++) {
            data[i] = Math.sqrt(data[i]) * Math.sin(data[i]);
        }

        const processingTime = Date.now() - startTime;

        // Transfer buffer back to main thread
        self.postMessage({
            result: buffer,
            processingTime: processingTime
        }, [buffer]);
    }
};
```

## 📊 Performance Comparison

### Benchmarking Different Approaches
```javascript
// performance-test.js
class PerformanceTester {
    static async compareProcessingMethods(dataSize = 1000000) {
        const testData = new Array(dataSize).fill(0).map(() =&gt; Math.random() * 1000);

        console.log(`Testing with ${dataSize} data points...\n`);

        // Test 1: Synchronous processing (blocks main thread)
        console.log('1. Synchronous Processing:');
        const syncStart = Date.now();
        const syncResult = this.processSynchronously(testData);
        const syncTime = Date.now() - syncStart;
        console.log(`   Time: ${syncTime}ms (BLOCKS UI)\n`);

        // Test 2: Chunked processing with setTimeout
        console.log('2. Chunked Processing (setTimeout):');
        const chunkStart = Date.now();
        const chunkResult = await this.processInChunks(testData);
        const chunkTime = Date.now() - chunkStart;
        console.log(`   Time: ${chunkTime}ms (Non-blocking)\n`);

        // Test 3: Web Worker processing
        console.log('3. Web Worker Processing:');
        const workerStart = Date.now();
        const workerResult = await this.processWithWorker(testData);
        const workerTime = Date.now() - workerStart;
        console.log(`   Time: ${workerTime}ms (Non-blocking)\n`);

        // Test 4: Multiple workers
        console.log('4. Multiple Workers:');
        const multiStart = Date.now();
        const multiResult = await this.processWithMultipleWorkers(testData);
        const multiTime = Date.now() - multiStart;
        console.log(`   Time: ${multiTime}ms (Non-blocking)\n`);

        // Summary
        console.log('Performance Summary:');
        console.log(`Synchronous:     ${syncTime}ms (baseline)`);
        console.log(`Chunked:         ${chunkTime}ms (${(chunkTime/syncTime*100).toFixed(1)}% of sync)`);
        console.log(`Single Worker:   ${workerTime}ms (${(workerTime/syncTime*100).toFixed(1)}% of sync)`);
        console.log(`Multiple Workers: ${multiTime}ms (${(multiTime/syncTime*100).toFixed(1)}% of sync)`);
    }

    static processSynchronously(data) {
        return data.map(value =&gt; Math.sqrt(value) * Math.sin(value));
    }

    static processInChunks(data, chunkSize = 10000) {
        return new Promise((resolve) =&gt; {
            const result = [];
            let index = 0;

            function processChunk() {
                const endIndex = Math.min(index + chunkSize, data.length);

                for (let i = index; i &lt; endIndex; i++) {
                    result.push(Math.sqrt(data[i]) * Math.sin(data[i]));
                }

                index = endIndex;

                if (index &lt; data.length) {
                    setTimeout(processChunk, 0); // Yield to event loop
                } else {
                    resolve(result);
                }
            }

            processChunk();
        });
    }

    static processWithWorker(data) {
        return new Promise((resolve, reject) =&gt; {
            const worker = new Worker('performance-worker.js');

            worker.onmessage = (e) =&gt; {
                resolve(e.data.result);
                worker.terminate();
            };

            worker.onerror = reject;

            worker.postMessage({ data });
        });
    }

    static async processWithMultipleWorkers(data) {
        const workerPool = new WorkerPool('performance-worker.js', 4);
        const chunkSize = Math.ceil(data.length / 4);
        const chunks = [];

        for (let i = 0; i &lt; data.length; i += chunkSize) {
            chunks.push(data.slice(i, i + chunkSize));
        }

        try {
            const results = await Promise.all(
                chunks.map(chunk =&gt; workerPool.execute({ data: chunk }))
            );

            return results.flat();
        } finally {
            workerPool.terminate();
        }
    }
}

// Run performance test
// PerformanceTester.compareProcessingMethods(1000000);
```

## 🎯 Best Practices for Complex Calculations

### 1. Choose the Right Approach
```javascript
// Decision matrix for processing strategies
function chooseProcessingStrategy(dataSize, complexity, uiBlocking) {
    if (dataSize &lt; 10000 &amp;&amp; complexity === 'low') {
        return 'synchronous'; // Fast enough for main thread
    }

    if (dataSize &lt; 100000 &amp;&amp; uiBlocking === 'acceptable') {
        return 'chunked'; // Break into smaller pieces
    }

    if (dataSize &lt; 1000000) {
        return 'single-worker'; // Use one worker
    }

    return 'worker-pool'; // Use multiple workers
}
```

### 2. Memory Management
```javascript
// Efficient memory usage with workers
class MemoryEfficientProcessor {
    static async processLargeDataset(data) {
        // Use transferable objects to avoid copying
        const buffer = new ArrayBuffer(data.length * 8);
        const view = new Float64Array(buffer);

        // Copy data to buffer
        for (let i = 0; i &lt; data.length; i++) {
            view[i] = data[i];
        }

        const worker = new Worker('memory-worker.js');

        return new Promise((resolve, reject) =&gt; {
            worker.onmessage = (e) =&gt; {
                const result = new Float64Array(e.data.buffer);
                resolve(Array.from(result));
                worker.terminate();
            };

            worker.onerror = reject;

            // Transfer buffer ownership
            worker.postMessage({ buffer }, [buffer]);
        });
    }
}
```

### 3. Progress Reporting
```javascript
// Worker with progress reporting
// progress-worker.js
self.onmessage = function(e) {
    const { data } = e.data;
    const results = [];
    const total = data.length;

    for (let i = 0; i &lt; total; i++) {
        // Process item
        results.push(Math.sqrt(data[i]) * Math.sin(data[i]));

        // Report progress every 1%
        if (i % Math.floor(total / 100) === 0) {
            self.postMessage({
                type: 'progress',
                completed: i,
                total: total,
                percentage: (i / total * 100).toFixed(1)
            });
        }
    }

    self.postMessage({
        type: 'complete',
        result: results
    });
};
```

## 🤔 Common Interview Questions

**Q: Why is JavaScript single-threaded?**
A: JavaScript was designed for simple web interactions. Single-threading prevents race conditions and makes the language easier to reason about. The event loop handles asynchronous operations without true multithreading.

**Q: How do you handle CPU-intensive tasks in JavaScript?**
A: Use Web Workers to move heavy computations off the main thread, implement chunked processing with setTimeout, or use requestIdleCallback for non-critical tasks.

**Q: What's the difference between Web Workers and Service Workers?**
A: Web Workers are for parallel processing and don't persist between sessions. Service Workers act as network proxies, handle caching, and persist between sessions.

**Q: How do you process a billion data points efficiently?**
A: Split data into chunks, use a worker pool for parallel processing, leverage transferable objects for zero-copy data transfer, and implement progress reporting.

**Q: What are transferable objects?**
A: Objects that can be transferred between threads without copying (zero-copy transfer). Includes ArrayBuffers, MessagePorts, and ImageBitmaps.

## 🎯 Key Takeaways

1. **JavaScript is single-threaded** - but can delegate work to Web Workers
2. **Use Web Workers for heavy computations** - prevents UI blocking
3. **Implement chunked processing** - for better user experience
4. **Leverage transferable objects** - for efficient data transfer
5. **Use worker pools** - for managing multiple workers efficiently
6. **Always handle errors** - workers can fail independently
7. **Clean up resources** - terminate workers when done
8. **Consider memory usage** - large datasets need careful management

---

**Previous Chapter**: [← Node.js Backend Development](./20-nodejs-backend.md)
**Next Chapter**: [Modern JavaScript Frameworks →](./22-modern-frameworks.md)

**Practice**: Build a data processing application that can handle millions of data points without blocking the UI!
</div></code></pre>

</body>
</html>
