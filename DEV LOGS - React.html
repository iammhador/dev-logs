<!DOCTYPE html>
<html>
<head>
<title>DEV LOGS - React.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="%F0%9F%A7%A9-jsx--components-the-building-blocks-of-react">🧩 JSX &amp; Components: The Building Blocks of React</h1>
<blockquote>
<p><strong>Master the foundation: JSX syntax, component creation, and the mental model that powers React applications</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>JSX syntax and how it transforms into JavaScript</li>
<li>Creating functional components with modern React</li>
<li>Component composition and the component tree</li>
<li>Props flow and component communication</li>
<li>Common JSX patterns and best practices</li>
</ul>
<h2 id="%F0%9F%A4%94-what-is-jsx">🤔 What is JSX?</h2>
<p>JSX (JavaScript XML) is a syntax extension that lets you write HTML-like code inside JavaScript. It's <strong>not</strong> HTML - it's syntactic sugar that gets compiled to <code>React.createElement()</code> calls.</p>
<pre class="hljs"><code><div><span class="hljs-comment">// This JSX...</span>
<span class="hljs-keyword">const</span> element = <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, World!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;

<span class="hljs-comment">// ...compiles to this JavaScript:</span>
<span class="hljs-keyword">const</span> element = React.createElement(<span class="hljs-string">"h1"</span>, <span class="hljs-literal">null</span>, <span class="hljs-string">"Hello, World!"</span>);
</div></code></pre>
<h3 id="jsx-rules-you-must-know">JSX Rules You Must Know</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ CORRECT: JSX must return a single parent element</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ValidComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Content<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Use React.Fragment or &lt;&gt; for multiple elements</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AlsoValid</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Content<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}

<span class="hljs-comment">// ❌ WRONG: Multiple root elements</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">InvalidComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Content<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span> <span class="hljs-comment">// This will cause an error!</span>
  );
}
</div></code></pre>
<h3 id="jsx-vs-html-key-differences">JSX vs HTML: Key Differences</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">JSXDifferences</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Use className instead of class */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"container"</span>&gt;</span>
        {/* Use camelCase for attributes */}
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span> // <span class="hljs-attr">not</span> <span class="hljs-attr">onchange</span>
          <span class="hljs-attr">autoComplete</span>=<span class="hljs-string">"off"</span> // <span class="hljs-attr">not</span> <span class="hljs-attr">autocomplete</span>
        /&gt;</span>

        {/* Self-closing tags must have closing slash */}
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"image.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Description"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>

        {/* Use curly braces for JavaScript expressions */}
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current time: {new Date().toLocaleTimeString()}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

        {/* Comments use JavaScript syntax */}
        {/* This is a comment in JSX */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8F%97%EF%B8%8F-creating-components">🏗️ Creating Components</h2>
<h3 id="functional-components-modern-react">Functional Components (Modern React)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Simple component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Welcome</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Welcome to React!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;
}

<span class="hljs-comment">// Component with props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Greeting</span>(<span class="hljs-params">{ name, age }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Hello, {name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You are {age} years old.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Arrow function component</span>
<span class="hljs-keyword">const</span> Button = <span class="hljs-function">(<span class="hljs-params">{ children, onClick, variant = <span class="hljs-string">"primary"</span> }</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">btn</span> <span class="hljs-attr">btn-</span>${<span class="hljs-attr">variant</span>}`} <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
};

<span class="hljs-comment">// Using the components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    alert(<span class="hljs-string">"Button clicked!"</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Welcome</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Greeting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"Alice"</span> <span class="hljs-attr">age</span>=<span class="hljs-string">{25}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"success"</span>&gt;</span>
        Click me!
      <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="component-naming-and-file-structure">Component Naming and File Structure</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ CORRECT: PascalCase for component names</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">/* ... */</span>
}
<span class="hljs-keyword">const</span> NavigationBar = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">/* ... */</span>
};

<span class="hljs-comment">// ❌ WRONG: lowercase or camelCase</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">userProfile</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">/* ... */</span>
} <span class="hljs-comment">// Won't work as JSX element</span>
<span class="hljs-keyword">const</span> navigationBar = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">/* ... */</span>
};

<span class="hljs-comment">// File structure best practices:</span>
<span class="hljs-comment">// components/</span>
<span class="hljs-comment">//   ├── UserProfile.jsx</span>
<span class="hljs-comment">//   ├── NavigationBar.jsx</span>
<span class="hljs-comment">//   └── Button/</span>
<span class="hljs-comment">//       ├── Button.jsx</span>
<span class="hljs-comment">//       ├── Button.css</span>
<span class="hljs-comment">//       └── index.js  // exports Button</span>
</div></code></pre>
<h2 id="%F0%9F%94%84-component-composition">🔄 Component Composition</h2>
<h3 id="the-power-of-composition">The Power of Composition</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Base components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Card</span>(<span class="hljs-params">{ children, className = <span class="hljs-string">""</span> }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">card</span> ${<span class="hljs-attr">className</span>}`}&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CardHeader</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-header"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CardBody</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-body"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CardFooter</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-footer"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// Composed component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserCard</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Card</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CardHeader</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">CardHeader</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CardBody</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Email: {user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Role: {user.role}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">CardBody</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CardFooter</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Edit Profile<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">CardFooter</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="conditional-rendering-patterns">Conditional Rendering Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConditionalExample</span>(<span class="hljs-params">{ user, isLoading, error }</span>) </span>{
  <span class="hljs-comment">// Pattern 1: Logical AND (&amp;&amp;)</span>
  <span class="hljs-keyword">const</span> showWelcome = user &amp;&amp; !isLoading;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Simple conditional rendering */}
      {isLoading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {/* Conditional with logical AND */}
      {showWelcome &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Welcome back, {user.name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      {/* Ternary operator for if-else */}
      {error ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>Error: {error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"success"</span>&gt;</span>Everything looks good!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      {/* Complex conditional logic */}
      {(() =&gt; {
        if (isLoading) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
        if (error) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error occurred<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
        if (user) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Welcome, {user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
        return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Please log in<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
      })()}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%93%8A-visual-component-tree">📊 Visual Component Tree</h2>
<pre class="hljs"><code><div>App
├── Header
│   ├── Logo
│   └── Navigation
│       ├── NavItem (&quot;Home&quot;)
│       ├── NavItem (&quot;About&quot;)
│       └── NavItem (&quot;Contact&quot;)
├── Main
│   ├── UserCard
│   │   ├── CardHeader
│   │   ├── CardBody
│   │   └── CardFooter
│   └── PostList
│       ├── Post
│       ├── Post
│       └── Post
└── Footer
    └── Copyright
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-mutating-props">1. Mutating Props</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Never mutate props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadComponent</span>(<span class="hljs-params">{ user }</span>) </span>{
  user.name = <span class="hljs-string">"Modified"</span>; <span class="hljs-comment">// DON'T DO THIS!</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ CORRECT: Props are read-only</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodComponent</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">const</span> displayName = user.name.toUpperCase();
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{displayName}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="2-incorrect-jsx-expressions">2. Incorrect JSX Expressions</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">JSXMistakes</span>(<span class="hljs-params">{ items, showTitle }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ❌ WRONG: Will render "false" as text */}
      {showTitle &amp;&amp; true &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>}

      {/* ✅ CORRECT: Use boolean conversion */}
      {!!showTitle &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>}
      {showTitle === true &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>}

      {/* ❌ WRONG: Will render "0" when items is empty */}
      {items.length &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Items: {items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {/* ✅ CORRECT: Explicit boolean check */}
      {items.length &gt; 0 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Items: {items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="3-inline-object-creation">3. Inline Object Creation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Creates new object on every render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadStyling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> "<span class="hljs-attr">red</span>", <span class="hljs-attr">fontSize:</span> "<span class="hljs-attr">16px</span>" }}&gt;</span>
      This creates a new object every render!
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Define styles outside or use CSS classes</span>
<span class="hljs-keyword">const</span> styles = {
  <span class="hljs-attr">error</span>: {
    <span class="hljs-attr">color</span>: <span class="hljs-string">"red"</span>,
    <span class="hljs-attr">fontSize</span>: <span class="hljs-string">"16px"</span>,
  },
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodStyling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{styles.error}</span>&gt;</span>This reuses the same object!<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when-and-why-to-use-components">🎯 When and Why to Use Components</h2>
<h3 id="component-creation-guidelines">Component Creation Guidelines</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ GOOD: Create components for reusability</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params">{ children, variant, onClick }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">btn</span> <span class="hljs-attr">btn-</span>${<span class="hljs-attr">variant</span>}`} <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ GOOD: Create components for complex logic</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserAvatar</span>(<span class="hljs-params">{ user, size = <span class="hljs-string">"medium"</span> }</span>) </span>{
  <span class="hljs-keyword">const</span> getInitials = <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> name
      .split(<span class="hljs-string">" "</span>)
      .map(<span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n[<span class="hljs-number">0</span>])
      .join(<span class="hljs-string">""</span>)
      .toUpperCase();
  };

  <span class="hljs-keyword">const</span> sizeClasses = {
    <span class="hljs-attr">small</span>: <span class="hljs-string">"w-8 h-8 text-sm"</span>,
    <span class="hljs-attr">medium</span>: <span class="hljs-string">"w-12 h-12 text-base"</span>,
    <span class="hljs-attr">large</span>: <span class="hljs-string">"w-16 h-16 text-lg"</span>,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">avatar</span> ${<span class="hljs-attr">sizeClasses</span>[<span class="hljs-attr">size</span>]}`}&gt;</span>
      {user.avatar ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{user.avatar}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{user.name}</span> /&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{getInitials(user.name)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ❌ AVOID: Over-componentizing simple elements</span>
<span class="hljs-comment">// Don't create a component for every single div or span</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OverEngineered</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Just use a div here<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-build-a-product-card">Challenge 1: Build a Product Card</h3>
<p>Create a <code>ProductCard</code> component that displays:</p>
<ul>
<li>Product image</li>
<li>Product name</li>
<li>Price (with currency formatting)</li>
<li>&quot;Add to Cart&quot; button</li>
<li>Sale badge (if on sale)</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your solution here:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProductCard</span>(<span class="hljs-params">{ product }</span>) </span>{
  <span class="hljs-comment">// Implement this component</span>
}

<span class="hljs-comment">// Test data:</span>
<span class="hljs-keyword">const</span> sampleProduct = {
  <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Wireless Headphones"</span>,
  <span class="hljs-attr">price</span>: <span class="hljs-number">99.99</span>,
  <span class="hljs-attr">image</span>: <span class="hljs-string">"headphones.jpg"</span>,
  <span class="hljs-attr">onSale</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">originalPrice</span>: <span class="hljs-number">149.99</span>,
};
</div></code></pre>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProductCard</span>(<span class="hljs-params">{ product }</span>) </span>{
  <span class="hljs-keyword">const</span> formatPrice = <span class="hljs-function">(<span class="hljs-params">price</span>) =&gt;</span> <span class="hljs-string">`$<span class="hljs-subst">${price.toFixed(<span class="hljs-number">2</span>)}</span>`</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-card"</span>&gt;</span>
      {product.onSale &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"sale-badge"</span>&gt;</span>SALE<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{product.image}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{product.name}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-image"</span> /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-name"</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"price-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"current-price"</span>&gt;</span>{formatPrice(product.price)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>

          {product.onSale &amp;&amp; product.originalPrice &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"original-price"</span>&gt;</span>
              {formatPrice(product.originalPrice)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"add-to-cart-btn"</span>&gt;</span>Add to Cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-conditional-navigation">Challenge 2: Conditional Navigation</h3>
<p>Create a <code>Navigation</code> component that shows different menu items based on user authentication status.</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Requirements:</span>
<span class="hljs-comment">// - Show "Login" and "Register" when user is null</span>
<span class="hljs-comment">// - Show "Dashboard", "Profile", "Logout" when user exists</span>
<span class="hljs-comment">// - Highlight current page</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Navigation</span>(<span class="hljs-params">{ user, currentPage }</span>) </span>{
  <span class="hljs-comment">// Your solution here</span>
}
</div></code></pre>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Navigation</span>(<span class="hljs-params">{ user, currentPage }</span>) </span>{
  <span class="hljs-keyword">const</span> NavItem = <span class="hljs-function">(<span class="hljs-params">{ href, children, isActive }</span>) =&gt;</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{href}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">nav-item</span> ${<span class="hljs-attr">isActive</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span>
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"navigation"</span>&gt;</span>
      {user ? (
        // Authenticated user menu
        <span class="hljs-tag">&lt;&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">NavItem</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/dashboard"</span> <span class="hljs-attr">isActive</span>=<span class="hljs-string">{currentPage</span> === <span class="hljs-string">"dashboard"</span>}&gt;</span>
            Dashboard
          <span class="hljs-tag">&lt;/<span class="hljs-name">NavItem</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">NavItem</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/profile"</span> <span class="hljs-attr">isActive</span>=<span class="hljs-string">{currentPage</span> === <span class="hljs-string">"profile"</span>}&gt;</span>
            Profile
          <span class="hljs-tag">&lt;/<span class="hljs-name">NavItem</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">NavItem</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/logout"</span>&gt;</span>Logout<span class="hljs-tag">&lt;/<span class="hljs-name">NavItem</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      ) : (
        <span class="hljs-comment">// Guest user menu</span>
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">NavItem</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/login"</span> <span class="hljs-attr">isActive</span>=<span class="hljs-string">{currentPage</span> === <span class="hljs-string">"login"</span>}&gt;</span>
            Login
          <span class="hljs-tag">&lt;/<span class="hljs-name">NavItem</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">NavItem</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/register"</span> <span class="hljs-attr">isActive</span>=<span class="hljs-string">{currentPage</span> === <span class="hljs-string">"register"</span>}&gt;</span>
            Register
          <span class="hljs-tag">&lt;/<span class="hljs-name">NavItem</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
    &lt;<span class="hljs-regexp">/nav&gt;
  );
}
</span></div></code></pre>
</details>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="what-interviewers-look-for">What Interviewers Look For</h3>
<ol>
<li>
<p><strong>JSX Understanding</strong>: &quot;Explain what happens when JSX is compiled&quot;</p>
<ul>
<li><strong>Good Answer</strong>: JSX transforms into <code>React.createElement()</code> calls, creating a virtual DOM representation</li>
</ul>
</li>
<li>
<p><strong>Component Design</strong>: &quot;How do you decide when to create a new component?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: Reusability, single responsibility, complex logic separation, and maintainability</li>
</ul>
</li>
<li>
<p><strong>Props vs State</strong>: &quot;What's the difference between props and state?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: Props are read-only data passed from parent; state is mutable data managed within component</li>
</ul>
</li>
</ol>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Q: What's wrong with this code?</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BrokenComponent</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Items<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      {items.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span> // Missing key prop!
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Q: Fix this conditional rendering</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FixMe</span>(<span class="hljs-params">{ count }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{count &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>} // Will show "0" when count is 0<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// A: Correct version</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Fixed</span>(<span class="hljs-params">{ count }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{count &gt; 0 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="pro-tips-for-interviews">Pro Tips for Interviews</h3>
<ol>
<li><strong>Always mention keys</strong> when discussing lists</li>
<li><strong>Explain the virtual DOM</strong> concept clearly</li>
<li><strong>Show awareness of performance</strong> implications</li>
<li><strong>Demonstrate composition</strong> over inheritance</li>
<li><strong>Use modern functional components</strong> (avoid class components unless specifically asked)</li>
</ol>
<h2 id="%F0%9F%9A%80-next-steps">🚀 Next Steps</h2>
<p>Now that you understand JSX and components, you're ready to dive into:</p>
<ul>
<li><strong>Props &amp; Children</strong> - How components communicate</li>
<li><strong>State Management</strong> - Making components interactive</li>
<li><strong>Event Handling</strong> - Responding to user interactions</li>
</ul>
<hr>
<blockquote>
<p><strong>Key Takeaway</strong>: JSX is just syntactic sugar for <code>React.createElement()</code>. Components are functions that return JSX. Master these fundamentals, and everything else in React becomes much clearer!</p>
</blockquote>
<h1 id="%F0%9F%8E%81-props--children-component-communication-mastery">🎁 Props &amp; Children: Component Communication Mastery</h1>
<blockquote>
<p><strong>Learn how React components talk to each other through props and unlock the power of component composition with children</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>Props: the data highway between components</li>
<li>Destructuring props like a pro</li>
<li>Default props and prop validation</li>
<li>The special <code>children</code> prop and composition patterns</li>
<li>Prop drilling and when it becomes a problem</li>
<li>Advanced prop patterns for flexible components</li>
</ul>
<h2 id="%F0%9F%9A%80-understanding-props">🚀 Understanding Props</h2>
<p>Props (short for &quot;properties&quot;) are how parent components pass data to child components. Think of them as function arguments for your components.</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Parent component passing props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = {
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Sarah Chen"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"sarah@example.com"</span>,
    <span class="hljs-attr">avatar</span>: <span class="hljs-string">"avatar.jpg"</span>,
    <span class="hljs-attr">isOnline</span>: <span class="hljs-literal">true</span>,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Passing different types of props */}
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span>
        <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> // <span class="hljs-attr">Object</span> <span class="hljs-attr">prop</span>
        <span class="hljs-attr">theme</span>=<span class="hljs-string">"dark"</span> // <span class="hljs-attr">String</span> <span class="hljs-attr">prop</span>
        <span class="hljs-attr">showStatus</span>=<span class="hljs-string">{true}</span> // <span class="hljs-attr">Boolean</span> <span class="hljs-attr">prop</span>
        <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{()</span> =&gt;</span> console.log("Edit")} // Function prop
        maxPosts={10} // Number prop
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Child component receiving props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ user, theme, showStatus, onEdit, maxPosts }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">profile</span> <span class="hljs-attr">profile--</span>${<span class="hljs-attr">theme</span>}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{user.avatar}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{user.name}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      {showStatus &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">status</span> ${<span class="hljs-attr">user.isOnline</span> ? "<span class="hljs-attr">online</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">offline</span>"}`}&gt;</span>
          {user.isOnline ? "🟢 Online" : "⚫ Offline"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      )}

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onEdit}</span>&gt;</span>Edit Profile<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Showing last {maxPosts} posts<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-props-destructuring-patterns">🎯 Props Destructuring Patterns</h2>
<h3 id="basic-destructuring">Basic Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ GOOD: Destructure in function parameters</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Welcome</span>(<span class="hljs-params">{ name, age, city }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, {name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
        Age: {age}, City: {city}
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ❌ AVOID: Using props object directly</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WelcomeVerbose</span>(<span class="hljs-params">props</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, {props.name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
        Age: {props.age}, City: {props.city}
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-destructuring-with-defaults">Advanced Destructuring with Defaults</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params">{
  children,
  variant = <span class="hljs-string">"primary"</span>, <span class="hljs-regexp">//</span> Default value
  size = <span class="hljs-string">"medium"</span>,
  disabled = false,
  onClick = (</span>) =&gt; </span>{}, <span class="hljs-comment">// Default function</span>
  ...restProps <span class="hljs-comment">// Spread remaining props</span>
}) {
  <span class="hljs-keyword">const</span> baseClasses = <span class="hljs-string">"btn"</span>;
  <span class="hljs-keyword">const</span> variantClass = <span class="hljs-string">`btn--<span class="hljs-subst">${variant}</span>`</span>;
  <span class="hljs-keyword">const</span> sizeClass = <span class="hljs-string">`btn--<span class="hljs-subst">${size}</span>`</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`${<span class="hljs-attr">baseClasses</span>} ${<span class="hljs-attr">variantClass</span>} ${<span class="hljs-attr">sizeClass</span>}`}
      <span class="hljs-attr">disabled</span>=<span class="hljs-string">{disabled}</span>
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>
      {<span class="hljs-attr">...restProps</span>} // <span class="hljs-attr">Pass</span> <span class="hljs-attr">through</span> <span class="hljs-attr">any</span> <span class="hljs-attr">additional</span> <span class="hljs-attr">props</span>
    &gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ButtonExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>Default Button<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"secondary"</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"large"</span>&gt;</span>
        Large Secondary
      <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">disabled</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> alert("Clicked")}&gt;
        Disabled Button
      <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">form</span>=<span class="hljs-string">"myForm"</span>&gt;</span>
        {" "}
        {/* type and form passed via ...restProps */}
        Submit
      <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="nested-object-destructuring">Nested Object Destructuring</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserCard</span>(<span class="hljs-params">{
  user: {
    name,
    email,
    profile: { bio, location, website } = {}, <span class="hljs-regexp">//</span> Default empty object
  },
  settings: { theme, notifications } = { theme: <span class="hljs-string">"light"</span>, notifications: true },
}</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">user-card</span> <span class="hljs-attr">user-card--</span>${<span class="hljs-attr">theme</span>}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      {bio &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"bio"</span>&gt;</span>{bio}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
      {location &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>📍 {location}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
      {website &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">{website}</span>&gt;</span>🌐 Website<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>}

      {notifications &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"notification-badge"</span>&gt;</span>🔔<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> userData = {
  <span class="hljs-attr">name</span>: <span class="hljs-string">"Alex Johnson"</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">"alex@example.com"</span>,
  <span class="hljs-attr">profile</span>: {
    <span class="hljs-attr">bio</span>: <span class="hljs-string">"Full-stack developer passionate about React"</span>,
    <span class="hljs-attr">location</span>: <span class="hljs-string">"San Francisco, CA"</span>,
    <span class="hljs-attr">website</span>: <span class="hljs-string">"https://alexjohnson.dev"</span>,
  },
};

<span class="hljs-keyword">const</span> userSettings = {
  <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
  <span class="hljs-attr">notifications</span>: <span class="hljs-literal">true</span>,
};

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{userData}</span> <span class="hljs-attr">settings</span>=<span class="hljs-string">{userSettings}</span> /&gt;</span></span>;
</div></code></pre>
<h2 id="%F0%9F%91%B6-the-children-prop-composition-magic">👶 The Children Prop: Composition Magic</h2>
<p>The <code>children</code> prop is special - it represents the content between opening and closing JSX tags.</p>
<h3 id="basic-children-usage">Basic Children Usage</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Container component that wraps children</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Card</span>(<span class="hljs-params">{ children, title, className = <span class="hljs-string">""</span> }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">card</span> ${<span class="hljs-attr">className</span>}`}&gt;</span>
      {title &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-header"</span>&gt;</span>{title}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card-body"</span>&gt;</span>
        {children} {/* This is where child content goes */}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage - anything between &lt;Card&gt; tags becomes children</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Card</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"User Info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>John Doe<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Software Engineer<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Contact<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Card</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Statistics"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats-card"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"number"</span>&gt;</span>1,234<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"label"</span>&gt;</span>Users<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"number"</span>&gt;</span>567<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"label"</span>&gt;</span>Orders<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-children-patterns">Advanced Children Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. Children as a function (render props pattern)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataFetcher</span>(<span class="hljs-params">{ url, children }</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetch(url)
      .then(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.json())
      .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        setData(data);
        setLoading(<span class="hljs-literal">false</span>);
      })
      .catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
        setError(err);
        setLoading(<span class="hljs-literal">false</span>);
      });
  }, [url]);

  <span class="hljs-comment">// Call children as a function, passing state</span>
  <span class="hljs-keyword">return</span> children({ data, loading, error });
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DataFetcher</span> <span class="hljs-attr">url</span>=<span class="hljs-string">"/api/users"</span>&gt;</span>
      {({ data, loading, error }) =&gt; {
        if (loading) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading users...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
        if (error) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;

        return (
          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
            {data.map((user) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        );
      }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">DataFetcher</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 2. Manipulating children with React.Children</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">List</span>(<span class="hljs-params">{ children, ordered = false }</span>) </span>{
  <span class="hljs-keyword">const</span> Tag = ordered ? <span class="hljs-string">"ol"</span> : <span class="hljs-string">"ul"</span>;

  <span class="hljs-comment">// Add props to each child</span>
  <span class="hljs-keyword">const</span> enhancedChildren = React.Children.map(children, (child, index) =&gt; {
    <span class="hljs-keyword">if</span> (React.isValidElement(child)) {
      <span class="hljs-keyword">return</span> React.cloneElement(child, {
        <span class="hljs-attr">key</span>: index,
        <span class="hljs-attr">className</span>: <span class="hljs-string">`<span class="hljs-subst">${child.props.className || <span class="hljs-string">""</span>}</span> list-item`</span>.trim(),
      });
    }
    <span class="hljs-keyword">return</span> child;
  });

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Tag</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"custom-list"</span>&gt;</span>{enhancedChildren}<span class="hljs-tag">&lt;/<span class="hljs-name">Tag</span>&gt;</span></span>;
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoApp</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span> <span class="hljs-attr">ordered</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Learn React fundamentals<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Master hooks<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Build awesome projects<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">List</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 3. Conditional children rendering</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Modal</span>(<span class="hljs-params">{ children, isOpen, onClose }</span>) </span>{
  <span class="hljs-keyword">if</span> (!isOpen) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-overlay"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClose}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{(e)</span> =&gt;</span> e.stopPropagation()}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-close"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClose}</span>&gt;</span>
          ×
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-prop-flow-and-communication-patterns">🔄 Prop Flow and Communication Patterns</h2>
<h3 id="parent-to-child-communication">Parent to Child Communication</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Parent manages state and passes down</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ShoppingCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Laptop"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">999</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Mouse"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">quantity</span>: <span class="hljs-number">2</span> },
  ]);

  <span class="hljs-keyword">const</span> updateQuantity = <span class="hljs-function">(<span class="hljs-params">id, newQuantity</span>) =&gt;</span> {
    setItems(
      items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.id === id ? { ...item, <span class="hljs-attr">quantity</span>: newQuantity } : item
      )
    );
  };

  <span class="hljs-keyword">const</span> removeItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setItems(items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"shopping-cart"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Shopping Cart<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      {items.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">CartItem</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
          <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
          <span class="hljs-attr">onUpdateQuantity</span>=<span class="hljs-string">{updateQuantity}</span> // <span class="hljs-attr">Function</span> <span class="hljs-attr">prop</span>
          <span class="hljs-attr">onRemove</span>=<span class="hljs-string">{removeItem}</span> // <span class="hljs-attr">Function</span> <span class="hljs-attr">prop</span>
        /&gt;</span>
      ))}
      <span class="hljs-tag">&lt;<span class="hljs-name">CartTotal</span> <span class="hljs-attr">items</span>=<span class="hljs-string">{items}</span> /&gt;</span> {/* Data prop */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Child receives props and calls parent functions</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CartItem</span>(<span class="hljs-params">{ item, onUpdateQuantity, onRemove }</span>) </span>{
  <span class="hljs-keyword">const</span> handleQuantityChange = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newQuantity = <span class="hljs-built_in">parseInt</span>(e.target.value);
    onUpdateQuantity(item.id, newQuantity);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-item"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>${item.price}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{item.quantity}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleQuantityChange}</span>
        <span class="hljs-attr">min</span>=<span class="hljs-string">"1"</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onRemove(item.id)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CartTotal</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-keyword">const</span> total = items.reduce(
    <span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.price * item.quantity,
    <span class="hljs-number">0</span>
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-total"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Total: ${total.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="prop-drilling-problem">Prop Drilling Problem</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ PROBLEM: Prop drilling - passing props through multiple levels</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span> });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Layout</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Dashboard</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Layout</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Layout</span>(<span class="hljs-params">{ children, user, setUser }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span> /&gt;</span> {/* Passing through */}
      <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Header</span>(<span class="hljs-params">{ user, setUser }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Navigation</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span> {/* Still passing through */}
      <span class="hljs-tag">&lt;<span class="hljs-name">UserMenu</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Navigation</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeToggle</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span> {/* Finally used here */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThemeToggle</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-comment">// This component is 4 levels deep but needs user data!</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Current theme: {user.theme}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-mutating-props">1. Mutating Props</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Never mutate props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadComponent</span>(<span class="hljs-params">{ user, items }</span>) </span>{
  user.name = <span class="hljs-string">"Modified"</span>; <span class="hljs-comment">// DON'T DO THIS!</span>
  items.push({ <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"New"</span> }); <span class="hljs-comment">// DON'T DO THIS!</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ CORRECT: Create new objects/arrays</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodComponent</span>(<span class="hljs-params">{ user, items }</span>) </span>{
  <span class="hljs-keyword">const</span> updatedUser = { ...user, <span class="hljs-attr">name</span>: <span class="hljs-string">"Modified"</span> };
  <span class="hljs-keyword">const</span> updatedItems = [...items, { <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"New"</span> }];

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{updatedUser.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="2-unnecessary-prop-passing">2. Unnecessary Prop Passing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Passing all props when only some are needed</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OverpassingParent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> massiveUserObject = {
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
    <span class="hljs-attr">preferences</span>: {
      <span class="hljs-comment">/* huge object */</span>
    },
    <span class="hljs-attr">history</span>: {
      <span class="hljs-comment">/* huge array */</span>
    },
    <span class="hljs-comment">// ... 50 more properties</span>
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">SimpleGreeting</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{massiveUserObject}</span> /&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SimpleGreeting</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, {user.name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>; <span class="hljs-comment">// Only needs name!</span>
}

<span class="hljs-comment">// ✅ CORRECT: Pass only what's needed</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EfficientParent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> user = {
    <span class="hljs-comment">/* massive object */</span>
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">SimpleGreeting</span> <span class="hljs-attr">name</span>=<span class="hljs-string">{user.name}</span> /&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SimpleGreeting</span>(<span class="hljs-params">{ name }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Hello, {name}!<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="3-boolean-prop-mistakes">3. Boolean Prop Mistakes</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Explicit true values</span>
&lt;Button disabled={<span class="hljs-literal">true</span>} loading={<span class="hljs-literal">true</span>} /&gt;

<span class="hljs-comment">// ✅ CORRECT: Shorthand for true</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">disabled</span> <span class="hljs-attr">loading</span> /&gt;</span></span>

<span class="hljs-comment">// ❌ WRONG: String booleans</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">"true"</span> /&gt;</span></span>  <span class="hljs-comment">// This is always truthy!</span>

<span class="hljs-comment">// ✅ CORRECT: Actual booleans</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isDisabled}</span> /&gt;</span></span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when-and-why-to-use-different-prop-patterns">🎯 When and Why to Use Different Prop Patterns</h2>
<h3 id="component-flexibility-spectrum">Component Flexibility Spectrum</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. RIGID: Specific, limited use cases</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserAvatar</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{user.avatar}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{user.name}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-avatar"</span> /&gt;</span></span>;
}

<span class="hljs-comment">// 2. FLEXIBLE: Configurable behavior</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Avatar</span>(<span class="hljs-params">{
  src,
  alt,
  size = <span class="hljs-string">"medium"</span>,
  shape = <span class="hljs-string">"circle"</span>,
  fallback = <span class="hljs-string">"👤"</span>,
}</span>) </span>{
  <span class="hljs-keyword">const</span> sizeClasses = {
    <span class="hljs-attr">small</span>: <span class="hljs-string">"w-8 h-8"</span>,
    <span class="hljs-attr">medium</span>: <span class="hljs-string">"w-12 h-12"</span>,
    <span class="hljs-attr">large</span>: <span class="hljs-string">"w-16 h-16"</span>,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">avatar</span> <span class="hljs-attr">avatar--</span>${<span class="hljs-attr">shape</span>} ${<span class="hljs-attr">sizeClasses</span>[<span class="hljs-attr">size</span>]}`}&gt;</span>
      {src ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{src}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{alt}</span> /&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"avatar-fallback"</span>&gt;</span>{fallback}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 3. HIGHLY FLEXIBLE: Composition-based</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FlexibleCard</span>(<span class="hljs-params">{ children, ...props }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"card"</span> {<span class="hljs-attr">...props</span>}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage shows the flexibility</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Examples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Rigid - only works with user objects */}
      <span class="hljs-tag">&lt;<span class="hljs-name">UserAvatar</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{currentUser}</span> /&gt;</span>

      {/* Flexible - works with any image data */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Avatar</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"profile.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Profile"</span> <span class="hljs-attr">size</span>=<span class="hljs-string">"large"</span> <span class="hljs-attr">shape</span>=<span class="hljs-string">"square"</span> /&gt;</span>

      {/* Highly flexible - can contain anything */}
      <span class="hljs-tag">&lt;<span class="hljs-name">FlexibleCard</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"special"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Custom Content<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Any JSX can go here<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Avatar</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"user.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"User"</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">FlexibleCard</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-smart-button-component">Challenge 1: Smart Button Component</h3>
<p>Create a <code>Button</code> component that:</p>
<ul>
<li>Accepts <code>variant</code> (primary, secondary, danger)</li>
<li>Accepts <code>size</code> (small, medium, large)</li>
<li>Shows loading state with spinner</li>
<li>Handles disabled state</li>
<li>Accepts any additional HTML button props</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your solution:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params">{ children, variant, size, loading, disabled, ...props }</span>) </span>{
  <span class="hljs-comment">// Implement this component</span>
}

<span class="hljs-comment">// Test cases:</span>
&lt;Button variant=<span class="hljs-string">"primary"</span> size=<span class="hljs-string">"large"</span>&gt;Save&lt;<span class="hljs-regexp">/Button&gt;
&lt;Button variant="danger" loading disabled&gt;Delete&lt;/</span>Button&gt;
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
</div></code></pre>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params">{
  children,
  variant = <span class="hljs-string">"primary"</span>,
  size = <span class="hljs-string">"medium"</span>,
  loading = false,
  disabled = false,
  className = <span class="hljs-string">""</span>,
  ...props
}</span>) </span>{
  <span class="hljs-keyword">const</span> baseClasses = <span class="hljs-string">"btn"</span>;
  <span class="hljs-keyword">const</span> variantClass = <span class="hljs-string">`btn--<span class="hljs-subst">${variant}</span>`</span>;
  <span class="hljs-keyword">const</span> sizeClass = <span class="hljs-string">`btn--<span class="hljs-subst">${size}</span>`</span>;
  <span class="hljs-keyword">const</span> loadingClass = loading ? <span class="hljs-string">"btn--loading"</span> : <span class="hljs-string">""</span>;

  <span class="hljs-keyword">const</span> allClasses = [
    baseClasses,
    variantClass,
    sizeClass,
    loadingClass,
    className,
  ]
    .filter(<span class="hljs-built_in">Boolean</span>)
    .join(<span class="hljs-string">" "</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{allClasses}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{disabled</span> || <span class="hljs-attr">loading</span>} {<span class="hljs-attr">...props</span>}&gt;</span>
      {loading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"spinner"</span>&gt;</span>⏳<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-flexible-list-component">Challenge 2: Flexible List Component</h3>
<p>Create a <code>List</code> component that:</p>
<ul>
<li>Renders items from an array</li>
<li>Accepts a render function for custom item rendering</li>
<li>Shows empty state when no items</li>
<li>Supports loading state</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your solution:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">List</span>(<span class="hljs-params">{ items, renderItem, loading, emptyMessage }</span>) </span>{
  <span class="hljs-comment">// Implement this component</span>
}

<span class="hljs-comment">// Test cases:</span>
<span class="hljs-keyword">const</span> users = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane"</span> },
];

<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">List</span>
  <span class="hljs-attr">items</span>=<span class="hljs-string">{users}</span>
  <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{(user)</span> =&gt;</span> <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
  emptyMessage="No users found"
/&gt;</span>;
</div></code></pre>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">List</span>(<span class="hljs-params">{
  items = [],
  renderItem,
  loading = false,
  emptyMessage = <span class="hljs-string">"No items found"</span>,
  className = <span class="hljs-string">""</span>,
}</span>) </span>{
  <span class="hljs-keyword">if</span> (loading) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"list-loading"</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">if</span> (items.length === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"list-empty"</span>&gt;</span>{emptyMessage}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">list</span> ${<span class="hljs-attr">className</span>}`}&gt;</span>
      {items.map((item, index) =&gt; {
        // Support both render function and default rendering
        if (renderItem) {
          return renderItem(item, index);
        }

        // Default rendering assumes item has id and can be stringified
        return (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id</span> || <span class="hljs-attr">index</span>} <span class="hljs-attr">className</span>=<span class="hljs-string">"list-item"</span>&gt;</span>
            {typeof item === "object" ? JSON.stringify(item) : item}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        );
      })}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="what-interviewers-ask">What Interviewers Ask</h3>
<ol>
<li>
<p><strong>&quot;Explain the difference between props and state&quot;</strong></p>
<ul>
<li><strong>Good Answer</strong>: Props are read-only data passed from parent to child. State is mutable data managed within a component. Props flow down, events flow up.</li>
</ul>
</li>
<li>
<p><strong>&quot;What is prop drilling and how do you solve it?&quot;</strong></p>
<ul>
<li><strong>Good Answer</strong>: Prop drilling is passing props through multiple component layers. Solutions include Context API, state management libraries, or component composition.</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you make components reusable?&quot;</strong></p>
<ul>
<li><strong>Good Answer</strong>: Use props for configuration, provide sensible defaults, use children for composition, and follow single responsibility principle.</li>
</ul>
</li>
</ol>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ RED FLAGS in interviews:</span>

<span class="hljs-comment">// 1. Mutating props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Bad</span>(<span class="hljs-params">{ user }</span>) </span>{
  user.name = <span class="hljs-string">"Changed"</span>; <span class="hljs-comment">// NEVER!</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// 2. Not using destructuring</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Verbose</span>(<span class="hljs-params">props</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {props.user.name} - {props.user.email}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 3. Inline object creation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Inefficient</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Component</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> "<span class="hljs-attr">red</span>" }} // <span class="hljs-attr">New</span> <span class="hljs-attr">object</span> <span class="hljs-attr">every</span> <span class="hljs-attr">render</span>!
      <span class="hljs-attr">data</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">items:</span> [] }} // <span class="hljs-attr">New</span> <span class="hljs-attr">object</span> <span class="hljs-attr">every</span> <span class="hljs-attr">render</span>!
    /&gt;</span></span>
  );
}

<span class="hljs-comment">// 4. Missing key props in lists</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MissingKeys</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {items.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}{" "}
      // No key!
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="pro-interview-tips">Pro Interview Tips</h3>
<ol>
<li><strong>Always destructure props</strong> in function parameters</li>
<li><strong>Mention performance implications</strong> of prop changes</li>
<li><strong>Show awareness of prop drilling</strong> and solutions</li>
<li><strong>Demonstrate composition patterns</strong> with children</li>
<li><strong>Use TypeScript prop types</strong> if asked about type safety</li>
</ol>
<h2 id="%F0%9F%9A%80-next-steps">🚀 Next Steps</h2>
<p>Now that you understand props and children, you're ready for:</p>
<ul>
<li><strong>useState and Functional State</strong> - Making components interactive</li>
<li><strong>Event Handling</strong> - Responding to user actions</li>
<li><strong>Controlled Components</strong> - Managing form inputs</li>
</ul>
<hr>
<blockquote>
<p><strong>Key Takeaway</strong>: Props are the communication system of React. Master prop patterns and component composition, and you'll build flexible, reusable components that scale with your application!</p>
</blockquote>
<h1 id="%F0%9F%94%84-usestate--functional-state-making-components-interactive">🔄 useState &amp; Functional State: Making Components Interactive</h1>
<blockquote>
<p><strong>Master React's most fundamental hook: useState. Learn how to manage component state, trigger re-renders, and build truly interactive applications</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>useState fundamentals and the state update cycle</li>
<li>State initialization patterns and lazy initialization</li>
<li>Functional updates and avoiding stale closures</li>
<li>Managing different types of state (primitives, objects, arrays)</li>
<li>State batching and performance considerations</li>
<li>Common useState patterns and anti-patterns</li>
</ul>
<h2 id="%F0%9F%9A%80-usestate-fundamentals">🚀 useState Fundamentals</h2>
<h3 id="the-anatomy-of-usestate">The Anatomy of useState</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// useState returns an array with exactly 2 elements:</span>
  <span class="hljs-comment">// [currentValue, setterFunction]</span>
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>); <span class="hljs-comment">// 0 is the initial value</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count - 1)}&gt;Decrement<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(0)}&gt;Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="state-update-cycle">State Update Cycle</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StateUpdateDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [message, setMessage] = useState(<span class="hljs-string">"Initial"</span>);

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Component rendering with message:"</span>, message);

  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Before setState:"</span>, message);
    setMessage(<span class="hljs-string">"Updated"</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"After setState (still old):"</span>, message); <span class="hljs-comment">// Still "Initial"!</span>

    <span class="hljs-comment">// State updates are asynchronous and trigger re-render</span>
    <span class="hljs-comment">// The new value will be available in the next render</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Message: {message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Update Message<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Console output when button is clicked:</span>
<span class="hljs-comment">// "Component rendering with message: Initial"</span>
<span class="hljs-comment">// "Before setState: Initial"</span>
<span class="hljs-comment">// "After setState (still old): Initial"</span>
<span class="hljs-comment">// "Component rendering with message: Updated"</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-state-initialization-patterns">🎯 State Initialization Patterns</h2>
<h3 id="simple-initialization">Simple Initialization</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SimpleState</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Primitive values</span>
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [age, setAge] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [isActive, setIsActive] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// Objects and arrays</span>
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span> });
  <span class="hljs-keyword">const</span> [items, setItems] = useState([]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setName(e.target.value)}
        placeholder="Name"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{age}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setAge(Number(e.target.value))}
        placeholder="Age"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
          <span class="hljs-attr">checked</span>=<span class="hljs-string">{isActive}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setIsActive(e.target.checked)}
        /&gt;
        Active
      <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="lazy-initialization-performance-optimization">Lazy Initialization (Performance Optimization)</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ EXPENSIVE: This function runs on every render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveInit</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(expensiveCalculation()); <span class="hljs-comment">// Runs every render!</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{data}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ OPTIMIZED: Lazy initialization with function</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedInit</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Pass a function to useState - it only runs once</span>
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Expensive calculation running..."</span>);
    <span class="hljs-keyword">return</span> expensiveCalculation(); <span class="hljs-comment">// Only runs on initial render</span>
  });

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{data}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// Real-world examples of lazy initialization</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LazyExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Reading from localStorage only once</span>
  <span class="hljs-keyword">const</span> [theme, setTheme] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> localStorage.getItem(<span class="hljs-string">"theme"</span>) || <span class="hljs-string">"light"</span>;
  });

  <span class="hljs-comment">// Complex object creation</span>
  <span class="hljs-keyword">const</span> [gameState, setGameState] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">level</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">score</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">lives</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">powerUps</span>: [],
      <span class="hljs-attr">enemies</span>: generateEnemies(<span class="hljs-number">1</span>), <span class="hljs-comment">// Expensive function</span>
    };
  });

  <span class="hljs-comment">// Date/time that shouldn't change</span>
  <span class="hljs-keyword">const</span> [sessionStart, setSessionStart] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>());

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Theme: {theme}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Game Level: {gameState.level}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Session started: {sessionStart.toLocaleTimeString()}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">expensiveCalculation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Simulate expensive operation</span>
  <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
    result += <span class="hljs-built_in">Math</span>.random();
  }
  <span class="hljs-keyword">return</span> result;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateEnemies</span>(<span class="hljs-params">level</span>) </span>{
  <span class="hljs-comment">// Simulate expensive enemy generation</span>
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: level * <span class="hljs-number">5</span> }, (_, i) =&gt; ({
    <span class="hljs-attr">id</span>: i,
    <span class="hljs-attr">type</span>: <span class="hljs-string">"goblin"</span>,
    <span class="hljs-attr">health</span>: <span class="hljs-number">100</span>,
    <span class="hljs-attr">position</span>: { <span class="hljs-attr">x</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">800</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">600</span> },
  }));
}
</div></code></pre>
<h2 id="%F0%9F%94%84-functional-updates-avoiding-stale-closures">🔄 Functional Updates: Avoiding Stale Closures</h2>
<h3 id="the-stale-closure-problem">The Stale Closure Problem</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ PROBLEM: Stale closure with rapid updates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StaleClosureProblem</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> handleMultipleUpdates = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// These all use the same 'count' value from when the function was created</span>
    setCount(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// If count was 0, this sets it to 1</span>
    setCount(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// This also sets it to 1 (not 2!)</span>
    setCount(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// This also sets it to 1 (not 3!)</span>

    <span class="hljs-comment">// Result: count becomes 1, not 3</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleMultipleUpdates}</span>&gt;</span>Add 3 (Broken)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ SOLUTION: Functional updates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FunctionalUpdatesSolution</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> handleMultipleUpdates = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Use functional updates - each gets the latest value</span>
    setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// Gets current count</span>
    setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// Gets updated count</span>
    setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// Gets updated count again</span>

    <span class="hljs-comment">// Result: count increases by 3</span>
  };

  <span class="hljs-keyword">const</span> handleAsyncUpdate = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Functional updates work great with async operations</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// Always gets latest value</span>
    }, <span class="hljs-number">1000</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleMultipleUpdates}</span>&gt;</span>Add 3 (Works!)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleAsyncUpdate}</span>&gt;</span>Add 1 After Delay<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-functional-update-patterns">Advanced Functional Update Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdvancedFunctionalUpdates</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Learn React"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Build a project"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
  ]);

  <span class="hljs-comment">// Toggle todo completion</span>
  <span class="hljs-keyword">const</span> toggleTodo = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prevTodos</span>) =&gt;</span>
      prevTodos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
        todo.id === id ? { ...todo, <span class="hljs-attr">completed</span>: !todo.completed } : todo
      )
    );
  };

  <span class="hljs-comment">// Add new todo</span>
  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prevTodos</span>) =&gt;</span> [
      ...prevTodos,
      {
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(), <span class="hljs-comment">// Simple ID generation</span>
        text,
        <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
      },
    ]);
  };

  <span class="hljs-comment">// Remove todo</span>
  <span class="hljs-keyword">const</span> removeTodo = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prevTodos</span>) =&gt;</span> prevTodos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.id !== id));
  };

  <span class="hljs-comment">// Complex state update with multiple conditions</span>
  <span class="hljs-keyword">const</span> updateTodoWithValidation = <span class="hljs-function">(<span class="hljs-params">id, newText</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prevTodos</span>) =&gt;</span> {
      <span class="hljs-comment">// You can add complex logic in functional updates</span>
      <span class="hljs-keyword">if</span> (!newText.trim()) {
        <span class="hljs-comment">// Don't update if text is empty</span>
        <span class="hljs-keyword">return</span> prevTodos;
      }

      <span class="hljs-keyword">return</span> prevTodos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (todo.id === id) {
          <span class="hljs-keyword">return</span> {
            ...todo,
            <span class="hljs-attr">text</span>: newText.trim(),
            <span class="hljs-attr">lastModified</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
          };
        }
        <span class="hljs-keyword">return</span> todo;
      });
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Todo List<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {todos.map((todo) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-item"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
            <span class="hljs-attr">checked</span>=<span class="hljs-string">{todo.completed}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleTodo(todo.id)}
          /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{todo.completed</span> ? "<span class="hljs-attr">completed</span>" <span class="hljs-attr">:</span> ""}&gt;</span>{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeTodo(todo.id)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> addTodo("New todo")}&gt;Add Todo<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%93%8A-managing-different-state-types">📊 Managing Different State Types</h2>
<h3 id="object-state-management">Object State Management</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ObjectStateManagement</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({
    <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">preferences</span>: {
      <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span>,
      <span class="hljs-attr">notifications</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">language</span>: <span class="hljs-string">"en"</span>,
    },
    <span class="hljs-attr">profile</span>: {
      <span class="hljs-attr">bio</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">avatar</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">socialLinks</span>: [],
    },
  });

  <span class="hljs-comment">// ❌ WRONG: Mutating state directly</span>
  <span class="hljs-keyword">const</span> updateNameWrong = <span class="hljs-function">(<span class="hljs-params">newName</span>) =&gt;</span> {
    user.name = newName; <span class="hljs-comment">// DON'T DO THIS!</span>
    setUser(user);
  };

  <span class="hljs-comment">// ✅ CORRECT: Creating new object</span>
  <span class="hljs-keyword">const</span> updateName = <span class="hljs-function">(<span class="hljs-params">newName</span>) =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prevUser</span>) =&gt;</span> ({
      ...prevUser,
      <span class="hljs-attr">name</span>: newName,
    }));
  };

  <span class="hljs-comment">// ✅ CORRECT: Updating nested objects</span>
  <span class="hljs-keyword">const</span> updateTheme = <span class="hljs-function">(<span class="hljs-params">newTheme</span>) =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prevUser</span>) =&gt;</span> ({
      ...prevUser,
      <span class="hljs-attr">preferences</span>: {
        ...prevUser.preferences,
        <span class="hljs-attr">theme</span>: newTheme,
      },
    }));
  };

  <span class="hljs-comment">// ✅ CORRECT: Updating deeply nested arrays</span>
  <span class="hljs-keyword">const</span> addSocialLink = <span class="hljs-function">(<span class="hljs-params">platform, url</span>) =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prevUser</span>) =&gt;</span> ({
      ...prevUser,
      <span class="hljs-attr">profile</span>: {
        ...prevUser.profile,
        <span class="hljs-attr">socialLinks</span>: [
          ...prevUser.profile.socialLinks,
          { platform, url, <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now() },
        ],
      },
    }));
  };

  <span class="hljs-comment">// Helper function for complex nested updates</span>
  <span class="hljs-keyword">const</span> updateUserField = <span class="hljs-function">(<span class="hljs-params">path, value</span>) =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prevUser</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> newUser = { ...prevUser };

      <span class="hljs-comment">// Simple path handling (for demo purposes)</span>
      <span class="hljs-keyword">if</span> (path === <span class="hljs-string">"preferences.theme"</span>) {
        newUser.preferences = { ...newUser.preferences, <span class="hljs-attr">theme</span>: value };
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (path === <span class="hljs-string">"profile.bio"</span>) {
        newUser.profile = { ...newUser.profile, <span class="hljs-attr">bio</span>: value };
      }

      <span class="hljs-keyword">return</span> newUser;
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{user.name}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateName(e.target.value)}
        placeholder="Name"
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{user.preferences.theme}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateTheme(e.target.value)}
      &gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"light"</span>&gt;</span>Light<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"dark"</span>&gt;</span>Dark<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{user.profile.bio}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateUserField("profile.bio", e.target.value)}
        placeholder="Bio"
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> addSocialLink("twitter", "@username")}&gt;
        Add Twitter
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(user, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="array-state-management">Array State Management</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ArrayStateManagement</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Apple"</span>, <span class="hljs-attr">category</span>: <span class="hljs-string">"fruit"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">1.2</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Banana"</span>, <span class="hljs-attr">category</span>: <span class="hljs-string">"fruit"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">0.8</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Carrot"</span>, <span class="hljs-attr">category</span>: <span class="hljs-string">"vegetable"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">0.5</span> },
  ]);

  <span class="hljs-comment">// Add item to end</span>
  <span class="hljs-keyword">const</span> addItem = <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> [...prevItems, { ...item, <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now() }]);
  };

  <span class="hljs-comment">// Add item to beginning</span>
  <span class="hljs-keyword">const</span> addItemToStart = <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> [{ ...item, <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now() }, ...prevItems]);
  };

  <span class="hljs-comment">// Remove item by id</span>
  <span class="hljs-keyword">const</span> removeItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> prevItems.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id));
  };

  <span class="hljs-comment">// Update item by id</span>
  <span class="hljs-keyword">const</span> updateItem = <span class="hljs-function">(<span class="hljs-params">id, updates</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> (item.id === id ? { ...item, ...updates } : item))
    );
  };

  <span class="hljs-comment">// Insert item at specific index</span>
  <span class="hljs-keyword">const</span> insertItemAt = <span class="hljs-function">(<span class="hljs-params">index, item</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> newItems = [...prevItems];
      newItems.splice(index, <span class="hljs-number">0</span>, { ...item, <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now() });
      <span class="hljs-keyword">return</span> newItems;
    });
  };

  <span class="hljs-comment">// Move item (reorder)</span>
  <span class="hljs-keyword">const</span> moveItem = <span class="hljs-function">(<span class="hljs-params">fromIndex, toIndex</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> newItems = [...prevItems];
      <span class="hljs-keyword">const</span> [movedItem] = newItems.splice(fromIndex, <span class="hljs-number">1</span>);
      newItems.splice(toIndex, <span class="hljs-number">0</span>, movedItem);
      <span class="hljs-keyword">return</span> newItems;
    });
  };

  <span class="hljs-comment">// Sort items</span>
  <span class="hljs-keyword">const</span> sortItems = <span class="hljs-function">(<span class="hljs-params">sortBy</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> sorted = [...prevItems].sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (sortBy === <span class="hljs-string">"name"</span>) {
          <span class="hljs-keyword">return</span> a.name.localeCompare(b.name);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sortBy === <span class="hljs-string">"price"</span>) {
          <span class="hljs-keyword">return</span> a.price - b.price;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      });
      <span class="hljs-keyword">return</span> sorted;
    });
  };

  <span class="hljs-comment">// Filter and update (complex operation)</span>
  <span class="hljs-keyword">const</span> updateItemsInCategory = <span class="hljs-function">(<span class="hljs-params">category, updates</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.category === category ? { ...item, ...updates } : item
      )
    );
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Items ({items.length})<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span>
            addItem({ name: "Orange", category: "fruit", price: 1.0 })
          }
        &gt;
          Add Orange
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> sortItems("name")}&gt;Sort by Name<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> sortItems("price")}&gt;Sort by Price<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateItemsInCategory("fruit", { onSale: true })}
        &gt;
          Put Fruits on Sale
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {items.map((item, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
              {item.name} - ${item.price}
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            {item.onSale &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"sale-badge"</span>&gt;</span>ON SALE<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
              <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateItem(item.id, { price: item.price * 0.9 })}
            &gt;
              10% Off
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeItem(item.id)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> moveItem(index, 0)}&gt;Move to Top<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A1-state-batching-and-performance">⚡ State Batching and Performance</h2>
<h3 id="understanding-state-batching">Understanding State Batching</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StateBatchingDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [email, setEmail] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Component rendered with:"</span>, { count, name, email });

  <span class="hljs-comment">// React 18: Automatic batching in all scenarios</span>
  <span class="hljs-keyword">const</span> handleBatchedUpdates = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Before updates"</span>);

    <span class="hljs-comment">// These will be batched together - only one re-render</span>
    setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>);
    setName(<span class="hljs-string">"John"</span>);
    setEmail(<span class="hljs-string">"john@example.com"</span>);

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"After updates (but before re-render)"</span>);
    <span class="hljs-comment">// Component will re-render once with all updates</span>
  };

  <span class="hljs-comment">// Even in async operations (React 18+)</span>
  <span class="hljs-keyword">const</span> handleAsyncBatchedUpdates = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-comment">// These are also batched in React 18</span>
      setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>);
      setName(<span class="hljs-string">"Jane"</span>);
      setEmail(<span class="hljs-string">"jane@example.com"</span>);
    }, <span class="hljs-number">1000</span>);
  };

  <span class="hljs-comment">// Force separate updates (rarely needed)</span>
  <span class="hljs-keyword">const</span> handleUnbatchedUpdates = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">import</span>(<span class="hljs-string">"react-dom"</span>).then(<span class="hljs-function">(<span class="hljs-params">{ flushSync }</span>) =&gt;</span> {
      flushSync(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>);
      });
      <span class="hljs-comment">// Re-render happens here</span>

      flushSync(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        setName(<span class="hljs-string">"Bob"</span>);
      });
      <span class="hljs-comment">// Another re-render happens here</span>
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Name: {name}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Email: {email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleBatchedUpdates}</span>&gt;</span>Batched Updates (1 render)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleAsyncBatchedUpdates}</span>&gt;</span>Async Batched Updates<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleUnbatchedUpdates}</span>&gt;</span>
        Unbatched Updates (multiple renders)
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-direct-state-mutation">1. Direct State Mutation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Mutating state directly</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MutationMistakes</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">hobbies</span>: [<span class="hljs-string">"reading"</span>] });
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);

  <span class="hljs-keyword">const</span> badUpdate = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// DON'T DO THESE:</span>
    user.name = <span class="hljs-string">"Jane"</span>; <span class="hljs-comment">// Mutating object</span>
    user.hobbies.push(<span class="hljs-string">"coding"</span>); <span class="hljs-comment">// Mutating nested array</span>
    items.push(<span class="hljs-number">4</span>); <span class="hljs-comment">// Mutating array</span>
    setUser(user); <span class="hljs-comment">// React won't detect the change!</span>
    setItems(items);
  };

  <span class="hljs-comment">// ✅ CORRECT: Create new objects/arrays</span>
  <span class="hljs-keyword">const</span> goodUpdate = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prevUser</span>) =&gt;</span> ({
      ...prevUser,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane"</span>,
      <span class="hljs-attr">hobbies</span>: [...prevUser.hobbies, <span class="hljs-string">"coding"</span>],
    }));

    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> [...prevItems, <span class="hljs-number">4</span>]);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>User: {user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hobbies: {user.hobbies.join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Items: {items.join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{badUpdate}</span>&gt;</span>Bad Update<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{goodUpdate}</span>&gt;</span>Good Update<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-stale-state-in-event-handlers">2. Stale State in Event Handlers</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ PROBLEM: Stale state in closures</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StaleStateProblems</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// This creates a closure that captures the current count value</span>
  <span class="hljs-keyword">const</span> handleDelayedIncrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// Uses stale count value!</span>
    }, <span class="hljs-number">3000</span>);
  };

  <span class="hljs-comment">// ✅ SOLUTION: Use functional updates</span>
  <span class="hljs-keyword">const</span> handleCorrectDelayedIncrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// Always gets latest value</span>
    }, <span class="hljs-number">3000</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Increment Now<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleDelayedIncrement}</span>&gt;</span>Increment in 3s (Broken)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCorrectDelayedIncrement}</span>&gt;</span>
        Increment in 3s (Fixed)
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="3-unnecessary-state">3. Unnecessary State</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Storing derived values in state</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UnnecessaryState</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-keyword">const</span> [itemCount, setItemCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [expensiveItems, setExpensiveItems] = useState([]);

  <span class="hljs-comment">// DON'T DO THIS - these should be computed values!</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setItemCount(items.length);
    setExpensiveItems(items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.price &gt; <span class="hljs-number">100</span>));
  }, [items]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Item count: {itemCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Expensive items: {expensiveItems.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Compute derived values during render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ComputedValues</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-comment">// These are computed on every render (which is fine for simple calculations)</span>
  <span class="hljs-keyword">const</span> itemCount = items.length;
  <span class="hljs-keyword">const</span> expensiveItems = items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.price &gt; <span class="hljs-number">100</span>);

  <span class="hljs-comment">// For expensive calculations, use useMemo (covered in later chapters)</span>
  <span class="hljs-keyword">const</span> expensiveCalculation = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.price, <span class="hljs-number">0</span>);
  }, [items]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Item count: {itemCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Expensive items: {expensiveItems.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Total value: ${expensiveCalculation}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when-and-why-to-use-usestate">🎯 When and Why to Use useState</h2>
<h3 id="usestate-decision-tree">useState Decision Tree</h3>
<pre class="hljs"><code><div>Do you need to store data that:
├── Changes over time? ────────────────────── YES → useState
├── Triggers re-renders when it changes? ──── YES → useState
├── Is derived from props or other state? ─── NO → Computed value
├── Persists between renders? ─────────────── YES → useState
├── Is only used in event handlers? ───────── MAYBE → useRef
└── Is shared between components? ─────────── MAYBE → Context/Props
</div></code></pre>
<h3 id="real-world-usestate-patterns">Real-World useState Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. Form state management</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ContactForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [formData, setFormData] = useState({
    <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">message</span>: <span class="hljs-string">""</span>,
  });
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
  <span class="hljs-keyword">const</span> [isSubmitting, setIsSubmitting] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> handleInputChange = <span class="hljs-function">(<span class="hljs-params">field, value</span>) =&gt;</span> {
    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [field]: value }));

    <span class="hljs-comment">// Clear error when user starts typing</span>
    <span class="hljs-keyword">if</span> (errors[field]) {
      setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [field]: <span class="hljs-literal">null</span> }));
    }
  };

  <span class="hljs-keyword">const</span> validateForm = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newErrors = {};
    <span class="hljs-keyword">if</span> (!formData.name.trim()) newErrors.name = <span class="hljs-string">"Name is required"</span>;
    <span class="hljs-keyword">if</span> (!formData.email.includes(<span class="hljs-string">"@"</span>)) newErrors.email = <span class="hljs-string">"Valid email required"</span>;
    <span class="hljs-keyword">if</span> (!formData.message.trim()) newErrors.message = <span class="hljs-string">"Message is required"</span>;

    setErrors(newErrors);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(newErrors).length === <span class="hljs-number">0</span>;
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> (e) =&gt; {
    e.preventDefault();

    <span class="hljs-keyword">if</span> (!validateForm()) <span class="hljs-keyword">return</span>;

    setIsSubmitting(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> submitForm(formData);
      setFormData({ <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">""</span> }); <span class="hljs-comment">// Reset form</span>
    } <span class="hljs-keyword">catch</span> (error) {
      setErrors({ <span class="hljs-attr">submit</span>: <span class="hljs-string">"Failed to submit form"</span> });
    } <span class="hljs-keyword">finally</span> {
      setIsSubmitting(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.name}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> handleInputChange("name", e.target.value)}
        placeholder="Name"
      /&gt;
      {errors.name &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> handleInputChange("email", e.target.value)}
        placeholder="Email"
      /&gt;
      {errors.email &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.message}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> handleInputChange("message", e.target.value)}
        placeholder="Message"
      /&gt;
      {errors.message &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.message}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isSubmitting}</span>&gt;</span>
        {isSubmitting ? "Submitting..." : "Submit"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {errors.submit &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.submit}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 2. Toggle and UI state</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ToggleExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [isMenuOpen, setIsMenuOpen] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [activeTab, setActiveTab] = useState(<span class="hljs-string">"home"</span>);
  <span class="hljs-keyword">const</span> [isLoading, setIsLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [showModal, setShowModal] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsMenuOpen(!isMenuOpen)}&gt;
        {isMenuOpen ? "Close" : "Open"} Menu
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"tabs"</span>&gt;</span>
        {["home", "about", "contact"].map((tab) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{tab}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{activeTab</span> === <span class="hljs-string">tab</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setActiveTab(tab)}
          &gt;
            {tab}
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
          setIsLoading(true);
          setTimeout(() =&gt; setIsLoading(false), 2000);
        }}
        disabled={isLoading}
      &gt;
        {isLoading ? "Loading..." : "Load Data"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowModal(true)}&gt;Show Modal<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {showModal &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowModal(false)}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{(e)</span> =&gt;</span> e.stopPropagation()}&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Modal Content<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowModal(false)}&gt;Close<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-shopping-cart">Challenge 1: Shopping Cart</h3>
<p>Build a shopping cart component with:</p>
<ul>
<li>Add/remove items</li>
<li>Update quantities</li>
<li>Calculate total price</li>
<li>Clear cart functionality</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your solution:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ShoppingCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Implement cart state and functions</span>
}

<span class="hljs-comment">// Test data:</span>
<span class="hljs-keyword">const</span> products = [
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Laptop"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">999</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Mouse"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">25</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Keyboard"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">75</span> },
];
</div></code></pre>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ShoppingCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [cartItems, setCartItems] = useState([]);

  <span class="hljs-keyword">const</span> addToCart = <span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> {
    setCartItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> existingItem = prevItems.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === product.id);

      <span class="hljs-keyword">if</span> (existingItem) {
        <span class="hljs-keyword">return</span> prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id === product.id
            ? { ...item, <span class="hljs-attr">quantity</span>: item.quantity + <span class="hljs-number">1</span> }
            : item
        );
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> [...prevItems, { ...product, <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span> }];
      }
    });
  };

  <span class="hljs-keyword">const</span> removeFromCart = <span class="hljs-function">(<span class="hljs-params">productId</span>) =&gt;</span> {
    setCartItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== productId)
    );
  };

  <span class="hljs-keyword">const</span> updateQuantity = <span class="hljs-function">(<span class="hljs-params">productId, newQuantity</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (newQuantity &lt;= <span class="hljs-number">0</span>) {
      removeFromCart(productId);
      <span class="hljs-keyword">return</span>;
    }

    setCartItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.id === productId ? { ...item, <span class="hljs-attr">quantity</span>: newQuantity } : item
      )
    );
  };

  <span class="hljs-keyword">const</span> clearCart = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCartItems([]);
  };

  <span class="hljs-keyword">const</span> totalPrice = cartItems.reduce(
    <span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.price * item.quantity,
    <span class="hljs-number">0</span>
  );

  <span class="hljs-keyword">const</span> totalItems = cartItems.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.quantity, <span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"shopping-cart"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Shopping Cart ({totalItems} items)<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

      {cartItems.length === 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Your cart is empty<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;&gt;</span>
          {cartItems.map((item) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-item"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>${item.price}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{item.quantity}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
                  updateQuantity(item.id, parseInt(e.target.value))
                }
                min="1"
              /&gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>${(item.price * item.quantity).toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeFromCart(item.id)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-total"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Total: ${totalPrice.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearCart}</span>&gt;</span>Clear Cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}

      &lt;div className=<span class="hljs-string">"products"</span>&gt;
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Products<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span>
        {products.map(<span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{product.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
              {product.name} - ${product.price}
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> addToCart(product)}&gt;Add to Cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        ))}
      &lt;<span class="hljs-regexp">/div&gt;
    &lt;/</span>div&gt;
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-multi-step-form">Challenge 2: Multi-Step Form</h3>
<p>Create a multi-step form with:</p>
<ul>
<li>Step navigation (next/previous)</li>
<li>Form validation</li>
<li>Progress indicator</li>
<li>Data persistence between steps</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MultiStepForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [currentStep, setCurrentStep] = useState(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> [formData, setFormData] = useState({
    <span class="hljs-comment">// Step 1</span>
    <span class="hljs-attr">firstName</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">lastName</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
    <span class="hljs-comment">// Step 2</span>
    <span class="hljs-attr">address</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">city</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">zipCode</span>: <span class="hljs-string">""</span>,
    <span class="hljs-comment">// Step 3</span>
    <span class="hljs-attr">cardNumber</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">expiryDate</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">cvv</span>: <span class="hljs-string">""</span>,
  });
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});

  <span class="hljs-keyword">const</span> totalSteps = <span class="hljs-number">3</span>;

  <span class="hljs-keyword">const</span> updateField = <span class="hljs-function">(<span class="hljs-params">field, value</span>) =&gt;</span> {
    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [field]: value }));
    <span class="hljs-keyword">if</span> (errors[field]) {
      setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [field]: <span class="hljs-literal">null</span> }));
    }
  };

  <span class="hljs-keyword">const</span> validateStep = <span class="hljs-function">(<span class="hljs-params">step</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newErrors = {};

    <span class="hljs-keyword">if</span> (step === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">if</span> (!formData.firstName.trim()) newErrors.firstName = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!formData.lastName.trim()) newErrors.lastName = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!formData.email.includes(<span class="hljs-string">"@"</span>))
        newErrors.email = <span class="hljs-string">"Valid email required"</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (step === <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">if</span> (!formData.address.trim()) newErrors.address = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!formData.city.trim()) newErrors.city = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!formData.zipCode.trim()) newErrors.zipCode = <span class="hljs-string">"Required"</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (step === <span class="hljs-number">3</span>) {
      <span class="hljs-keyword">if</span> (!formData.cardNumber.trim()) newErrors.cardNumber = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!formData.expiryDate.trim()) newErrors.expiryDate = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!formData.cvv.trim()) newErrors.cvv = <span class="hljs-string">"Required"</span>;
    }

    setErrors(newErrors);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(newErrors).length === <span class="hljs-number">0</span>;
  };

  <span class="hljs-keyword">const</span> nextStep = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (validateStep(currentStep)) {
      setCurrentStep(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> <span class="hljs-built_in">Math</span>.min(prev + <span class="hljs-number">1</span>, totalSteps));
    }
  };

  <span class="hljs-keyword">const</span> prevStep = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCurrentStep(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> <span class="hljs-built_in">Math</span>.max(prev - <span class="hljs-number">1</span>, <span class="hljs-number">1</span>));
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (validateStep(currentStep)) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted:"</span>, formData);
      alert(<span class="hljs-string">"Form submitted successfully!"</span>);
    }
  };

  <span class="hljs-keyword">const</span> renderStep = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (currentStep) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Personal Information<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.firstName}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("firstName", e.target.value)}
              placeholder="First Name"
            /&gt;
            {errors.firstName &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.firstName}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            )}

            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.lastName}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("lastName", e.target.value)}
              placeholder="Last Name"
            /&gt;
            {errors.lastName &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.lastName}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            )}

            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.email}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("email", e.target.value)}
              placeholder="Email"
            /&gt;
            {errors.email &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );

      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Address Information<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.address}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("address", e.target.value)}
              placeholder="Address"
            /&gt;
            {errors.address &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.address}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.city}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("city", e.target.value)}
              placeholder="City"
            /&gt;
            {errors.city &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.city}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.zipCode}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("zipCode", e.target.value)}
              placeholder="Zip Code"
            /&gt;
            {errors.zipCode &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.zipCode}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );

      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Payment Information<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.cardNumber}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("cardNumber", e.target.value)}
              placeholder="Card Number"
            /&gt;
            {errors.cardNumber &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.cardNumber}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            )}

            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.expiryDate}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("expiryDate", e.target.value)}
              placeholder="MM/YY"
            /&gt;
            {errors.expiryDate &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.expiryDate}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            )}

            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.cvv}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateField("cvv", e.target.value)}
              placeholder="CVV"
            /&gt;
            {errors.cvv &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors.cvv}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );

      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"multi-step-form"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"progress-bar"</span>&gt;</span>
        {Array.from({ length: totalSteps }, (_, i) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{i</span> + <span class="hljs-attr">1</span>}
            <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">step</span> ${<span class="hljs-attr">currentStep</span> &gt;</span>= i + 1 ? "active" : ""}`}
          &gt;
            {i + 1}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {renderStep()}

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-navigation"</span>&gt;</span>
        {currentStep &gt; 1 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{prevStep}</span>&gt;</span>Previous<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>}

        {currentStep <span class="hljs-tag">&lt; <span class="hljs-attr">totalSteps</span> ? (
          &lt;<span class="hljs-attr">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{nextStep}</span>&gt;</span>Next<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        ) : (
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"step-indicator"</span>&gt;</span>
        Step {currentStep} of {totalSteps}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="what-interviewers-look-for">What Interviewers Look For</h3>
<ol>
<li>
<p><strong>State Update Understanding</strong>: &quot;What happens when you call setState?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: setState schedules a re-render, state updates are asynchronous, React may batch multiple updates</li>
</ul>
</li>
<li>
<p><strong>Functional Updates</strong>: &quot;When would you use a function in setState?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: When the new state depends on the previous state, to avoid stale closures, especially in async operations</li>
</ul>
</li>
<li>
<p><strong>State Structure</strong>: &quot;How do you decide what to put in state?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: Only data that changes over time and affects rendering. Avoid derived values, prefer computed values.</li>
</ul>
</li>
</ol>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Q: What's wrong with this code?</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BrokenCounter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> increment = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(count + <span class="hljs-number">1</span>);
    setCount(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// Won't work as expected!</span>
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}

<span class="hljs-comment">// Q: Fix this async state update</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AsyncProblem</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> delayedIncrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// Stale closure!</span>
    }, <span class="hljs-number">1000</span>);
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{delayedIncrement}</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}

<span class="hljs-comment">// Q: Optimize this expensive initialization</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveInit</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(expensiveCalculation()); <span class="hljs-comment">// Runs every render!</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{data}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="pro-interview-tips">Pro Interview Tips</h3>
<ol>
<li><strong>Always mention functional updates</strong> when discussing state that depends on previous state</li>
<li><strong>Explain the difference</strong> between state and props clearly</li>
<li><strong>Show awareness of performance</strong> implications (unnecessary re-renders)</li>
<li><strong>Demonstrate immutability</strong> principles with objects and arrays</li>
<li><strong>Know when NOT to use state</strong> (derived values, refs for non-rendering data)</li>
</ol>
<h2 id="%F0%9F%9A%80-next-steps">🚀 Next Steps</h2>
<p>Now that you've mastered useState, you're ready for:</p>
<ul>
<li><strong>Rendering Logic, Lists, and Keys</strong> - Efficiently rendering dynamic content</li>
<li><strong>Handling DOM Events</strong> - User interactions and event handling</li>
<li><strong>useEffect</strong> - Side effects and lifecycle management</li>
</ul>
<hr>
<blockquote>
<p><strong>Key Takeaway</strong>: useState is React's fundamental state primitive. Master functional updates, immutability, and when to use state vs computed values. Remember: state should only contain data that changes over time and affects what's rendered!</p>
</blockquote>
<h1 id="%F0%9F%93%8B-rendering-logic-lists-and-keys-dynamic-content-mastery">📋 Rendering Logic, Lists, and Keys: Dynamic Content Mastery</h1>
<blockquote>
<p><strong>Master React's rendering patterns: conditional rendering, list rendering, and the crucial role of keys in React's reconciliation process</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>Conditional rendering patterns and best practices</li>
<li>List rendering with map() and performance considerations</li>
<li>The critical importance of keys in React's reconciliation</li>
<li>Advanced rendering patterns and optimization techniques</li>
<li>Common pitfalls and how to avoid them</li>
<li>When and how to use React.Fragment</li>
</ul>
<h2 id="%F0%9F%94%80-conditional-rendering-patterns">🔀 Conditional Rendering Patterns</h2>
<h3 id="basic-conditional-rendering">Basic Conditional Rendering</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConditionalBasics</span>(<span class="hljs-params">{ user, isLoading, error }</span>) </span>{
  <span class="hljs-comment">// 1. Simple if statement (early return)</span>
  <span class="hljs-keyword">if</span> (isLoading) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"spinner"</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>Error: {error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">if</span> (!user) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"empty"</span>&gt;</span>No user found<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-comment">// 2. Ternary operator for inline conditions</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-profile"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

      {/* Simple ternary */}
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{user.isOnline ? "🟢 Online" : "🔴 Offline"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      {/* Ternary with components */}
      {user.isPremium ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">PremiumBadge</span> /&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> upgradeToPremium(user.id)}&gt;
          Upgrade to Premium
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      )}

      {/* Logical AND for optional rendering */}
      {user.bio &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"bio"</span>&gt;</span>{user.bio}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}

      {/* Multiple conditions */}
      {user.isAdmin &amp;&amp; user.permissions.includes("delete") &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"danger"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> deleteUser(user.id)}&gt;
          Delete User
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Helper components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PremiumBadge</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"premium-badge"</span>&gt;</span>⭐ Premium<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="advanced-conditional-patterns">Advanced Conditional Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdvancedConditionals</span>(<span class="hljs-params">{ userRole, permissions, features }</span>) </span>{
  <span class="hljs-comment">// 1. Switch-like pattern with object mapping</span>
  <span class="hljs-keyword">const</span> roleComponents = {
    <span class="hljs-attr">admin</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AdminDashboard</span> /&gt;</span></span>,
    <span class="hljs-attr">moderator</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ModeratorPanel</span> /&gt;</span></span>,
    <span class="hljs-attr">user</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserDashboard</span> /&gt;</span></span>,
    <span class="hljs-attr">guest</span>: <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">GuestWelcome</span> /&gt;</span></span>,
  };

  <span class="hljs-comment">// 2. Complex conditional logic with helper functions</span>
  <span class="hljs-keyword">const</span> canAccessFeature = <span class="hljs-function">(<span class="hljs-params">feature</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> permissions.includes(feature) || userRole === <span class="hljs-string">"admin"</span>;
  };

  <span class="hljs-keyword">const</span> renderFeatureSection = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!features || features.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">EmptyState</span> <span class="hljs-attr">message</span>=<span class="hljs-string">"No features available"</span> /&gt;</span></span>;
    }

    <span class="hljs-keyword">const</span> availableFeatures = features.filter(<span class="hljs-function">(<span class="hljs-params">feature</span>) =&gt;</span>
      canAccessFeature(feature.permission)
    );

    <span class="hljs-keyword">if</span> (availableFeatures.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AccessDenied</span> /&gt;</span></span>;
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"features"</span>&gt;</span>
        {availableFeatures.map((feature) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">FeatureCard</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{feature.id}</span> <span class="hljs-attr">feature</span>=<span class="hljs-string">{feature}</span> /&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  };

  <span class="hljs-comment">// 3. Nested conditional rendering</span>
  <span class="hljs-keyword">const</span> renderUserActions = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (userRole === <span class="hljs-string">"guest"</span>) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"guest-actions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Sign In<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Sign Up<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      );
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-actions"</span>&gt;</span>
        {userRole === "admin" &amp;&amp; (
          <span class="hljs-tag">&lt;&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Manage Users<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>System Settings<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/&gt;</span></span>
        )}

        {(userRole === <span class="hljs-string">"admin"</span> || userRole === <span class="hljs-string">"moderator"</span>) &amp;&amp; (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Moderate Content<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
        )}

        &lt;button&gt;Profile Settings&lt;<span class="hljs-regexp">/button&gt;
        &lt;button&gt;Sign Out&lt;/</span>button&gt;
      &lt;<span class="hljs-regexp">/div&gt;
    );
  };

  return (
    &lt;div className="dashboard"&gt;
      {/</span>* Render role-specific component *<span class="hljs-regexp">/}
      {roleComponents[userRole] || &lt;div&gt;Unknown role&lt;/</span>div&gt;}

      {<span class="hljs-comment">/* Conditional sections */</span>}
      {renderFeatureSection()}
      {renderUserActions()}

      {<span class="hljs-comment">/* Complex conditional with multiple factors */</span>}
      {userRole !== <span class="hljs-string">"guest"</span> &amp;&amp; permissions.includes(<span class="hljs-string">"notifications"</span>) &amp;&amp; (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">NotificationCenter</span> /&gt;</span></span>
      )}
    &lt;<span class="hljs-regexp">/div&gt;
  );
}

/</span><span class="hljs-regexp">/ Helper components
function EmptyState({ message }) {
  return (
    &lt;div className="empty-state"&gt;
      &lt;p&gt;{message}&lt;/</span>p&gt;
    &lt;<span class="hljs-regexp">/div&gt;
  );
}

function AccessDenied() {
  return (
    &lt;div className="access-denied"&gt;
      &lt;p&gt;You don't have permission to access these features.&lt;/</span>p&gt;
    &lt;<span class="hljs-regexp">/div&gt;
  );
}
</span></div></code></pre>
<h3 id="conditional-rendering-anti-patterns">Conditional Rendering Anti-Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: These patterns can cause issues</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConditionalAntiPatterns</span>(<span class="hljs-params">{ items, user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ❌ DON'T: Conditional rendering with numbers (0 is falsy!) */}
      {items.length &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>You have {items.length} items<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}
      {/* If items.length is 0, this renders "0" instead of nothing! */}

      {/* ❌ DON'T: Complex expressions in JSX */}
      {user &amp;&amp;
        user.preferences &amp;&amp;
        user.preferences.theme === "dark" &amp;&amp;
        user.isActive &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">DarkThemeComponent</span> /&gt;</span>}

      {/* ❌ DON'T: Nested ternaries (hard to read) */}
      {user ? (
        user.isAdmin ? (
          user.permissions.includes("delete") ? (
            <span class="hljs-tag">&lt;<span class="hljs-name">DeleteButton</span> /&gt;</span>
          ) : (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>No delete permission<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )
        ) : (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Not an admin<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>No user<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Better patterns</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConditionalBestPractices</span>(<span class="hljs-params">{ items, user }</span>) </span>{
  <span class="hljs-comment">// Helper functions for complex logic</span>
  <span class="hljs-keyword">const</span> hasItems = items &amp;&amp; items.length &gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> canDelete = user?.isAdmin &amp;&amp; user?.permissions?.includes(<span class="hljs-string">"delete"</span>);
  <span class="hljs-keyword">const</span> isDarkThemeUser = user?.preferences?.theme === <span class="hljs-string">"dark"</span> &amp;&amp; user?.isActive;

  <span class="hljs-keyword">const</span> renderUserStatus = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!user) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>No user<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
    <span class="hljs-keyword">if</span> (!user.isAdmin) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Not an admin<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
    <span class="hljs-keyword">if</span> (!user.permissions.includes(<span class="hljs-string">"delete"</span>))
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>No delete permission<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DeleteButton</span> /&gt;</span></span>;
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ✅ DO: Explicit boolean conversion */}
      {hasItems &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>You have {items.length} items<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {/* ✅ DO: Extract complex conditions */}
      {isDarkThemeUser &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">DarkThemeComponent</span> /&gt;</span>}

      {/* ✅ DO: Use helper functions for complex logic */}
      {renderUserStatus()}

      {/* ✅ DO: Use early returns in helper functions */}
      {canDelete &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">DeleteButton</span> /&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%93%8B-list-rendering-mastery">📋 List Rendering Mastery</h2>
<h3 id="basic-list-rendering">Basic List Rendering</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BasicListRendering</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> fruits = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>, <span class="hljs-string">"grape"</span>];
  <span class="hljs-keyword">const</span> users = [
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>, <span class="hljs-attr">isActive</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"jane@example.com"</span>, <span class="hljs-attr">isActive</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"bob@example.com"</span>, <span class="hljs-attr">isActive</span>: <span class="hljs-literal">true</span> },
  ];

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Simple array of strings */}
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Fruits<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {fruits.map((fruit, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>&gt;</span>{fruit}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>

      {/* Array of objects */}
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Users<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-list"</span>&gt;</span>
        {users.map((user) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-card"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">status</span> ${<span class="hljs-attr">user.isActive</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">inactive</span>"}`}&gt;</span>
              {user.isActive ? "Active" : "Inactive"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Conditional rendering within lists */}
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Active Users Only<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"active-users"</span>&gt;</span>
        {users
          .filter((user) =&gt; user.isActive)
          .map((user) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span>
          ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserCard</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-list-patterns">Advanced List Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdvancedListPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [products, setProducts] = useState([
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Laptop"</span>,
      <span class="hljs-attr">category</span>: <span class="hljs-string">"electronics"</span>,
      <span class="hljs-attr">price</span>: <span class="hljs-number">999</span>,
      <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span>,
    },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Book"</span>, <span class="hljs-attr">category</span>: <span class="hljs-string">"education"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">false</span> },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Headphones"</span>,
      <span class="hljs-attr">category</span>: <span class="hljs-string">"electronics"</span>,
      <span class="hljs-attr">price</span>: <span class="hljs-number">199</span>,
      <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span>,
    },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Notebook"</span>, <span class="hljs-attr">category</span>: <span class="hljs-string">"education"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">inStock</span>: <span class="hljs-literal">true</span> },
  ]);

  <span class="hljs-keyword">const</span> [sortBy, setSortBy] = useState(<span class="hljs-string">"name"</span>);
  <span class="hljs-keyword">const</span> [filterCategory, setFilterCategory] = useState(<span class="hljs-string">"all"</span>);
  <span class="hljs-keyword">const</span> [showOutOfStock, setShowOutOfStock] = useState(<span class="hljs-literal">true</span>);

  <span class="hljs-comment">// Complex filtering and sorting</span>
  <span class="hljs-keyword">const</span> processedProducts = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> filtered = products;

    <span class="hljs-comment">// Filter by category</span>
    <span class="hljs-keyword">if</span> (filterCategory !== <span class="hljs-string">"all"</span>) {
      filtered = filtered.filter(
        <span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> product.category === filterCategory
      );
    }

    <span class="hljs-comment">// Filter by stock status</span>
    <span class="hljs-keyword">if</span> (!showOutOfStock) {
      filtered = filtered.filter(<span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> product.inStock);
    }

    <span class="hljs-comment">// Sort products</span>
    filtered.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">switch</span> (sortBy) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"name"</span>:
          <span class="hljs-keyword">return</span> a.name.localeCompare(b.name);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"price"</span>:
          <span class="hljs-keyword">return</span> a.price - b.price;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"category"</span>:
          <span class="hljs-keyword">return</span> a.category.localeCompare(b.category);
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      }
    });

    <span class="hljs-keyword">return</span> filtered;
  }, [products, sortBy, filterCategory, showOutOfStock]);

  <span class="hljs-comment">// Group products by category</span>
  <span class="hljs-keyword">const</span> groupedProducts = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> processedProducts.reduce(<span class="hljs-function">(<span class="hljs-params">groups, product</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> category = product.category;
      <span class="hljs-keyword">if</span> (!groups[category]) {
        groups[category] = [];
      }
      groups[category].push(product);
      <span class="hljs-keyword">return</span> groups;
    }, {});
  }, [processedProducts]);

  <span class="hljs-keyword">const</span> renderProductList = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (processedProducts.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"empty-state"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>No products found matching your criteria.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      );
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-list"</span>&gt;</span>
        {processedProducts.map((product) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">ProductCard</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{product.id}</span>
            <span class="hljs-attr">product</span>=<span class="hljs-string">{product}</span>
            <span class="hljs-attr">onToggleStock</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleStock(product.id)}
          /&gt;
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  };

  <span class="hljs-keyword">const</span> renderGroupedProducts = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.entries(groupedProducts).map(
      <span class="hljs-function">(<span class="hljs-params">[category, categoryProducts]</span>) =&gt;</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{category}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"category-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"category-title"</span>&gt;</span>
            {category.charAt(0).toUpperCase() + category.slice(1)}(
            {categoryProducts.length})
          <span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"category-products"</span>&gt;</span>
            {categoryProducts.map((product) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">ProductCard</span>
                <span class="hljs-attr">key</span>=<span class="hljs-string">{product.id}</span>
                <span class="hljs-attr">product</span>=<span class="hljs-string">{product}</span>
                <span class="hljs-attr">onToggleStock</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleStock(product.id)}
              /&gt;
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      )
    );
  };

  <span class="hljs-keyword">const</span> toggleStock = <span class="hljs-function">(<span class="hljs-params">productId</span>) =&gt;</span> {
    setProducts(<span class="hljs-function">(<span class="hljs-params">prevProducts</span>) =&gt;</span>
      prevProducts.map(<span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span>
        product.id === productId
          ? { ...product, <span class="hljs-attr">inStock</span>: !product.inStock }
          : product
      )
    );
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-manager"</span>&gt;</span>
      {/* Controls */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{sortBy}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSortBy(e.target.value)}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"name"</span>&gt;</span>Sort by Name<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"price"</span>&gt;</span>Sort by Price<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"category"</span>&gt;</span>Sort by Category<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{filterCategory}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFilterCategory(e.target.value)}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"all"</span>&gt;</span>All Categories<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"electronics"</span>&gt;</span>Electronics<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"education"</span>&gt;</span>Education<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
            <span class="hljs-attr">checked</span>=<span class="hljs-string">{showOutOfStock}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setShowOutOfStock(e.target.checked)}
          /&gt;
          Show out of stock
        <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* View toggle */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"view-toggle"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setViewMode("list")}&gt;List View<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setViewMode("grouped")}&gt;Grouped View<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Render products */}
      {viewMode === "grouped" ? renderGroupedProducts() : renderProductList()}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProductCard</span>(<span class="hljs-params">{ product, onToggleStock }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">product-card</span> ${!<span class="hljs-attr">product.inStock</span> ? "<span class="hljs-attr">out-of-stock</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"category"</span>&gt;</span>{product.category}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"price"</span>&gt;</span>${product.price}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stock"</span>&gt;</span>
        {product.inStock ? "✅ In Stock" : "❌ Out of Stock"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onToggleStock}</span>&gt;</span>
        {product.inStock ? "Mark Out of Stock" : "Mark In Stock"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%91-keys-the-heart-of-reacts-reconciliation">🔑 Keys: The Heart of React's Reconciliation</h2>
<h3 id="understanding-keys-and-reconciliation">Understanding Keys and Reconciliation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// React's reconciliation process:</span>
<span class="hljs-comment">// 1. Compare new virtual DOM with previous virtual DOM</span>
<span class="hljs-comment">// 2. Identify what changed</span>
<span class="hljs-comment">// 3. Update only the changed parts in real DOM</span>
<span class="hljs-comment">// 4. Keys help React identify which items changed, moved, or were added/removed</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">KeysExplanation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Apple"</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">"red"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Banana"</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">"yellow"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Orange"</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">"orange"</span> },
  ]);

  <span class="hljs-keyword">const</span> addItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newItem = {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
      <span class="hljs-attr">name</span>: <span class="hljs-string">"New Fruit"</span>,
      <span class="hljs-attr">color</span>: <span class="hljs-string">"green"</span>,
    };
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> [newItem, ...prevItems]); <span class="hljs-comment">// Add to beginning</span>
  };

  <span class="hljs-keyword">const</span> removeItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> prevItems.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id));
  };

  <span class="hljs-keyword">const</span> shuffleItems = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> [...prevItems].sort(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">Math</span>.random() - <span class="hljs-number">0.5</span>));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addItem}</span>&gt;</span>Add Item to Beginning<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{shuffleItems}</span>&gt;</span>Shuffle Items<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* ❌ BAD: Using index as key */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"bad-example"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>❌ Bad: Index as Key<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        {items.map((item, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">ItemComponent</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> // <span class="hljs-attr">DON</span>'<span class="hljs-attr">T</span> <span class="hljs-attr">DO</span> <span class="hljs-attr">THIS</span>!
            <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
            <span class="hljs-attr">onRemove</span>=<span class="hljs-string">{()</span> =&gt;</span> removeItem(item.id)}
          /&gt;
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* ✅ GOOD: Using stable unique ID as key */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"good-example"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>✅ Good: Stable ID as Key<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        {items.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">ItemComponent</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> // <span class="hljs-attr">DO</span> <span class="hljs-attr">THIS</span>!
            <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
            <span class="hljs-attr">onRemove</span>=<span class="hljs-string">{()</span> =&gt;</span> removeItem(item.id)}
          /&gt;
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Component with internal state to demonstrate key importance</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ItemComponent</span>(<span class="hljs-params">{ item, onRemove }</span>) </span>{
  <span class="hljs-keyword">const</span> [isExpanded, setIsExpanded] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// This component maintains its own state</span>
  <span class="hljs-comment">// Wrong keys can cause state to "stick" to wrong items</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item-component"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item-header"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsExpanded(!isExpanded)}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> <span class="hljs-attr">item.color</span> }}&gt;</span>🍎<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{(e)</span> =&gt;</span> {
            e.stopPropagation();
            onRemove();
          }}
        &gt;
          Remove
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {isExpanded &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item-details"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Color: {item.color}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setInputValue(e.target.value)}
            placeholder="Type something..."
          /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You typed: {inputValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="key-selection-strategies">Key Selection Strategies</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">KeyStrategies</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Different scenarios for choosing keys</span>

  <span class="hljs-comment">// 1. ✅ BEST: Stable unique IDs from data</span>
  <span class="hljs-keyword">const</span> usersWithIds = [
    { <span class="hljs-attr">id</span>: <span class="hljs-string">"user_123"</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-string">"user_456"</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"jane@example.com"</span> },
  ];

  <span class="hljs-comment">// 2. ✅ GOOD: Composite keys when no single unique field</span>
  <span class="hljs-keyword">const</span> userPosts = [
    { <span class="hljs-attr">userId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">postId</span>: <span class="hljs-number">101</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"First Post"</span> },
    { <span class="hljs-attr">userId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">postId</span>: <span class="hljs-number">102</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Second Post"</span> },
    { <span class="hljs-attr">userId</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">postId</span>: <span class="hljs-number">103</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Another Post"</span> },
  ];

  <span class="hljs-comment">// 3. ⚠️ ACCEPTABLE: Index when list is static and never reordered</span>
  <span class="hljs-keyword">const</span> staticMenuItems = [<span class="hljs-string">"Home"</span>, <span class="hljs-string">"About"</span>, <span class="hljs-string">"Contact"</span>]; <span class="hljs-comment">// Never changes</span>

  <span class="hljs-comment">// 4. ✅ GOOD: Generated stable IDs</span>
  <span class="hljs-keyword">const</span> [dynamicItems, setDynamicItems] = useState([
    { <span class="hljs-attr">tempId</span>: generateId(), <span class="hljs-attr">text</span>: <span class="hljs-string">"Item 1"</span> },
    { <span class="hljs-attr">tempId</span>: generateId(), <span class="hljs-attr">text</span>: <span class="hljs-string">"Item 2"</span> },
  ]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ✅ Using stable IDs */}
      <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Users (Stable IDs)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        {usersWithIds.map((user) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>
            {user.name} - {user.email}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>

      {/* ✅ Using composite keys */}
      <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>User Posts (Composite Keys)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        {userPosts.map((post) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{</span>`${<span class="hljs-attr">post.userId</span>}<span class="hljs-attr">-</span>${<span class="hljs-attr">post.postId</span>}`}&gt;</span>
            User {post.userId}: {post.title}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>

      {/* ⚠️ Index acceptable for static lists */}
      <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Static Menu (Index OK)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        {staticMenuItems.map((item, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>&gt;</span>{item}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>

      {/* ✅ Generated stable IDs */}
      <span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Dynamic Items (Generated IDs)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        {dynamicItems.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.tempId}</span>&gt;</span>
            {item.text}
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeItem(item.tempId)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Helper function to generate stable IDs</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">generateId</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random().toString(<span class="hljs-number">36</span>).substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;
}
</div></code></pre>
<h3 id="key-anti-patterns-and-solutions">Key Anti-Patterns and Solutions</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">KeyAntiPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([
    { <span class="hljs-attr">text</span>: <span class="hljs-string">"Learn React"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">text</span>: <span class="hljs-string">"Build a project"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">text</span>: <span class="hljs-string">"Get a job"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
  ]);

  <span class="hljs-comment">// ❌ WRONG: Random keys (breaks reconciliation)</span>
  <span class="hljs-keyword">const</span> renderWithRandomKeys = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{Math.random()}</span>&gt;</span>
        {" "}
        {/* DON'T DO THIS! */}
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ));
  };

  <span class="hljs-comment">// ❌ WRONG: Using array index when list can be reordered</span>
  <span class="hljs-keyword">const</span> renderWithIndexKeys = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> todos.map(<span class="hljs-function">(<span class="hljs-params">todo, index</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>&gt;</span>
        {" "}
        {/* PROBLEMATIC for dynamic lists */}
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ));
  };

  <span class="hljs-comment">// ❌ WRONG: Non-unique keys</span>
  <span class="hljs-keyword">const</span> renderWithNonUniqueKeys = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.completed}</span>&gt;</span>
        {" "}
        {/* NOT UNIQUE! */}
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ));
  };

  <span class="hljs-comment">// ✅ CORRECT: Add stable IDs to data</span>
  <span class="hljs-keyword">const</span> [todosWithIds, setTodosWithIds] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Learn React"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Build a project"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Get a job"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
  ]);

  <span class="hljs-keyword">const</span> renderCorrectly = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> todosWithIds.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>
        {" "}
        {/* CORRECT! */}
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ));
  };

  <span class="hljs-comment">// ✅ ALTERNATIVE: Use content-based keys when appropriate</span>
  <span class="hljs-keyword">const</span> renderWithContentKeys = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Only if todo text is guaranteed to be unique and stable</span>
    <span class="hljs-keyword">return</span> todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.text}</span>&gt;</span>
        {" "}
        {/* OK if text is unique */}
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Todo List<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {renderCorrectly()}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoItem</span>(<span class="hljs-params">{ todo }</span>) </span>{
  <span class="hljs-keyword">const</span> [isEditing, setIsEditing] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [editText, setEditText] = useState(todo.text);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-item"</span>&gt;</span>
      {isEditing ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{editText}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setEditText(e.target.value)}
          onBlur={() =&gt; setIsEditing(false)}
          autoFocus
        /&gt;
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsEditing(true)}&gt;{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      )}

      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
        <span class="hljs-attr">checked</span>=<span class="hljs-string">{todo.completed}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> {
          /* toggle todo */
        }}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%A9-reactfragment-and-multiple-elements">🧩 React.Fragment and Multiple Elements</h2>
<h3 id="using-reactfragment">Using React.Fragment</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> React, { Fragment } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FragmentExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> items = [<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"orange"</span>];

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ❌ PROBLEM: Extra wrapper div */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"wrapper"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Fruits<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Here are some fruits:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* ✅ SOLUTION 1: React.Fragment */}
      <span class="hljs-tag">&lt;<span class="hljs-name">React.Fragment</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Fruits<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Here are some fruits:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">React.Fragment</span>&gt;</span>

      {/* ✅ SOLUTION 2: Fragment shorthand */}
      <span class="hljs-tag">&lt;&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Fruits<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Here are some fruits:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/&gt;</span></span>

      {<span class="hljs-comment">/* ✅ SOLUTION 3: Fragment with key (when needed in lists) */</span>}
      {items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Fragment</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{item}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Description of {item}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Fragment</span>&gt;</span></span>
      ))}

      {<span class="hljs-comment">/* ✅ SOLUTION 4: Array of elements (less common) */</span>}
      {[
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">key</span>=<span class="hljs-string">"title"</span>&gt;</span>Fruits<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span>,
        &lt;p key=<span class="hljs-string">"description"</span>&gt;Here are some fruits:&lt;<span class="hljs-regexp">/p&gt;,
      ]}
    &lt;/</span>div&gt;
  );
}

<span class="hljs-comment">// Real-world Fragment usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TableRowFragment</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-comment">// Fragment allows returning multiple &lt;td&gt; elements</span>
  <span class="hljs-comment">// without wrapping them in a &lt;div&gt; (which would break table structure)</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{user.role}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Edit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserTable</span>(<span class="hljs-params">{ users }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Email<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Role<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Actions<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
        {users.map((user) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">TableRowFragment</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A1-performance-considerations">⚡ Performance Considerations</h2>
<h3 id="optimizing-list-rendering">Optimizing List Rendering</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { memo, useMemo, useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-comment">// ✅ Memoized list item to prevent unnecessary re-renders</span>
<span class="hljs-keyword">const</span> ListItem = memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ListItem</span>(<span class="hljs-params">{ item, onUpdate, onDelete }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Rendering item: <span class="hljs-subst">${item.name}</span>`</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"list-item"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>${item.price}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onUpdate(item.id)}&gt;Update<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onDelete(item.id)}&gt;Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Laptop"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">999</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Mouse"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">25</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Keyboard"</span>, <span class="hljs-attr">price</span>: <span class="hljs-number">75</span> },
  ]);
  <span class="hljs-keyword">const</span> [filter, setFilter] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// ✅ Memoize filtered items to avoid recalculation</span>
  <span class="hljs-keyword">const</span> filteredItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Filtering items..."</span>);
    <span class="hljs-keyword">return</span> items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
      item.name.toLowerCase().includes(filter.toLowerCase())
    );
  }, [items, filter]);

  <span class="hljs-comment">// ✅ Memoize callbacks to prevent child re-renders</span>
  <span class="hljs-keyword">const</span> handleUpdate = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.id === id ? { ...item, <span class="hljs-attr">price</span>: item.price * <span class="hljs-number">1.1</span> } : item
      )
    );
  }, []);

  <span class="hljs-keyword">const</span> handleDelete = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span> prevItems.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id));
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{filter}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFilter(e.target.value)}
        placeholder="Filter items..."
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item-list"</span>&gt;</span>
        {filteredItems.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">ListItem</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
            <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
            <span class="hljs-attr">onUpdate</span>=<span class="hljs-string">{handleUpdate}</span>
            <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{handleDelete}</span>
          /&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
        Showing {filteredItems.length} of {items.length} items
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="virtual-scrolling-for-large-lists">Virtual Scrolling for Large Lists</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// For very large lists (1000+ items), consider virtual scrolling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">VirtualScrollExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
    <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, (_, i) =&gt; ({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>,
    }))
  );

  <span class="hljs-comment">// This is a simplified example - use libraries like react-window or react-virtualized</span>
  <span class="hljs-keyword">const</span> [visibleRange, setVisibleRange] = useState({ <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">end</span>: <span class="hljs-number">50</span> });
  <span class="hljs-keyword">const</span> itemHeight = <span class="hljs-number">50</span>;
  <span class="hljs-keyword">const</span> containerHeight = <span class="hljs-number">400</span>;

  <span class="hljs-keyword">const</span> visibleItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.slice(visibleRange.start, visibleRange.end);
  }, [items, visibleRange]);

  <span class="hljs-keyword">const</span> handleScroll = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> scrollTop = e.target.scrollTop;
    <span class="hljs-keyword">const</span> start = <span class="hljs-built_in">Math</span>.floor(scrollTop / itemHeight);
    <span class="hljs-keyword">const</span> end = <span class="hljs-built_in">Math</span>.min(
      start + <span class="hljs-built_in">Math</span>.ceil(containerHeight / itemHeight) + <span class="hljs-number">5</span>,
      items.length
    );

    setVisibleRange({ start, end });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">"virtual-scroll-container"</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">containerHeight</span>, <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>" }}
      <span class="hljs-attr">onScroll</span>=<span class="hljs-string">{handleScroll}</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">items.length</span> * <span class="hljs-attr">itemHeight</span>, <span class="hljs-attr">position:</span> "<span class="hljs-attr">relative</span>" }}&gt;</span>
        {visibleItems.map((item, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
              <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
              <span class="hljs-attr">top:</span> (<span class="hljs-attr">visibleRange.start</span> + <span class="hljs-attr">index</span>) * <span class="hljs-attr">itemHeight</span>,
              <span class="hljs-attr">height:</span> <span class="hljs-attr">itemHeight</span>,
              <span class="hljs-attr">width:</span> "<span class="hljs-attr">100</span>%",
            }}
          &gt;</span>
            {item.name} - {item.value.toFixed(2)}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-index-as-key-in-dynamic-lists">1. Index as Key in Dynamic Lists</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Index as key with dynamic operations</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BrokenTodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([
    <span class="hljs-string">"Learn React"</span>,
    <span class="hljs-string">"Build a project"</span>,
    <span class="hljs-string">"Get a job"</span>,
  ]);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTodos([<span class="hljs-string">"New todo"</span>, ...todos]); <span class="hljs-comment">// Adding to beginning</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addTodo}</span>&gt;</span>Add Todo<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      {todos.map((todo, index) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoInput</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">initialValue</span>=<span class="hljs-string">{todo}</span> /&gt;</span> // BROKEN!
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoInput</span>(<span class="hljs-params">{ initialValue }</span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(initialValue);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setValue(e.target.value)} /&gt;</span>;
}

<span class="hljs-comment">// ✅ CORRECT: Stable keys</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FixedTodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Learn React"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Build a project"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Get a job"</span> },
  ]);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newTodo = { <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(), <span class="hljs-attr">text</span>: <span class="hljs-string">"New todo"</span> };
    setTodos([newTodo, ...todos]);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addTodo}</span>&gt;</span>Add Todo<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      {todos.map((todo) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoInput</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span> <span class="hljs-attr">initialValue</span>=<span class="hljs-string">{todo.text}</span> /&gt;</span> // FIXED!
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-conditional-rendering-gotchas">2. Conditional Rendering Gotchas</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Falsy values rendering unexpectedly</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConditionalGotchas</span>(<span class="hljs-params">{ items, count }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ❌ Renders "0" when count is 0 */}
      {count &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {/* ❌ Renders "0" when items array is empty */}
      {items.length &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Items: {items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {/* ❌ Can render "NaN" or unexpected values */}
      {items.length &amp;&amp; items.length &gt; 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Average: {items.reduce((a, b) =&gt; a + b, 0) / items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Explicit boolean conversion</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConditionalFixed</span>(<span class="hljs-params">{ items, count }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ✅ Explicit boolean conversion */}
      {count &gt; 0 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {/* ✅ Explicit length check */}
      {items.length &gt; 0 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Items: {items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      {/* ✅ Safe calculation with proper checks */}
      {items.length &gt; 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          Average:{" "}
          {(items.reduce((a, b) =&gt; a + b, 0) / items.length).toFixed(2)}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-dynamic-table-with-sorting">Challenge 1: Dynamic Table with Sorting</h3>
<p>Build a sortable table component with:</p>
<ul>
<li>Click column headers to sort</li>
<li>Visual indicators for sort direction</li>
<li>Multiple data types (string, number, date)</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your solution:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SortableTable</span>(<span class="hljs-params">{ data, columns }</span>) </span>{
  <span class="hljs-comment">// Implement sorting logic</span>
}

<span class="hljs-comment">// Test data:</span>
<span class="hljs-keyword">const</span> userData = [
  {
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
    <span class="hljs-attr">joinDate</span>: <span class="hljs-string">"2023-01-15"</span>,
  },
  {
    <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane"</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"jane@example.com"</span>,
    <span class="hljs-attr">joinDate</span>: <span class="hljs-string">"2023-03-20"</span>,
  },
  {
    <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">35</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"bob@example.com"</span>,
    <span class="hljs-attr">joinDate</span>: <span class="hljs-string">"2023-02-10"</span>,
  },
];

<span class="hljs-keyword">const</span> columns = [
  { <span class="hljs-attr">key</span>: <span class="hljs-string">"name"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Name"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> },
  { <span class="hljs-attr">key</span>: <span class="hljs-string">"age"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Age"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"number"</span> },
  { <span class="hljs-attr">key</span>: <span class="hljs-string">"email"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Email"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"string"</span> },
  { <span class="hljs-attr">key</span>: <span class="hljs-string">"joinDate"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Join Date"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"date"</span> },
];
</div></code></pre>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SortableTable</span>(<span class="hljs-params">{ data, columns }</span>) </span>{
  <span class="hljs-keyword">const</span> [sortConfig, setSortConfig] = useState({ <span class="hljs-attr">key</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">direction</span>: <span class="hljs-string">"asc"</span> });

  <span class="hljs-keyword">const</span> sortedData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!sortConfig.key) <span class="hljs-keyword">return</span> data;

    <span class="hljs-keyword">return</span> [...data].sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> aValue = a[sortConfig.key];
      <span class="hljs-keyword">const</span> bValue = b[sortConfig.key];

      <span class="hljs-comment">// Find column type</span>
      <span class="hljs-keyword">const</span> column = columns.find(<span class="hljs-function">(<span class="hljs-params">col</span>) =&gt;</span> col.key === sortConfig.key);
      <span class="hljs-keyword">const</span> type = column?.type || <span class="hljs-string">"string"</span>;

      <span class="hljs-keyword">let</span> comparison = <span class="hljs-number">0</span>;

      <span class="hljs-keyword">switch</span> (type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"number"</span>:
          comparison = aValue - bValue;
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"date"</span>:
          comparison = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(aValue) - <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(bValue);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"string"</span>:
        <span class="hljs-keyword">default</span>:
          comparison = aValue.localeCompare(bValue);
          <span class="hljs-keyword">break</span>;
      }

      <span class="hljs-keyword">return</span> sortConfig.direction === <span class="hljs-string">"desc"</span> ? -comparison : comparison;
    });
  }, [data, sortConfig, columns]);

  <span class="hljs-keyword">const</span> handleSort = <span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
    setSortConfig(<span class="hljs-function">(<span class="hljs-params">prevConfig</span>) =&gt;</span> ({
      key,
      <span class="hljs-attr">direction</span>:
        prevConfig.key === key &amp;&amp; prevConfig.direction === <span class="hljs-string">"asc"</span>
          ? <span class="hljs-string">"desc"</span>
          : <span class="hljs-string">"asc"</span>,
    }));
  };

  <span class="hljs-keyword">const</span> getSortIcon = <span class="hljs-function">(<span class="hljs-params">columnKey</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (sortConfig.key !== columnKey) <span class="hljs-keyword">return</span> <span class="hljs-string">"↕️"</span>;
    <span class="hljs-keyword">return</span> sortConfig.direction === <span class="hljs-string">"asc"</span> ? <span class="hljs-string">"↑"</span> : <span class="hljs-string">"↓"</span>;
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"sortable-table"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
          {columns.map((column) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>
              <span class="hljs-attr">key</span>=<span class="hljs-string">{column.key}</span>
              <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleSort(column.key)}
              className="sortable-header"
            &gt;
              {column.label} {getSortIcon(column.key)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
        {sortedData.map((row) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{row.id}</span>&gt;</span>
            {columns.map((column) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{column.key}</span>&gt;</span>{row[column.key]}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-nested-comment-system">Challenge 2: Nested Comment System</h3>
<p>Create a nested comment component with:</p>
<ul>
<li>Recursive rendering of replies</li>
<li>Expand/collapse functionality</li>
<li>Add reply functionality</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CommentSystem</span>(<span class="hljs-params">{ comments }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"comment-system"</span>&gt;</span>
      {comments.map((comment) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Comment</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{comment.id}</span> <span class="hljs-attr">comment</span>=<span class="hljs-string">{comment}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Comment</span>(<span class="hljs-params">{ comment, depth = <span class="hljs-number">0</span> }</span>) </span>{
  <span class="hljs-keyword">const</span> [isExpanded, setIsExpanded] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [showReplyForm, setShowReplyForm] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [replies, setReplies] = useState(comment.replies || []);

  <span class="hljs-keyword">const</span> addReply = <span class="hljs-function">(<span class="hljs-params">replyText</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newReply = {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
      <span class="hljs-attr">author</span>: <span class="hljs-string">"Current User"</span>,
      <span class="hljs-attr">text</span>: replyText,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      <span class="hljs-attr">replies</span>: [],
    };

    setReplies(<span class="hljs-function">(<span class="hljs-params">prevReplies</span>) =&gt;</span> [...prevReplies, newReply]);
    setShowReplyForm(<span class="hljs-literal">false</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"comment"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginLeft:</span> `${<span class="hljs-attr">depth</span> * <span class="hljs-attr">20</span>}<span class="hljs-attr">px</span>` }}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"comment-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>{comment.author}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"timestamp"</span>&gt;</span>{comment.timestamp}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        {replies.length &gt; 0 &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsExpanded(!isExpanded)}
            className="toggle-replies"
          &gt;
            {isExpanded ? "▼" : "▶"} {replies.length} replies
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"comment-text"</span>&gt;</span>{comment.text}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"comment-actions"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowReplyForm(!showReplyForm)}&gt;Reply<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {showReplyForm &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ReplyForm</span>
          <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{addReply}</span>
          <span class="hljs-attr">onCancel</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowReplyForm(false)}
        /&gt;
      )}

      {isExpanded &amp;&amp; replies.length &gt; 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"replies"</span>&gt;</span>
          {replies.map((reply) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">Comment</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{reply.id}</span> <span class="hljs-attr">comment</span>=<span class="hljs-string">{reply}</span> <span class="hljs-attr">depth</span>=<span class="hljs-string">{depth</span> + <span class="hljs-attr">1</span>} /&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ReplyForm</span>(<span class="hljs-params">{ onSubmit, onCancel }</span>) </span>{
  <span class="hljs-keyword">const</span> [text, setText] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    e.preventDefault();
    <span class="hljs-keyword">if</span> (text.trim()) {
      onSubmit(text.trim());
      setText(<span class="hljs-string">""</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"reply-form"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{text}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setText(e.target.value)}
        placeholder="Write a reply..."
        rows={3}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-actions"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{!text.trim()}</span>&gt;</span>
          Post Reply
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onCancel}</span>&gt;</span>
          Cancel
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="what-interviewers-look-for">What Interviewers Look For</h3>
<ol>
<li>
<p><strong>Key Understanding</strong>: &quot;Why are keys important in React?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: Keys help React identify which items have changed, been added, or removed. They're crucial for efficient reconciliation and maintaining component state correctly.</li>
</ul>
</li>
<li>
<p><strong>Conditional Rendering</strong>: &quot;What's wrong with <code>{count &amp;&amp; &lt;div&gt;{count}&lt;/div&gt;}</code>?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: If count is 0, it will render &quot;0&quot; instead of nothing. Should use <code>{count &gt; 0 &amp;&amp; &lt;div&gt;{count}&lt;/div&gt;}</code></li>
</ul>
</li>
<li>
<p><strong>Performance</strong>: &quot;How would you optimize a large list?&quot;</p>
<ul>
<li><strong>Good Answer</strong>: Use React.memo for list items, useMemo for filtering/sorting, useCallback for event handlers, consider virtual scrolling for very large lists.</li>
</ul>
</li>
</ol>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Q: What will this render when items is an empty array?</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Question1</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{items.length &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Items: {items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
<span class="hljs-comment">// Answer: It will render "0" because items.length is 0 (falsy)</span>

<span class="hljs-comment">// Q: What's the problem with this key usage?</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Question2</span>(<span class="hljs-params">{ todos }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {todos.map((todo, index) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
<span class="hljs-comment">// Answer: Index as key can cause issues when list is reordered or items are added/removed</span>

<span class="hljs-comment">// Q: How would you render this list efficiently?</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Question3</span>(<span class="hljs-params">{ largeList }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {largeList.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveComponent</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
<span class="hljs-comment">// Answer: Memoize ExpensiveComponent with React.memo, use virtual scrolling for very large lists</span>
</div></code></pre>
<h3 id="pro-interview-tips">Pro Interview Tips</h3>
<ol>
<li><strong>Always mention keys</strong> when discussing list rendering</li>
<li><strong>Explain reconciliation</strong> - show you understand how React works under the hood</li>
<li><strong>Discuss performance</strong> implications of different patterns</li>
<li><strong>Show awareness of edge cases</strong> (falsy values, empty arrays, etc.)</li>
<li><strong>Demonstrate optimization knowledge</strong> (memo, useMemo, virtual scrolling)</li>
</ol>
<h2 id="%F0%9F%9A%80-next-steps">🚀 Next Steps</h2>
<p>Now that you've mastered rendering patterns, you're ready for:</p>
<ul>
<li><strong>Handling DOM Events</strong> - User interactions and event handling</li>
<li><strong>Controlled vs Uncontrolled Inputs</strong> - Form handling patterns</li>
<li><strong>useEffect</strong> - Side effects and lifecycle management</li>
</ul>
<hr>
<blockquote>
<p><strong>Key Takeaway</strong>: Master conditional rendering, list rendering with proper keys, and React's reconciliation process. Keys are crucial for performance and correctness - always use stable, unique identifiers when possible!</p>
</blockquote>
<h1 id="%F0%9F%8E%AF-handling-dom-events-user-interactions-mastery">🎯 Handling DOM Events: User Interactions Mastery</h1>
<blockquote>
<p><strong>Master React's event system: SyntheticEvents, event handling patterns, and building interactive user interfaces</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>React's SyntheticEvent system and how it differs from native events</li>
<li>Event handling patterns and best practices</li>
<li>Event delegation and performance considerations</li>
<li>Form events and input handling</li>
<li>Mouse, keyboard, and touch events</li>
<li>Event propagation, bubbling, and capturing</li>
<li>Custom event handlers and event composition</li>
<li>Common event handling mistakes and solutions</li>
</ul>
<h2 id="%E2%9A%A1-reacts-syntheticevent-system">⚡ React's SyntheticEvent System</h2>
<h3 id="understanding-syntheticevents">Understanding SyntheticEvents</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// React wraps native DOM events in SyntheticEvent objects</span>
<span class="hljs-comment">// This provides cross-browser compatibility and consistent behavior</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SyntheticEventDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Event type:"</span>, event.type); <span class="hljs-comment">// 'click'</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Is SyntheticEvent:"</span>, event.nativeEvent !== <span class="hljs-literal">undefined</span>); <span class="hljs-comment">// true</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Target element:"</span>, event.target); <span class="hljs-comment">// The clicked element</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Current target:"</span>, event.currentTarget); <span class="hljs-comment">// The element with the event handler</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Native event:"</span>, event.nativeEvent); <span class="hljs-comment">// Original DOM event</span>

    <span class="hljs-comment">// SyntheticEvent properties (cross-browser compatible)</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Timestamp:"</span>, event.timeStamp);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Bubbles:"</span>, event.bubbles);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Cancelable:"</span>, event.cancelable);

    <span class="hljs-comment">// Prevent default behavior</span>
    event.preventDefault();

    <span class="hljs-comment">// Stop event propagation</span>
    event.stopPropagation();
  };

  <span class="hljs-keyword">const</span> handleMouseEvent = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-comment">// Mouse-specific properties</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Mouse position:"</span>, { <span class="hljs-attr">x</span>: event.clientX, <span class="hljs-attr">y</span>: event.clientY });
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button pressed:"</span>, event.button); <span class="hljs-comment">// 0: left, 1: middle, 2: right</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Modifier keys:"</span>, {
      <span class="hljs-attr">ctrl</span>: event.ctrlKey,
      <span class="hljs-attr">shift</span>: event.shiftKey,
      <span class="hljs-attr">alt</span>: event.altKey,
      <span class="hljs-attr">meta</span>: event.metaKey, <span class="hljs-comment">// Cmd on Mac, Windows key on PC</span>
    });
  };

  <span class="hljs-keyword">const</span> handleKeyEvent = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-comment">// Keyboard-specific properties</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Key pressed:"</span>, event.key); <span class="hljs-comment">// 'a', 'Enter', 'ArrowUp', etc.</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Key code:"</span>, event.keyCode); <span class="hljs-comment">// Deprecated but still used</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Which:"</span>, event.which); <span class="hljs-comment">// Deprecated</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Code:"</span>, event.code); <span class="hljs-comment">// 'KeyA', 'Enter', 'ArrowUp', etc.</span>

    <span class="hljs-comment">// Modern way to check for specific keys</span>
    <span class="hljs-keyword">if</span> (event.key === <span class="hljs-string">"Enter"</span>) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Enter key pressed!"</span>);
    }

    <span class="hljs-keyword">if</span> (event.key === <span class="hljs-string">"Escape"</span>) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Escape key pressed!"</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Click me (check console)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">onMouseMove</span>=<span class="hljs-string">{handleMouseEvent}</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">width:</span> <span class="hljs-attr">200</span>,
          <span class="hljs-attr">height:</span> <span class="hljs-attr">100</span>,
          <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>",
          <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span> <span class="hljs-attr">0</span>",
        }}
      &gt;</span>
        Move mouse here
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">onKeyDown</span>=<span class="hljs-string">{handleKeyEvent}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Type here and check console"</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="event-handler-patterns">Event Handler Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventHandlerPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [message, setMessage] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// 1. ✅ Inline arrow function (good for simple handlers)</span>
  <span class="hljs-keyword">const</span> inlineHandler = (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );

  <span class="hljs-comment">// 2. ✅ Function declaration (good for complex logic)</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleComplexClick</span>(<span class="hljs-params">event</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Complex click handler"</span>);
    setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>);
    setMessage(<span class="hljs-string">`Button clicked at <span class="hljs-subst">${<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString()}</span>`</span>);
  }

  <span class="hljs-comment">// 3. ✅ Arrow function with useCallback (for performance)</span>
  <span class="hljs-keyword">const</span> handleOptimizedClick = useCallback(<span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>);
  }, []); <span class="hljs-comment">// Empty dependency array since we use functional update</span>

  <span class="hljs-comment">// 4. ✅ Parameterized event handlers</span>
  <span class="hljs-keyword">const</span> handleParameterizedClick = <span class="hljs-function">(<span class="hljs-params">increment</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + increment);
  };

  <span class="hljs-comment">// 5. ✅ Event handler with additional parameters</span>
  <span class="hljs-keyword">const</span> handleClickWithParams = <span class="hljs-function">(<span class="hljs-params">id, action</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Performing <span class="hljs-subst">${action}</span> on item <span class="hljs-subst">${id}</span>`</span>);
    <span class="hljs-comment">// Handle the action</span>
  };

  <span class="hljs-comment">// 6. ❌ WRONG: Calling function immediately</span>
  <span class="hljs-keyword">const</span> wrongHandler = (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleComplexClick()}</span>&gt;</span>
      {" "}
      {/* DON'T DO THIS! */}
      Wrong way
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Event Handler Patterns<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Pattern 1: Inline */}
      {inlineHandler}

      {/* Pattern 2: Function reference */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleComplexClick}</span>&gt;</span>Complex Handler<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* Pattern 3: Optimized with useCallback */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleOptimizedClick}</span>&gt;</span>Optimized Handler<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* Pattern 4: Parameterized */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleParameterizedClick(5)}</span>&gt;</span>Add 5<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleParameterizedClick(-1)}</span>&gt;</span>Subtract 1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* Pattern 5: With additional parameters */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClickWithParams(</span>"<span class="hljs-attr">user123</span>", "<span class="hljs-attr">delete</span>")}&gt;</span>
        Delete User
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Message: {message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%96%B1%EF%B8%8F-mouse-events">🖱️ Mouse Events</h2>
<h3 id="comprehensive-mouse-event-handling">Comprehensive Mouse Event Handling</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MouseEventHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [mouseState, setMouseState] = useState({
    <span class="hljs-attr">position</span>: { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> },
    <span class="hljs-attr">isDown</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">button</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">clickCount</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">dragStart</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">false</span>,
  });

  <span class="hljs-keyword">const</span> [hoverState, setHoverState] = useState({
    <span class="hljs-attr">isHovered</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">hoverTime</span>: <span class="hljs-number">0</span>,
  });

  <span class="hljs-comment">// Mouse movement tracking</span>
  <span class="hljs-keyword">const</span> handleMouseMove = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setMouseState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">position</span>: {
        <span class="hljs-attr">x</span>: event.clientX,
        <span class="hljs-attr">y</span>: event.clientY,
      },
    }));

    <span class="hljs-comment">// If dragging, update drag position</span>
    <span class="hljs-keyword">if</span> (mouseState.isDragging &amp;&amp; mouseState.dragStart) {
      <span class="hljs-keyword">const</span> deltaX = event.clientX - mouseState.dragStart.x;
      <span class="hljs-keyword">const</span> deltaY = event.clientY - mouseState.dragStart.y;
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Drag delta:"</span>, { deltaX, deltaY });
    }
  };

  <span class="hljs-comment">// Mouse button events</span>
  <span class="hljs-keyword">const</span> handleMouseDown = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setMouseState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">isDown</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">button</span>: event.button,
      <span class="hljs-attr">dragStart</span>: {
        <span class="hljs-attr">x</span>: event.clientX,
        <span class="hljs-attr">y</span>: event.clientY,
      },
      <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">true</span>,
    }));

    <span class="hljs-comment">// Prevent text selection during drag</span>
    event.preventDefault();
  };

  <span class="hljs-keyword">const</span> handleMouseUp = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setMouseState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">isDown</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">button</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">dragStart</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">false</span>,
    }));
  };

  <span class="hljs-comment">// Click events</span>
  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setMouseState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">clickCount</span>: prev.clickCount + <span class="hljs-number">1</span>,
    }));

    <span class="hljs-comment">// Different actions based on button</span>
    <span class="hljs-keyword">switch</span> (event.button) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: <span class="hljs-comment">// Left click</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Left click"</span>);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: <span class="hljs-comment">// Middle click</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Middle click"</span>);
        event.preventDefault(); <span class="hljs-comment">// Prevent default middle-click behavior</span>
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: <span class="hljs-comment">// Right click</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Right click"</span>);
        <span class="hljs-keyword">break</span>;
    }
  };

  <span class="hljs-keyword">const</span> handleDoubleClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Double click detected"</span>);
    setMouseState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">clickCount</span>: prev.clickCount + <span class="hljs-number">1</span>,
    }));
  };

  <span class="hljs-comment">// Context menu (right-click menu)</span>
  <span class="hljs-keyword">const</span> handleContextMenu = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault(); <span class="hljs-comment">// Prevent default context menu</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Custom context menu would appear here"</span>);
  };

  <span class="hljs-comment">// Hover events</span>
  <span class="hljs-keyword">const</span> handleMouseEnter = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setHoverState({
      <span class="hljs-attr">isHovered</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">hoverTime</span>: <span class="hljs-built_in">Date</span>.now(),
    });
  };

  <span class="hljs-keyword">const</span> handleMouseLeave = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> hoverDuration = <span class="hljs-built_in">Date</span>.now() - hoverState.hoverTime;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hovered for <span class="hljs-subst">${hoverDuration}</span>ms`</span>);

    setHoverState({
      <span class="hljs-attr">isHovered</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">hoverTime</span>: <span class="hljs-number">0</span>,
    });
  };

  <span class="hljs-comment">// Mouse wheel events</span>
  <span class="hljs-keyword">const</span> handleWheel = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Wheel delta:"</span>, {
      <span class="hljs-attr">deltaX</span>: event.deltaX,
      <span class="hljs-attr">deltaY</span>: event.deltaY,
      <span class="hljs-attr">deltaZ</span>: event.deltaZ,
    });

    <span class="hljs-comment">// Prevent page scroll if needed</span>
    <span class="hljs-comment">// event.preventDefault();</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mouse-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Mouse Event Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Mouse tracking area */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">"mouse-area"</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">width:</span> <span class="hljs-attr">400</span>,
          <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span>,
          <span class="hljs-attr">border:</span> "<span class="hljs-attr">2px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">333</span>",
          <span class="hljs-attr">position:</span> "<span class="hljs-attr">relative</span>",
          <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">hoverState.isHovered</span> ? "#<span class="hljs-attr">f0f0f0</span>" <span class="hljs-attr">:</span> "#<span class="hljs-attr">fff</span>",
          <span class="hljs-attr">cursor:</span> <span class="hljs-attr">mouseState.isDragging</span> ? "<span class="hljs-attr">grabbing</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">grab</span>",
        }}
        <span class="hljs-attr">onMouseMove</span>=<span class="hljs-string">{handleMouseMove}</span>
        <span class="hljs-attr">onMouseDown</span>=<span class="hljs-string">{handleMouseDown}</span>
        <span class="hljs-attr">onMouseUp</span>=<span class="hljs-string">{handleMouseUp}</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>
        <span class="hljs-attr">onDoubleClick</span>=<span class="hljs-string">{handleDoubleClick}</span>
        <span class="hljs-attr">onContextMenu</span>=<span class="hljs-string">{handleContextMenu}</span>
        <span class="hljs-attr">onMouseEnter</span>=<span class="hljs-string">{handleMouseEnter}</span>
        <span class="hljs-attr">onMouseLeave</span>=<span class="hljs-string">{handleMouseLeave}</span>
        <span class="hljs-attr">onWheel</span>=<span class="hljs-string">{handleWheel}</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"instructions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Try different mouse interactions:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Move mouse to track position<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Click (left, middle, right)<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Double-click<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Right-click for context menu<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Drag to see drag detection<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Scroll wheel<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Mouse position indicator */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
            <span class="hljs-attr">left:</span> <span class="hljs-attr">mouseState.position.x</span> <span class="hljs-attr">-</span> <span class="hljs-attr">5</span>,
            <span class="hljs-attr">top:</span> <span class="hljs-attr">mouseState.position.y</span> <span class="hljs-attr">-</span> <span class="hljs-attr">5</span>,
            <span class="hljs-attr">width:</span> <span class="hljs-attr">10</span>,
            <span class="hljs-attr">height:</span> <span class="hljs-attr">10</span>,
            <span class="hljs-attr">backgroundColor:</span> "<span class="hljs-attr">red</span>",
            <span class="hljs-attr">borderRadius:</span> "<span class="hljs-attr">50</span>%",
            <span class="hljs-attr">pointerEvents:</span> "<span class="hljs-attr">none</span>",
          }}
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Mouse state display */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mouse-state"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Mouse State:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Position: ({mouseState.position.x}, {mouseState.position.y})
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Mouse Down: {mouseState.isDown ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Button: {mouseState.button !== null ? mouseState.button : "None"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Click Count: {mouseState.clickCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dragging: {mouseState.isDragging ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hovered: {hoverState.isHovered ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%8C%A8%EF%B8%8F-keyboard-events">⌨️ Keyboard Events</h2>
<h3 id="advanced-keyboard-event-handling">Advanced Keyboard Event Handling</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">KeyboardEventHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [keyState, setKeyState] = useState({
    <span class="hljs-attr">lastKey</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">keysPressed</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(),
    <span class="hljs-attr">keySequence</span>: [],
    <span class="hljs-attr">shortcuts</span>: [],
  });

  <span class="hljs-keyword">const</span> [textInput, setTextInput] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [isComposing, setIsComposing] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// Key down event</span>
  <span class="hljs-keyword">const</span> handleKeyDown = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> key = event.key;

    setKeyState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">lastKey</span>: key,
      <span class="hljs-attr">keysPressed</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...prev.keysPressed, key]),
      <span class="hljs-attr">keySequence</span>: [...prev.keySequence, key].slice(<span class="hljs-number">-10</span>), <span class="hljs-comment">// Keep last 10 keys</span>
    }));

    <span class="hljs-comment">// Handle special key combinations</span>
    <span class="hljs-keyword">if</span> (event.ctrlKey &amp;&amp; event.key === <span class="hljs-string">"s"</span>) {
      event.preventDefault();
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Save shortcut triggered"</span>);
      setKeyState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
        ...prev,
        <span class="hljs-attr">shortcuts</span>: [...prev.shortcuts, <span class="hljs-string">"Ctrl+S"</span>],
      }));
    }

    <span class="hljs-keyword">if</span> (event.ctrlKey &amp;&amp; event.key === <span class="hljs-string">"z"</span>) {
      event.preventDefault();
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Undo shortcut triggered"</span>);
      setKeyState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
        ...prev,
        <span class="hljs-attr">shortcuts</span>: [...prev.shortcuts, <span class="hljs-string">"Ctrl+Z"</span>],
      }));
    }

    <span class="hljs-comment">// Handle arrow keys</span>
    <span class="hljs-keyword">if</span> ([<span class="hljs-string">"ArrowUp"</span>, <span class="hljs-string">"ArrowDown"</span>, <span class="hljs-string">"ArrowLeft"</span>, <span class="hljs-string">"ArrowRight"</span>].includes(key)) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Arrow key pressed: <span class="hljs-subst">${key}</span>`</span>);
      <span class="hljs-comment">// Prevent default scrolling if needed</span>
      <span class="hljs-comment">// event.preventDefault();</span>
    }

    <span class="hljs-comment">// Handle escape key</span>
    <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"Escape"</span>) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Escape pressed - could close modal, clear input, etc."</span>);
      setTextInput(<span class="hljs-string">""</span>);
    }

    <span class="hljs-comment">// Handle enter key</span>
    <span class="hljs-keyword">if</span> (key === <span class="hljs-string">"Enter"</span>) {
      <span class="hljs-keyword">if</span> (event.shiftKey) {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Shift+Enter: New line"</span>);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Enter: Submit form"</span>);
        event.preventDefault();
      }
    }
  };

  <span class="hljs-comment">// Key up event</span>
  <span class="hljs-keyword">const</span> handleKeyUp = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setKeyState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> newKeysPressed = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(prev.keysPressed);
      newKeysPressed.delete(event.key);
      <span class="hljs-keyword">return</span> {
        ...prev,
        <span class="hljs-attr">keysPressed</span>: newKeysPressed,
      };
    });
  };

  <span class="hljs-comment">// Input composition events (for IME support)</span>
  <span class="hljs-keyword">const</span> handleCompositionStart = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setIsComposing(<span class="hljs-literal">true</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Composition started (IME input)"</span>);
  };

  <span class="hljs-keyword">const</span> handleCompositionEnd = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setIsComposing(<span class="hljs-literal">false</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Composition ended:"</span>, event.data);
  };

  <span class="hljs-comment">// Global keyboard shortcuts</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleGlobalKeyDown = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-comment">// Global shortcuts that work anywhere on the page</span>
      <span class="hljs-keyword">if</span> (event.ctrlKey &amp;&amp; event.shiftKey &amp;&amp; event.key === <span class="hljs-string">"K"</span>) {
        event.preventDefault();
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Global shortcut: Ctrl+Shift+K"</span>);
      }
    };

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleGlobalKeyDown);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleGlobalKeyDown);
    };
  }, []);

  <span class="hljs-comment">// Custom hook for keyboard shortcuts</span>
  <span class="hljs-keyword">const</span> useKeyboardShortcut = <span class="hljs-function">(<span class="hljs-params">keys, callback</span>) =&gt;</span> {
    useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> handleKeyDown = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> pressedKeys = [];
        <span class="hljs-keyword">if</span> (event.ctrlKey) pressedKeys.push(<span class="hljs-string">"ctrl"</span>);
        <span class="hljs-keyword">if</span> (event.shiftKey) pressedKeys.push(<span class="hljs-string">"shift"</span>);
        <span class="hljs-keyword">if</span> (event.altKey) pressedKeys.push(<span class="hljs-string">"alt"</span>);
        <span class="hljs-keyword">if</span> (event.metaKey) pressedKeys.push(<span class="hljs-string">"meta"</span>);
        pressedKeys.push(event.key.toLowerCase());

        <span class="hljs-keyword">const</span> shortcut = pressedKeys.join(<span class="hljs-string">"+"</span>);
        <span class="hljs-keyword">if</span> (keys.includes(shortcut)) {
          event.preventDefault();
          callback(event);
        }
      };

      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);
    }, [keys, callback]);
  };

  <span class="hljs-comment">// Use the custom hook</span>
  useKeyboardShortcut([<span class="hljs-string">"ctrl+k"</span>], () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Quick search triggered"</span>);
  });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"keyboard-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Keyboard Event Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"input-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{textInput}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setTextInput(e.target.value)}
          onKeyDown={handleKeyDown}
          onKeyUp={handleKeyUp}
          onCompositionStart={handleCompositionStart}
          onCompositionEnd={handleCompositionEnd}
          placeholder="Type here to test keyboard events..."
          rows={4}
          cols={50}
        /&gt;

        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Composing: {isComposing ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"keyboard-state"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Keyboard State:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Last Key: {keyState.lastKey}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Keys Currently Pressed: {Array.from(keyState.keysPressed).join(", ")}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Key Sequence: {keyState.keySequence.join(" → ")}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Shortcuts Used: {keyState.shortcuts.join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"shortcuts-help"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Try These Shortcuts:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Ctrl+S - Save<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Ctrl+Z - Undo<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Ctrl+K - Quick search<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Ctrl+Shift+K - Global shortcut<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Escape - Clear input<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Enter - Submit<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Shift+Enter - New line<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%93%9D-form-events">📝 Form Events</h2>
<h3 id="comprehensive-form-event-handling">Comprehensive Form Event Handling</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormEventHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [formData, setFormData] = useState({
    <span class="hljs-attr">username</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">confirmPassword</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">country</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">interests</span>: [],
    <span class="hljs-attr">newsletter</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">bio</span>: <span class="hljs-string">""</span>,
  });

  <span class="hljs-keyword">const</span> [formState, setFormState] = useState({
    <span class="hljs-attr">isDirty</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">isValid</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">errors</span>: {},
    <span class="hljs-attr">touchedFields</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(),
    <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
  });

  <span class="hljs-comment">// Input change handler</span>
  <span class="hljs-keyword">const</span> handleInputChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name, value, type, checked } = event.target;

    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      [name]: type === <span class="hljs-string">"checkbox"</span> ? checked : value,
    }));

    setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">isDirty</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">touchedFields</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...prev.touchedFields, name]),
    }));

    <span class="hljs-comment">// Real-time validation</span>
    validateField(name, type === <span class="hljs-string">"checkbox"</span> ? checked : value);
  };

  <span class="hljs-comment">// Multi-select handler</span>
  <span class="hljs-keyword">const</span> handleMultiSelectChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name, value } = event.target;

    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> currentValues = prev[name] || [];
      <span class="hljs-keyword">const</span> newValues = currentValues.includes(value)
        ? currentValues.filter(<span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> v !== value)
        : [...currentValues, value];

      <span class="hljs-keyword">return</span> {
        ...prev,
        [name]: newValues,
      };
    });
  };

  <span class="hljs-comment">// Field validation</span>
  <span class="hljs-keyword">const</span> validateField = <span class="hljs-function">(<span class="hljs-params">fieldName, value</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> errors = { ...formState.errors };

    <span class="hljs-keyword">switch</span> (fieldName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"username"</span>:
        <span class="hljs-keyword">if</span> (!value.trim()) {
          errors.username = <span class="hljs-string">"Username is required"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value.length &lt; <span class="hljs-number">3</span>) {
          errors.username = <span class="hljs-string">"Username must be at least 3 characters"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.username;
        }
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"email"</span>:
        <span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;
        <span class="hljs-keyword">if</span> (!value.trim()) {
          errors.email = <span class="hljs-string">"Email is required"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!emailRegex.test(value)) {
          errors.email = <span class="hljs-string">"Please enter a valid email"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.email;
        }
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"password"</span>:
        <span class="hljs-keyword">if</span> (!value) {
          errors.password = <span class="hljs-string">"Password is required"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value.length &lt; <span class="hljs-number">8</span>) {
          errors.password = <span class="hljs-string">"Password must be at least 8 characters"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.password;
        }
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"confirmPassword"</span>:
        <span class="hljs-keyword">if</span> (value !== formData.password) {
          errors.confirmPassword = <span class="hljs-string">"Passwords do not match"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.confirmPassword;
        }
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"age"</span>:
        <span class="hljs-keyword">const</span> ageNum = <span class="hljs-built_in">parseInt</span>(value);
        <span class="hljs-keyword">if</span> (!value) {
          errors.age = <span class="hljs-string">"Age is required"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(ageNum) || ageNum &lt; <span class="hljs-number">13</span> || ageNum &gt; <span class="hljs-number">120</span>) {
          errors.age = <span class="hljs-string">"Please enter a valid age (13-120)"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.age;
        }
        <span class="hljs-keyword">break</span>;
    }

    setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      errors,
      <span class="hljs-attr">isValid</span>: <span class="hljs-built_in">Object</span>.keys(errors).length === <span class="hljs-number">0</span>,
    }));
  };

  <span class="hljs-comment">// Focus and blur events</span>
  <span class="hljs-keyword">const</span> handleFocus = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name } = event.target;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Field focused: <span class="hljs-subst">${name}</span>`</span>);

    <span class="hljs-comment">// Could show help text, highlight field, etc.</span>
  };

  <span class="hljs-keyword">const</span> handleBlur = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name, value } = event.target;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Field blurred: <span class="hljs-subst">${name}</span>`</span>);

    setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">touchedFields</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...prev.touchedFields, name]),
    }));

    <span class="hljs-comment">// Validate on blur</span>
    validateField(name, value);
  };

  <span class="hljs-comment">// Form submission</span>
  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> (event) =&gt; {
    event.preventDefault();

    setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">true</span> }));

    <span class="hljs-comment">// Validate all fields</span>
    <span class="hljs-built_in">Object</span>.keys(formData).forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
      validateField(field, formData[field]);
    });

    <span class="hljs-keyword">if</span> (formState.isValid) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Simulate API call</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, <span class="hljs-number">2000</span>));
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted:"</span>, formData);
        alert(<span class="hljs-string">"Form submitted successfully!"</span>);

        <span class="hljs-comment">// Reset form</span>
        setFormData({
          <span class="hljs-attr">username</span>: <span class="hljs-string">""</span>,
          <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
          <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>,
          <span class="hljs-attr">confirmPassword</span>: <span class="hljs-string">""</span>,
          <span class="hljs-attr">age</span>: <span class="hljs-string">""</span>,
          <span class="hljs-attr">country</span>: <span class="hljs-string">""</span>,
          <span class="hljs-attr">interests</span>: [],
          <span class="hljs-attr">newsletter</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">bio</span>: <span class="hljs-string">""</span>,
        });

        setFormState({
          <span class="hljs-attr">isDirty</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">isValid</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">errors</span>: {},
          <span class="hljs-attr">touchedFields</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(),
          <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
        });
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Submission error:"</span>, error);
        setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span> }));
      }
    } <span class="hljs-keyword">else</span> {
      setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span> }));
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form has errors:"</span>, formState.errors);
    }
  };

  <span class="hljs-comment">// Form reset</span>
  <span class="hljs-keyword">const</span> handleReset = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-comment">// event.preventDefault(); // Uncomment to prevent default reset</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form reset"</span>);

    setFormData({
      <span class="hljs-attr">username</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">confirmPassword</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">age</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">country</span>: <span class="hljs-string">""</span>,
      <span class="hljs-attr">interests</span>: [],
      <span class="hljs-attr">newsletter</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">bio</span>: <span class="hljs-string">""</span>,
    });

    setFormState({
      <span class="hljs-attr">isDirty</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">isValid</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">errors</span>: {},
      <span class="hljs-attr">touchedFields</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(),
      <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Form Event Handling Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span> <span class="hljs-attr">onReset</span>=<span class="hljs-string">{handleReset}</span>&gt;</span>
        {/* Text input */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"username"</span>&gt;</span>Username:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.username}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onFocus</span>=<span class="hljs-string">{handleFocus}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.username</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {formState.errors.username &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{formState.errors.username}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Email input */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"email"</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.email}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onFocus</span>=<span class="hljs-string">{handleFocus}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.email</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {formState.errors.email &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{formState.errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Password input */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.password}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onFocus</span>=<span class="hljs-string">{handleFocus}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.password</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {formState.errors.password &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{formState.errors.password}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Confirm password */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"confirmPassword"</span>&gt;</span>Confirm Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"confirmPassword"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"confirmPassword"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.confirmPassword}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onFocus</span>=<span class="hljs-string">{handleFocus}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.confirmPassword</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {formState.errors.confirmPassword &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
              {formState.errors.confirmPassword}
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Number input */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"age"</span>&gt;</span>Age:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"age"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"age"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.age}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onFocus</span>=<span class="hljs-string">{handleFocus}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
            <span class="hljs-attr">min</span>=<span class="hljs-string">"13"</span>
            <span class="hljs-attr">max</span>=<span class="hljs-string">"120"</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.age</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {formState.errors.age &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{formState.errors.age}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Select dropdown */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"country"</span>&gt;</span>Country:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"country"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"country"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.country}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onFocus</span>=<span class="hljs-string">{handleFocus}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
          &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>Select a country<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"us"</span>&gt;</span>United States<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ca"</span>&gt;</span>Canada<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"uk"</span>&gt;</span>United Kingdom<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"de"</span>&gt;</span>Germany<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"fr"</span>&gt;</span>France<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Checkboxes */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Interests:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          {["Technology", "Sports", "Music", "Travel", "Cooking"].map(
            (interest) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{interest}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"checkbox-label"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                  <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
                  <span class="hljs-attr">name</span>=<span class="hljs-string">"interests"</span>
                  <span class="hljs-attr">value</span>=<span class="hljs-string">{interest}</span>
                  <span class="hljs-attr">checked</span>=<span class="hljs-string">{formData.interests.includes(interest)}</span>
                  <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleMultiSelectChange}</span>
                /&gt;</span>
                {interest}
              <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            )
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Single checkbox */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"checkbox-label"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
              <span class="hljs-attr">name</span>=<span class="hljs-string">"newsletter"</span>
              <span class="hljs-attr">checked</span>=<span class="hljs-string">{formData.newsletter}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            /&gt;</span>
            Subscribe to newsletter
          <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Textarea */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"bio"</span>&gt;</span>Bio:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"bio"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"bio"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.bio}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onFocus</span>=<span class="hljs-string">{handleFocus}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
            <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span>
            <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Tell us about yourself..."</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Form actions */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-actions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>
            <span class="hljs-attr">disabled</span>=<span class="hljs-string">{!formState.isValid</span> || <span class="hljs-attr">formState.isSubmitting</span>}
          &gt;</span>
            {formState.isSubmitting ? "Submitting..." : "Submit"}
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"reset"</span>&gt;</span>Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

      {/* Form state display */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-state"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Form State:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dirty: {formState.isDirty ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Valid: {formState.isValid ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Submitting: {formState.isSubmitting ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Touched Fields: {Array.from(formState.touchedFields).join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Errors: {Object.keys(formState.errors).length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8C%8A-event-propagation-and-delegation">🌊 Event Propagation and Delegation</h2>
<h3 id="understanding-event-flow">Understanding Event Flow</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventPropagationDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [eventLog, setEventLog] = useState([]);

  <span class="hljs-keyword">const</span> logEvent = <span class="hljs-function">(<span class="hljs-params">phase, element, event</span>) =&gt;</span> {
    setEventLog(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [
      ...prev,
      {
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now() + <span class="hljs-built_in">Math</span>.random(),
        phase,
        element,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString(),
      },
    ]);
  };

  <span class="hljs-keyword">const</span> clearLog = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setEventLog([]);

  <span class="hljs-comment">// Event handlers for different phases</span>
  <span class="hljs-keyword">const</span> handleGrandparentCapture = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    logEvent(<span class="hljs-string">"Capture"</span>, <span class="hljs-string">"Grandparent"</span>, event);
  };

  <span class="hljs-keyword">const</span> handleGrandparentBubble = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    logEvent(<span class="hljs-string">"Bubble"</span>, <span class="hljs-string">"Grandparent"</span>, event);
  };

  <span class="hljs-keyword">const</span> handleParentCapture = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    logEvent(<span class="hljs-string">"Capture"</span>, <span class="hljs-string">"Parent"</span>, event);
  };

  <span class="hljs-keyword">const</span> handleParentBubble = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    logEvent(<span class="hljs-string">"Bubble"</span>, <span class="hljs-string">"Parent"</span>, event);
  };

  <span class="hljs-keyword">const</span> handleChildClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    logEvent(<span class="hljs-string">"Target"</span>, <span class="hljs-string">"Child"</span>, event);

    <span class="hljs-comment">// Uncomment to stop propagation</span>
    <span class="hljs-comment">// event.stopPropagation();</span>
  };

  <span class="hljs-keyword">const</span> handleChildStopPropagation = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    logEvent(<span class="hljs-string">"Target"</span>, <span class="hljs-string">"Child (Stop Propagation)"</span>, event);
    event.stopPropagation(); <span class="hljs-comment">// Stops bubbling</span>
  };

  <span class="hljs-keyword">const</span> handleChildPreventDefault = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    logEvent(<span class="hljs-string">"Target"</span>, <span class="hljs-string">"Child (Prevent Default)"</span>, event);
    event.preventDefault(); <span class="hljs-comment">// Prevents default behavior</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"propagation-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Event Propagation Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearLog}</span>&gt;</span>Clear Log<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Event propagation example */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">"grandparent"</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>",
          <span class="hljs-attr">border:</span> "<span class="hljs-attr">3px</span> <span class="hljs-attr">solid</span> <span class="hljs-attr">red</span>",
          <span class="hljs-attr">backgroundColor:</span> "#<span class="hljs-attr">ffe6e6</span>",
        }}
        <span class="hljs-attr">onClickCapture</span>=<span class="hljs-string">{handleGrandparentCapture}</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleGrandparentBubble}</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Grandparent (Red)<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"parent"</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>",
            <span class="hljs-attr">border:</span> "<span class="hljs-attr">3px</span> <span class="hljs-attr">solid</span> <span class="hljs-attr">blue</span>",
            <span class="hljs-attr">backgroundColor:</span> "#<span class="hljs-attr">e6f3ff</span>",
            <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span>",
          }}
          <span class="hljs-attr">onClickCapture</span>=<span class="hljs-string">{handleParentCapture}</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleParentBubble}</span>
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Parent (Blue)<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">margin:</span> "<span class="hljs-attr">10px</span>" }}&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">"child"</span>
              <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
                <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>",
                <span class="hljs-attr">border:</span> "<span class="hljs-attr">3px</span> <span class="hljs-attr">solid</span> <span class="hljs-attr">green</span>",
                <span class="hljs-attr">backgroundColor:</span> "#<span class="hljs-attr">e6ffe6</span>",
                <span class="hljs-attr">margin:</span> "<span class="hljs-attr">5px</span>",
              }}
              <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleChildClick}</span>
            &gt;</span>
              Child (Normal)
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">"child"</span>
              <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
                <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>",
                <span class="hljs-attr">border:</span> "<span class="hljs-attr">3px</span> <span class="hljs-attr">solid</span> <span class="hljs-attr">green</span>",
                <span class="hljs-attr">backgroundColor:</span> "#<span class="hljs-attr">e6ffe6</span>",
                <span class="hljs-attr">margin:</span> "<span class="hljs-attr">5px</span>",
              }}
              <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleChildStopPropagation}</span>
            &gt;</span>
              Child (Stop Propagation)
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">a</span>
              <span class="hljs-attr">href</span>=<span class="hljs-string">"#"</span>
              <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
                <span class="hljs-attr">display:</span> "<span class="hljs-attr">inline-block</span>",
                <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>",
                <span class="hljs-attr">border:</span> "<span class="hljs-attr">3px</span> <span class="hljs-attr">solid</span> <span class="hljs-attr">green</span>",
                <span class="hljs-attr">backgroundColor:</span> "#<span class="hljs-attr">e6ffe6</span>",
                <span class="hljs-attr">margin:</span> "<span class="hljs-attr">5px</span>",
                <span class="hljs-attr">textDecoration:</span> "<span class="hljs-attr">none</span>",
              }}
              <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleChildPreventDefault}</span>
            &gt;</span>
              Link (Prevent Default)
            <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Event log */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"event-log"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Event Log (Order of Execution):<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">maxHeight:</span> "<span class="hljs-attr">200px</span>", <span class="hljs-attr">overflowY:</span> "<span class="hljs-attr">auto</span>" }}&gt;</span>
          {eventLog.map((log) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{log.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"log-entry"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"timestamp"</span>&gt;</span>{log.timestamp}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"phase"</span>&gt;</span>{log.phase}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"element"</span>&gt;</span>{log.element}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"explanation"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Event Flow Explanation:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Capture Phase:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Event travels from root to target
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Target Phase:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Event reaches the target element
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Bubble Phase:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Event bubbles back up to root
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Click different buttons to see how stopPropagation() and
          preventDefault() affect the flow.
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="event-delegation-pattern">Event Delegation Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventDelegationDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Item 1"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"task"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Item 2"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"note"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Item 3"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"task"</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Item 4"</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">"note"</span> },
  ]);

  <span class="hljs-comment">// ❌ INEFFICIENT: Individual event handlers for each item</span>
  <span class="hljs-keyword">const</span> renderWithIndividualHandlers = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> editItem(item.id)}&gt;Edit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> deleteItem(item.id)}&gt;Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> duplicateItem(item.id)}&gt;Duplicate<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ));
  };

  <span class="hljs-comment">// ✅ EFFICIENT: Event delegation with single handler</span>
  <span class="hljs-keyword">const</span> handleItemAction = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> action = event.target.dataset.action;
    <span class="hljs-keyword">const</span> itemId = <span class="hljs-built_in">parseInt</span>(event.target.dataset.itemId);

    <span class="hljs-keyword">if</span> (!action || !itemId) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">switch</span> (action) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"edit"</span>:
        editItem(itemId);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"delete"</span>:
        deleteItem(itemId);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"duplicate"</span>:
        duplicateItem(itemId);
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"toggle"</span>:
        toggleItem(itemId);
        <span class="hljs-keyword">break</span>;
    }
  };

  <span class="hljs-keyword">const</span> renderWithDelegation = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"items-container"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleItemAction}</span>&gt;</span>
        {items.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
              <span class="hljs-attr">data-action</span>=<span class="hljs-string">"toggle"</span>
              <span class="hljs-attr">data-item-id</span>=<span class="hljs-string">{item.id}</span>
            /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
              {item.name} ({item.type})
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">data-action</span>=<span class="hljs-string">"edit"</span> <span class="hljs-attr">data-item-id</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
              Edit
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">data-action</span>=<span class="hljs-string">"delete"</span> <span class="hljs-attr">data-item-id</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
              Delete
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">data-action</span>=<span class="hljs-string">"duplicate"</span> <span class="hljs-attr">data-item-id</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
              Duplicate
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  };

  <span class="hljs-comment">// Action handlers</span>
  <span class="hljs-keyword">const</span> editItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Editing item <span class="hljs-subst">${id}</span>`</span>);
    <span class="hljs-keyword">const</span> newName = prompt(<span class="hljs-string">"Enter new name:"</span>);
    <span class="hljs-keyword">if</span> (newName) {
      setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
        prev.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> (item.id === id ? { ...item, <span class="hljs-attr">name</span>: newName } : item))
      );
    }
  };

  <span class="hljs-keyword">const</span> deleteItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Deleting item <span class="hljs-subst">${id}</span>`</span>);
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id));
  };

  <span class="hljs-keyword">const</span> duplicateItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Duplicating item <span class="hljs-subst">${id}</span>`</span>);
    <span class="hljs-keyword">const</span> item = items.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === id);
    <span class="hljs-keyword">if</span> (item) {
      <span class="hljs-keyword">const</span> newItem = {
        ...item,
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Math</span>.max(...items.map(<span class="hljs-function">(<span class="hljs-params">i</span>) =&gt;</span> i.id)) + <span class="hljs-number">1</span>,
        <span class="hljs-attr">name</span>: <span class="hljs-string">`<span class="hljs-subst">${item.name}</span> (Copy)`</span>,
      };
      setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, newItem]);
    }
  };

  <span class="hljs-keyword">const</span> toggleItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Toggling item <span class="hljs-subst">${id}</span>`</span>);
    <span class="hljs-comment">// Toggle logic here</span>
  };

  <span class="hljs-keyword">const</span> addItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newItem = {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Math</span>.max(...items.map(<span class="hljs-function">(<span class="hljs-params">i</span>) =&gt;</span> i.id)) + <span class="hljs-number">1</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${items.length + <span class="hljs-number">1</span>}</span>`</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">Math</span>.random() &gt; <span class="hljs-number">0.5</span> ? <span class="hljs-string">"task"</span> : <span class="hljs-string">"note"</span>,
    };
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, newItem]);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"delegation-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Event Delegation Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addItem}</span>&gt;</span>Add Item<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>✅ With Event Delegation (Efficient):<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      {renderWithDelegation()}

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-note"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Performance Benefits:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Single event listener instead of multiple<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Better memory usage<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Automatically handles dynamically added elements<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Easier to manage and maintain<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%93%B1-touch-events">📱 Touch Events</h2>
<h3 id="mobile-touch-event-handling">Mobile Touch Event Handling</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TouchEventHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [touchState, setTouchState] = useState({
    <span class="hljs-attr">touches</span>: [],
    <span class="hljs-attr">gesture</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">swipeDirection</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">pinchScale</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">rotation</span>: <span class="hljs-number">0</span>,
  });

  <span class="hljs-keyword">const</span> [dragState, setDragState] = useState({
    <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">startPosition</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">currentPosition</span>: <span class="hljs-literal">null</span>,
  });

  <span class="hljs-comment">// Touch start</span>
  <span class="hljs-keyword">const</span> handleTouchStart = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> touches = <span class="hljs-built_in">Array</span>.from(event.touches).map(<span class="hljs-function">(<span class="hljs-params">touch</span>) =&gt;</span> ({
      <span class="hljs-attr">id</span>: touch.identifier,
      <span class="hljs-attr">x</span>: touch.clientX,
      <span class="hljs-attr">y</span>: touch.clientY,
    }));

    setTouchState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      touches,
    }));

    <span class="hljs-keyword">if</span> (touches.length === <span class="hljs-number">1</span>) {
      setDragState({
        <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">startPosition</span>: { <span class="hljs-attr">x</span>: touches[<span class="hljs-number">0</span>].x, <span class="hljs-attr">y</span>: touches[<span class="hljs-number">0</span>].y },
        <span class="hljs-attr">currentPosition</span>: { <span class="hljs-attr">x</span>: touches[<span class="hljs-number">0</span>].x, <span class="hljs-attr">y</span>: touches[<span class="hljs-number">0</span>].y },
      });
    }

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Touch start: <span class="hljs-subst">${touches.length}</span> touches`</span>);
  };

  <span class="hljs-comment">// Touch move</span>
  <span class="hljs-keyword">const</span> handleTouchMove = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault(); <span class="hljs-comment">// Prevent scrolling</span>

    <span class="hljs-keyword">const</span> touches = <span class="hljs-built_in">Array</span>.from(event.touches).map(<span class="hljs-function">(<span class="hljs-params">touch</span>) =&gt;</span> ({
      <span class="hljs-attr">id</span>: touch.identifier,
      <span class="hljs-attr">x</span>: touch.clientX,
      <span class="hljs-attr">y</span>: touch.clientY,
    }));

    setTouchState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      touches,
    }));

    <span class="hljs-comment">// Single finger drag</span>
    <span class="hljs-keyword">if</span> (touches.length === <span class="hljs-number">1</span> &amp;&amp; dragState.isDragging) {
      setDragState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
        ...prev,
        <span class="hljs-attr">currentPosition</span>: { <span class="hljs-attr">x</span>: touches[<span class="hljs-number">0</span>].x, <span class="hljs-attr">y</span>: touches[<span class="hljs-number">0</span>].y },
      }));
    }

    <span class="hljs-comment">// Two finger gestures (pinch/zoom)</span>
    <span class="hljs-keyword">if</span> (touches.length === <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">const</span> [touch1, touch2] = touches;
      <span class="hljs-keyword">const</span> distance = <span class="hljs-built_in">Math</span>.sqrt(
        <span class="hljs-built_in">Math</span>.pow(touch2.x - touch1.x, <span class="hljs-number">2</span>) + <span class="hljs-built_in">Math</span>.pow(touch2.y - touch1.y, <span class="hljs-number">2</span>)
      );

      <span class="hljs-comment">// Calculate rotation</span>
      <span class="hljs-keyword">const</span> angle =
        (<span class="hljs-built_in">Math</span>.atan2(touch2.y - touch1.y, touch2.x - touch1.x) * <span class="hljs-number">180</span>) / <span class="hljs-built_in">Math</span>.PI;

      setTouchState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
        ...prev,
        <span class="hljs-attr">gesture</span>: <span class="hljs-string">"pinch"</span>,
        <span class="hljs-attr">pinchScale</span>: distance / <span class="hljs-number">100</span>, <span class="hljs-comment">// Normalize</span>
        <span class="hljs-attr">rotation</span>: angle,
      }));
    }
  };

  <span class="hljs-comment">// Touch end</span>
  <span class="hljs-keyword">const</span> handleTouchEnd = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> remainingTouches = <span class="hljs-built_in">Array</span>.from(event.touches).map(<span class="hljs-function">(<span class="hljs-params">touch</span>) =&gt;</span> ({
      <span class="hljs-attr">id</span>: touch.identifier,
      <span class="hljs-attr">x</span>: touch.clientX,
      <span class="hljs-attr">y</span>: touch.clientY,
    }));

    <span class="hljs-comment">// Detect swipe gesture</span>
    <span class="hljs-keyword">if</span> (
      dragState.isDragging &amp;&amp;
      dragState.startPosition &amp;&amp;
      dragState.currentPosition
    ) {
      <span class="hljs-keyword">const</span> deltaX = dragState.currentPosition.x - dragState.startPosition.x;
      <span class="hljs-keyword">const</span> deltaY = dragState.currentPosition.y - dragState.startPosition.y;
      <span class="hljs-keyword">const</span> distance = <span class="hljs-built_in">Math</span>.sqrt(deltaX * deltaX + deltaY * deltaY);

      <span class="hljs-keyword">if</span> (distance &gt; <span class="hljs-number">50</span>) {
        <span class="hljs-comment">// Minimum swipe distance</span>
        <span class="hljs-keyword">let</span> direction;
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.abs(deltaX) &gt; <span class="hljs-built_in">Math</span>.abs(deltaY)) {
          direction = deltaX &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">"right"</span> : <span class="hljs-string">"left"</span>;
        } <span class="hljs-keyword">else</span> {
          direction = deltaY &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">"down"</span> : <span class="hljs-string">"up"</span>;
        }

        setTouchState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
          ...prev,
          <span class="hljs-attr">swipeDirection</span>: direction,
        }));

        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Swipe detected: <span class="hljs-subst">${direction}</span>`</span>);

        <span class="hljs-comment">// Clear swipe direction after a delay</span>
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          setTouchState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
            ...prev,
            <span class="hljs-attr">swipeDirection</span>: <span class="hljs-literal">null</span>,
          }));
        }, <span class="hljs-number">1000</span>);
      }
    }

    setTouchState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">touches</span>: remainingTouches,
      <span class="hljs-attr">gesture</span>: remainingTouches.length &gt; <span class="hljs-number">1</span> ? prev.gesture : <span class="hljs-literal">null</span>,
    }));

    <span class="hljs-keyword">if</span> (remainingTouches.length === <span class="hljs-number">0</span>) {
      setDragState({
        <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">startPosition</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">currentPosition</span>: <span class="hljs-literal">null</span>,
      });
    }

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Touch end: <span class="hljs-subst">${remainingTouches.length}</span> touches remaining`</span>);
  };

  <span class="hljs-comment">// Touch cancel (when touch is interrupted)</span>
  <span class="hljs-keyword">const</span> handleTouchCancel = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Touch cancelled"</span>);
    setTouchState({
      <span class="hljs-attr">touches</span>: [],
      <span class="hljs-attr">gesture</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">swipeDirection</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">pinchScale</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">rotation</span>: <span class="hljs-number">0</span>,
    });

    setDragState({
      <span class="hljs-attr">isDragging</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">startPosition</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">currentPosition</span>: <span class="hljs-literal">null</span>,
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"touch-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Touch Event Handling Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">"touch-area"</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">width:</span> <span class="hljs-attr">300</span>,
          <span class="hljs-attr">height:</span> <span class="hljs-attr">200</span>,
          <span class="hljs-attr">border:</span> "<span class="hljs-attr">2px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">333</span>",
          <span class="hljs-attr">backgroundColor:</span> "#<span class="hljs-attr">f0f0f0</span>",
          <span class="hljs-attr">position:</span> "<span class="hljs-attr">relative</span>",
          <span class="hljs-attr">touchAction:</span> "<span class="hljs-attr">none</span>", // <span class="hljs-attr">Disable</span> <span class="hljs-attr">default</span> <span class="hljs-attr">touch</span> <span class="hljs-attr">behaviors</span>
          <span class="hljs-attr">transform:</span> `<span class="hljs-attr">scale</span>(${<span class="hljs-attr">touchState.pinchScale</span>}) <span class="hljs-attr">rotate</span>(${<span class="hljs-attr">touchState.rotation</span>}<span class="hljs-attr">deg</span>)`,
          <span class="hljs-attr">transition:</span> <span class="hljs-attr">touchState.gesture</span> ? "<span class="hljs-attr">none</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">transform</span> <span class="hljs-attr">0.2s</span>",
        }}
        <span class="hljs-attr">onTouchStart</span>=<span class="hljs-string">{handleTouchStart}</span>
        <span class="hljs-attr">onTouchMove</span>=<span class="hljs-string">{handleTouchMove}</span>
        <span class="hljs-attr">onTouchEnd</span>=<span class="hljs-string">{handleTouchEnd}</span>
        <span class="hljs-attr">onTouchCancel</span>=<span class="hljs-string">{handleTouchCancel}</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"instructions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Touch Area<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Try:<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Single finger drag<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Swipe gestures<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Two finger pinch/zoom<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Two finger rotation<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Visualize touch points */}
        {touchState.touches.map((touch) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{touch.id}</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
              <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
              <span class="hljs-attr">left:</span> <span class="hljs-attr">touch.x</span> <span class="hljs-attr">-</span> <span class="hljs-attr">10</span>,
              <span class="hljs-attr">top:</span> <span class="hljs-attr">touch.y</span> <span class="hljs-attr">-</span> <span class="hljs-attr">10</span>,
              <span class="hljs-attr">width:</span> <span class="hljs-attr">20</span>,
              <span class="hljs-attr">height:</span> <span class="hljs-attr">20</span>,
              <span class="hljs-attr">backgroundColor:</span> "<span class="hljs-attr">red</span>",
              <span class="hljs-attr">borderRadius:</span> "<span class="hljs-attr">50</span>%",
              <span class="hljs-attr">pointerEvents:</span> "<span class="hljs-attr">none</span>",
            }}
          /&gt;</span>
        ))}

        {/* Show swipe direction */}
        {touchState.swipeDirection &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
              <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
              <span class="hljs-attr">top:</span> "<span class="hljs-attr">50</span>%",
              <span class="hljs-attr">left:</span> "<span class="hljs-attr">50</span>%",
              <span class="hljs-attr">transform:</span> "<span class="hljs-attr">translate</span>(<span class="hljs-attr">-50</span>%, <span class="hljs-attr">-50</span>%)",
              <span class="hljs-attr">fontSize:</span> "<span class="hljs-attr">24px</span>",
              <span class="hljs-attr">fontWeight:</span> "<span class="hljs-attr">bold</span>",
              <span class="hljs-attr">color:</span> "<span class="hljs-attr">blue</span>",
            }}
          &gt;</span>
            Swipe: {touchState.swipeDirection.toUpperCase()}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Touch state display */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"touch-state"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Touch State:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Active Touches: {touchState.touches.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Gesture: {touchState.gesture || "None"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Swipe Direction: {touchState.swipeDirection || "None"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Pinch Scale: {touchState.pinchScale.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Rotation: {touchState.rotation.toFixed(1)}°<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dragging: {dragState.isDragging ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"touch-tips"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Touch Event Tips:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            Use <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>touchAction: 'none'<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span> to disable default behaviors
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            Always call <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>preventDefault()<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span> in touchmove to prevent
            scrolling
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            Handle <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>touchcancel<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span> for interrupted touches
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Use touch identifiers to track individual fingers<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Consider gesture libraries for complex interactions<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-event-handler-performance-issues">1. Event Handler Performance Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Creating new functions on every render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PerformanceIssues</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {items.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
          {/* New function created on every render! */}
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> console.log(item.id)}&gt;Click<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

          {/* Inline object creation */}
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> <span class="hljs-attr">item.active</span> ? "<span class="hljs-attr">green</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">red</span>" }}&gt;</span>
            {item.name}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Optimized event handlers</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedEventHandlers</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-comment">// Memoized handler</span>
  <span class="hljs-keyword">const</span> handleItemClick = useCallback(<span class="hljs-function">(<span class="hljs-params">itemId</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(itemId);
  }, []);

  <span class="hljs-comment">// Memoized style objects</span>
  <span class="hljs-keyword">const</span> activeStyle = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ <span class="hljs-attr">color</span>: <span class="hljs-string">"green"</span> }), []);
  <span class="hljs-keyword">const</span> inactiveStyle = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ <span class="hljs-attr">color</span>: <span class="hljs-string">"red"</span> }), []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {items.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ItemComponent</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
          <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleItemClick}</span>
          <span class="hljs-attr">activeStyle</span>=<span class="hljs-string">{activeStyle}</span>
          <span class="hljs-attr">inactiveStyle</span>=<span class="hljs-string">{inactiveStyle}</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> ItemComponent = memo(<span class="hljs-function">(<span class="hljs-params">{ item, onClick, activeStyle, inactiveStyle }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    onClick(item.id);
  }, [item.id, onClick]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Click<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{item.active</span> ? <span class="hljs-attr">activeStyle</span> <span class="hljs-attr">:</span> <span class="hljs-attr">inactiveStyle</span>}&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});
</div></code></pre>
<h3 id="2-event-object-persistence">2. Event Object Persistence</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Accessing event after async operation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventPersistenceIssue</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-comment">// This will cause an error!</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(event.target.value); <span class="hljs-comment">// Error: event is pooled</span>
    }, <span class="hljs-number">1000</span>);
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ CORRECT: Persist event data</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventPersistenceFixed</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-comment">// Extract needed data immediately</span>
    <span class="hljs-keyword">const</span> targetValue = event.target.value;
    <span class="hljs-keyword">const</span> eventType = event.type;

    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(targetValue); <span class="hljs-comment">// Works!</span>
      <span class="hljs-built_in">console</span>.log(eventType); <span class="hljs-comment">// Works!</span>
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-comment">// Alternative: persist the entire event (React 17+)</span>
    <span class="hljs-comment">// event.persist();</span>
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="3-incorrect-event-binding">3. Incorrect Event Binding</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Common binding mistakes</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventBindingMistakes</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ❌ Calling function immediately */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{setCount(count</span> + <span class="hljs-attr">1</span>)}&gt;</span>Wrong<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* ❌ Missing function reference */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">"handleClick()"</span>&gt;</span>Wrong<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* ❌ Incorrect this binding (class components) */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleClick}</span>&gt;</span>Might be wrong<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Proper event binding</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventBindingCorrect</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* ✅ Function reference */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Correct<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* ✅ Inline arrow function */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((prev) =&gt; prev + 1)}&gt;Correct<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* ✅ Functional update */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Correct<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-keyboard-shortcut-manager">Challenge 1: Keyboard Shortcut Manager</h3>
<p>Build a component that:</p>
<ul>
<li>Registers multiple keyboard shortcuts</li>
<li>Shows active shortcuts</li>
<li>Handles conflicts</li>
<li>Allows enabling/disabling shortcuts</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">KeyboardShortcutManager</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [shortcuts, setShortcuts] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">keys</span>: <span class="hljs-string">"ctrl+s"</span>, <span class="hljs-attr">action</span>: <span class="hljs-string">"Save"</span>, <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">keys</span>: <span class="hljs-string">"ctrl+z"</span>, <span class="hljs-attr">action</span>: <span class="hljs-string">"Undo"</span>, <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">keys</span>: <span class="hljs-string">"ctrl+y"</span>, <span class="hljs-attr">action</span>: <span class="hljs-string">"Redo"</span>, <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">keys</span>: <span class="hljs-string">"ctrl+k"</span>, <span class="hljs-attr">action</span>: <span class="hljs-string">"Search"</span>, <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">keys</span>: <span class="hljs-string">"escape"</span>, <span class="hljs-attr">action</span>: <span class="hljs-string">"Cancel"</span>, <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span> },
  ]);

  <span class="hljs-keyword">const</span> [activeKeys, setActiveKeys] = useState(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());
  <span class="hljs-keyword">const</span> [lastTriggered, setLastTriggered] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleKeyDown = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> pressedKeys = [];
      <span class="hljs-keyword">if</span> (event.ctrlKey) pressedKeys.push(<span class="hljs-string">"ctrl"</span>);
      <span class="hljs-keyword">if</span> (event.shiftKey) pressedKeys.push(<span class="hljs-string">"shift"</span>);
      <span class="hljs-keyword">if</span> (event.altKey) pressedKeys.push(<span class="hljs-string">"alt"</span>);
      <span class="hljs-keyword">if</span> (event.metaKey) pressedKeys.push(<span class="hljs-string">"meta"</span>);
      pressedKeys.push(event.key.toLowerCase());

      <span class="hljs-keyword">const</span> keyCombo = pressedKeys.join(<span class="hljs-string">"+"</span>);

      setActiveKeys(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(pressedKeys));

      <span class="hljs-keyword">const</span> matchedShortcut = shortcuts.find(
        <span class="hljs-function">(<span class="hljs-params">shortcut</span>) =&gt;</span> shortcut.enabled &amp;&amp; shortcut.keys === keyCombo
      );

      <span class="hljs-keyword">if</span> (matchedShortcut) {
        event.preventDefault();
        setLastTriggered({
          <span class="hljs-attr">shortcut</span>: matchedShortcut,
          <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString(),
        });
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Triggered: <span class="hljs-subst">${matchedShortcut.action}</span>`</span>);
      }
    };

    <span class="hljs-keyword">const</span> handleKeyUp = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setActiveKeys(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());
    };

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keyup"</span>, handleKeyUp);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keyup"</span>, handleKeyUp);
    };
  }, [shortcuts]);

  <span class="hljs-keyword">const</span> toggleShortcut = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setShortcuts(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">shortcut</span>) =&gt;</span>
        shortcut.id === id
          ? { ...shortcut, <span class="hljs-attr">enabled</span>: !shortcut.enabled }
          : shortcut
      )
    );
  };

  <span class="hljs-keyword">const</span> addShortcut = <span class="hljs-function">(<span class="hljs-params">keys, action</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newShortcut = {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Math</span>.max(...shortcuts.map(<span class="hljs-function">(<span class="hljs-params">s</span>) =&gt;</span> s.id)) + <span class="hljs-number">1</span>,
      keys,
      action,
      <span class="hljs-attr">enabled</span>: <span class="hljs-literal">true</span>,
    };
    setShortcuts(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, newShortcut]);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"shortcut-manager"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Keyboard Shortcut Manager<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"active-keys"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Currently Pressed Keys:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{Array.from(activeKeys).join(" + ") || "None"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {lastTriggered &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"last-triggered"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Last Triggered:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            {lastTriggered.shortcut.action} at {lastTriggered.timestamp}
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"shortcuts-list"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Registered Shortcuts:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        {shortcuts.map((shortcut) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{shortcut.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"shortcut-item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">keys</span> ${<span class="hljs-attr">shortcut.enabled</span> ? "<span class="hljs-attr">enabled</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">disabled</span>"}`}
            &gt;</span>
              {shortcut.keys}
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"action"</span>&gt;</span>{shortcut.action}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleShortcut(shortcut.id)}&gt;
              {shortcut.enabled ? "Disable" : "Enable"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-advanced-form-validation">Challenge 2: Advanced Form Validation</h3>
<p>Create a form with:</p>
<ul>
<li>Real-time validation</li>
<li>Custom validation rules</li>
<li>Field dependencies</li>
<li>Async validation</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdvancedFormValidation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [formData, setFormData] = useState({
    <span class="hljs-attr">username</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">confirmPassword</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">terms</span>: <span class="hljs-literal">false</span>,
  });

  <span class="hljs-keyword">const</span> [validationState, setValidationState] = useState({
    <span class="hljs-attr">errors</span>: {},
    <span class="hljs-attr">isValidating</span>: {},
    <span class="hljs-attr">touchedFields</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(),
  });

  <span class="hljs-comment">// Validation rules</span>
  <span class="hljs-keyword">const</span> validationRules = {
    <span class="hljs-attr">username</span>: [
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value.length &gt;= <span class="hljs-number">3</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Username must be at least 3 characters"</span>,
      },
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/^[a-zA-Z0-9_]+$/</span>.test(value),
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Username can only contain letters, numbers, and underscores"</span>,
      },
    ],
    <span class="hljs-attr">email</span>: [
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.test(value),
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Please enter a valid email"</span>,
      },
    ],
    <span class="hljs-attr">password</span>: [
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value.length &gt;= <span class="hljs-number">8</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Password must be at least 8 characters"</span>,
      },
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/(?=.*[a-z])/</span>.test(value),
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Password must contain lowercase letter"</span>,
      },
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/(?=.*[A-Z])/</span>.test(value),
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Password must contain uppercase letter"</span>,
      },
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-regexp">/(?=.*\d)/</span>.test(value),
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Password must contain number"</span>,
      },
    ],
    <span class="hljs-attr">confirmPassword</span>: [
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value === formData.password,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Passwords do not match"</span>,
      },
    ],
    <span class="hljs-attr">age</span>: [
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-built_in">parseInt</span>(value) &gt;= <span class="hljs-number">13</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Must be at least 13 years old"</span>,
      },
      {
        <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> <span class="hljs-built_in">parseInt</span>(value) &lt;= <span class="hljs-number">120</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Please enter a valid age"</span>,
      },
    ],
    <span class="hljs-attr">terms</span>: [
      { <span class="hljs-attr">rule</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value === <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"You must accept the terms"</span> },
    ],
  };

  <span class="hljs-comment">// Async validation (simulate API call)</span>
  <span class="hljs-keyword">const</span> asyncValidateUsername = <span class="hljs-keyword">async</span> (username) =&gt; {
    <span class="hljs-keyword">if</span> (username.length &lt; <span class="hljs-number">3</span>) <span class="hljs-keyword">return</span>;

    setValidationState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">isValidating</span>: { ...prev.isValidating, <span class="hljs-attr">username</span>: <span class="hljs-literal">true</span> },
    }));

    <span class="hljs-comment">// Simulate API call</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, <span class="hljs-number">1000</span>));

    <span class="hljs-keyword">const</span> isAvailable = ![<span class="hljs-string">"admin"</span>, <span class="hljs-string">"user"</span>, <span class="hljs-string">"test"</span>].includes(
      username.toLowerCase()
    );

    setValidationState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> newErrors = { ...prev.errors };
      <span class="hljs-keyword">if</span> (!isAvailable) {
        newErrors.username = <span class="hljs-string">"Username is already taken"</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">delete</span> newErrors.username;
      }

      <span class="hljs-keyword">return</span> {
        ...prev,
        <span class="hljs-attr">errors</span>: newErrors,
        <span class="hljs-attr">isValidating</span>: { ...prev.isValidating, <span class="hljs-attr">username</span>: <span class="hljs-literal">false</span> },
      };
    });
  };

  <span class="hljs-keyword">const</span> validateField = <span class="hljs-function">(<span class="hljs-params">fieldName, value</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> rules = validationRules[fieldName] || [];
    <span class="hljs-keyword">const</span> errors = { ...validationState.errors };

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> { rule, message } <span class="hljs-keyword">of</span> rules) {
      <span class="hljs-keyword">if</span> (!rule(value)) {
        errors[fieldName] = message;
        <span class="hljs-keyword">break</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">delete</span> errors[fieldName];
      }
    }

    setValidationState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      errors,
    }));

    <span class="hljs-comment">// Async validation for username</span>
    <span class="hljs-keyword">if</span> (fieldName === <span class="hljs-string">"username"</span> &amp;&amp; !errors[fieldName]) {
      asyncValidateUsername(value);
    }
  };

  <span class="hljs-keyword">const</span> handleInputChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name, value, type, checked } = event.target;
    <span class="hljs-keyword">const</span> newValue = type === <span class="hljs-string">"checkbox"</span> ? checked : value;

    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      [name]: newValue,
    }));

    <span class="hljs-comment">// Validate field if it's been touched</span>
    <span class="hljs-keyword">if</span> (validationState.touchedFields.has(name)) {
      validateField(name, newValue);
    }
  };

  <span class="hljs-keyword">const</span> handleBlur = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name, value } = event.target;

    setValidationState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">touchedFields</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...prev.touchedFields, name]),
    }));

    validateField(name, value);
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault();

    <span class="hljs-comment">// Validate all fields</span>
    <span class="hljs-built_in">Object</span>.keys(formData).forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
      validateField(field, formData[field]);
    });

    <span class="hljs-keyword">const</span> hasErrors = <span class="hljs-built_in">Object</span>.keys(validationState.errors).length &gt; <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> isValidating = <span class="hljs-built_in">Object</span>.values(validationState.isValidating).some(
      <span class="hljs-built_in">Boolean</span>
    );

    <span class="hljs-keyword">if</span> (!hasErrors &amp;&amp; !isValidating) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted:"</span>, formData);
      alert(<span class="hljs-string">"Form submitted successfully!"</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"advanced-form"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Advanced Form Validation<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"username"</span>&gt;</span>Username:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.username}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
          <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{validationState.errors.username</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {validationState.isValidating.username &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"validating"</span>&gt;</span>Checking availability...<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
        {validationState.errors.username &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {validationState.errors.username}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"email"</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
          <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{validationState.errors.email</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {validationState.errors.email &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{validationState.errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
          <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{validationState.errors.password</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {validationState.errors.password &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {validationState.errors.password}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"confirmPassword"</span>&gt;</span>Confirm Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"confirmPassword"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"confirmPassword"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.confirmPassword}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
          <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{validationState.errors.confirmPassword</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {validationState.errors.confirmPassword &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {validationState.errors.confirmPassword}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"age"</span>&gt;</span>Age:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"age"</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">"age"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.age}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
          <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{validationState.errors.age</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {validationState.errors.age &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{validationState.errors.age}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"terms"</span>
            <span class="hljs-attr">checked</span>=<span class="hljs-string">{formData.terms}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
          /&gt;</span>
          I accept the terms and conditions
        <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        {validationState.errors.terms &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{validationState.errors.terms}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>
        <span class="hljs-attr">disabled</span>=<span class="hljs-string">{</span>
          <span class="hljs-attr">Object.keys</span>(<span class="hljs-attr">validationState.errors</span>)<span class="hljs-attr">.length</span> &gt;</span> 0 ||
          Object.values(validationState.isValidating).some(Boolean)
        }
      &gt;
        Submit
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%AF-when-and-why-to-use-different-event-patterns">🎯 When and Why to Use Different Event Patterns</h2>
<h3 id="event-handler-patterns-decision-tree">Event Handler Patterns Decision Tree</h3>
<pre class="hljs"><code><div>📊 Choosing the Right Event Handler Pattern:

1. **Simple, one-time actions** → Inline arrow functions
   Example: onClick={() =&gt; setCount(count + 1)}

2. **Complex logic or reusable handlers** → Function declarations
   Example: const handleComplexSubmit = (event) =&gt; { /* complex logic */ }

3. **Performance-critical components** → useCallback + memo
   Example: const optimizedHandler = useCallback(() =&gt; {}, [deps])

4. **Dynamic parameters** → Higher-order functions
   Example: const handleClick = (id) =&gt; (event) =&gt; { /* use id */ }

5. **Many similar elements** → Event delegation
   Example: Single handler on parent with event.target checks

6. **Global shortcuts** → useEffect with document listeners
   Example: Global keyboard shortcuts, escape key handling
</div></code></pre>
<h3 id="performance-considerations">Performance Considerations</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Performance Guidelines</span>

<span class="hljs-comment">// ✅ Good for small lists or simple interactions</span>
<span class="hljs-keyword">const</span> SimpleList = <span class="hljs-function">(<span class="hljs-params">{ items }</span>) =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
    {items.map((item) =&gt; (
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleClick(item.id)}&gt;
        {item.name}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    ))}
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
);

<span class="hljs-comment">// ✅ Better for large lists or complex components</span>
<span class="hljs-keyword">const</span> OptimizedList = <span class="hljs-function">(<span class="hljs-params">{ items }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> itemId = event.target.dataset.itemId;
    <span class="hljs-comment">// Handle click</span>
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>
      {items.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">data-item-id</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
          {item.name}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
};
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<ol>
<li>
<p><strong>&quot;Explain React's SyntheticEvent system&quot;</strong></p>
<ul>
<li>Cross-browser compatibility wrapper</li>
<li>Event pooling (React 16 and earlier)</li>
<li>Access to native event via <code>nativeEvent</code></li>
<li>Consistent API across browsers</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you handle performance with many event handlers?&quot;</strong></p>
<ul>
<li>Event delegation pattern</li>
<li>useCallback for expensive handlers</li>
<li>React.memo for component optimization</li>
<li>Avoid inline functions in render-heavy components</li>
</ul>
</li>
<li>
<p><strong>&quot;What's the difference between onClick and onClickCapture?&quot;</strong></p>
<ul>
<li>onClick: Bubble phase (default)</li>
<li>onClickCapture: Capture phase</li>
<li>Event flow: Capture → Target → Bubble</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you prevent event bubbling?&quot;</strong></p>
<ul>
<li><code>event.stopPropagation()</code> - Stops bubbling</li>
<li><code>event.preventDefault()</code> - Prevents default behavior</li>
<li><code>event.stopImmediatePropagation()</code> - Stops all handlers</li>
</ul>
</li>
<li>
<p><strong>&quot;Explain event delegation and when to use it&quot;</strong></p>
<ul>
<li>Single event listener on parent element</li>
<li>Use <code>event.target</code> to determine actual clicked element</li>
<li>Better performance for large lists</li>
<li>Automatically handles dynamically added elements</li>
</ul>
</li>
</ol>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🚨 Red flags interviewers look for:</span>

<span class="hljs-comment">// 1. Calling functions immediately</span>
&lt;button onClick={handleClick()}&gt; <span class="hljs-comment">// ❌ Wrong</span>

<span class="hljs-comment">// 2. Not handling async operations properly</span>
<span class="hljs-keyword">const</span> handleClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(event.target); <span class="hljs-comment">// ❌ Event is pooled</span>
  }, <span class="hljs-number">1000</span>);
};

<span class="hljs-comment">// 3. Memory leaks with global listeners</span>
useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'click'</span>, handler);
  <span class="hljs-comment">// ❌ Missing cleanup</span>
}, []);

<span class="hljs-comment">// 4. Inefficient re-renders</span>
{items.map(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> (
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> expensive(item)}&gt; // ❌ New function every render
))}

// 5. Not preventing default when needed
const handleSubmit = (event) =&gt; {
  // ❌ Missing event.preventDefault()
  // Form will submit and page will reload
};
</span></div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>SyntheticEvents</strong> provide cross-browser compatibility and consistent behavior</li>
<li><strong>Event delegation</strong> is crucial for performance with large lists</li>
<li><strong>useCallback</strong> and <strong>memo</strong> help optimize event handler performance</li>
<li><strong>Event propagation</strong> understanding is essential for complex UIs</li>
<li><strong>Touch events</strong> require special handling for mobile experiences</li>
<li><strong>Form events</strong> need careful validation and state management</li>
<li><strong>Global event listeners</strong> must be cleaned up to prevent memory leaks</li>
<li><strong>Event persistence</strong> is important for async operations</li>
</ol>
<hr>
<p><strong>Next up</strong>: <a href="06-controlled-vs-uncontrolled-inputs.md">06-controlled-vs-uncontrolled-inputs.md</a> - Master form input patterns and when to use each approach!</p>
<h1 id="%F0%9F%8E%9B%EF%B8%8F-controlled-vs-uncontrolled-inputs-form-mastery">🎛️ Controlled vs Uncontrolled Inputs: Form Mastery</h1>
<blockquote>
<p><strong>Master React's input patterns: When to control state, when to let the DOM handle it, and how to choose the right approach for your forms</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>The fundamental difference between controlled and uncontrolled components</li>
<li>When and why to use each pattern</li>
<li>Form validation strategies for both approaches</li>
<li>Performance implications and optimization techniques</li>
<li>Hybrid approaches and advanced patterns</li>
<li>Real-world form handling scenarios</li>
<li>Common pitfalls and how to avoid them</li>
</ul>
<h2 id="%F0%9F%8E%9B%EF%B8%8F-controlled-components-react-takes-control">🎛️ Controlled Components: React Takes Control</h2>
<h3 id="understanding-controlled-components">Understanding Controlled Components</h3>
<p>In controlled components, React state is the &quot;single source of truth&quot; for form inputs. The input's value is always driven by React state, and changes flow through event handlers.</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ControlledInputBasics</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [textareaValue, setTextareaValue] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [selectValue, setSelectValue] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [checkboxValue, setCheckboxValue] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [radioValue, setRadioValue] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// ✅ Controlled input - value comes from state</span>
  <span class="hljs-keyword">const</span> handleInputChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setInputValue(event.target.value);
  };

  <span class="hljs-keyword">const</span> handleTextareaChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setTextareaValue(event.target.value);
  };

  <span class="hljs-keyword">const</span> handleSelectChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setSelectValue(event.target.value);
  };

  <span class="hljs-keyword">const</span> handleCheckboxChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setCheckboxValue(event.target.checked);
  };

  <span class="hljs-keyword">const</span> handleRadioChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    setRadioValue(event.target.value);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controlled-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Controlled Components Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Text Input */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"controlled-input"</span>&gt;</span>Text Input:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"controlled-input"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span> // ✅ <span class="hljs-attr">Value</span> <span class="hljs-attr">controlled</span> <span class="hljs-attr">by</span> <span class="hljs-attr">React</span> <span class="hljs-attr">state</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span> // ✅ <span class="hljs-attr">Changes</span> <span class="hljs-attr">update</span> <span class="hljs-attr">state</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Type something..."</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current value: "{inputValue}"<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Length: {inputValue.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Textarea */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"controlled-textarea"</span>&gt;</span>Textarea:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"controlled-textarea"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{textareaValue}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleTextareaChange}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Enter multiple lines..."</span>
          <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Lines: {textareaValue.split("\n").length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Words:{" "}
          {textareaValue.trim() ? textareaValue.trim().split(/\s+/).length : 0}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Select Dropdown */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"controlled-select"</span>&gt;</span>Select:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"controlled-select"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{selectValue}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleSelectChange}</span>
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>Choose an option...<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"option1"</span>&gt;</span>Option 1<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"option2"</span>&gt;</span>Option 2<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"option3"</span>&gt;</span>Option 3<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Selected: {selectValue || "None"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Checkbox */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
            <span class="hljs-attr">checked</span>=<span class="hljs-string">{checkboxValue}</span> // ✅ <span class="hljs-attr">Use</span> '<span class="hljs-attr">checked</span>' <span class="hljs-attr">for</span> <span class="hljs-attr">checkboxes</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleCheckboxChange}</span>
          /&gt;</span>
          Checkbox Option
        <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Checked: {checkboxValue ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Radio Buttons */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>Radio Options:<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span>
          {["radio1", "radio2", "radio3"].map((option) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{option}</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">"radio"</span>
                <span class="hljs-attr">name</span>=<span class="hljs-string">"controlled-radio"</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{option}</span>
                <span class="hljs-attr">checked</span>=<span class="hljs-string">{radioValue</span> === <span class="hljs-string">option}</span> // ✅ <span class="hljs-attr">Compare</span> <span class="hljs-attr">with</span> <span class="hljs-attr">current</span> <span class="hljs-attr">state</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleRadioChange}</span>
              /&gt;</span>
              {option.charAt(0).toUpperCase() + option.slice(1)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Selected: {radioValue || "None"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Form State Summary */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"state-summary"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Current Form State:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>
          {JSON.stringify(
            {
              input: inputValue,
              textarea: textareaValue,
              select: selectValue,
              checkbox: checkboxValue,
              radio: radioValue,
            },
            null,
            2
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-controlled-component-patterns">Advanced Controlled Component Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdvancedControlledPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [formData, setFormData] = useState({
    <span class="hljs-attr">username</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">confirmPassword</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">bio</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">skills</span>: [],
    <span class="hljs-attr">experience</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">newsletter</span>: <span class="hljs-literal">false</span>,
  });

  <span class="hljs-keyword">const</span> [formState, setFormState] = useState({
    <span class="hljs-attr">errors</span>: {},
    <span class="hljs-attr">touched</span>: {},
    <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">isDirty</span>: <span class="hljs-literal">false</span>,
  });

  <span class="hljs-comment">// ✅ Generic handler for all form fields</span>
  <span class="hljs-keyword">const</span> handleFieldChange = <span class="hljs-function">(<span class="hljs-params">fieldName</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { type, value, checked } = event.target;
    <span class="hljs-keyword">const</span> newValue = type === <span class="hljs-string">"checkbox"</span> ? checked : value;

    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      [fieldName]: newValue,
    }));

    setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">isDirty</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">touched</span>: { ...prev.touched, [fieldName]: <span class="hljs-literal">true</span> },
    }));

    <span class="hljs-comment">// Real-time validation</span>
    validateField(fieldName, newValue);
  };

  <span class="hljs-comment">// ✅ Multi-select handler</span>
  <span class="hljs-keyword">const</span> handleMultiSelectChange = <span class="hljs-function">(<span class="hljs-params">fieldName</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { value, checked } = event.target;

    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> currentArray = prev[fieldName] || [];
      <span class="hljs-keyword">const</span> newArray = checked
        ? [...currentArray, value]
        : currentArray.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item !== value);

      <span class="hljs-keyword">return</span> {
        ...prev,
        [fieldName]: newArray,
      };
    });
  };

  <span class="hljs-comment">// ✅ Input transformation (e.g., formatting)</span>
  <span class="hljs-keyword">const</span> handleFormattedChange = <span class="hljs-function">(<span class="hljs-params">fieldName, formatter</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> rawValue = event.target.value;
    <span class="hljs-keyword">const</span> formattedValue = formatter(rawValue);

    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      [fieldName]: formattedValue,
    }));
  };

  <span class="hljs-comment">// Formatters</span>
  <span class="hljs-keyword">const</span> formatters = {
    <span class="hljs-attr">phone</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
      <span class="hljs-comment">// Format as (XXX) XXX-XXXX</span>
      <span class="hljs-keyword">const</span> numbers = value.replace(<span class="hljs-regexp">/\D/g</span>, <span class="hljs-string">""</span>);
      <span class="hljs-keyword">if</span> (numbers.length &lt;= <span class="hljs-number">3</span>) <span class="hljs-keyword">return</span> numbers;
      <span class="hljs-keyword">if</span> (numbers.length &lt;= <span class="hljs-number">6</span>)
        <span class="hljs-keyword">return</span> <span class="hljs-string">`(<span class="hljs-subst">${numbers.slice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>)}</span>) <span class="hljs-subst">${numbers.slice(<span class="hljs-number">3</span>)}</span>`</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-string">`(<span class="hljs-subst">${numbers.slice(<span class="hljs-number">0</span>, <span class="hljs-number">3</span>)}</span>) <span class="hljs-subst">${numbers.slice(<span class="hljs-number">3</span>, <span class="hljs-number">6</span>)}</span>-<span class="hljs-subst">${numbers.slice(
        <span class="hljs-number">6</span>,
        <span class="hljs-number">10</span>
      )}</span>`</span>;
    },

    <span class="hljs-attr">currency</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
      <span class="hljs-comment">// Format as currency</span>
      <span class="hljs-keyword">const</span> numbers = value.replace(<span class="hljs-regexp">/[^\d.]/g</span>, <span class="hljs-string">""</span>);
      <span class="hljs-keyword">const</span> parts = numbers.split(<span class="hljs-string">"."</span>);
      <span class="hljs-keyword">if</span> (parts.length &gt; <span class="hljs-number">2</span>) <span class="hljs-keyword">return</span> parts[<span class="hljs-number">0</span>] + <span class="hljs-string">"."</span> + parts[<span class="hljs-number">1</span>];
      <span class="hljs-keyword">return</span> numbers;
    },

    <span class="hljs-attr">uppercase</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value.toUpperCase(),

    <span class="hljs-attr">noSpaces</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> value.replace(<span class="hljs-regexp">/\s/g</span>, <span class="hljs-string">""</span>),
  };

  <span class="hljs-comment">// Validation</span>
  <span class="hljs-keyword">const</span> validateField = <span class="hljs-function">(<span class="hljs-params">fieldName, value</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> errors = { ...formState.errors };

    <span class="hljs-keyword">switch</span> (fieldName) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"username"</span>:
        <span class="hljs-keyword">if</span> (!value.trim()) {
          errors.username = <span class="hljs-string">"Username is required"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value.length &lt; <span class="hljs-number">3</span>) {
          errors.username = <span class="hljs-string">"Username must be at least 3 characters"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[a-zA-Z0-9_]+$/</span>.test(value)) {
          errors.username =
            <span class="hljs-string">"Username can only contain letters, numbers, and underscores"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.username;
        }
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"email"</span>:
        <span class="hljs-keyword">if</span> (!value.trim()) {
          errors.email = <span class="hljs-string">"Email is required"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.test(value)) {
          errors.email = <span class="hljs-string">"Please enter a valid email address"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.email;
        }
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"password"</span>:
        <span class="hljs-keyword">if</span> (!value) {
          errors.password = <span class="hljs-string">"Password is required"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (value.length &lt; <span class="hljs-number">8</span>) {
          errors.password = <span class="hljs-string">"Password must be at least 8 characters"</span>;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/</span>.test(value)) {
          errors.password =
            <span class="hljs-string">"Password must contain uppercase, lowercase, and number"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.password;
        }
        <span class="hljs-keyword">break</span>;

      <span class="hljs-keyword">case</span> <span class="hljs-string">"confirmPassword"</span>:
        <span class="hljs-keyword">if</span> (value !== formData.password) {
          errors.confirmPassword = <span class="hljs-string">"Passwords do not match"</span>;
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">delete</span> errors.confirmPassword;
        }
        <span class="hljs-keyword">break</span>;
    }

    setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      errors,
    }));
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault();

    <span class="hljs-comment">// Validate all fields</span>
    <span class="hljs-built_in">Object</span>.keys(formData).forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
      validateField(field, formData[field]);
    });

    <span class="hljs-keyword">const</span> hasErrors = <span class="hljs-built_in">Object</span>.keys(formState.errors).length &gt; <span class="hljs-number">0</span>;

    <span class="hljs-keyword">if</span> (!hasErrors) {
      setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">true</span> }));

      <span class="hljs-comment">// Simulate API call</span>
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted:"</span>, formData);
        alert(<span class="hljs-string">"Form submitted successfully!"</span>);
        setFormState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span> }));
      }, <span class="hljs-number">2000</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"advanced-controlled-form"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Advanced Controlled Form Patterns<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Basic text input with validation */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"username"</span>&gt;</span>Username:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.username}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleFieldChange(</span>"<span class="hljs-attr">username</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.username</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {formState.errors.username &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{formState.errors.username}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Email with validation */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"email"</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleFieldChange(</span>"<span class="hljs-attr">email</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.email</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {formState.errors.email &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{formState.errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Password with strength indicator */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleFieldChange(</span>"<span class="hljs-attr">password</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.password</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {formState.errors.password &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{formState.errors.password}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}

        {/* Password strength indicator */}
        {formData.password &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"password-strength"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"strength-bar"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">strength-fill</span> ${
                  <span class="hljs-attr">formData.password.length</span> &gt;</span>= 8 &amp;&amp;
                  /(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(formData.password)
                    ? "strong"
                    : formData.password.length &gt;= 6
                    ? "medium"
                    : "weak"
                }`}
                style={{
                  width: `${Math.min(
                    (formData.password.length / 12) * 100,
                    100
                  )}%`,
                }}
              /&gt;
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Confirm password */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"confirmPassword"</span>&gt;</span>Confirm Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"confirmPassword"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.confirmPassword}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleFieldChange(</span>"<span class="hljs-attr">confirmPassword</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{formState.errors.confirmPassword</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {formState.errors.confirmPassword &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {formState.errors.confirmPassword}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Formatted phone input */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"phone"</span>&gt;</span>Phone:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"tel"</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"phone"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.phone</span> || ""}
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleFormattedChange(</span>"<span class="hljs-attr">phone</span>", <span class="hljs-attr">formatters.phone</span>)}
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"(555) 123-4567"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Multi-select checkboxes */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>Skills:<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span>
          {["JavaScript", "React", "Node.js", "Python", "SQL"].map((skill) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{skill}</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{skill}</span>
                <span class="hljs-attr">checked</span>=<span class="hljs-string">{formData.skills.includes(skill)}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleMultiSelectChange(</span>"<span class="hljs-attr">skills</span>")}
              /&gt;</span>
              {skill}
            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Selected: {formData.skills.join(", ") || "None"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Character-limited textarea */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"bio"</span>&gt;</span>Bio (max 500 characters):<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"bio"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.bio}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> {
            if (e.target.value.length <span class="hljs-tag">&lt;<span class="hljs-name">=</span> <span class="hljs-attr">500</span>) {
              <span class="hljs-attr">handleFieldChange</span>("<span class="hljs-attr">bio</span>")(<span class="hljs-attr">e</span>);
            }
          }}
          <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Tell us about yourself..."</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"character-count"</span>&gt;</span>
          {formData.bio.length}/500 characters
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Newsletter checkbox */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
            <span class="hljs-attr">checked</span>=<span class="hljs-string">{formData.newsletter}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleFieldChange(</span>"<span class="hljs-attr">newsletter</span>")}
          /&gt;</span>
          Subscribe to newsletter
        <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Submit button */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>
        <span class="hljs-attr">disabled</span>=<span class="hljs-string">{</span>
          <span class="hljs-attr">formState.isSubmitting</span> || <span class="hljs-attr">Object.keys</span>(<span class="hljs-attr">formState.errors</span>)<span class="hljs-attr">.length</span> &gt;</span> 0
        }
        className="submit-button"
      &gt;
        {formState.isSubmitting ? "Submitting..." : "Submit"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* Form state debug */}
      <span class="hljs-tag">&lt;<span class="hljs-name">details</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-debug"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">summary</span>&gt;</span>Form State Debug<span class="hljs-tag">&lt;/<span class="hljs-name">summary</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify({ formData, formState }, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">details</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%86%93-uncontrolled-components-let-the-dom-handle-it">🆓 Uncontrolled Components: Let the DOM Handle It</h2>
<h3 id="understanding-uncontrolled-components">Understanding Uncontrolled Components</h3>
<p>Uncontrolled components let the DOM maintain its own state. You access values using refs when needed (like on form submission).</p>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UncontrolledInputBasics</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// ✅ Refs to access DOM values</span>
  <span class="hljs-keyword">const</span> inputRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> textareaRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> selectRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> checkboxRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> fileRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> [submittedData, setSubmittedData] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault();

    <span class="hljs-comment">// ✅ Access values through refs</span>
    <span class="hljs-keyword">const</span> formData = {
      <span class="hljs-attr">input</span>: inputRef.current.value,
      <span class="hljs-attr">textarea</span>: textareaRef.current.value,
      <span class="hljs-attr">select</span>: selectRef.current.value,
      <span class="hljs-attr">checkbox</span>: checkboxRef.current.checked,
      <span class="hljs-attr">file</span>: fileRef.current.files[<span class="hljs-number">0</span>]?.name || <span class="hljs-string">"No file selected"</span>,
    };

    setSubmittedData(formData);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Uncontrolled form data:"</span>, formData);
  };

  <span class="hljs-keyword">const</span> handleReset = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// ✅ Reset form using DOM methods</span>
    inputRef.current.value = <span class="hljs-string">""</span>;
    textareaRef.current.value = <span class="hljs-string">""</span>;
    selectRef.current.value = <span class="hljs-string">""</span>;
    checkboxRef.current.checked = <span class="hljs-literal">false</span>;
    fileRef.current.value = <span class="hljs-string">""</span>;
    setSubmittedData(<span class="hljs-literal">null</span>);
  };

  <span class="hljs-keyword">const</span> focusInput = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    inputRef.current.focus();
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"uncontrolled-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Uncontrolled Components Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
        {/* Text Input with default value */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"uncontrolled-input"</span>&gt;</span>Text Input:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"uncontrolled-input"</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span>
            <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">"Default text"</span> // ✅ <span class="hljs-attr">Use</span> <span class="hljs-attr">defaultValue</span>, <span class="hljs-attr">not</span> <span class="hljs-attr">value</span>
            <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Type something..."</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Textarea */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"uncontrolled-textarea"</span>&gt;</span>Textarea:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"uncontrolled-textarea"</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">{textareaRef}</span>
            <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">"Default textarea content"</span>
            <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Select */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"uncontrolled-select"</span>&gt;</span>Select:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"uncontrolled-select"</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">{selectRef}</span>
            <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">"option2"</span> // ✅ <span class="hljs-attr">Default</span> <span class="hljs-attr">selection</span>
          &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>Choose an option...<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"option1"</span>&gt;</span>Option 1<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"option2"</span>&gt;</span>Option 2<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"option3"</span>&gt;</span>Option 3<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Checkbox */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
              <span class="hljs-attr">ref</span>=<span class="hljs-string">{checkboxRef}</span>
              <span class="hljs-attr">defaultChecked</span>=<span class="hljs-string">{true}</span> // ✅ <span class="hljs-attr">Use</span> <span class="hljs-attr">defaultChecked</span>
            /&gt;</span>
            Checkbox Option
          <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* File Input (always uncontrolled) */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"file-input"</span>&gt;</span>File:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"file-input"</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">{fileRef}</span>
            <span class="hljs-attr">accept</span>=<span class="hljs-string">".txt,.pdf,.doc,.docx"</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-actions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleReset}</span>&gt;</span>
            Reset
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{focusInput}</span>&gt;</span>
            Focus Input
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

      {/* Display submitted data */}
      {submittedData &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"submitted-data"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Submitted Data:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(submittedData, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-uncontrolled-patterns">Advanced Uncontrolled Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdvancedUncontrolledPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> formRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [validationErrors, setValidationErrors] = useState({});
  <span class="hljs-keyword">const</span> [isSubmitting, setIsSubmitting] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// ✅ Validation using FormData API</span>
  <span class="hljs-keyword">const</span> validateForm = <span class="hljs-function">(<span class="hljs-params">formData</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> errors = {};

    <span class="hljs-keyword">const</span> username = formData.get(<span class="hljs-string">"username"</span>);
    <span class="hljs-keyword">const</span> email = formData.get(<span class="hljs-string">"email"</span>);
    <span class="hljs-keyword">const</span> password = formData.get(<span class="hljs-string">"password"</span>);
    <span class="hljs-keyword">const</span> confirmPassword = formData.get(<span class="hljs-string">"confirmPassword"</span>);
    <span class="hljs-keyword">const</span> age = formData.get(<span class="hljs-string">"age"</span>);

    <span class="hljs-keyword">if</span> (!username || username.length &lt; <span class="hljs-number">3</span>) {
      errors.username = <span class="hljs-string">"Username must be at least 3 characters"</span>;
    }

    <span class="hljs-keyword">if</span> (!email || !<span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.test(email)) {
      errors.email = <span class="hljs-string">"Please enter a valid email"</span>;
    }

    <span class="hljs-keyword">if</span> (!password || password.length &lt; <span class="hljs-number">8</span>) {
      errors.password = <span class="hljs-string">"Password must be at least 8 characters"</span>;
    }

    <span class="hljs-keyword">if</span> (password !== confirmPassword) {
      errors.confirmPassword = <span class="hljs-string">"Passwords do not match"</span>;
    }

    <span class="hljs-keyword">if</span> (!age || <span class="hljs-built_in">parseInt</span>(age) &lt; <span class="hljs-number">13</span> || <span class="hljs-built_in">parseInt</span>(age) &gt; <span class="hljs-number">120</span>) {
      errors.age = <span class="hljs-string">"Please enter a valid age (13-120)"</span>;
    }

    <span class="hljs-keyword">return</span> errors;
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> (event) =&gt; {
    event.preventDefault();

    <span class="hljs-comment">// ✅ Use FormData API for uncontrolled forms</span>
    <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(formRef.current);

    <span class="hljs-comment">// Convert FormData to regular object for easier handling</span>
    <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">Object</span>.fromEntries(formData.entries());

    <span class="hljs-comment">// Handle checkboxes (they won't appear in FormData if unchecked)</span>
    data.newsletter = formData.has(<span class="hljs-string">"newsletter"</span>);

    <span class="hljs-comment">// Handle multiple checkboxes</span>
    data.skills = formData.getAll(<span class="hljs-string">"skills"</span>);

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form data:"</span>, data);

    <span class="hljs-comment">// Validate</span>
    <span class="hljs-keyword">const</span> errors = validateForm(formData);
    setValidationErrors(errors);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(errors).length === <span class="hljs-number">0</span>) {
      setIsSubmitting(<span class="hljs-literal">true</span>);

      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Simulate API call</span>
        <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, <span class="hljs-number">2000</span>));

        alert(<span class="hljs-string">"Form submitted successfully!"</span>);
        formRef.current.reset(); <span class="hljs-comment">// ✅ Reset entire form</span>
        setValidationErrors({});
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Submission error:"</span>, error);
      } <span class="hljs-keyword">finally</span> {
        setIsSubmitting(<span class="hljs-literal">false</span>);
      }
    }
  };

  <span class="hljs-comment">// ✅ Real-time validation on blur</span>
  <span class="hljs-keyword">const</span> handleFieldBlur = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> { name, value } = event.target;
    <span class="hljs-keyword">const</span> tempFormData = <span class="hljs-keyword">new</span> FormData();
    tempFormData.set(name, value);

    <span class="hljs-comment">// Get all current form values for cross-field validation</span>
    <span class="hljs-keyword">const</span> currentFormData = <span class="hljs-keyword">new</span> FormData(formRef.current);
    <span class="hljs-keyword">const</span> errors = validateForm(currentFormData);

    setValidationErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      [name]: errors[name],
    }));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"advanced-uncontrolled-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Advanced Uncontrolled Form Patterns<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{formRef}</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
        {/* Username */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"username"</span>&gt;</span>Username:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"username"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"username"</span> // ✅ <span class="hljs-attr">Name</span> <span class="hljs-attr">attribute</span> <span class="hljs-attr">is</span> <span class="hljs-attr">crucial</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleFieldBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{validationErrors.username</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {validationErrors.username &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{validationErrors.username}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Email */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"email"</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleFieldBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{validationErrors.email</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {validationErrors.email &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{validationErrors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Password */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleFieldBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{validationErrors.password</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {validationErrors.password &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{validationErrors.password}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Confirm Password */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"confirmPassword"</span>&gt;</span>Confirm Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"confirmPassword"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"confirmPassword"</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleFieldBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{validationErrors.confirmPassword</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {validationErrors.confirmPassword &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
              {validationErrors.confirmPassword}
            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Age */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"age"</span>&gt;</span>Age:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"age"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"age"</span>
            <span class="hljs-attr">min</span>=<span class="hljs-string">"13"</span>
            <span class="hljs-attr">max</span>=<span class="hljs-string">"120"</span>
            <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleFieldBlur}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{validationErrors.age</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
          /&gt;</span>
          {validationErrors.age &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>{validationErrors.age}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Country Select */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"country"</span>&gt;</span>Country:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"country"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"country"</span> <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">""</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>Select a country<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"us"</span>&gt;</span>United States<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"ca"</span>&gt;</span>Canada<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"uk"</span>&gt;</span>United Kingdom<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"de"</span>&gt;</span>Germany<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Skills (Multiple Checkboxes) */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">fieldset</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">legend</span>&gt;</span>Skills:<span class="hljs-tag">&lt;/<span class="hljs-name">legend</span>&gt;</span>
            {["JavaScript", "React", "Node.js", "Python"].map((skill) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{skill}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                  <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
                  <span class="hljs-attr">name</span>=<span class="hljs-string">"skills"</span> // ✅ <span class="hljs-attr">Same</span> <span class="hljs-attr">name</span> <span class="hljs-attr">for</span> <span class="hljs-attr">multiple</span> <span class="hljs-attr">values</span>
                  <span class="hljs-attr">value</span>=<span class="hljs-string">{skill}</span>
                /&gt;</span>
                {skill}
              <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">fieldset</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Newsletter */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"newsletter"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"yes"</span> /&gt;</span>
            Subscribe to newsletter
          <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Bio */}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"bio"</span>&gt;</span>Bio:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
            <span class="hljs-attr">id</span>=<span class="hljs-string">"bio"</span>
            <span class="hljs-attr">name</span>=<span class="hljs-string">"bio"</span>
            <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span>
            <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Tell us about yourself..."</span>
          /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        {/* Hidden field */}
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"hidden"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"formVersion"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"2.0"</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isSubmitting}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"submit-button"</span>&gt;</span>
          {isSubmitting ? "Submitting..." : "Submit"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%96%EF%B8%8F-controlled-vs-uncontrolled-when-to-use-each">⚖️ Controlled vs Uncontrolled: When to Use Each</h2>
<h3 id="decision-matrix">Decision Matrix</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 📊 Decision Guide:</span>

<span class="hljs-comment">// ✅ Use CONTROLLED when:</span>
<span class="hljs-comment">// - Real-time validation needed</span>
<span class="hljs-comment">// - Input formatting required</span>
<span class="hljs-comment">// - Conditional field visibility</span>
<span class="hljs-comment">// - Complex form interactions</span>
<span class="hljs-comment">// - State needs to be shared with other components</span>
<span class="hljs-comment">// - You need to prevent certain inputs</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ControlledUseCase</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [creditCard, setCreditCard] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [expiryDate, setExpiryDate] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [showCVV, setShowCVV] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// ✅ Real-time formatting</span>
  <span class="hljs-keyword">const</span> handleCreditCardChange = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">let</span> value = event.target.value.replace(<span class="hljs-regexp">/\D/g</span>, <span class="hljs-string">""</span>); <span class="hljs-comment">// Remove non-digits</span>
    value = value.replace(<span class="hljs-regexp">/(\d{4})(?=\d)/g</span>, <span class="hljs-string">"$1 "</span>); <span class="hljs-comment">// Add spaces</span>
    <span class="hljs-keyword">if</span> (value.length &lt;= <span class="hljs-number">19</span>) {
      <span class="hljs-comment">// Limit length</span>
      setCreditCard(value);
    }
  };

  <span class="hljs-comment">// ✅ Conditional field visibility</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setShowCVV(creditCard.length &gt;= <span class="hljs-number">19</span>); <span class="hljs-comment">// Show CVV when card number is complete</span>
  }, [creditCard]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{creditCard}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleCreditCardChange}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"1234 5678 9012 3456"</span>
      /&gt;</span>

      {showCVV &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"CVV"</span> <span class="hljs-attr">maxLength</span>=<span class="hljs-string">{3}</span> /&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Use UNCONTROLLED when:</span>
<span class="hljs-comment">// - Simple forms with basic validation</span>
<span class="hljs-comment">// - Performance is critical (large forms)</span>
<span class="hljs-comment">// - Working with third-party form libraries</span>
<span class="hljs-comment">// - File uploads</span>
<span class="hljs-comment">// - You don't need real-time updates</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UncontrolledUseCase</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> formRef = useRef();

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault();
    <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(formRef.current);

    <span class="hljs-comment">// ✅ Simple validation on submit</span>
    <span class="hljs-keyword">const</span> email = formData.get(<span class="hljs-string">"email"</span>);
    <span class="hljs-keyword">if</span> (!email.includes(<span class="hljs-string">"@"</span>)) {
      alert(<span class="hljs-string">"Please enter a valid email"</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Process form...</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{formRef}</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">required</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"file"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"resume"</span> <span class="hljs-attr">accept</span>=<span class="hljs-string">".pdf,.doc"</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="performance-comparison">Performance Comparison</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PerformanceComparison</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [renderCount, setRenderCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [controlledValue, setControlledValue] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> uncontrolledRef = useRef();

  <span class="hljs-comment">// Track renders</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setRenderCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Performance Comparison<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Component renders: {renderCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      {/* ❌ Controlled - causes re-render on every keystroke */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controlled-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Controlled Input (Re-renders on every change)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{controlledValue}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setControlledValue(e.target.value)}
          placeholder="Type here - watch render count"
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current value: {controlledValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* ✅ Uncontrolled - no re-renders during typing */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"uncontrolled-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Uncontrolled Input (No re-renders during typing)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{uncontrolledRef}</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Type here - render count stays same"</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
            alert(`Value: ${uncontrolledRef.current.value}`);
          }}
        &gt;
          Get Value
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-hybrid-approaches">🔄 Hybrid Approaches</h2>
<h3 id="mixing-controlled-and-uncontrolled">Mixing Controlled and Uncontrolled</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HybridFormApproach</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// ✅ Controlled for fields that need real-time updates</span>
  <span class="hljs-keyword">const</span> [searchQuery, setSearchQuery] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [selectedCategory, setSelectedCategory] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// ✅ Uncontrolled for simple fields</span>
  <span class="hljs-keyword">const</span> formRef = useRef();

  <span class="hljs-comment">// ✅ Filtered results based on controlled inputs</span>
  <span class="hljs-keyword">const</span> filteredResults = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Simulate filtering logic</span>
    <span class="hljs-keyword">return</span> mockData.filter(
      <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.name.toLowerCase().includes(searchQuery.toLowerCase()) &amp;&amp;
        (selectedCategory === <span class="hljs-string">""</span> || item.category === selectedCategory)
    );
  }, [searchQuery, selectedCategory]);

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault();

    <span class="hljs-comment">// Get uncontrolled values</span>
    <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(formRef.current);

    <span class="hljs-comment">// Combine with controlled values</span>
    <span class="hljs-keyword">const</span> submissionData = {
      searchQuery,
      selectedCategory,
      <span class="hljs-attr">name</span>: formData.get(<span class="hljs-string">"name"</span>),
      <span class="hljs-attr">email</span>: formData.get(<span class="hljs-string">"email"</span>),
      <span class="hljs-attr">message</span>: formData.get(<span class="hljs-string">"message"</span>),
    };

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Hybrid form submission:"</span>, submissionData);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"hybrid-form"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Hybrid Form Approach<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Controlled section for real-time features */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"search-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Search &amp; Filter (Controlled)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{searchQuery}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSearchQuery(e.target.value)}
          placeholder="Search..."
        /&gt;

        <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{selectedCategory}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSelectedCategory(e.target.value)}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>All Categories<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"tech"</span>&gt;</span>Technology<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"design"</span>&gt;</span>Design<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"business"</span>&gt;</span>Business<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"results"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Found {filteredResults.length} results<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          {/* Render filtered results */}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Uncontrolled section for simple form */}
      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{formRef}</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"contact-form"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Contact Form (Uncontrolled)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Your name"</span> <span class="hljs-attr">required</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Your email"</span> <span class="hljs-attr">required</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Your message"</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span> <span class="hljs-attr">required</span> /&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Send Message<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="converting-between-patterns">Converting Between Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConvertibleForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [isControlled, setIsControlled] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [controlledValue, setControlledValue] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> uncontrolledRef = useRef();

  <span class="hljs-keyword">const</span> toggleMode = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (isControlled) {
      <span class="hljs-comment">// Converting from controlled to uncontrolled</span>
      <span class="hljs-comment">// Set the DOM value to match current state</span>
      uncontrolledRef.current.value = controlledValue;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// Converting from uncontrolled to controlled</span>
      <span class="hljs-comment">// Set state to match current DOM value</span>
      setControlledValue(uncontrolledRef.current.value);
    }
    setIsControlled(!isControlled);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"convertible-form"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Convertible Form Pattern<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleMode}</span>&gt;</span>
        Switch to {isControlled ? "Uncontrolled" : "Controlled"} Mode
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
        Current mode:{" "}
        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>{isControlled ? "Controlled" : "Uncontrolled"}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      {isControlled ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{controlledValue}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setControlledValue(e.target.value)}
          placeholder="Controlled input"
        /&gt;
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{uncontrolledRef}</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">{controlledValue}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Uncontrolled input"</span>
        /&gt;</span>
      )}

      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current value: {isControlled ? controlledValue : "Check on submit"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-mixing-value-and-defaultvalue">1. Mixing value and defaultValue</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Don't mix controlled and uncontrolled props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MixedPropsError</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> // <span class="hljs-attr">Controlled</span>
      <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">"initial"</span> // ❌ <span class="hljs-attr">This</span> <span class="hljs-attr">will</span> <span class="hljs-attr">be</span> <span class="hljs-attr">ignored</span>!
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setValue(e.target.value)}
    /&gt;</span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Choose one pattern</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CorrectPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-string">"initial"</span>); <span class="hljs-comment">// Start with initial value</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Controlled */}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setValue(e.target.value)} /&gt;

      {/* OR Uncontrolled */}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">"initial"</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{someRef}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-forgetting-to-handle-nullundefined-values">2. Forgetting to handle null/undefined values</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Can cause "uncontrolled to controlled" warning</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NullValueError</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-literal">null</span>); <span class="hljs-comment">// ❌ null makes it uncontrolled initially</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> // ❌ <span class="hljs-attr">null</span> <span class="hljs-attr">-</span>&gt;</span> string causes warning
      onChange={(e) =&gt; setValue(e.target.value)}
    /&gt;</span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Always use string for controlled inputs</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CorrectNullHandling</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-string">""</span>); <span class="hljs-comment">// ✅ Always string</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{value</span> || ""} // ✅ <span class="hljs-attr">Ensure</span> <span class="hljs-attr">it</span>'<span class="hljs-attr">s</span> <span class="hljs-attr">always</span> <span class="hljs-attr">a</span> <span class="hljs-attr">string</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setValue(e.target.value)}
    /&gt;</span>
  );
}
</div></code></pre>
<h3 id="3-inefficient-controlled-components">3. Inefficient controlled components</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Expensive operations in render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveControlled</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// ❌ Expensive operation on every keystroke</span>
  <span class="hljs-keyword">const</span> expensiveValidation = <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> {
    <span class="hljs-comment">// Simulate expensive operation</span>
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
      <span class="hljs-comment">// Heavy computation</span>
    }
    <span class="hljs-keyword">return</span> val.length &gt; <span class="hljs-number">5</span>;
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setValue(e.target.value)} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Valid: {expensiveValidation(value) ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Debounce expensive operations</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedControlled</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [isValid, setIsValid] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// ✅ Debounced validation</span>
  <span class="hljs-keyword">const</span> debouncedValidation = useCallback(
    debounce(<span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> {
      <span class="hljs-comment">// Expensive operation only after user stops typing</span>
      <span class="hljs-keyword">const</span> valid = expensiveValidation(val);
      setIsValid(valid);
    }, <span class="hljs-number">300</span>),
    []
  );

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    debouncedValidation(value);
  }, [value, debouncedValidation]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setValue(e.target.value)} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Valid: {isValid ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-smart-form-component">Challenge 1: Smart Form Component</h3>
<p>Build a form component that:</p>
<ul>
<li>Automatically chooses controlled vs uncontrolled based on props</li>
<li>Supports both real-time and submit-time validation</li>
<li>Handles file uploads properly</li>
<li>Provides a clean API for both patterns</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SmartForm</span>(<span class="hljs-params">{
  fields,
  onSubmit,
  realTimeValidation = false,
  initialValues = {},
}</span>) </span>{
  <span class="hljs-keyword">const</span> [controlledValues, setControlledValues] = useState(initialValues);
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
  <span class="hljs-keyword">const</span> formRef = useRef();

  <span class="hljs-keyword">const</span> isControlled =
    realTimeValidation || <span class="hljs-built_in">Object</span>.keys(initialValues).length &gt; <span class="hljs-number">0</span>;

  <span class="hljs-keyword">const</span> validateField = <span class="hljs-function">(<span class="hljs-params">name, value, fieldConfig</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (!fieldConfig.validation) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> rule <span class="hljs-keyword">of</span> fieldConfig.validation) {
      <span class="hljs-keyword">if</span> (!rule.test(value)) {
        <span class="hljs-keyword">return</span> rule.message;
      }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  };

  <span class="hljs-keyword">const</span> handleControlledChange = <span class="hljs-function">(<span class="hljs-params">name, fieldConfig</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> value =
      event.target.type === <span class="hljs-string">"checkbox"</span>
        ? event.target.checked
        : event.target.value;

    setControlledValues(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: value }));

    <span class="hljs-keyword">if</span> (realTimeValidation) {
      <span class="hljs-keyword">const</span> error = validateField(name, value, fieldConfig);
      setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: error }));
    }
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    event.preventDefault();

    <span class="hljs-keyword">let</span> formData;
    <span class="hljs-keyword">if</span> (isControlled) {
      formData = controlledValues;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">const</span> formDataObj = <span class="hljs-keyword">new</span> FormData(formRef.current);
      formData = <span class="hljs-built_in">Object</span>.fromEntries(formDataObj.entries());
    }

    <span class="hljs-comment">// Validate all fields</span>
    <span class="hljs-keyword">const</span> newErrors = {};
    fields.forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> error = validateField(field.name, formData[field.name], field);
      <span class="hljs-keyword">if</span> (error) newErrors[field.name] = error;
    });

    setErrors(newErrors);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(newErrors).length === <span class="hljs-number">0</span>) {
      onSubmit(formData);
    }
  };

  <span class="hljs-keyword">const</span> renderField = <span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> commonProps = {
      <span class="hljs-attr">id</span>: field.name,
      <span class="hljs-attr">name</span>: field.name,
      <span class="hljs-attr">type</span>: field.type || <span class="hljs-string">"text"</span>,
      <span class="hljs-attr">placeholder</span>: field.placeholder,
      <span class="hljs-attr">required</span>: field.required,
    };

    <span class="hljs-keyword">if</span> (isControlled) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          {<span class="hljs-attr">...commonProps</span>}
          <span class="hljs-attr">value</span>=<span class="hljs-string">{controlledValues[field.name]</span> || ""}
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleControlledChange(field.name,</span> <span class="hljs-attr">field</span>)}
        /&gt;</span></span>
      );
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          {<span class="hljs-attr">...commonProps</span>}
          <span class="hljs-attr">defaultValue</span>=<span class="hljs-string">{initialValues[field.name]</span> || ""}
        /&gt;</span></span>
      );
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{formRef}</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Smart Form ({isControlled ? "Controlled" : "Uncontrolled"})<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {fields.map((field) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{field.name}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">{field.name}</span>&gt;</span>{field.label}:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          {renderField(field)}
          {errors[field.name] &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{errors[field.name]}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Submit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SmartFormExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> fields = [
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"username"</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">"Username"</span>,
      <span class="hljs-attr">validation</span>: [{ <span class="hljs-attr">test</span>: <span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> v.length &gt;= <span class="hljs-number">3</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"Min 3 characters"</span> }],
    },
    {
      <span class="hljs-attr">name</span>: <span class="hljs-string">"email"</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">"Email"</span>,
      <span class="hljs-attr">type</span>: <span class="hljs-string">"email"</span>,
      <span class="hljs-attr">validation</span>: [{ <span class="hljs-attr">test</span>: <span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> v.includes(<span class="hljs-string">"@"</span>), <span class="hljs-attr">message</span>: <span class="hljs-string">"Invalid email"</span> }],
    },
  ];

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Uncontrolled form */}
      <span class="hljs-tag">&lt;<span class="hljs-name">SmartForm</span>
        <span class="hljs-attr">fields</span>=<span class="hljs-string">{fields}</span>
        <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{(data)</span> =&gt;</span> console.log("Uncontrolled:", data)}
      /&gt;

      {/* Controlled form with real-time validation */}
      <span class="hljs-tag">&lt;<span class="hljs-name">SmartForm</span>
        <span class="hljs-attr">fields</span>=<span class="hljs-string">{fields}</span>
        <span class="hljs-attr">realTimeValidation</span>=<span class="hljs-string">{true}</span>
        <span class="hljs-attr">initialValues</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">username:</span> "<span class="hljs-attr">john</span>" }}
        <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{(data)</span> =&gt;</span> console.log("Controlled:", data)}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-form-state-manager-hook">Challenge 2: Form State Manager Hook</h3>
<p>Create a custom hook that:</p>
<ul>
<li>Manages both controlled and uncontrolled forms</li>
<li>Provides validation utilities</li>
<li>Handles form reset and dirty state</li>
<li>Supports field-level and form-level validation</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useFormState</span>(<span class="hljs-params">initialValues = {}, validationRules = {}</span>) </span>{
  <span class="hljs-keyword">const</span> [values, setValues] = useState(initialValues);
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
  <span class="hljs-keyword">const</span> [touched, setTouched] = useState({});
  <span class="hljs-keyword">const</span> [isDirty, setIsDirty] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [isSubmitting, setIsSubmitting] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> validateField = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name, value</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> rules = validationRules[name];
      <span class="hljs-keyword">if</span> (!rules) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> rule <span class="hljs-keyword">of</span> rules) {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> rule === <span class="hljs-string">"function"</span>) {
          <span class="hljs-keyword">const</span> result = rule(value, values);
          <span class="hljs-keyword">if</span> (result !== <span class="hljs-literal">true</span>) <span class="hljs-keyword">return</span> result;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (rule.test &amp;&amp; !rule.test(value, values)) {
          <span class="hljs-keyword">return</span> rule.message;
        }
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    },
    [validationRules, values]
  );

  <span class="hljs-keyword">const</span> validateForm = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newErrors = {};
    <span class="hljs-built_in">Object</span>.keys(validationRules).forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> error = validateField(field, values[field]);
      <span class="hljs-keyword">if</span> (error) newErrors[field] = error;
    });
    <span class="hljs-keyword">return</span> newErrors;
  }, [validateField, values, validationRules]);

  <span class="hljs-keyword">const</span> setValue = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name, value</span>) =&gt;</span> {
      setValues(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: value }));
      setIsDirty(<span class="hljs-literal">true</span>);

      <span class="hljs-comment">// Clear error when user starts typing</span>
      <span class="hljs-keyword">if</span> (errors[name]) {
        setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: <span class="hljs-literal">null</span> }));
      }
    },
    [errors]
  );

  <span class="hljs-keyword">const</span> setFieldTouched = useCallback(<span class="hljs-function">(<span class="hljs-params">name, isTouched = <span class="hljs-literal">true</span></span>) =&gt;</span> {
    setTouched(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: isTouched }));
  }, []);

  <span class="hljs-keyword">const</span> setFieldError = useCallback(<span class="hljs-function">(<span class="hljs-params">name, error</span>) =&gt;</span> {
    setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: error }));
  }, []);

  <span class="hljs-keyword">const</span> handleChange = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> { type, value, checked } = event.target;
      <span class="hljs-keyword">const</span> newValue = type === <span class="hljs-string">"checkbox"</span> ? checked : value;
      setValue(name, newValue);
    },
    [setValue]
  );

  <span class="hljs-keyword">const</span> handleBlur = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      setFieldTouched(name, <span class="hljs-literal">true</span>);
      <span class="hljs-keyword">const</span> error = validateField(name, event.target.value);
      setFieldError(name, error);
    },
    [validateField, setFieldTouched, setFieldError]
  );

  <span class="hljs-keyword">const</span> handleSubmit = useCallback(
    <span class="hljs-function">(<span class="hljs-params">onSubmit</span>) =&gt;</span> <span class="hljs-keyword">async</span> (event) =&gt; {
      event.preventDefault();

      setIsSubmitting(<span class="hljs-literal">true</span>);

      <span class="hljs-comment">// Mark all fields as touched</span>
      <span class="hljs-keyword">const</span> allTouched = <span class="hljs-built_in">Object</span>.keys(validationRules).reduce(<span class="hljs-function">(<span class="hljs-params">acc, field</span>) =&gt;</span> {
        acc[field] = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">return</span> acc;
      }, {});
      setTouched(allTouched);

      <span class="hljs-comment">// Validate entire form</span>
      <span class="hljs-keyword">const</span> formErrors = validateForm();
      setErrors(formErrors);

      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(formErrors).length === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">await</span> onSubmit(values);
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Form submission error:"</span>, error);
        }
      }

      setIsSubmitting(<span class="hljs-literal">false</span>);
    },
    [values, validateForm, validationRules]
  );

  <span class="hljs-keyword">const</span> reset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setValues(initialValues);
    setErrors({});
    setTouched({});
    setIsDirty(<span class="hljs-literal">false</span>);
    setIsSubmitting(<span class="hljs-literal">false</span>);
  }, [initialValues]);

  <span class="hljs-keyword">const</span> getFieldProps = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> ({
      <span class="hljs-attr">value</span>: values[name] || <span class="hljs-string">""</span>,
      <span class="hljs-attr">onChange</span>: handleChange(name),
      <span class="hljs-attr">onBlur</span>: handleBlur(name),
      <span class="hljs-attr">error</span>: touched[name] ? errors[name] : <span class="hljs-literal">null</span>,
    }),
    [values, handleChange, handleBlur, touched, errors]
  );

  <span class="hljs-keyword">return</span> {
    values,
    errors,
    touched,
    isDirty,
    isSubmitting,
    setValue,
    setFieldTouched,
    setFieldError,
    handleChange,
    handleBlur,
    handleSubmit,
    reset,
    validateForm,
    getFieldProps,
    <span class="hljs-attr">isValid</span>: <span class="hljs-built_in">Object</span>.keys(errors).length === <span class="hljs-number">0</span>,
  };
}

<span class="hljs-comment">// Usage example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormWithCustomHook</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> validationRules = {
    <span class="hljs-attr">username</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> v.length &gt;= <span class="hljs-number">3</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Username must be at least 3 characters"</span>,
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> <span class="hljs-regexp">/^[a-zA-Z0-9_]+$/</span>.test(v),
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Username can only contain letters, numbers, and underscores"</span>,
      },
    ],
    <span class="hljs-attr">email</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>.test(v),
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Please enter a valid email"</span>,
      },
    ],
    <span class="hljs-attr">password</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-function">(<span class="hljs-params">v</span>) =&gt;</span> v.length &gt;= <span class="hljs-number">8</span>,
        <span class="hljs-attr">message</span>: <span class="hljs-string">"Password must be at least 8 characters"</span>,
      },
    ],
    <span class="hljs-attr">confirmPassword</span>: [
      <span class="hljs-function">(<span class="hljs-params">value, allValues</span>) =&gt;</span> {
        <span class="hljs-keyword">return</span> value === allValues.password || <span class="hljs-string">"Passwords do not match"</span>;
      },
    ],
  };

  <span class="hljs-keyword">const</span> form = useFormState(
    { <span class="hljs-attr">username</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">confirmPassword</span>: <span class="hljs-string">""</span> },
    validationRules
  );

  <span class="hljs-keyword">const</span> onSubmit = <span class="hljs-keyword">async</span> (data) =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted:"</span>, data);
    <span class="hljs-comment">// Simulate API call</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, <span class="hljs-number">1000</span>));
    alert(<span class="hljs-string">"Form submitted successfully!"</span>);
    form.reset();
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{form.handleSubmit(onSubmit)}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Form with Custom Hook<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Username:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          {<span class="hljs-attr">...form.getFieldProps</span>("<span class="hljs-attr">username</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{form.getFieldProps(</span>"<span class="hljs-attr">username</span>")<span class="hljs-attr">.error</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {form.getFieldProps("username").error &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {form.getFieldProps("username").error}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          {<span class="hljs-attr">...form.getFieldProps</span>("<span class="hljs-attr">email</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{form.getFieldProps(</span>"<span class="hljs-attr">email</span>")<span class="hljs-attr">.error</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {form.getFieldProps("email").error &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {form.getFieldProps("email").error}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          {<span class="hljs-attr">...form.getFieldProps</span>("<span class="hljs-attr">password</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{form.getFieldProps(</span>"<span class="hljs-attr">password</span>")<span class="hljs-attr">.error</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {form.getFieldProps("password").error &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {form.getFieldProps("password").error}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Confirm Password:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          {<span class="hljs-attr">...form.getFieldProps</span>("<span class="hljs-attr">confirmPassword</span>")}
          <span class="hljs-attr">className</span>=<span class="hljs-string">{form.getFieldProps(</span>"<span class="hljs-attr">confirmPassword</span>")<span class="hljs-attr">.error</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}
        /&gt;</span>
        {form.getFieldProps("confirmPassword").error &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>
            {form.getFieldProps("confirmPassword").error}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-actions"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{!form.isValid</span> || <span class="hljs-attr">form.isSubmitting</span>}&gt;</span>
          {form.isSubmitting ? "Submitting..." : "Submit"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{form.reset}</span>&gt;</span>
          Reset
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-state"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dirty: {form.isDirty ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Valid: {form.isValid ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Submitting: {form.isSubmitting ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%AF-when-and-why-decision-framework">🎯 When and Why: Decision Framework</h2>
<h3 id="quick-decision-tree">Quick Decision Tree</h3>
<pre class="hljs"><code><div>🤔 Should I use Controlled or Uncontrolled?

├── Do you need real-time validation?
│   ├── Yes → Controlled ✅
│   └── No → Continue...
│
├── Do you need to format input as user types?
│   ├── Yes → Controlled ✅
│   └── No → Continue...
│
├── Do you need conditional field visibility?
│   ├── Yes → Controlled ✅
│   └── No → Continue...
│
├── Is it a file input?
│   ├── Yes → Uncontrolled ✅ (files are always uncontrolled)
│   └── No → Continue...
│
├── Is performance critical (large forms)?
│   ├── Yes → Uncontrolled ✅
│   └── No → Continue...
│
├── Do you need to share form state with other components?
│   ├── Yes → Controlled ✅
│   └── No → Continue...
│
└── Simple form with submit-only validation?
    └── Yes → Uncontrolled ✅
</div></code></pre>
<h3 id="performance-guidelines">Performance Guidelines</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 📊 Performance Considerations:</span>

<span class="hljs-comment">// ✅ Controlled: Good for</span>
<span class="hljs-comment">// - Small to medium forms (&lt; 20 fields)</span>
<span class="hljs-comment">// - Forms with complex interactions</span>
<span class="hljs-comment">// - Real-time features</span>

<span class="hljs-comment">// ✅ Uncontrolled: Good for</span>
<span class="hljs-comment">// - Large forms (&gt; 20 fields)</span>
<span class="hljs-comment">// - Simple forms</span>
<span class="hljs-comment">// - Performance-critical applications</span>
<span class="hljs-comment">// - Third-party form libraries</span>

<span class="hljs-comment">// 🎯 Hybrid: Best of both worlds</span>
<span class="hljs-comment">// - Controlled for interactive fields</span>
<span class="hljs-comment">// - Uncontrolled for simple fields</span>
<span class="hljs-comment">// - Use refs for occasional access</span>
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<ol>
<li>
<p><strong>&quot;What's the difference between controlled and uncontrolled components?&quot;</strong></p>
<ul>
<li>Controlled: React state manages the value</li>
<li>Uncontrolled: DOM manages the value, accessed via refs</li>
<li>Show code examples of both patterns</li>
</ul>
</li>
<li>
<p><strong>&quot;When would you choose controlled over uncontrolled?&quot;</strong></p>
<ul>
<li>Real-time validation</li>
<li>Input formatting</li>
<li>Conditional rendering</li>
<li>State sharing between components</li>
</ul>
</li>
<li>
<p><strong>&quot;What's the 'uncontrolled to controlled' warning?&quot;</strong></p>
<ul>
<li>Happens when value changes from null/undefined to string</li>
<li>Always initialize controlled inputs with empty string</li>
<li>Show how to fix the warning</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you handle file uploads in React?&quot;</strong></p>
<ul>
<li>File inputs are always uncontrolled</li>
<li>Use refs to access FileList</li>
<li>Show proper file handling patterns</li>
</ul>
</li>
<li>
<p><strong>&quot;What are the performance implications?&quot;</strong></p>
<ul>
<li>Controlled: Re-renders on every change</li>
<li>Uncontrolled: No re-renders during typing</li>
<li>When to optimize with debouncing</li>
</ul>
</li>
</ol>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🚨 Red Flags in Interviews:</span>

<span class="hljs-comment">// ❌ Mixing controlled and uncontrolled</span>
&lt;input value={value} defaultValue=<span class="hljs-string">"bad"</span> /&gt;

<span class="hljs-comment">// ❌ Not handling null values</span>
<span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-literal">null</span>);
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span> /&gt;</span></span> <span class="hljs-comment">// Warning!</span>

<span class="hljs-comment">// ❌ Expensive operations in render</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> expensiveValidation()} /&gt;</span>

<span class="hljs-comment">// ❌ Not using proper form submission</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> getValue()}&gt; // Should use form onSubmit

// ❌ Forgetting name attributes for uncontrolled
<span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref}</span> /&gt;</span> // Missing name for FormData
</span></div></code></pre>
<h3 id="best-practices-to-mention">Best Practices to Mention</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Interview-worthy patterns:</span>

<span class="hljs-comment">// 1. Proper controlled initialization</span>
<span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-string">""</span>); <span class="hljs-comment">// Always string</span>

<span class="hljs-comment">// 2. Debounced validation</span>
<span class="hljs-keyword">const</span> debouncedValidate = useCallback(debounce(validateField, <span class="hljs-number">300</span>), []);

<span class="hljs-comment">// 3. Proper form submission</span>
<span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
  event.preventDefault();
  <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(event.target);
};

<span class="hljs-comment">// 4. Hybrid approach for performance</span>
<span class="hljs-keyword">const</span> useHybridForm = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// Controlled for interactive fields</span>
  <span class="hljs-comment">// Uncontrolled for simple fields</span>
};

<span class="hljs-comment">// 5. Proper error handling</span>
<span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
<span class="hljs-keyword">const</span> validateField = <span class="hljs-function">(<span class="hljs-params">name, value</span>) =&gt;</span> {
  <span class="hljs-comment">// Return error or null</span>
};
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<h3 id="decision-matrix-summary">Decision Matrix Summary</h3>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Controlled</th>
<th>Uncontrolled</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Real-time validation</strong></td>
<td>✅ Excellent</td>
<td>❌ Limited</td>
</tr>
<tr>
<td><strong>Input formatting</strong></td>
<td>✅ Excellent</td>
<td>❌ Not possible</td>
</tr>
<tr>
<td><strong>Performance</strong></td>
<td>⚠️ Re-renders</td>
<td>✅ No re-renders</td>
</tr>
<tr>
<td><strong>Simplicity</strong></td>
<td>⚠️ More code</td>
<td>✅ Less code</td>
</tr>
<tr>
<td><strong>File uploads</strong></td>
<td>❌ Not possible</td>
<td>✅ Required</td>
</tr>
<tr>
<td><strong>Form libraries</strong></td>
<td>⚠️ Some support</td>
<td>✅ Full support</td>
</tr>
<tr>
<td><strong>Testing</strong></td>
<td>✅ Easy to test</td>
<td>⚠️ Requires DOM</td>
</tr>
<tr>
<td><strong>Accessibility</strong></td>
<td>✅ Full control</td>
<td>✅ Native behavior</td>
</tr>
</tbody>
</table>
<h3 id="mental-model">Mental Model</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🧠 Think of it this way:</span>

<span class="hljs-comment">// Controlled = "React is the boss"</span>
<span class="hljs-comment">// - React state controls everything</span>
<span class="hljs-comment">// - Every change goes through React</span>
<span class="hljs-comment">// - More power, more responsibility</span>

<span class="hljs-comment">// Uncontrolled = "DOM is the boss"</span>
<span class="hljs-comment">// - DOM handles its own state</span>
<span class="hljs-comment">// - React checks in when needed</span>
<span class="hljs-comment">// - Less power, less responsibility</span>

<span class="hljs-comment">// Hybrid = "Shared responsibility"</span>
<span class="hljs-comment">// - React controls what matters</span>
<span class="hljs-comment">// - DOM handles the rest</span>
<span class="hljs-comment">// - Best of both worlds</span>
</div></code></pre>
<h3 id="production-tips">Production Tips</h3>
<ol>
<li><strong>Start with uncontrolled</strong> for simple forms</li>
<li><strong>Upgrade to controlled</strong> when you need real-time features</li>
<li><strong>Use hybrid approach</strong> for complex forms</li>
<li><strong>Always validate on submit</strong> regardless of pattern</li>
<li><strong>Consider performance</strong> for large forms</li>
<li><strong>Test both patterns</strong> in your component library</li>
</ol>
<hr>
<p><strong>Next up</strong>: <a href="./07-useEffect-dependencies-cleanup.md">useEffect Dependencies &amp; Cleanup</a> - Master React's most powerful hook for side effects and lifecycle management.</p>
<p><strong>Previous</strong>: <a href="./05-handling-dom-events.md">Handling DOM Events</a></p>
<hr>
<p><em>💡 Pro tip: In interviews, always explain your choice between controlled and uncontrolled. Show that you understand the trade-offs and can make informed decisions based on requirements.</em></p>
<h1 id="%E2%9A%A1-useeffect-dependencies--cleanup-mastery">⚡ useEffect: Dependencies &amp; Cleanup Mastery</h1>
<blockquote>
<p><strong>Master React's most powerful hook: When effects run, how dependencies work, and why cleanup prevents memory leaks</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>How useEffect works under the hood</li>
<li>The dependency array and its impact on performance</li>
<li>Common dependency pitfalls and how to avoid them</li>
<li>Cleanup functions and preventing memory leaks</li>
<li>Advanced patterns: conditional effects, custom hooks</li>
<li>Performance optimization strategies</li>
<li>Real-world scenarios and best practices</li>
</ul>
<h2 id="%E2%9A%A1-understanding-useeffect-fundamentals">⚡ Understanding useEffect Fundamentals</h2>
<h3 id="the-effect-lifecycle">The Effect Lifecycle</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EffectLifecycleDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🔄 Component render"</span>);

  <span class="hljs-comment">// 🎯 Effect runs AFTER every render (no dependency array)</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🚀 Effect runs after render"</span>);
    <span class="hljs-built_in">document</span>.title = <span class="hljs-string">`Count: <span class="hljs-subst">${count}</span>`</span>;

    <span class="hljs-comment">// 🧹 Cleanup function (optional)</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🧹 Cleanup from previous effect"</span>);
    };
  });

  <span class="hljs-comment">// 🎯 Effect runs only on mount (empty dependency array)</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🏁 Component mounted - runs once"</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"💀 Component will unmount"</span>);
    };
  }, []); <span class="hljs-comment">// ✅ Empty dependency array = run once</span>

  <span class="hljs-comment">// 🎯 Effect runs when count changes (specific dependency)</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`📊 Count changed to: <span class="hljs-subst">${count}</span>`</span>);

    <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> timer = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`⏰ Timer fired for count: <span class="hljs-subst">${count}</span>`</span>);
      }, <span class="hljs-number">1000</span>);

      <span class="hljs-comment">// 🧹 Cleanup timer to prevent memory leaks</span>
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`🧹 Cleaning up timer for count: <span class="hljs-subst">${count}</span>`</span>);
        clearTimeout(timer);
      };
    }
  }, [count]); <span class="hljs-comment">// ✅ Only runs when count changes</span>

  <span class="hljs-comment">// 🎯 Effect with multiple dependencies</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`👤 User info: <span class="hljs-subst">${name}</span>, Count: <span class="hljs-subst">${count}</span>`</span>);

    <span class="hljs-comment">// Simulate API call</span>
    <span class="hljs-keyword">if</span> (name &amp;&amp; count &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"📡 Making API call with user data"</span>);
    }
  }, [name, count]); <span class="hljs-comment">// ✅ Runs when either name OR count changes</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"effect-lifecycle-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>useEffect Lifecycle Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Open console to see effect execution order<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((c) =&gt; c + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setName(e.target.value)}
          placeholder="Enter your name"
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current name: {name || "No name"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Document title should show count<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="effect-execution-order">Effect Execution Order</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EffectExecutionOrder</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [toggle, setToggle] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"1️⃣ Render phase"</span>);

  <span class="hljs-comment">// Multiple effects to show execution order</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"2️⃣ First effect (no deps)"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🧹 First effect cleanup"</span>);
  });

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"3️⃣ Second effect (empty deps)"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🧹 Second effect cleanup"</span>);
  }, []);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"4️⃣ Third effect (toggle dep)"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🧹 Third effect cleanup"</span>);
  }, [toggle]);

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"5️⃣ Render complete, effects will run next"</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Effect Execution Order<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Check console for execution sequence<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setToggle(!toggle)}&gt;
        Toggle: {toggle.toString()}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"execution-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Execution Order:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ol</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Component renders<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>DOM is updated<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Cleanup functions run (for changed effects)<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>New effects run (in order they're defined)<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ol</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-dependency-array-deep-dive">🎯 Dependency Array Deep Dive</h2>
<h3 id="understanding-dependencies">Understanding Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DependencyArrayExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> });
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>]);

  <span class="hljs-comment">// ❌ WRONG: Missing dependencies</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Count is <span class="hljs-subst">${count}</span>`</span>); <span class="hljs-comment">// Uses count but doesn't depend on it</span>
    <span class="hljs-built_in">document</span>.title = <span class="hljs-string">`User: <span class="hljs-subst">${user.name}</span>`</span>; <span class="hljs-comment">// Uses user but doesn't depend on it</span>
  }, []); <span class="hljs-comment">// ❌ Missing count and user dependencies</span>

  <span class="hljs-comment">// ✅ CORRECT: All dependencies included</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Count is <span class="hljs-subst">${count}</span>`</span>);
    <span class="hljs-built_in">document</span>.title = <span class="hljs-string">`User: <span class="hljs-subst">${user.name}</span>, Count: <span class="hljs-subst">${count}</span>`</span>;
  }, [count, user.name]); <span class="hljs-comment">// ✅ Includes all used values</span>

  <span class="hljs-comment">// ⚠️ CAREFUL: Object dependencies</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User object changed:"</span>, user);
    <span class="hljs-comment">// This will run on every render if user object is recreated</span>
  }, [user]); <span class="hljs-comment">// ⚠️ Object reference comparison</span>

  <span class="hljs-comment">// ✅ BETTER: Specific object properties</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User name or age changed"</span>);
  }, [user.name, user.age]); <span class="hljs-comment">// ✅ Only specific properties</span>

  <span class="hljs-comment">// ❌ WRONG: Array dependencies without proper comparison</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Items changed:"</span>, items);
  }, [items]); <span class="hljs-comment">// ❌ Array reference comparison</span>

  <span class="hljs-comment">// ✅ BETTER: Use useMemo for stable references</span>
  <span class="hljs-keyword">const</span> stableItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> items, [items.join(<span class="hljs-string">","</span>)]);
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Items actually changed:"</span>, stableItems);
  }, [stableItems]);

  <span class="hljs-comment">// 🎯 Function dependencies</span>
  <span class="hljs-keyword">const</span> expensiveCalculation = useCallback(<span class="hljs-function">(<span class="hljs-params">num</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Expensive calculation running"</span>);
    <span class="hljs-keyword">return</span> num * <span class="hljs-number">2</span>;
  }, []); <span class="hljs-comment">// ✅ Memoized function</span>

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> result = expensiveCalculation(count);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculation result:"</span>, result);
  }, [count, expensiveCalculation]); <span class="hljs-comment">// ✅ Include function dependency</span>

  <span class="hljs-keyword">const</span> updateUser = <span class="hljs-function">(<span class="hljs-params">field, value</span>) =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [field]: value }));
  };

  <span class="hljs-keyword">const</span> addItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, <span class="hljs-string">`item-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>]);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dependency-examples"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Dependency Array Examples<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((c) =&gt; c + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateUser("name", `User-${Date.now()}`)}&gt;
          Change Name
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateUser("age", Math.floor(Math.random() * 50) + 20)}
        &gt;
          Change Age
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addItem}</span>&gt;</span>Add Item<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"state-display"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>User: {JSON.stringify(user)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Items: {items.join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="dependency-array-patterns">Dependency Array Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DependencyPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [results, setResults] = useState([]);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">preferences</span>: { <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span> } });

  <span class="hljs-comment">// 🎯 Pattern 1: Debounced API calls</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!searchTerm.trim()) {
      setResults([]);
      <span class="hljs-keyword">return</span>;
    }

    setLoading(<span class="hljs-literal">true</span>);

    <span class="hljs-keyword">const</span> timeoutId = setTimeout(<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Simulate API call</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Searching for: <span class="hljs-subst">${searchTerm}</span>`</span>);
        <span class="hljs-keyword">const</span> mockResults = [
          <span class="hljs-string">`Result 1 for <span class="hljs-subst">${searchTerm}</span>`</span>,
          <span class="hljs-string">`Result 2 for <span class="hljs-subst">${searchTerm}</span>`</span>,
          <span class="hljs-string">`Result 3 for <span class="hljs-subst">${searchTerm}</span>`</span>,
        ];
        setResults(mockResults);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Search failed:"</span>, error);
        setResults([]);
      } <span class="hljs-keyword">finally</span> {
        setLoading(<span class="hljs-literal">false</span>);
      }
    }, <span class="hljs-number">500</span>); <span class="hljs-comment">// 500ms debounce</span>

    <span class="hljs-comment">// 🧹 Cleanup: Cancel previous search</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      clearTimeout(timeoutId);
      setLoading(<span class="hljs-literal">false</span>);
    };
  }, [searchTerm]); <span class="hljs-comment">// ✅ Only depends on searchTerm</span>

  <span class="hljs-comment">// 🎯 Pattern 2: Nested object dependencies</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"User theme changed:"</span>, user.preferences.theme);
    <span class="hljs-built_in">document</span>.body.className = <span class="hljs-string">`theme-<span class="hljs-subst">${user.preferences.theme}</span>`</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">document</span>.body.className = <span class="hljs-string">""</span>; <span class="hljs-comment">// Cleanup theme</span>
    };
  }, [user.preferences.theme]); <span class="hljs-comment">// ✅ Specific nested property</span>

  <span class="hljs-comment">// 🎯 Pattern 3: Conditional effects</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Only run effect if user is logged in</span>
    <span class="hljs-keyword">if</span> (user.id) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Setting up user session"</span>);

      <span class="hljs-keyword">const</span> sessionTimer = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Refreshing user session"</span>);
      }, <span class="hljs-number">60000</span>); <span class="hljs-comment">// Refresh every minute</span>

      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Cleaning up user session"</span>);
        clearInterval(sessionTimer);
      };
    }
  }, [user.id]); <span class="hljs-comment">// ✅ Only runs when user.id changes</span>

  <span class="hljs-comment">// 🎯 Pattern 4: Effect with external dependencies</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleResize = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Window resized:"</span>, <span class="hljs-built_in">window</span>.innerWidth);
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"resize"</span>, handleResize);

    <span class="hljs-comment">// 🧹 Always cleanup event listeners</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"resize"</span>, handleResize);
    };
  }, []); <span class="hljs-comment">// ✅ No dependencies - setup once</span>

  <span class="hljs-comment">// 🎯 Pattern 5: Effect with function dependencies</span>
  <span class="hljs-keyword">const</span> logUserActivity = useCallback(
    <span class="hljs-function">(<span class="hljs-params">activity</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`User <span class="hljs-subst">${user.id}</span> performed: <span class="hljs-subst">${activity}</span>`</span>);
    },
    [user.id]
  ); <span class="hljs-comment">// ✅ Function depends on user.id</span>

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    logUserActivity(<span class="hljs-string">"page_view"</span>);
  }, [logUserActivity]); <span class="hljs-comment">// ✅ Include function dependency</span>

  <span class="hljs-keyword">const</span> updateUserTheme = <span class="hljs-function">(<span class="hljs-params">theme</span>) =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">preferences</span>: {
        ...prev.preferences,
        theme,
      },
    }));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dependency-patterns"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Advanced Dependency Patterns<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"search-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Debounced Search<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSearchTerm(e.target.value)}
          placeholder="Search..."
        /&gt;
        {loading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Searching...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          {results.map((result, index) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>&gt;</span>{result}<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"theme-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Theme Control<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current theme: {user.preferences.theme}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateUserTheme("light")}&gt;Light Theme<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateUserTheme("dark")}&gt;Dark Theme<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateUserTheme("auto")}&gt;Auto Theme<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>User Session<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>User ID: {user.id}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setUser((prev) =&gt; ({ ...prev, id: prev.id + 1 }))}
        &gt;
          Switch User
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setUser((prev) =&gt; ({ ...prev, id: null }))}&gt;
          Logout
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%B9-cleanup-functions-preventing-memory-leaks">🧹 Cleanup Functions: Preventing Memory Leaks</h2>
<h3 id="essential-cleanup-patterns">Essential Cleanup Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CleanupPatterns</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [isActive, setIsActive] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [position, setPosition] = useState({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> });
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// 🎯 Pattern 1: Timer cleanup</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!isActive) <span class="hljs-keyword">return</span>;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Starting timer"</span>);
    <span class="hljs-keyword">const</span> intervalId = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Timer tick:"</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString());
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-comment">// 🧹 CRITICAL: Clear timer to prevent memory leak</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Cleaning up timer"</span>);
      clearInterval(intervalId);
    };
  }, [isActive]);

  <span class="hljs-comment">// 🎯 Pattern 2: Event listener cleanup</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleMouseMove = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      setPosition({ <span class="hljs-attr">x</span>: event.clientX, <span class="hljs-attr">y</span>: event.clientY });
    };

    <span class="hljs-keyword">const</span> handleKeyPress = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (event.key === <span class="hljs-string">"Escape"</span>) {
        setIsActive(<span class="hljs-literal">false</span>);
      }
    };

    <span class="hljs-keyword">if</span> (isActive) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Adding event listeners"</span>);
      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleKeyPress);
    }

    <span class="hljs-comment">// 🧹 CRITICAL: Remove event listeners</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Removing event listeners"</span>);
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleKeyPress);
    };
  }, [isActive]);

  <span class="hljs-comment">// 🎯 Pattern 3: AbortController for fetch requests</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!isActive) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> abortController = <span class="hljs-keyword">new</span> AbortController();

    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Starting fetch request"</span>);

        <span class="hljs-comment">// Simulate API call with abort signal</span>
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>, {
          <span class="hljs-attr">signal</span>: abortController.signal,
        });

        <span class="hljs-keyword">if</span> (!response.ok) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Fetch failed"</span>);

        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
        setData(result);
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Fetch completed"</span>);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">if</span> (error.name === <span class="hljs-string">"AbortError"</span>) {
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Fetch was aborted"</span>);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Fetch error:"</span>, error);
        }
      }
    };

    fetchData();

    <span class="hljs-comment">// 🧹 CRITICAL: Abort ongoing requests</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Aborting fetch request"</span>);
      abortController.abort();
    };
  }, [isActive]);

  <span class="hljs-comment">// 🎯 Pattern 4: WebSocket cleanup</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!isActive) <span class="hljs-keyword">return</span>;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Connecting to WebSocket"</span>);
    <span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">"wss://echo.websocket.org"</span>);

    ws.onopen = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"WebSocket connected"</span>);
      ws.send(<span class="hljs-string">"Hello WebSocket!"</span>);
    };

    ws.onmessage = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"WebSocket message:"</span>, event.data);
    };

    ws.onerror = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"WebSocket error:"</span>, error);
    };

    ws.onclose = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"WebSocket disconnected"</span>);
    };

    <span class="hljs-comment">// 🧹 CRITICAL: Close WebSocket connection</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Closing WebSocket"</span>);
      <span class="hljs-keyword">if</span> (ws.readyState === WebSocket.OPEN) {
        ws.close();
      }
    };
  }, [isActive]);

  <span class="hljs-comment">// 🎯 Pattern 5: Subscription cleanup</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!isActive) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// Simulate subscription (like Redux store)</span>
    <span class="hljs-keyword">const</span> subscription = {
      <span class="hljs-attr">unsubscribe</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Unsubscribed from store"</span>),
    };

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Subscribing to store"</span>);

    <span class="hljs-comment">// 🧹 CRITICAL: Unsubscribe to prevent memory leaks</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      subscription.unsubscribe();
    };
  }, [isActive]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cleanup-patterns"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Cleanup Patterns Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsActive(!isActive)}
          className={isActive ? "active" : ""}
        &gt;
          {isActive ? "Stop" : "Start"} Effects
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"status"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Effects active: {isActive ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Mouse position: {position.x}, {position.y}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Data: {data ? JSON.stringify(data) : "No data"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Press Escape to deactivate<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cleanup-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>What gets cleaned up:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>✅ Timers (setInterval, setTimeout)<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>✅ Event listeners<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>✅ Fetch requests (AbortController)<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>✅ WebSocket connections<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>✅ Subscriptions<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>✅ Animation frames<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>✅ DOM modifications<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="memory-leak-prevention">Memory Leak Prevention</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MemoryLeakPrevention</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [componentCount, setComponentCount] = useState(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> [showLeakyComponent, setShowLeakyComponent] = useState(<span class="hljs-literal">true</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"memory-leak-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Memory Leak Prevention<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setComponentCount((c) =&gt; c + 1)}&gt;
          Create Component #{componentCount + 1}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowLeakyComponent(!showLeakyComponent)}&gt;
          {showLeakyComponent ? "Hide" : "Show"} Leaky Component
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Show multiple instances to demonstrate leaks */}
      {Array.from({ length: componentCount }, (_, i) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Component Instance #{i + 1}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          {showLeakyComponent ? <span class="hljs-tag">&lt;<span class="hljs-name">LeakyComponent</span> /&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">CleanComponent</span> /&gt;</span>}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ❌ BAD: Component with memory leaks</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LeakyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// ❌ Timer without cleanup</span>
    setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>);
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-comment">// ❌ Event listener without cleanup</span>
    <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Clicked"</span>);
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, handleClick);

    <span class="hljs-comment">// ❌ No cleanup function!</span>
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"leaky-component"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>❌ Leaky Component - Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This component creates memory leaks!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ GOOD: Component with proper cleanup</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CleanComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// ✅ Timer with cleanup</span>
    <span class="hljs-keyword">const</span> intervalId = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>);
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-comment">// ✅ Event listener with cleanup</span>
    <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Clicked"</span>);
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"click"</span>, handleClick);

    <span class="hljs-comment">// ✅ Proper cleanup function</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      clearInterval(intervalId);
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"click"</span>, handleClick);
    };
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"clean-component"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>✅ Clean Component - Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This component properly cleans up!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%9A%80-advanced-useeffect-patterns">🚀 Advanced useEffect Patterns</h2>
<h3 id="custom-hook-patterns">Custom Hook Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Custom hook for API calls</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useApi</span>(<span class="hljs-params">url, dependencies = []</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!url) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> abortController = <span class="hljs-keyword">new</span> AbortController();

    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
      setLoading(<span class="hljs-literal">true</span>);
      setError(<span class="hljs-literal">null</span>);

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, {
          <span class="hljs-attr">signal</span>: abortController.signal,
        });

        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
        }

        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
        setData(result);
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-keyword">if</span> (err.name !== <span class="hljs-string">"AbortError"</span>) {
          setError(err.message);
        }
      } <span class="hljs-keyword">finally</span> {
        setLoading(<span class="hljs-literal">false</span>);
      }
    };

    fetchData();

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      abortController.abort();
    };
  }, [url, ...dependencies]);

  <span class="hljs-keyword">return</span> { data, loading, error };
}

<span class="hljs-comment">// 🎯 Custom hook for local storage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useLocalStorage</span>(<span class="hljs-params">key, initialValue</span>) </span>{
  <span class="hljs-keyword">const</span> [storedValue, setStoredValue] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> item = <span class="hljs-built_in">window</span>.localStorage.getItem(key);
      <span class="hljs-keyword">return</span> item ? <span class="hljs-built_in">JSON</span>.parse(item) : initialValue;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Error reading localStorage key "<span class="hljs-subst">${key}</span>":`</span>, error);
      <span class="hljs-keyword">return</span> initialValue;
    }
  });

  <span class="hljs-keyword">const</span> setValue = useCallback(
    <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> valueToStore =
          value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Function</span> ? value(storedValue) : value;
        setStoredValue(valueToStore);
        <span class="hljs-built_in">window</span>.localStorage.setItem(key, <span class="hljs-built_in">JSON</span>.stringify(valueToStore));
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Error setting localStorage key "<span class="hljs-subst">${key}</span>":`</span>, error);
      }
    },
    [key, storedValue]
  );

  <span class="hljs-comment">// 🎯 Listen for storage changes from other tabs</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleStorageChange = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.key === key &amp;&amp; e.newValue !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">try</span> {
          setStoredValue(<span class="hljs-built_in">JSON</span>.parse(e.newValue));
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Error parsing localStorage key "<span class="hljs-subst">${key}</span>":`</span>, error);
        }
      }
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"storage"</span>, handleStorageChange);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"storage"</span>, handleStorageChange);
    };
  }, [key]);

  <span class="hljs-keyword">return</span> [storedValue, setValue];
}

<span class="hljs-comment">// 🎯 Custom hook for window size</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useWindowSize</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [windowSize, setWindowSize] = useState({
    <span class="hljs-attr">width</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-literal">undefined</span>,
  });

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleResize = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setWindowSize({
        <span class="hljs-attr">width</span>: <span class="hljs-built_in">window</span>.innerWidth,
        <span class="hljs-attr">height</span>: <span class="hljs-built_in">window</span>.innerHeight,
      });
    };

    <span class="hljs-comment">// Set initial size</span>
    handleResize();

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"resize"</span>, handleResize);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"resize"</span>, handleResize);
    };
  }, []);

  <span class="hljs-keyword">return</span> windowSize;
}

<span class="hljs-comment">// 🎯 Custom hook for debounced values</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDebounce</span>(<span class="hljs-params">value, delay</span>) </span>{
  <span class="hljs-keyword">const</span> [debouncedValue, setDebouncedValue] = useState(value);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handler = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setDebouncedValue(value);
    }, delay);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      clearTimeout(handler);
    };
  }, [value, delay]);

  <span class="hljs-keyword">return</span> debouncedValue;
}

<span class="hljs-comment">// Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CustomHookExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [userId, setUserId] = useState(<span class="hljs-number">1</span>);

  <span class="hljs-comment">// 🎯 Using custom hooks</span>
  <span class="hljs-keyword">const</span> debouncedSearchTerm = useDebounce(searchTerm, <span class="hljs-number">500</span>);
  <span class="hljs-keyword">const</span> {
    <span class="hljs-attr">data</span>: userData,
    loading,
    error,
  } = useApi(userId ? <span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span> : <span class="hljs-literal">null</span>, [userId]);
  <span class="hljs-keyword">const</span> [preferences, setPreferences] = useLocalStorage(<span class="hljs-string">"userPreferences"</span>, {
    <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span>,
    <span class="hljs-attr">language</span>: <span class="hljs-string">"en"</span>,
  });
  <span class="hljs-keyword">const</span> windowSize = useWindowSize();

  <span class="hljs-comment">// 🎯 Effect that depends on debounced value</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (debouncedSearchTerm) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Searching for:"</span>, debouncedSearchTerm);
      <span class="hljs-comment">// Perform search...</span>
    }
  }, [debouncedSearchTerm]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"custom-hook-examples"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Custom Hook Examples<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"search-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Debounced Search<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSearchTerm(e.target.value)}
          placeholder="Search (debounced)..."
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Search term: {searchTerm}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Debounced: {debouncedSearchTerm}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"api-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>API Data<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setUserId(userId + 1)}&gt;
          Load User {userId + 1}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        {loading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
        {error &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
        {userData &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(userData, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"storage-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Local Storage Preferences<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span>
            setPreferences((prev) =&gt; ({
              ...prev,
              theme: prev.theme === "light" ? "dark" : "light",
            }))
          }
        &gt;
          Toggle Theme: {preferences.theme}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(preferences, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"window-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Window Size<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Width: {windowSize.width}px<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Height: {windowSize.height}px<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-missing-dependencies">1. Missing Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Missing dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MissingDependencies</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [multiplier, setMultiplier] = useState(<span class="hljs-number">2</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> result = count * multiplier; <span class="hljs-comment">// Uses count and multiplier</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Result:"</span>, result);
  }, []); <span class="hljs-comment">// ❌ Missing count and multiplier dependencies</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((c) =&gt; c + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setMultiplier((m) =&gt; m + 1)}&gt;
        Multiplier: {multiplier}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: All dependencies included</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CorrectDependencies</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [multiplier, setMultiplier] = useState(<span class="hljs-number">2</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> result = count * multiplier;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Result:"</span>, result);
  }, [count, multiplier]); <span class="hljs-comment">// ✅ All dependencies included</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((c) =&gt; c + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setMultiplier((m) =&gt; m + 1)}&gt;
        Multiplier: {multiplier}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-infinite-loops">2. Infinite Loops</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Infinite loop</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">InfiniteLoop</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// This creates a new array every time</span>
    setData([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]); <span class="hljs-comment">// ❌ Causes infinite re-renders</span>
  }, [data]); <span class="hljs-comment">// ❌ data changes every render</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Data: {data.join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ CORRECT: Stable dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NoInfiniteLoop</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setData([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]);
  }, []); <span class="hljs-comment">// ✅ Empty dependency array</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Data: {data.join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="3-stale-closures">3. Stale Closures</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Stale closure</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StaleClosure</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> timer = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(count + <span class="hljs-number">1</span>); <span class="hljs-comment">// ❌ Always uses initial count value (0)</span>
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearInterval(timer);
  }, []); <span class="hljs-comment">// ❌ Empty deps but uses count</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ CORRECT: Functional update</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NoStaleClosure</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> timer = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>); <span class="hljs-comment">// ✅ Uses current value</span>
    }, <span class="hljs-number">1000</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearInterval(timer);
  }, []); <span class="hljs-comment">// ✅ No dependencies needed</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="4-unnecessary-effects">4. Unnecessary Effects</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Unnecessary effect for derived state</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UnnecessaryEffect</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [firstName, setFirstName] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [lastName, setLastName] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [fullName, setFullName] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// ❌ Don't use effect for derived state</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setFullName(<span class="hljs-string">`<span class="hljs-subst">${firstName}</span> <span class="hljs-subst">${lastName}</span>`</span>);
  }, [firstName, lastName]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{firstName}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFirstName(e.target.value)}
        placeholder="First name"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{lastName}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setLastName(e.target.value)}
        placeholder="Last name"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Full name: {fullName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Derived state during render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DerivedState</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [firstName, setFirstName] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [lastName, setLastName] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// ✅ Calculate during render</span>
  <span class="hljs-keyword">const</span> fullName = <span class="hljs-string">`<span class="hljs-subst">${firstName}</span> <span class="hljs-subst">${lastName}</span>`</span>.trim();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{firstName}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFirstName(e.target.value)}
        placeholder="First name"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{lastName}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setLastName(e.target.value)}
        placeholder="Last name"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Full name: {fullName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-data-fetcher-with-cleanup">Challenge 1: Data Fetcher with Cleanup</h3>
<p>Build a component that:</p>
<ul>
<li>Fetches user data based on user ID</li>
<li>Shows loading state</li>
<li>Handles errors gracefully</li>
<li>Cancels ongoing requests when user ID changes</li>
<li>Implements retry functionality</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataFetcher</span>(<span class="hljs-params">{ userId }</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [retryCount, setRetryCount] = useState(<span class="hljs-number">0</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!userId) {
      setData(<span class="hljs-literal">null</span>);
      setError(<span class="hljs-literal">null</span>);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> abortController = <span class="hljs-keyword">new</span> AbortController();
    <span class="hljs-keyword">let</span> retryTimeout;

    <span class="hljs-keyword">const</span> fetchUserData = <span class="hljs-keyword">async</span> (attempt = <span class="hljs-number">0</span>) =&gt; {
      setLoading(<span class="hljs-literal">true</span>);
      setError(<span class="hljs-literal">null</span>);

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>, {
          <span class="hljs-attr">signal</span>: abortController.signal,
        });

        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>);
        }

        <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
        setData(userData);
        setRetryCount(<span class="hljs-number">0</span>);
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-keyword">if</span> (err.name === <span class="hljs-string">"AbortError"</span>) {
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Request was aborted"</span>);
          <span class="hljs-keyword">return</span>;
        }

        setError(err.message);

        <span class="hljs-comment">// Retry logic</span>
        <span class="hljs-keyword">if</span> (attempt &lt; <span class="hljs-number">3</span>) {
          <span class="hljs-keyword">const</span> delay = <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, attempt) * <span class="hljs-number">1000</span>; <span class="hljs-comment">// Exponential backoff</span>
          retryTimeout = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            setRetryCount(attempt + <span class="hljs-number">1</span>);
            fetchUserData(attempt + <span class="hljs-number">1</span>);
          }, delay);
        }
      } <span class="hljs-keyword">finally</span> {
        setLoading(<span class="hljs-literal">false</span>);
      }
    };

    fetchUserData();

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      abortController.abort();
      <span class="hljs-keyword">if</span> (retryTimeout) {
        clearTimeout(retryTimeout);
      }
    };
  }, [userId]);

  <span class="hljs-keyword">const</span> handleRetry = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setRetryCount(<span class="hljs-number">0</span>);
    setError(<span class="hljs-literal">null</span>);
    <span class="hljs-comment">// Trigger re-fetch by updating a dependency</span>
  };

  <span class="hljs-keyword">if</span> (loading) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-fetcher loading"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Loading user data...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        {retryCount &gt; 0 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Retry attempt: {retryCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-fetcher error"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleRetry}</span>&gt;</span>Retry<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">if</span> (!data) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-fetcher empty"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>No user selected<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-fetcher success"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>User Data<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(data, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-real-time-chat-component">Challenge 2: Real-time Chat Component</h3>
<p>Create a chat component that:</p>
<ul>
<li>Connects to WebSocket on mount</li>
<li>Sends and receives messages</li>
<li>Shows connection status</li>
<li>Handles reconnection on disconnect</li>
<li>Cleans up properly on unmount</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RealTimeChat</span>(<span class="hljs-params">{ roomId, userId }</span>) </span>{
  <span class="hljs-keyword">const</span> [messages, setMessages] = useState([]);
  <span class="hljs-keyword">const</span> [newMessage, setNewMessage] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [connectionStatus, setConnectionStatus] = useState(<span class="hljs-string">"disconnected"</span>);
  <span class="hljs-keyword">const</span> [ws, setWs] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> reconnectTimeoutRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> reconnectAttemptsRef = useRef(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> connectWebSocket = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!roomId || !userId) <span class="hljs-keyword">return</span>;

    setConnectionStatus(<span class="hljs-string">"connecting"</span>);

    <span class="hljs-keyword">const</span> websocket = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">`wss://chat.example.com/rooms/<span class="hljs-subst">${roomId}</span>`</span>);

    websocket.onopen = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"WebSocket connected"</span>);
      setConnectionStatus(<span class="hljs-string">"connected"</span>);
      reconnectAttemptsRef.current = <span class="hljs-number">0</span>;

      <span class="hljs-comment">// Send join message</span>
      websocket.send(
        <span class="hljs-built_in">JSON</span>.stringify({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"join"</span>,
          userId,
          roomId,
        })
      );
    };

    websocket.onmessage = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> message = <span class="hljs-built_in">JSON</span>.parse(event.data);

        <span class="hljs-keyword">if</span> (message.type === <span class="hljs-string">"message"</span>) {
          setMessages(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [
            ...prev,
            {
              <span class="hljs-attr">id</span>: message.id,
              <span class="hljs-attr">text</span>: message.text,
              <span class="hljs-attr">userId</span>: message.userId,
              <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(message.timestamp),
            },
          ]);
        }
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error parsing message:"</span>, error);
      }
    };

    websocket.onerror = <span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"WebSocket error:"</span>, error);
      setConnectionStatus(<span class="hljs-string">"error"</span>);
    };

    websocket.onclose = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"WebSocket closed:"</span>, event.code, event.reason);
      setConnectionStatus(<span class="hljs-string">"disconnected"</span>);
      setWs(<span class="hljs-literal">null</span>);

      <span class="hljs-comment">// Attempt to reconnect if not a clean close</span>
      <span class="hljs-keyword">if</span> (event.code !== <span class="hljs-number">1000</span> &amp;&amp; reconnectAttemptsRef.current &lt; <span class="hljs-number">5</span>) {
        <span class="hljs-keyword">const</span> delay = <span class="hljs-built_in">Math</span>.min(
          <span class="hljs-number">1000</span> * <span class="hljs-built_in">Math</span>.pow(<span class="hljs-number">2</span>, reconnectAttemptsRef.current),
          <span class="hljs-number">30000</span>
        );

        reconnectTimeoutRef.current = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          reconnectAttemptsRef.current++;
          connectWebSocket();
        }, delay);
      }
    };

    setWs(websocket);
  }, [roomId, userId]);

  <span class="hljs-comment">// Connect on mount and when roomId/userId changes</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    connectWebSocket();

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (reconnectTimeoutRef.current) {
        clearTimeout(reconnectTimeoutRef.current);
      }

      <span class="hljs-keyword">if</span> (ws) {
        ws.close(<span class="hljs-number">1000</span>, <span class="hljs-string">"Component unmounting"</span>);
      }
    };
  }, [connectWebSocket]);

  <span class="hljs-comment">// Cleanup on unmount</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (ws &amp;&amp; ws.readyState === WebSocket.OPEN) {
        ws.send(
          <span class="hljs-built_in">JSON</span>.stringify({
            <span class="hljs-attr">type</span>: <span class="hljs-string">"leave"</span>,
            userId,
            roomId,
          })
        );
        ws.close(<span class="hljs-number">1000</span>, <span class="hljs-string">"User leaving"</span>);
      }
    };
  }, []);

  <span class="hljs-keyword">const</span> sendMessage = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    e.preventDefault();

    <span class="hljs-keyword">if</span> (!newMessage.trim() || !ws || ws.readyState !== WebSocket.OPEN) {
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">const</span> message = {
      <span class="hljs-attr">type</span>: <span class="hljs-string">"message"</span>,
      <span class="hljs-attr">text</span>: newMessage.trim(),
      userId,
      roomId,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
    };

    ws.send(<span class="hljs-built_in">JSON</span>.stringify(message));
    setNewMessage(<span class="hljs-string">""</span>);
  };

  <span class="hljs-keyword">const</span> getStatusColor = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (connectionStatus) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"connected"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"green"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"connecting"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"orange"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"error"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"red"</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"gray"</span>;
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"real-time-chat"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chat-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Chat Room: {roomId}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"connection-status"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">"status-indicator"</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">getStatusColor</span>() }}
          /&gt;</span>
          {connectionStatus}
          {reconnectAttemptsRef.current &gt; 0 &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span> (Attempt {reconnectAttemptsRef.current})<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"messages"</span>&gt;</span>
        {messages.map((message) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{message.id}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">message</span> ${<span class="hljs-attr">message.userId</span> === <span class="hljs-string">userId</span> ? "<span class="hljs-attr">own</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">other</span>"}`}
          &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-header"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-id"</span>&gt;</span>{message.userId}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"timestamp"</span>&gt;</span>
                {message.timestamp.toLocaleTimeString()}
              <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-text"</span>&gt;</span>{message.text}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{sendMessage}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-form"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{newMessage}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setNewMessage(e.target.value)}
          placeholder="Type a message..."
          disabled={connectionStatus !== "connected"}
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>
          <span class="hljs-attr">disabled</span>=<span class="hljs-string">{connectionStatus</span> !== <span class="hljs-string">"connected"</span> || !<span class="hljs-attr">newMessage.trim</span>()}
        &gt;</span>
          Send
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>

      {connectionStatus === "error" &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{connectWebSocket}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"reconnect-button"</span>&gt;</span>
          Reconnect
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%AF-when-and-why-useeffect-decision-framework">🎯 When and Why: useEffect Decision Framework</h2>
<h3 id="quick-decision-tree">Quick Decision Tree</h3>
<pre class="hljs"><code><div>🤔 Do I need useEffect?

├── Is this for side effects? (API calls, subscriptions, DOM manipulation)
│   ├── Yes → Continue...
│   └── No → Use regular variables or useMemo/useCallback
│
├── When should it run?
│   ├── Once on mount → useEffect(() =&gt; {}, [])
│   ├── On every render → useEffect(() =&gt; {})
│   ├── When specific values change → useEffect(() =&gt; {}, [dep1, dep2])
│   └── Conditionally → Add condition inside effect
│
├── Does it need cleanup?
│   ├── Timers → Yes, clear them
│   ├── Event listeners → Yes, remove them
│   ├── Subscriptions → Yes, unsubscribe
│   ├── Network requests → Yes, abort them
│   └── DOM modifications → Yes, revert them
│
└── Are dependencies correct?
    ├── Include all values from component scope used inside effect
    ├── Use ESLint plugin to catch missing dependencies
    └── Consider useCallback/useMemo for stable references
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<ol>
<li>
<p><strong>&quot;Explain the useEffect dependency array&quot;</strong></p>
<ul>
<li>No array: runs after every render</li>
<li>Empty array: runs once on mount</li>
<li>With dependencies: runs when dependencies change</li>
<li>Show examples of each pattern</li>
</ul>
</li>
<li>
<p><strong>&quot;What happens if you don't clean up effects?&quot;</strong></p>
<ul>
<li>Memory leaks from timers and event listeners</li>
<li>Stale closures and race conditions</li>
<li>Performance degradation</li>
<li>Show before/after cleanup examples</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you handle async operations in useEffect?&quot;</strong></p>
<ul>
<li>Can't make useEffect async directly</li>
<li>Create async function inside effect</li>
<li>Use AbortController for cleanup</li>
<li>Handle race conditions</li>
</ul>
</li>
<li>
<p><strong>&quot;What's the difference between useEffect and useLayoutEffect?&quot;</strong></p>
<ul>
<li>useEffect: runs after DOM updates (asynchronous)</li>
<li>useLayoutEffect: runs before DOM updates (synchronous)</li>
<li>Use useLayoutEffect for DOM measurements</li>
</ul>
</li>
</ol>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🚨 Red Flags in Interviews:</span>

<span class="hljs-comment">// ❌ Missing cleanup</span>
useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {}, <span class="hljs-number">1000</span>); <span class="hljs-comment">// No cleanup!</span>
}, []);

<span class="hljs-comment">// ❌ Missing dependencies</span>
useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(someVariable); <span class="hljs-comment">// Uses someVariable but not in deps</span>
}, []);

<span class="hljs-comment">// ❌ Infinite loop</span>
useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  setSomeState({}); <span class="hljs-comment">// Creates new object every time</span>
}, [someState]);

<span class="hljs-comment">// ❌ Async useEffect</span>
useEffect(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-comment">// Don't do this!</span>
  <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api"</span>);
}, []);

<span class="hljs-comment">// ❌ Effect for derived state</span>
useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  setFullName(firstName + lastName); <span class="hljs-comment">// Should be calculated during render</span>
}, [firstName, lastName]);
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<h3 id="mental-model">Mental Model</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🧠 Think of useEffect as:</span>

<span class="hljs-comment">// "After React finishes updating the DOM,</span>
<span class="hljs-comment">//  run this side effect if any of these</span>
<span class="hljs-comment">//  dependencies have changed since last time"</span>

useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// Side effect code here</span>

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Cleanup code here</span>
    <span class="hljs-comment">// Runs before next effect or unmount</span>
  };
}, [dependency1, dependency2]); <span class="hljs-comment">// When to run</span>
</div></code></pre>
<h3 id="best-practices-summary">Best Practices Summary</h3>
<ol>
<li><strong>Always include dependencies</strong> that are used inside the effect</li>
<li><strong>Always clean up</strong> timers, listeners, and subscriptions</li>
<li><strong>Use AbortController</strong> for fetch requests</li>
<li><strong>Prefer functional updates</strong> to avoid stale closures</li>
<li><strong>Don't use effects for derived state</strong> - calculate during render</li>
<li><strong>Use custom hooks</strong> to encapsulate complex effect logic</li>
<li><strong>Test your cleanup</strong> by rapidly mounting/unmounting components</li>
</ol>
<hr>
<p><strong>Next up</strong>: <a href="./08-useRef-refs-vs-variables.md">useRef: Refs vs Variables</a> - Master direct DOM access and mutable values that don't trigger re-renders.</p>
<p><strong>Previous</strong>: <a href="./06-controlled-vs-uncontrolled-inputs.md">Controlled vs Uncontrolled Inputs</a></p>
<hr>
<p><em>💡 Pro tip: In interviews, always explain your dependency choices and demonstrate understanding of cleanup. Show that you can prevent memory leaks and handle edge cases.</em></p>
<h1 id="%F0%9F%8E%AF-useref-refs-vs-variables-deep-dive">🎯 useRef: Refs vs Variables Deep Dive</h1>
<blockquote>
<p><strong>Master React's escape hatch: Direct DOM access, mutable values, and when refs are better than state</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>Understanding refs vs regular variables vs state</li>
<li>Direct DOM manipulation and focus management</li>
<li>Storing mutable values that don't trigger re-renders</li>
<li>Ref forwarding and imperative APIs</li>
<li>Common ref patterns and anti-patterns</li>
<li>Performance optimizations with refs</li>
<li>Real-world scenarios and best practices</li>
</ul>
<h2 id="%F0%9F%8E%AF-understanding-useref-fundamentals">🎯 Understanding useRef Fundamentals</h2>
<h3 id="refs-vs-state-vs-variables">Refs vs State vs Variables</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RefVsStateVsVariables</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// 🎯 State: Triggers re-render when changed</span>
  <span class="hljs-keyword">const</span> [stateValue, setStateValue] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// 🎯 Ref: Persists between renders, doesn't trigger re-render</span>
  <span class="hljs-keyword">const</span> refValue = useRef(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// ❌ Regular variable: Gets reset on every render</span>
  <span class="hljs-keyword">let</span> regularVariable = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// 🎯 Ref for tracking render count</span>
  <span class="hljs-keyword">const</span> renderCount = useRef(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// Increment render count on every render</span>
  renderCount.current += <span class="hljs-number">1</span>;

  <span class="hljs-keyword">const</span> handleStateIncrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setStateValue(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>); <span class="hljs-comment">// ✅ Triggers re-render</span>
  };

  <span class="hljs-keyword">const</span> handleRefIncrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    refValue.current += <span class="hljs-number">1</span>; <span class="hljs-comment">// ✅ Persists but no re-render</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Ref value:"</span>, refValue.current);
  };

  <span class="hljs-keyword">const</span> handleVariableIncrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    regularVariable += <span class="hljs-number">1</span>; <span class="hljs-comment">// ❌ Will be reset on next render</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Variable value:"</span>, regularVariable);
  };

  <span class="hljs-keyword">const</span> forceRerender = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setStateValue(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev); <span class="hljs-comment">// Force re-render without changing state</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"ref-comparison"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Refs vs State vs Variables<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"render-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Render count:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {renderCount.current}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"value-display"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"state-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>State Value (triggers re-render)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current value: {stateValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleStateIncrement}</span>&gt;</span>Increment State<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"ref-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Ref Value (persists, no re-render)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current value: {refValue.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleRefIncrement}</span>&gt;</span>Increment Ref<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Check console for actual value<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"variable-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Regular Variable (resets each render)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current value: {regularVariable}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleVariableIncrement}</span>&gt;</span>Increment Variable<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Always resets to 0<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{forceRerender}</span>&gt;</span>Force Re-render<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
            console.log("Current values:");
            console.log("State:", stateValue);
            console.log("Ref:", refValue.current);
            console.log("Variable:", regularVariable);
          }}
        &gt;
          Log All Values
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"explanation"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Key Differences:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>State:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Triggers re-render, UI updates automatically
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Ref:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Persists between renders, no re-render, manual
            UI updates
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Variable:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Resets on every render, loses value
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="dom-refs-and-element-access">DOM Refs and Element Access</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DOMRefExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// 🎯 Refs for DOM elements</span>
  <span class="hljs-keyword">const</span> inputRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> textareaRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> divRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> videoRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// 🎯 Refs for storing DOM measurements</span>
  <span class="hljs-keyword">const</span> measurementsRef = useRef({ <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">0</span> });

  <span class="hljs-keyword">const</span> [measurements, setMeasurements] = useState({ <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">0</span> });
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [isPlaying, setIsPlaying] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// 🎯 Focus management</span>
  <span class="hljs-keyword">const</span> focusInput = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (inputRef.current) {
      inputRef.current.focus();
      inputRef.current.select(); <span class="hljs-comment">// Select all text</span>
    }
  };

  <span class="hljs-keyword">const</span> clearAndFocus = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setInputValue(<span class="hljs-string">""</span>);
    <span class="hljs-comment">// Focus after state update</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (inputRef.current) {
        inputRef.current.focus();
      }
    }, <span class="hljs-number">0</span>);
  };

  <span class="hljs-comment">// 🎯 Scroll management</span>
  <span class="hljs-keyword">const</span> scrollToTop = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (divRef.current) {
      divRef.current.scrollTop = <span class="hljs-number">0</span>;
    }
  };

  <span class="hljs-keyword">const</span> scrollToBottom = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (divRef.current) {
      divRef.current.scrollTop = divRef.current.scrollHeight;
    }
  };

  <span class="hljs-comment">// 🎯 Measurements</span>
  <span class="hljs-keyword">const</span> measureElement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (divRef.current) {
      <span class="hljs-keyword">const</span> rect = divRef.current.getBoundingClientRect();
      <span class="hljs-keyword">const</span> newMeasurements = {
        <span class="hljs-attr">width</span>: rect.width,
        <span class="hljs-attr">height</span>: rect.height,
        <span class="hljs-attr">top</span>: rect.top,
        <span class="hljs-attr">left</span>: rect.left,
      };

      <span class="hljs-comment">// Store in ref (doesn't trigger re-render)</span>
      measurementsRef.current = newMeasurements;

      <span class="hljs-comment">// Update state to show in UI</span>
      setMeasurements(newMeasurements);
    }
  };

  <span class="hljs-comment">// 🎯 Video control</span>
  <span class="hljs-keyword">const</span> toggleVideo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (videoRef.current) {
      <span class="hljs-keyword">if</span> (isPlaying) {
        videoRef.current.pause();
      } <span class="hljs-keyword">else</span> {
        videoRef.current.play();
      }
      setIsPlaying(!isPlaying);
    }
  };

  <span class="hljs-keyword">const</span> setVideoTime = <span class="hljs-function">(<span class="hljs-params">seconds</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (videoRef.current) {
      videoRef.current.currentTime = seconds;
    }
  };

  <span class="hljs-comment">// 🎯 Text manipulation</span>
  <span class="hljs-keyword">const</span> insertTextAtCursor = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (textareaRef.current) {
      <span class="hljs-keyword">const</span> textarea = textareaRef.current;
      <span class="hljs-keyword">const</span> start = textarea.selectionStart;
      <span class="hljs-keyword">const</span> end = textarea.selectionEnd;
      <span class="hljs-keyword">const</span> currentValue = textarea.value;

      <span class="hljs-keyword">const</span> newValue =
        currentValue.substring(<span class="hljs-number">0</span>, start) + text + currentValue.substring(end);
      textarea.value = newValue;

      <span class="hljs-comment">// Set cursor position after inserted text</span>
      <span class="hljs-keyword">const</span> newCursorPos = start + text.length;
      textarea.setSelectionRange(newCursorPos, newCursorPos);
      textarea.focus();
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dom-ref-examples"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>DOM Refs and Element Access<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Input Focus Management */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"input-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Input Focus Management<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setInputValue(e.target.value)}
          placeholder="Type something..."
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"input-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{focusInput}</span>&gt;</span>Focus &amp; Select<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearAndFocus}</span>&gt;</span>Clear &amp; Focus<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
              if (inputRef.current) {
                inputRef.current.blur();
              }
            }}
          &gt;
            Blur
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Textarea with Text Insertion */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"textarea-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Textarea Manipulation<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{textareaRef}</span>
          <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span>
          <span class="hljs-attr">cols</span>=<span class="hljs-string">{50}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Click buttons to insert text at cursor..."</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"textarea-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> insertTextAtCursor("Hello ")}&gt;
            Insert "Hello "
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> insertTextAtCursor("World!")}&gt;
            Insert "World!"
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> insertTextAtCursor("\n")}&gt;
            Insert New Line
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
              if (textareaRef.current) {
                textareaRef.current.value = "";
                textareaRef.current.focus();
              }
            }}
          &gt;
            Clear
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Scrollable Div */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"scroll-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Scroll Management<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{divRef}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"scrollable-div"</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">height:</span> "<span class="hljs-attr">150px</span>",
            <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>",
            <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>",
            <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>",
          }}
        &gt;</span>
          {Array.from({ length: 50 }, (_, i) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{i}</span>&gt;</span>Line {i + 1} - This is some scrollable content<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"scroll-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{scrollToTop}</span>&gt;</span>Scroll to Top<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{scrollToBottom}</span>&gt;</span>Scroll to Bottom<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{measureElement}</span>&gt;</span>Measure Element<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Measurements Display */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"measurements-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Element Measurements<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(measurements, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Video Control */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"video-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Video Control<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">video</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{videoRef}</span>
          <span class="hljs-attr">width</span>=<span class="hljs-string">"300"</span>
          <span class="hljs-attr">height</span>=<span class="hljs-string">"200"</span>
          <span class="hljs-attr">controls</span>=<span class="hljs-string">{false}</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>" }}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">source</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/sample-video.mp4"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"video/mp4"</span> /&gt;</span>
          Your browser does not support the video tag.
        <span class="hljs-tag">&lt;/<span class="hljs-name">video</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"video-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleVideo}</span>&gt;</span>{isPlaying ? "Pause" : "Play"}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setVideoTime(0)}&gt;Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setVideoTime(10)}&gt;Skip to 10s<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-mutable-values-and-performance">🔄 Mutable Values and Performance</h2>
<h3 id="using-refs-for-mutable-values">Using Refs for Mutable Values</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MutableValueExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [messages, setMessages] = useState([]);

  <span class="hljs-comment">// 🎯 Refs for values that don't need to trigger re-renders</span>
  <span class="hljs-keyword">const</span> timerIdRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> previousCountRef = useRef(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> callbackCountRef = useRef(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> isComponentMountedRef = useRef(<span class="hljs-literal">true</span>);

  <span class="hljs-comment">// 🎯 Ref for storing expensive calculations</span>
  <span class="hljs-keyword">const</span> expensiveValueRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> lastCalculationInputRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// 🎯 Track previous value</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    previousCountRef.current = count;
  });

  <span class="hljs-comment">// 🎯 Cleanup on unmount</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      isComponentMountedRef.current = <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (timerIdRef.current) {
        clearInterval(timerIdRef.current);
      }
    };
  }, []);

  <span class="hljs-keyword">const</span> startTimer = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (timerIdRef.current) {
      clearInterval(timerIdRef.current);
    }

    timerIdRef.current = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-comment">// ✅ Check if component is still mounted</span>
      <span class="hljs-keyword">if</span> (isComponentMountedRef.current) {
        setCount(<span class="hljs-function">(<span class="hljs-params">prevCount</span>) =&gt;</span> prevCount + <span class="hljs-number">1</span>);
      }
    }, <span class="hljs-number">1000</span>);
  };

  <span class="hljs-keyword">const</span> stopTimer = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (timerIdRef.current) {
      clearInterval(timerIdRef.current);
      timerIdRef.current = <span class="hljs-literal">null</span>;
    }
  };

  <span class="hljs-comment">// 🎯 Expensive calculation with caching</span>
  <span class="hljs-keyword">const</span> getExpensiveValue = <span class="hljs-function">(<span class="hljs-params">input</span>) =&gt;</span> {
    <span class="hljs-comment">// Only recalculate if input changed</span>
    <span class="hljs-keyword">if</span> (lastCalculationInputRef.current !== input) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Performing expensive calculation..."</span>);

      <span class="hljs-comment">// Simulate expensive operation</span>
      <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; input * <span class="hljs-number">1000000</span>; i++) {
        result += <span class="hljs-built_in">Math</span>.random();
      }

      expensiveValueRef.current = result;
      lastCalculationInputRef.current = input;
    }

    <span class="hljs-keyword">return</span> expensiveValueRef.current;
  };

  <span class="hljs-comment">// 🎯 Callback with ref to avoid stale closures</span>
  <span class="hljs-keyword">const</span> handleAsyncOperation = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    callbackCountRef.current += <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> currentCallCount = callbackCountRef.current;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Starting async operation #<span class="hljs-subst">${currentCallCount}</span>`</span>);

    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-comment">// ✅ Check if this is still the latest call</span>
      <span class="hljs-keyword">if</span> (
        callbackCountRef.current === currentCallCount &amp;&amp;
        isComponentMountedRef.current
      ) {
        setMessages(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [
          ...prev,
          {
            <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
            <span class="hljs-attr">text</span>: <span class="hljs-string">`Async operation #<span class="hljs-subst">${currentCallCount}</span> completed`</span>,
            <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toLocaleTimeString(),
          },
        ]);
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Async operation #<span class="hljs-subst">${currentCallCount}</span> was superseded`</span>);
      }
    }, <span class="hljs-number">2000</span>);
  }, []);

  <span class="hljs-keyword">const</span> clearMessages = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setMessages([]);
  };

  <span class="hljs-keyword">const</span> expensiveValue = getExpensiveValue(count);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"mutable-value-examples"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Mutable Values with Refs<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"counter-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Timer with Ref Management<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Previous count: {previousCountRef.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Change: {count - previousCountRef.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"timer-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{startTimer}</span>&gt;</span>Start Timer<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{stopTimer}</span>&gt;</span>Stop Timer<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(0)}&gt;Reset Count<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"expensive-calculation"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Cached Expensive Calculation<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Input: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          Expensive result: {expensiveValue?.toFixed(2) || "Not calculated"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Check console - calculation only runs when count changes<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"async-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Async Operations with Race Condition Prevention<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleAsyncOperation}</span>&gt;</span>
          Start Async Operation (2s delay)
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Callback count: {callbackCountRef.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"messages"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Messages:<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
          {messages.length === 0 ? (
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>No messages yet<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          ) : (
            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
              {messages.map((message) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{message.id}</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>{message.timestamp}:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {message.text}
                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
              ))}
            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
          )}
          {messages.length &gt; 0 &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearMessages}</span>&gt;</span>Clear Messages<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"ref-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Ref Usage Summary:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>timerIdRef<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>: Stores timer ID for cleanup
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>previousCountRef<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>: Tracks previous state value
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>callbackCountRef<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>: Prevents race conditions
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>isComponentMountedRef<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>: Prevents state updates after
            unmount
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>expensiveValueRef<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>: Caches expensive calculations
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="performance-optimization-with-refs">Performance Optimization with Refs</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PerformanceOptimizationWithRefs</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState(
    <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, (_, i) =&gt; ({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
      <span class="hljs-attr">selected</span>: <span class="hljs-literal">false</span>,
    }))
  );
  <span class="hljs-keyword">const</span> [filter, setFilter] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// 🎯 Refs for performance optimization</span>
  <span class="hljs-keyword">const</span> selectedItemsRef = useRef(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());
  <span class="hljs-keyword">const</span> lastFilterRef = useRef(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> filteredItemsRef = useRef([]);
  <span class="hljs-keyword">const</span> renderCountRef = useRef(<span class="hljs-number">0</span>);

  renderCountRef.current += <span class="hljs-number">1</span>;

  <span class="hljs-comment">// 🎯 Memoized filtered items with ref caching</span>
  <span class="hljs-keyword">const</span> filteredItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Only recalculate if filter actually changed</span>
    <span class="hljs-keyword">if</span> (
      lastFilterRef.current === filter &amp;&amp;
      filteredItemsRef.current.length &gt; <span class="hljs-number">0</span>
    ) {
      <span class="hljs-keyword">return</span> filteredItemsRef.current;
    }

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Filtering items..."</span>);
    <span class="hljs-keyword">const</span> result = items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
      item.name.toLowerCase().includes(filter.toLowerCase())
    );

    lastFilterRef.current = filter;
    filteredItemsRef.current = result;

    <span class="hljs-keyword">return</span> result;
  }, [items, filter]);

  <span class="hljs-comment">// 🎯 Optimized selection handling</span>
  <span class="hljs-keyword">const</span> toggleItemSelection = useCallback(<span class="hljs-function">(<span class="hljs-params">itemId</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> selectedItems = selectedItemsRef.current;

    <span class="hljs-keyword">if</span> (selectedItems.has(itemId)) {
      selectedItems.delete(itemId);
    } <span class="hljs-keyword">else</span> {
      selectedItems.add(itemId);
    }

    <span class="hljs-comment">// Update items state</span>
    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.id === itemId
          ? { ...item, <span class="hljs-attr">selected</span>: selectedItems.has(itemId) }
          : item
      )
    );
  }, []);

  <span class="hljs-keyword">const</span> selectAll = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> selectedItems = selectedItemsRef.current;
    selectedItems.clear();

    filteredItems.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      selectedItems.add(item.id);
    });

    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
        ...item,
        <span class="hljs-attr">selected</span>: selectedItems.has(item.id),
      }))
    );
  };

  <span class="hljs-keyword">const</span> clearSelection = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    selectedItemsRef.current.clear();

    setItems(<span class="hljs-function">(<span class="hljs-params">prevItems</span>) =&gt;</span>
      prevItems.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({ ...item, <span class="hljs-attr">selected</span>: <span class="hljs-literal">false</span> }))
    );
  };

  <span class="hljs-keyword">const</span> getSelectionCount = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> selectedItemsRef.current.size;
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-optimization"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Performance Optimization with Refs<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Render count: {renderCountRef.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Total items: {items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Filtered items: {filteredItems.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Selected items: {getSelectionCount()}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{filter}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFilter(e.target.value)}
          placeholder="Filter items..."
        /&gt;

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"selection-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{selectAll}</span>&gt;</span>Select All Filtered<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearSelection}</span>&gt;</span>Clear Selection<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"items-list"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> "<span class="hljs-attr">300px</span>", <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>" }}&gt;</span>
        {filteredItems.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">item</span> ${<span class="hljs-attr">item.selected</span> ? "<span class="hljs-attr">selected</span>" <span class="hljs-attr">:</span> ""}`}
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleItemSelection(item.id)}
            style={{
              padding: "5px",
              cursor: "pointer",
              backgroundColor: item.selected ? "#e3f2fd" : "transparent",
            }}
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
              <span class="hljs-attr">checked</span>=<span class="hljs-string">{item.selected}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> {}} // Handled by parent click
            /&gt;
            {item.name}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"optimization-notes"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Optimization Techniques Used:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>selectedItemsRef:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Tracks selection without
            triggering re-renders
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>filteredItemsRef:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Caches filtered results
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>lastFilterRef:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Prevents unnecessary filtering
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>useMemo:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Memoizes expensive filtering operation
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>useCallback:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Prevents function recreation
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-ref-forwarding-and-imperative-apis">🔄 Ref Forwarding and Imperative APIs</h2>
<h3 id="ref-forwarding-patterns">Ref Forwarding Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Basic ref forwarding</span>
<span class="hljs-keyword">const</span> CustomInput = forwardRef(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> { label, error, ...inputProps } = props;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"custom-input"</span>&gt;</span>
      {label &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>{label}<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>}
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{ref}</span> {<span class="hljs-attr">...inputProps</span>} /&gt;</span>
      {error &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>{error}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// 🎯 Advanced ref forwarding with imperative API</span>
<span class="hljs-keyword">const</span> AdvancedInput = forwardRef(<span class="hljs-function">(<span class="hljs-params">props, ref</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> { onValueChange, ...otherProps } = props;
  <span class="hljs-keyword">const</span> inputRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [value, setValue] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// 🎯 Expose imperative API</span>
  useImperativeHandle(
    ref,
    () =&gt; ({
      <span class="hljs-attr">focus</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        inputRef.current?.focus();
      },
      <span class="hljs-attr">blur</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        inputRef.current?.blur();
      },
      <span class="hljs-attr">clear</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        setValue(<span class="hljs-string">""</span>);
        inputRef.current?.focus();
      },
      <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> value,
      <span class="hljs-attr">setValue</span>: <span class="hljs-function">(<span class="hljs-params">newValue</span>) =&gt;</span> {
        setValue(newValue);
      },
      <span class="hljs-attr">selectAll</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        inputRef.current?.select();
      },
      <span class="hljs-attr">insertAtCursor</span>: <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> input = inputRef.current;
        <span class="hljs-keyword">if</span> (input) {
          <span class="hljs-keyword">const</span> start = input.selectionStart;
          <span class="hljs-keyword">const</span> end = input.selectionEnd;
          <span class="hljs-keyword">const</span> newValue =
            value.substring(<span class="hljs-number">0</span>, start) + text + value.substring(end);
          setValue(newValue);

          <span class="hljs-comment">// Set cursor position after inserted text</span>
          setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            <span class="hljs-keyword">const</span> newPos = start + text.length;
            input.setSelectionRange(newPos, newPos);
          }, <span class="hljs-number">0</span>);
        }
      },
    }),
    [value]
  );

  <span class="hljs-keyword">const</span> handleChange = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newValue = e.target.value;
    setValue(newValue);
    onValueChange?.(newValue);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
      {<span class="hljs-attr">...otherProps</span>}
    /&gt;</span></span>
  );
});

<span class="hljs-comment">// 🎯 Modal component with ref forwarding</span>
<span class="hljs-keyword">const</span> Modal = forwardRef(<span class="hljs-function">(<span class="hljs-params">{ children, title, onClose }, ref</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [isOpen, setIsOpen] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> modalRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> previousFocusRef = useRef(<span class="hljs-literal">null</span>);

  useImperativeHandle(
    ref,
    () =&gt; ({
      <span class="hljs-attr">open</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        previousFocusRef.current = <span class="hljs-built_in">document</span>.activeElement;
        setIsOpen(<span class="hljs-literal">true</span>);
      },
      <span class="hljs-attr">close</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        setIsOpen(<span class="hljs-literal">false</span>);
        previousFocusRef.current?.focus();
      },
      <span class="hljs-attr">isOpen</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> isOpen,
    }),
    [isOpen]
  );

  <span class="hljs-comment">// 🎯 Focus management</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (isOpen &amp;&amp; modalRef.current) {
      modalRef.current.focus();
    }
  }, [isOpen]);

  <span class="hljs-comment">// 🎯 Escape key handling</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleEscape = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">"Escape"</span> &amp;&amp; isOpen) {
        setIsOpen(<span class="hljs-literal">false</span>);
        onClose?.();
      }
    };

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleEscape);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleEscape);
  }, [isOpen, onClose]);

  <span class="hljs-keyword">if</span> (!isOpen) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-overlay"</span>
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
        setIsOpen(false);
        onClose?.();
      }}
    &gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">{modalRef}</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{(e)</span> =&gt;</span> e.stopPropagation()}
        tabIndex={-1}
      &gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{title}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
              setIsOpen(false);
              onClose?.();
            }}
          &gt;
            ×
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RefForwardingExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> customInputRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> advancedInputRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> modalRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"ref-forwarding-examples"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Ref Forwarding Examples<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Basic ref forwarding */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"basic-forwarding"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Basic Ref Forwarding<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">CustomInput</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{customInputRef}</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Custom Input"</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Type something..."</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> customInputRef.current?.focus()}&gt;
          Focus Custom Input
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Advanced ref forwarding with imperative API */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"advanced-forwarding"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Advanced Ref Forwarding (Imperative API)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">AdvancedInput</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{advancedInputRef}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Advanced input..."</span>
          <span class="hljs-attr">onValueChange</span>=<span class="hljs-string">{setInputValue}</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Current value: {inputValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"advanced-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> advancedInputRef.current?.focus()}&gt;
            Focus
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> advancedInputRef.current?.clear()}&gt;
            Clear
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> advancedInputRef.current?.selectAll()}&gt;
            Select All
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span>
              advancedInputRef.current?.insertAtCursor(" [INSERTED] ")
            }
          &gt;
            Insert Text
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
              const value = advancedInputRef.current?.getValue();
              alert(`Current value: ${value}`);
            }}
          &gt;
            Get Value
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Modal with ref forwarding */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-forwarding"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Modal with Ref Forwarding<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> modalRef.current?.open()}&gt;Open Modal<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Modal</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{modalRef}</span>
          <span class="hljs-attr">title</span>=<span class="hljs-string">"Example Modal"</span>
          <span class="hljs-attr">onClose</span>=<span class="hljs-string">{()</span> =&gt;</span> console.log("Modal closed")}
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is modal content.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Press Escape or click outside to close.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Focus is managed automatically"</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="custom-hooks-with-refs">Custom Hooks with Refs</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Custom hook for element visibility</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useIntersectionObserver</span>(<span class="hljs-params">options = {}</span>) </span>{
  <span class="hljs-keyword">const</span> [isIntersecting, setIsIntersecting] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [entry, setEntry] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> elementRef = useRef(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> element = elementRef.current;
    <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function">(<span class="hljs-params">[entry]</span>) =&gt;</span> {
      setIsIntersecting(entry.isIntersecting);
      setEntry(entry);
    }, options);

    observer.observe(element);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      observer.unobserve(element);
    };
  }, [options]);

  <span class="hljs-keyword">return</span> [elementRef, isIntersecting, entry];
}

<span class="hljs-comment">// 🎯 Custom hook for click outside</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useClickOutside</span>(<span class="hljs-params">callback</span>) </span>{
  <span class="hljs-keyword">const</span> ref = useRef(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (ref.current &amp;&amp; !ref.current.contains(event.target)) {
        callback();
      }
    };

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"mousedown"</span>, handleClick);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"mousedown"</span>, handleClick);
  }, [callback]);

  <span class="hljs-keyword">return</span> ref;
}

<span class="hljs-comment">// 🎯 Custom hook for hover</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useHover</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [isHovered, setIsHovered] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> ref = useRef(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> element = ref.current;
    <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> handleMouseEnter = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setIsHovered(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">const</span> handleMouseLeave = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setIsHovered(<span class="hljs-literal">false</span>);

    element.addEventListener(<span class="hljs-string">"mouseenter"</span>, handleMouseEnter);
    element.addEventListener(<span class="hljs-string">"mouseleave"</span>, handleMouseLeave);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      element.removeEventListener(<span class="hljs-string">"mouseenter"</span>, handleMouseEnter);
      element.removeEventListener(<span class="hljs-string">"mouseleave"</span>, handleMouseLeave);
    };
  }, []);

  <span class="hljs-keyword">return</span> [ref, isHovered];
}

<span class="hljs-comment">// 🎯 Custom hook for element size</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useElementSize</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [size, setSize] = useState({ <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">0</span> });
  <span class="hljs-keyword">const</span> ref = useRef(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> element = ref.current;
    <span class="hljs-keyword">if</span> (!element) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> resizeObserver = <span class="hljs-keyword">new</span> ResizeObserver(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> entry <span class="hljs-keyword">of</span> entries) {
        <span class="hljs-keyword">const</span> { width, height } = entry.contentRect;
        setSize({ width, height });
      }
    });

    resizeObserver.observe(element);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      resizeObserver.unobserve(element);
    };
  }, []);

  <span class="hljs-keyword">return</span> [ref, size];
}

<span class="hljs-comment">// Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CustomHookExamples</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [visibilityRef, isVisible] = useIntersectionObserver({
    <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.5</span>,
  });

  <span class="hljs-keyword">const</span> [hoverRef, isHovered] = useHover();
  <span class="hljs-keyword">const</span> [sizeRef, size] = useElementSize();

  <span class="hljs-keyword">const</span> [showDropdown, setShowDropdown] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> dropdownRef = useClickOutside(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setShowDropdown(<span class="hljs-literal">false</span>));

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"custom-hook-examples"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Custom Hooks with Refs<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Intersection Observer */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> "<span class="hljs-attr">200px</span>", <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>", <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>" }}
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> "<span class="hljs-attr">300px</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Scroll down to see the observed element...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{visibilityRef}</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>",
            <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">isVisible</span> ? "<span class="hljs-attr">lightgreen</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">lightcoral</span>",
            <span class="hljs-attr">transition:</span> "<span class="hljs-attr">background-color</span> <span class="hljs-attr">0.3s</span>",
          }}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This element is {isVisible ? "visible" : "not visible"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> "<span class="hljs-attr">300px</span>", <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>" }}&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>More content below...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Hover Detection */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">{hoverRef}</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>",
          <span class="hljs-attr">margin:</span> "<span class="hljs-attr">20px</span> <span class="hljs-attr">0</span>",
          <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">isHovered</span> ? "<span class="hljs-attr">lightblue</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">lightgray</span>",
          <span class="hljs-attr">transition:</span> "<span class="hljs-attr">background-color</span> <span class="hljs-attr">0.3s</span>",
          <span class="hljs-attr">cursor:</span> "<span class="hljs-attr">pointer</span>",
        }}
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Hover over me! Currently {isHovered ? "hovered" : "not hovered"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Element Size */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">{sizeRef}</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">padding:</span> "<span class="hljs-attr">20px</span>",
          <span class="hljs-attr">margin:</span> "<span class="hljs-attr">20px</span> <span class="hljs-attr">0</span>",
          <span class="hljs-attr">border:</span> "<span class="hljs-attr">2px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">333</span>",
          <span class="hljs-attr">resize:</span> "<span class="hljs-attr">both</span>",
          <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>",
          <span class="hljs-attr">minWidth:</span> "<span class="hljs-attr">200px</span>",
          <span class="hljs-attr">minHeight:</span> "<span class="hljs-attr">100px</span>",
        }}
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Resize me!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Width: {size.width.toFixed(0)}px<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Height: {size.height.toFixed(0)}px<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Click Outside */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dropdown-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowDropdown(!showDropdown)}&gt;
          Toggle Dropdown
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        {showDropdown &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">ref</span>=<span class="hljs-string">{dropdownRef}</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
              <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
              <span class="hljs-attr">top:</span> "<span class="hljs-attr">100</span>%",
              <span class="hljs-attr">left:</span> <span class="hljs-attr">0</span>,
              <span class="hljs-attr">backgroundColor:</span> "<span class="hljs-attr">white</span>",
              <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>",
              <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>",
              <span class="hljs-attr">zIndex:</span> <span class="hljs-attr">1000</span>,
            }}
          &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Click outside to close<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> alert("Button clicked!")}&gt;Action<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-using-refs-instead-of-state">1. Using Refs Instead of State</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Using ref for UI state</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WrongRefUsage</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> countRef = useRef(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> increment = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    countRef.current += <span class="hljs-number">1</span>;
    <span class="hljs-comment">// ❌ UI won't update because no re-render is triggered</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {countRef.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> {/* ❌ Won't update */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Use state for UI values</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CorrectStateUsage</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> increment = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>); <span class="hljs-comment">// ✅ Triggers re-render</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> {/* ✅ Updates correctly */}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-accessing-refs-during-render">2. Accessing Refs During Render</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Accessing ref.current during render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WrongRefAccess</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> inputRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// ❌ Don't access ref.current during render</span>
  <span class="hljs-keyword">const</span> inputValue = inputRef.current?.value || <span class="hljs-string">""</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Value: {inputValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span> {/* ❌ May be stale or null */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Access refs in effects or event handlers</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CorrectRefAccess</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> inputRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> handleGetValue = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// ✅ Access ref in event handler</span>
    <span class="hljs-keyword">const</span> value = inputRef.current?.value || <span class="hljs-string">""</span>;
    setInputValue(value);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{inputRef}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleGetValue}</span>&gt;</span>Get Value<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Value: {inputValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="3-not-handling-null-refs">3. Not Handling Null Refs</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Not checking for null</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UnsafeRefAccess</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> elementRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    elementRef.current.focus(); <span class="hljs-comment">// ❌ May throw error if null</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{elementRef}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Focus<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Always check for null</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SafeRefAccess</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> elementRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (elementRef.current) {
      <span class="hljs-comment">// ✅ Safe null check</span>
      elementRef.current.focus();
    }

    <span class="hljs-comment">// Or use optional chaining</span>
    elementRef.current?.focus(); <span class="hljs-comment">// ✅ Also safe</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{elementRef}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Focus<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="4-ref-callback-mistakes">4. Ref Callback Mistakes</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Inline ref callback</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">InlineRefCallback</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [elements, setElements] = useState([]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {[1, 2, 3].map((num) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{num}</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{(el)</span> =&gt;</span> {
            // ❌ Creates new function on every render
            if (el) {
              setElements((prev) =&gt; [...prev, el]);
            }
          }}
        /&gt;
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Stable ref callback</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StableRefCallback</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [elements, setElements] = useState([]);
  <span class="hljs-keyword">const</span> elementsRef = useRef([]);

  <span class="hljs-keyword">const</span> setElementRef = useCallback(
    <span class="hljs-function">(<span class="hljs-params">index</span>) =&gt;</span> <span class="hljs-function">(<span class="hljs-params">el</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (el) {
        elementsRef.current[index] = el;
      }
    },
    []
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {[1, 2, 3].map((num, index) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{num}</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{setElementRef(index)}</span> // ✅ <span class="hljs-attr">Stable</span> <span class="hljs-attr">callback</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-focus-management-system">Challenge 1: Focus Management System</h3>
<p>Build a focus management system that:</p>
<ul>
<li>Tracks focus history</li>
<li>Provides focus navigation (next/previous)</li>
<li>Handles focus trapping in modals</li>
<li>Restores focus when components unmount</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useFocusManager</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> focusHistoryRef = useRef([]);
  <span class="hljs-keyword">const</span> currentFocusIndexRef = useRef(<span class="hljs-number">-1</span>);
  <span class="hljs-keyword">const</span> trapContainerRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> isTrapActiveRef = useRef(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> addToHistory = useCallback(<span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (
      element &amp;&amp;
      element !== focusHistoryRef.current[currentFocusIndexRef.current]
    ) {
      focusHistoryRef.current.push(element);
      currentFocusIndexRef.current = focusHistoryRef.current.length - <span class="hljs-number">1</span>;
    }
  }, []);

  <span class="hljs-keyword">const</span> focusPrevious = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (currentFocusIndexRef.current &gt; <span class="hljs-number">0</span>) {
      currentFocusIndexRef.current -= <span class="hljs-number">1</span>;
      <span class="hljs-keyword">const</span> element = focusHistoryRef.current[currentFocusIndexRef.current];
      <span class="hljs-keyword">if</span> (element &amp;&amp; <span class="hljs-built_in">document</span>.contains(element)) {
        element.focus();
      }
    }
  }, []);

  <span class="hljs-keyword">const</span> focusNext = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (currentFocusIndexRef.current &lt; focusHistoryRef.current.length - <span class="hljs-number">1</span>) {
      currentFocusIndexRef.current += <span class="hljs-number">1</span>;
      <span class="hljs-keyword">const</span> element = focusHistoryRef.current[currentFocusIndexRef.current];
      <span class="hljs-keyword">if</span> (element &amp;&amp; <span class="hljs-built_in">document</span>.contains(element)) {
        element.focus();
      }
    }
  }, []);

  <span class="hljs-keyword">const</span> enableFocusTrap = useCallback(<span class="hljs-function">(<span class="hljs-params">container</span>) =&gt;</span> {
    trapContainerRef.current = container;
    isTrapActiveRef.current = <span class="hljs-literal">true</span>;

    <span class="hljs-keyword">const</span> handleKeyDown = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (
        e.key === <span class="hljs-string">"Tab"</span> &amp;&amp;
        isTrapActiveRef.current &amp;&amp;
        trapContainerRef.current
      ) {
        <span class="hljs-keyword">const</span> focusableElements = trapContainerRef.current.querySelectorAll(
          <span class="hljs-string">'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'</span>
        );

        <span class="hljs-keyword">const</span> firstElement = focusableElements[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">const</span> lastElement = focusableElements[focusableElements.length - <span class="hljs-number">1</span>];

        <span class="hljs-keyword">if</span> (e.shiftKey) {
          <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.activeElement === firstElement) {
            e.preventDefault();
            lastElement.focus();
          }
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.activeElement === lastElement) {
            e.preventDefault();
            firstElement.focus();
          }
        }
      }
    };

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);
      isTrapActiveRef.current = <span class="hljs-literal">false</span>;
    };
  }, []);

  <span class="hljs-keyword">const</span> disableFocusTrap = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    isTrapActiveRef.current = <span class="hljs-literal">false</span>;
    trapContainerRef.current = <span class="hljs-literal">null</span>;
  }, []);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleFocus = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!isTrapActiveRef.current) {
        addToHistory(e.target);
      }
    };

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"focusin"</span>, handleFocus);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"focusin"</span>, handleFocus);
    };
  }, [addToHistory]);

  <span class="hljs-keyword">return</span> {
    focusPrevious,
    focusNext,
    enableFocusTrap,
    disableFocusTrap,
    <span class="hljs-attr">getFocusHistory</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> focusHistoryRef.current,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FocusManagementDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { focusPrevious, focusNext, enableFocusTrap, disableFocusTrap } =
    useFocusManager();
  <span class="hljs-keyword">const</span> [showModal, setShowModal] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> modalRef = useRef(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (showModal &amp;&amp; modalRef.current) {
      <span class="hljs-keyword">const</span> cleanup = enableFocusTrap(modalRef.current);
      <span class="hljs-keyword">return</span> cleanup;
    } <span class="hljs-keyword">else</span> {
      disableFocusTrap();
    }
  }, [showModal, enableFocusTrap, disableFocusTrap]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"focus-management-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Focus Management System<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{focusPrevious}</span>&gt;</span>Focus Previous<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{focusNext}</span>&gt;</span>Focus Next<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowModal(true)}&gt;Open Modal<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Input 1"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Input 2"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Button 1<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Textarea"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Button 2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {showModal &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-overlay"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{modalRef}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal"</span> <span class="hljs-attr">tabIndex</span>=<span class="hljs-string">{-1}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Modal with Focus Trap<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Modal input 1"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Modal input 2"</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowModal(false)}&gt;Close<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Another Button<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-virtual-scrolling-with-refs">Challenge 2: Virtual Scrolling with Refs</h3>
<p>Create a virtual scrolling component that:</p>
<ul>
<li>Only renders visible items</li>
<li>Uses refs for scroll position tracking</li>
<li>Handles dynamic item heights</li>
<li>Maintains scroll position during updates</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useVirtualScroll</span>(<span class="hljs-params">{
  items,
  itemHeight,
  containerHeight,
  overscan = <span class="hljs-number">5</span>,
}</span>) </span>{
  <span class="hljs-keyword">const</span> scrollElementRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [scrollTop, setScrollTop] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [isScrolling, setIsScrolling] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> scrollTimeoutRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> startIndex = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, <span class="hljs-built_in">Math</span>.floor(scrollTop / itemHeight) - overscan);
  <span class="hljs-keyword">const</span> endIndex = <span class="hljs-built_in">Math</span>.min(
    items.length - <span class="hljs-number">1</span>,
    <span class="hljs-built_in">Math</span>.ceil((scrollTop + containerHeight) / itemHeight) + overscan
  );

  <span class="hljs-keyword">const</span> visibleItems = items
    .slice(startIndex, endIndex + <span class="hljs-number">1</span>)
    .map(<span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> ({
      ...item,
      <span class="hljs-attr">index</span>: startIndex + index,
    }));

  <span class="hljs-keyword">const</span> totalHeight = items.length * itemHeight;
  <span class="hljs-keyword">const</span> offsetY = startIndex * itemHeight;

  <span class="hljs-keyword">const</span> handleScroll = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    setScrollTop(e.target.scrollTop);
    setIsScrolling(<span class="hljs-literal">true</span>);

    <span class="hljs-keyword">if</span> (scrollTimeoutRef.current) {
      clearTimeout(scrollTimeoutRef.current);
    }

    scrollTimeoutRef.current = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setIsScrolling(<span class="hljs-literal">false</span>);
    }, <span class="hljs-number">150</span>);
  }, []);

  <span class="hljs-keyword">const</span> scrollToIndex = useCallback(
    <span class="hljs-function">(<span class="hljs-params">index</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (scrollElementRef.current) {
        <span class="hljs-keyword">const</span> scrollTop = index * itemHeight;
        scrollElementRef.current.scrollTop = scrollTop;
        setScrollTop(scrollTop);
      }
    },
    [itemHeight]
  );

  <span class="hljs-keyword">const</span> scrollToTop = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    scrollToIndex(<span class="hljs-number">0</span>);
  }, [scrollToIndex]);

  <span class="hljs-keyword">const</span> scrollToBottom = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    scrollToIndex(items.length - <span class="hljs-number">1</span>);
  }, [scrollToIndex, items.length]);

  <span class="hljs-keyword">return</span> {
    scrollElementRef,
    visibleItems,
    totalHeight,
    offsetY,
    handleScroll,
    scrollToIndex,
    scrollToTop,
    scrollToBottom,
    isScrolling,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">VirtualScrollDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> items = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
      <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, (_, i) =&gt; ({
        <span class="hljs-attr">id</span>: i,
        <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">`Description for item <span class="hljs-subst">${i}</span>`</span>,
      })),
    []
  );

  <span class="hljs-keyword">const</span> {
    scrollElementRef,
    visibleItems,
    totalHeight,
    offsetY,
    handleScroll,
    scrollToIndex,
    scrollToTop,
    scrollToBottom,
    isScrolling,
  } = useVirtualScroll({
    items,
    <span class="hljs-attr">itemHeight</span>: <span class="hljs-number">50</span>,
    <span class="hljs-attr">containerHeight</span>: <span class="hljs-number">400</span>,
  });

  <span class="hljs-keyword">const</span> [jumpToIndex, setJumpToIndex] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> handleJumpTo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> index = <span class="hljs-built_in">parseInt</span>(jumpToIndex);
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isNaN</span>(index) &amp;&amp; index &gt;= <span class="hljs-number">0</span> &amp;&amp; index &lt; items.length) {
      scrollToIndex(index);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"virtual-scroll-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Virtual Scrolling with Refs<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{scrollToTop}</span>&gt;</span>Scroll to Top<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{scrollToBottom}</span>&gt;</span>Scroll to Bottom<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"jump-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{jumpToIndex}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setJumpToIndex(e.target.value)}
            placeholder="Jump to index"
            min="0"
            max={items.length - 1}
          /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleJumpTo}</span>&gt;</span>Jump<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"scroll-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Total items: {items.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Visible items: {visibleItems.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Scrolling: {isScrolling ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">ref</span>=<span class="hljs-string">{scrollElementRef}</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">"virtual-scroll-container"</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">height:</span> "<span class="hljs-attr">400px</span>",
          <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>",
          <span class="hljs-attr">border:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">ccc</span>",
        }}
        <span class="hljs-attr">onScroll</span>=<span class="hljs-string">{handleScroll}</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">totalHeight</span>, <span class="hljs-attr">position:</span> "<span class="hljs-attr">relative</span>" }}&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
              <span class="hljs-attr">transform:</span> `<span class="hljs-attr">translateY</span>(${<span class="hljs-attr">offsetY</span>}<span class="hljs-attr">px</span>)`,
              <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
              <span class="hljs-attr">top:</span> <span class="hljs-attr">0</span>,
              <span class="hljs-attr">left:</span> <span class="hljs-attr">0</span>,
              <span class="hljs-attr">right:</span> <span class="hljs-attr">0</span>,
            }}
          &gt;</span>
            {visibleItems.map((item) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
                  <span class="hljs-attr">height:</span> "<span class="hljs-attr">50px</span>",
                  <span class="hljs-attr">padding:</span> "<span class="hljs-attr">10px</span>",
                  <span class="hljs-attr">borderBottom:</span> "<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> #<span class="hljs-attr">eee</span>",
                  <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>",
                  <span class="hljs-attr">alignItems:</span> "<span class="hljs-attr">center</span>",
                }}
              &gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>{item.description}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%AF-when-and-why-useref-decision-framework">🎯 When and Why: useRef Decision Framework</h2>
<h3 id="quick-decision-tree">Quick Decision Tree</h3>
<pre class="hljs"><code><div>🤔 Should I use useRef?

├── Do I need to access DOM elements directly?
│   ├── Yes → useRef for DOM reference ✅
│   └── No → Continue...
│
├── Do I need a value that persists but doesn't trigger re-renders?
│   ├── Yes → useRef for mutable value ✅
│   └── No → Continue...
│
├── Do I need to store timer IDs, intervals, or subscriptions?
│   ├── Yes → useRef for cleanup references ✅
│   └── No → Continue...
│
├── Do I need to track previous values?
│   ├── Yes → useRef for previous state ✅
│   └── No → Continue...
│
├── Do I need to prevent stale closures in effects?
│   ├── Yes → useRef for current values ✅
│   └── No → Use useState instead
│
└── Is this for UI state that should trigger re-renders?
    └── Yes → Use useState, not useRef ❌
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<ol>
<li>
<p><strong>&quot;What's the difference between useRef and useState?&quot;</strong></p>
<ul>
<li>useRef: Mutable, doesn't trigger re-renders, persists between renders</li>
<li>useState: Immutable updates, triggers re-renders, for UI state</li>
<li>Show examples of when to use each</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you access DOM elements in React?&quot;</strong></p>
<ul>
<li>Use useRef to create a ref</li>
<li>Attach ref to JSX element</li>
<li>Access via ref.current in effects or event handlers</li>
<li>Show focus management example</li>
</ul>
</li>
<li>
<p><strong>&quot;What is ref forwarding and when do you use it?&quot;</strong></p>
<ul>
<li>Passing refs through components to child elements</li>
<li>Use forwardRef and useImperativeHandle</li>
<li>Common in reusable component libraries</li>
<li>Show custom input component example</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you prevent memory leaks with refs?&quot;</strong></p>
<ul>
<li>Store cleanup functions (timers, subscriptions)</li>
<li>Check if component is mounted before state updates</li>
<li>Clean up in useEffect return function</li>
<li>Show timer cleanup example</li>
</ul>
</li>
</ol>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🚨 Red Flags in Interviews:</span>

<span class="hljs-comment">// ❌ Using ref for UI state</span>
<span class="hljs-keyword">const</span> countRef = useRef(<span class="hljs-number">0</span>);
<span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{countRef.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>; <span class="hljs-comment">// Won't update</span>

<span class="hljs-comment">// ❌ Accessing ref during render</span>
<span class="hljs-keyword">const</span> value = inputRef.current?.value; <span class="hljs-comment">// May be null/stale</span>

<span class="hljs-comment">// ❌ Not checking for null</span>
elementRef.current.focus(); <span class="hljs-comment">// May throw error</span>

<span class="hljs-comment">// ❌ Inline ref callbacks</span>
ref={(el) =&gt; { <span class="hljs-comment">/* new function every render */</span> }}

<span class="hljs-comment">// ❌ Forgetting cleanup</span>
<span class="hljs-keyword">const</span> timer = setInterval(...);
<span class="hljs-comment">// No cleanup in useEffect return</span>
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<h3 id="mental-model">Mental Model</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🧠 Think of useRef as:</span>

<span class="hljs-comment">// "A box that holds a value that:</span>
<span class="hljs-comment">//  - Persists between renders</span>
<span class="hljs-comment">//  - Doesn't trigger re-renders when changed</span>
<span class="hljs-comment">//  - Can hold any mutable value</span>
<span class="hljs-comment">//  - Is perfect for DOM access and cleanup"</span>

<span class="hljs-keyword">const</span> ref = useRef(initialValue);
<span class="hljs-comment">// ref.current = the actual value</span>
<span class="hljs-comment">// ref itself never changes</span>
</div></code></pre>
<h3 id="best-practices-summary">Best Practices Summary</h3>
<ol>
<li><strong>Use refs for DOM access</strong> - focus, scroll, measurements</li>
<li><strong>Use refs for mutable values</strong> - timers, counters, flags</li>
<li><strong>Always check for null</strong> - refs may be null initially</li>
<li><strong>Don't access refs during render</strong> - use effects or event handlers</li>
<li><strong>Use ref forwarding</strong> for reusable components</li>
<li><strong>Store cleanup references</strong> - prevent memory leaks</li>
<li><strong>Prefer useState for UI state</strong> - don't use refs for visible data</li>
</ol>
<hr>
<p><strong>Next up</strong>: <a href="./09-useMemo-what-when-why.md">useMemo: What, When, and Why</a> - Master performance optimization and expensive calculation caching.</p>
<p><strong>Previous</strong>: <a href="./07-useEffect-dependencies-cleanup.md">useEffect Dependencies &amp; Cleanup</a></p>
<hr>
<p><em>💡 Pro tip: In interviews, demonstrate understanding of when NOT to use refs. Show that you know the difference between mutable refs and immutable state, and always explain your choice.</em># 🚀 useMemo: What, When, and Why</p>
<blockquote>
<p><strong>Master React's performance optimization: Expensive calculations, object stability, and when memoization actually helps</strong></p>
</blockquote>
<h2 id="%F0%9F%8E%AF-what-youll-learn">🎯 What You'll Learn</h2>
<ul>
<li>Understanding useMemo fundamentals and when it's needed</li>
<li>Expensive calculation optimization patterns</li>
<li>Object and array reference stability</li>
<li>Dependency array best practices</li>
<li>Performance measurement and profiling</li>
<li>Common memoization mistakes and anti-patterns</li>
<li>Real-world optimization scenarios</li>
<li>Interview insights and best practices</li>
</ul>
<h2 id="%F0%9F%8E%AF-understanding-usememo-fundamentals">🎯 Understanding useMemo Fundamentals</h2>
<h3 id="what-is-usememo">What is useMemo?</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 useMemo caches the result of expensive calculations</span>
<span class="hljs-keyword">const</span> memoizedValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// Expensive calculation here</span>
  <span class="hljs-keyword">return</span> expensiveCalculation(dependencies);
}, [dependencies]);

<span class="hljs-comment">// 🎯 Basic syntax breakdown:</span>
<span class="hljs-comment">// useMemo(calculateValue, dependencies)</span>
<span class="hljs-comment">// - calculateValue: Function that returns the value to cache</span>
<span class="hljs-comment">// - dependencies: Array of values that trigger recalculation</span>
</div></code></pre>
<h3 id="when-react-re-calculates">When React Re-calculates</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MemoBasicsDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">"John"</span>);
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);

  <span class="hljs-comment">// 🎯 Without useMemo - runs on every render</span>
  <span class="hljs-keyword">const</span> expensiveCalculationWithoutMemo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🔴 Expensive calculation running (no memo)"</span>);
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
      result += <span class="hljs-built_in">Math</span>.random();
    }
    <span class="hljs-keyword">return</span> result;
  };

  <span class="hljs-comment">// 🎯 With useMemo - only runs when dependencies change</span>
  <span class="hljs-keyword">const</span> expensiveCalculationWithMemo = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🟢 Expensive calculation running (with memo)"</span>);
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
      result += <span class="hljs-built_in">Math</span>.random();
    }
    <span class="hljs-keyword">return</span> result;
  }, [count]); <span class="hljs-comment">// Only recalculates when count changes</span>

  <span class="hljs-comment">// 🎯 Array processing with memo</span>
  <span class="hljs-keyword">const</span> processedItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🟡 Processing items array"</span>);
    <span class="hljs-keyword">return</span> items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
      <span class="hljs-attr">id</span>: item,
      <span class="hljs-attr">value</span>: item * <span class="hljs-number">2</span>,
      <span class="hljs-attr">label</span>: <span class="hljs-string">`Item <span class="hljs-subst">${item}</span>`</span>,
      <span class="hljs-attr">isEven</span>: item % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>,
    }));
  }, [items]); <span class="hljs-comment">// Only recalculates when items array changes</span>

  <span class="hljs-comment">// 🎯 Complex object creation</span>
  <span class="hljs-keyword">const</span> userProfile = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🔵 Creating user profile object"</span>);
    <span class="hljs-keyword">return</span> {
      name,
      <span class="hljs-attr">displayName</span>: name.toUpperCase(),
      <span class="hljs-attr">initials</span>: name
        .split(<span class="hljs-string">" "</span>)
        .map(<span class="hljs-function">(<span class="hljs-params">n</span>) =&gt;</span> n[<span class="hljs-number">0</span>])
        .join(<span class="hljs-string">""</span>),
      <span class="hljs-attr">metadata</span>: {
        <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
        count,
        <span class="hljs-attr">hasItems</span>: items.length &gt; <span class="hljs-number">0</span>,
      },
    };
  }, [name, count, items.length]); <span class="hljs-comment">// Recalculates when any dependency changes</span>

  <span class="hljs-keyword">const</span> renderCount = useRef(<span class="hljs-number">0</span>);
  renderCount.current += <span class="hljs-number">1</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"memo-basics-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>useMemo Basics Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"render-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Render count:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {renderCount.current}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Check console to see when calculations run<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Count (affects memoized calculation):<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((c) =&gt; c + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Name (affects user profile):<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setName(e.target.value)}
            placeholder="Enter name"
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Items (affects processed items):<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setItems((prev) =&gt; [...prev, prev.length + 1])}
          &gt;
            Add Item
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setItems((prev) =&gt; prev.slice(0, -1))}&gt;
            Remove Item
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Force re-render (no state change):<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count)}&gt;Force Re-render<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"results"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Without Memo (runs every render)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Result: {expensiveCalculationWithoutMemo().toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>With Memo (runs only when count changes)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Result: {expensiveCalculationWithMemo.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Processed Items<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"items-grid"</span>&gt;</span>
            {processedItems.map((item) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
                <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
                <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">item</span> ${<span class="hljs-attr">item.isEven</span> ? "<span class="hljs-attr">even</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">odd</span>"}`}
              &gt;</span>
                {item.label}: {item.value}
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>User Profile<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(userProfile, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"explanation"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>What's Happening:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Without memo:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Calculation runs on every render
            (expensive!)
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>With memo:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Calculation only runs when dependencies
            change
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Processed items:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Only recalculates when items array
            changes
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>User profile:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Only recalculates when name, count,
            or items.length changes
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%92%B0-expensive-calculations">💰 Expensive Calculations</h2>
<h3 id="identifying-expensive-operations">Identifying Expensive Operations</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveCalculationsDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(
    <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, (_, i) =&gt; ({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>,
      <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>][<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>)],
    }))
  );

  <span class="hljs-keyword">const</span> [filterCategory, setFilterCategory] = useState(<span class="hljs-string">"all"</span>);
  <span class="hljs-keyword">const</span> [sortBy, setSortBy] = useState(<span class="hljs-string">"id"</span>);
  <span class="hljs-keyword">const</span> [searchTerm, setSearchTerm] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [threshold, setThreshold] = useState(<span class="hljs-number">50</span>);

  <span class="hljs-comment">// 🎯 Expensive filtering and sorting</span>
  <span class="hljs-keyword">const</span> processedData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Data processing"</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"🔄 Processing data..."</span>);

    <span class="hljs-keyword">let</span> result = data;

    <span class="hljs-comment">// Filter by category</span>
    <span class="hljs-keyword">if</span> (filterCategory !== <span class="hljs-string">"all"</span>) {
      result = result.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.category === filterCategory);
    }

    <span class="hljs-comment">// Filter by search term (expensive string operations)</span>
    <span class="hljs-keyword">if</span> (searchTerm) {
      result = result.filter(
        <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id.toString().includes(searchTerm) ||
          item.category.toLowerCase().includes(searchTerm.toLowerCase())
      );
    }

    <span class="hljs-comment">// Filter by threshold</span>
    result = result.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.value &gt;= threshold);

    <span class="hljs-comment">// Sort (expensive for large arrays)</span>
    result = result.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">switch</span> (sortBy) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"value"</span>:
          <span class="hljs-keyword">return</span> b.value - a.value;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"category"</span>:
          <span class="hljs-keyword">return</span> a.category.localeCompare(b.category);
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">return</span> a.id - b.id;
      }
    });

    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Data processing"</span>);
    <span class="hljs-keyword">return</span> result;
  }, [data, filterCategory, searchTerm, threshold, sortBy]);

  <span class="hljs-comment">// 🎯 Expensive statistical calculations</span>
  <span class="hljs-keyword">const</span> statistics = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Statistics calculation"</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"📊 Calculating statistics..."</span>);

    <span class="hljs-keyword">if</span> (processedData.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">average</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">max</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">median</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">standardDeviation</span>: <span class="hljs-number">0</span>,
      };
    }

    <span class="hljs-keyword">const</span> values = processedData.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.value);
    <span class="hljs-keyword">const</span> sum = values.reduce(<span class="hljs-function">(<span class="hljs-params">acc, val</span>) =&gt;</span> acc + val, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">const</span> average = sum / values.length;

    <span class="hljs-keyword">const</span> sortedValues = [...values].sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b);
    <span class="hljs-keyword">const</span> median =
      sortedValues.length % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>
        ? (sortedValues[sortedValues.length / <span class="hljs-number">2</span> - <span class="hljs-number">1</span>] +
            sortedValues[sortedValues.length / <span class="hljs-number">2</span>]) /
          <span class="hljs-number">2</span>
        : sortedValues[<span class="hljs-built_in">Math</span>.floor(sortedValues.length / <span class="hljs-number">2</span>)];

    <span class="hljs-keyword">const</span> variance =
      values.reduce(<span class="hljs-function">(<span class="hljs-params">acc, val</span>) =&gt;</span> acc + <span class="hljs-built_in">Math</span>.pow(val - average, <span class="hljs-number">2</span>), <span class="hljs-number">0</span>) /
      values.length;
    <span class="hljs-keyword">const</span> standardDeviation = <span class="hljs-built_in">Math</span>.sqrt(variance);

    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Statistics calculation"</span>);

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">count</span>: processedData.length,
      <span class="hljs-attr">average</span>: average.toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">min</span>: <span class="hljs-built_in">Math</span>.min(...values).toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">max</span>: <span class="hljs-built_in">Math</span>.max(...values).toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">median</span>: median.toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">standardDeviation</span>: standardDeviation.toFixed(<span class="hljs-number">2</span>),
    };
  }, [processedData]);

  <span class="hljs-comment">// 🎯 Expensive chart data preparation</span>
  <span class="hljs-keyword">const</span> chartData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Chart data preparation"</span>);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"📈 Preparing chart data..."</span>);

    <span class="hljs-comment">// Group by category and calculate averages</span>
    <span class="hljs-keyword">const</span> categoryGroups = processedData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!acc[item.category]) {
        acc[item.category] = [];
      }
      acc[item.category].push(item.value);
      <span class="hljs-keyword">return</span> acc;
    }, {});

    <span class="hljs-keyword">const</span> chartData = <span class="hljs-built_in">Object</span>.entries(categoryGroups).map(
      <span class="hljs-function">(<span class="hljs-params">[category, values]</span>) =&gt;</span> ({
        category,
        <span class="hljs-attr">average</span>: values.reduce(<span class="hljs-function">(<span class="hljs-params">sum, val</span>) =&gt;</span> sum + val, <span class="hljs-number">0</span>) / values.length,
        <span class="hljs-attr">count</span>: values.length,
        <span class="hljs-attr">min</span>: <span class="hljs-built_in">Math</span>.min(...values),
        <span class="hljs-attr">max</span>: <span class="hljs-built_in">Math</span>.max(...values),
      })
    );

    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Chart data preparation"</span>);
    <span class="hljs-keyword">return</span> chartData;
  }, [processedData]);

  <span class="hljs-keyword">const</span> addRandomData = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newItems = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, (_, i) =&gt; ({
      <span class="hljs-attr">id</span>: data.length + i,
      <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>,
      <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>][<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>)],
    }));
    setData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, ...newItems]);
  };

  <span class="hljs-keyword">const</span> resetData = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setData(
      <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, (_, i) =&gt; ({
        <span class="hljs-attr">id</span>: i,
        <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>,
        <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>][<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>)],
      }))
    );
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"expensive-calculations-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Expensive Calculations Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-note"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>📊 Performance Note:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Open DevTools Console to see
          timing information
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-row"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Filter Category:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{filterCategory}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFilterCategory(e.target.value)}
            &gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"all"</span>&gt;</span>All Categories<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"A"</span>&gt;</span>Category A<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"B"</span>&gt;</span>Category B<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"C"</span>&gt;</span>Category C<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Sort By:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{sortBy}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSortBy(e.target.value)}&gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"id"</span>&gt;</span>ID<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"value"</span>&gt;</span>Value (High to Low)<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"category"</span>&gt;</span>Category<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-row"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Search:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{searchTerm}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSearchTerm(e.target.value)}
              placeholder="Search by ID or category"
            /&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Minimum Value: {threshold}<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span>
              <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span>
              <span class="hljs-attr">max</span>=<span class="hljs-string">"100"</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{threshold}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setThreshold(Number(e.target.value))}
            /&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-row"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addRandomData}</span>&gt;</span>Add 1000 Random Items<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{resetData}</span>&gt;</span>Reset Data<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"results"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Data Summary<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Total items: {data.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Filtered items: {processedData.length}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Processing time: Check console<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Statistics<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats-grid"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Count:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {statistics.count}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Average:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {statistics.average}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Min:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {statistics.min}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Max:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {statistics.max}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Median:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {statistics.median}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Std Dev:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {statistics.standardDeviation}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Chart Data by Category<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-data"</span>&gt;</span>
            {chartData.map((item) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.category}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-item"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Category {item.category}<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {item.count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Average: {item.average.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
                  Range: {item.min.toFixed(2)} - {item.max.toFixed(2)}
                <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Sample Data (First 10 items)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-preview"</span>&gt;</span>
            {processedData.slice(0, 10).map((item) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-item"</span>&gt;</span>
                ID: {item.id}, Value: {item.value.toFixed(2)}, Category:{" "}
                {item.category}
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))}
            {processedData.length &gt; 10 &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>... and {processedData.length - 10} more items<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            )}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"optimization-notes"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Optimization Techniques Used:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Data Processing:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Memoized filtering, searching, and
            sorting
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Statistics:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Memoized complex mathematical
            calculations
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Chart Data:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Memoized data transformation for
            visualization
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Dependency Arrays:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Only recalculate when relevant
            inputs change
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%97-reference-stability">🔗 Reference Stability</h2>
<h3 id="object-and-array-reference-stability">Object and Array Reference Stability</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ReferenceStabilityDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">"John"</span>);
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-string">"apple"</span>, <span class="hljs-string">"banana"</span>, <span class="hljs-string">"cherry"</span>]);

  <span class="hljs-comment">// 🎯 Without useMemo - new object/array on every render</span>
  <span class="hljs-keyword">const</span> unstableConfig = {
    <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
    count,
    <span class="hljs-attr">features</span>: [<span class="hljs-string">"feature1"</span>, <span class="hljs-string">"feature2"</span>],
  };

  <span class="hljs-keyword">const</span> unstableArray = items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.toUpperCase());

  <span class="hljs-comment">// 🎯 With useMemo - stable references</span>
  <span class="hljs-keyword">const</span> stableConfig = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
      count,
      <span class="hljs-attr">features</span>: [<span class="hljs-string">"feature1"</span>, <span class="hljs-string">"feature2"</span>],
    }),
    [count]
  ); <span class="hljs-comment">// Only creates new object when count changes</span>

  <span class="hljs-keyword">const</span> stableArray = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.toUpperCase()),
    [items]
  ); <span class="hljs-comment">// Only creates new array when items change</span>

  <span class="hljs-comment">// 🎯 Complex object with nested properties</span>
  <span class="hljs-keyword">const</span> complexConfig = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      <span class="hljs-attr">user</span>: {
        name,
        <span class="hljs-attr">preferences</span>: {
          <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
          <span class="hljs-attr">notifications</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">layout</span>: <span class="hljs-string">"grid"</span>,
        },
      },
      <span class="hljs-attr">app</span>: {
        <span class="hljs-attr">version</span>: <span class="hljs-string">"1.0.0"</span>,
        <span class="hljs-attr">features</span>: {
          <span class="hljs-attr">search</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">export</span>: count &gt; <span class="hljs-number">5</span>,
          <span class="hljs-attr">advanced</span>: count &gt; <span class="hljs-number">10</span>,
        },
      },
      <span class="hljs-attr">data</span>: {
        <span class="hljs-attr">items</span>: items.length,
        <span class="hljs-attr">processed</span>: items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
          <span class="hljs-attr">original</span>: item,
          <span class="hljs-attr">processed</span>: item.toUpperCase(),
          <span class="hljs-attr">length</span>: item.length,
        })),
      },
    }),
    [name, count, items]
  );

  <span class="hljs-comment">// 🎯 Filtered and sorted data</span>
  <span class="hljs-keyword">const</span> processedItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items
      .filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.length &gt; <span class="hljs-number">3</span>)
      .sort()
      .map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
        <span class="hljs-attr">id</span>: item,
        <span class="hljs-attr">display</span>: item.charAt(<span class="hljs-number">0</span>).toUpperCase() + item.slice(<span class="hljs-number">1</span>),
        <span class="hljs-attr">metadata</span>: {
          <span class="hljs-attr">length</span>: item.length,
          <span class="hljs-attr">vowels</span>: (item.match(<span class="hljs-regexp">/[aeiou]/gi</span>) || []).length,
        },
      }));
  }, [items]);

  <span class="hljs-comment">// 🎯 Reference tracking</span>
  <span class="hljs-keyword">const</span> previousRefsRef = useRef({});
  <span class="hljs-keyword">const</span> renderCountRef = useRef(<span class="hljs-number">0</span>);
  renderCountRef.current += <span class="hljs-number">1</span>;

  <span class="hljs-keyword">const</span> checkReferenceStability = <span class="hljs-function">(<span class="hljs-params">name, current</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> previous = previousRefsRef.current[name];
    <span class="hljs-keyword">const</span> isStable = previous === current;
    previousRefsRef.current[name] = current;
    <span class="hljs-keyword">return</span> isStable;
  };

  <span class="hljs-keyword">const</span> addItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newItem = <span class="hljs-string">`item<span class="hljs-subst">${items.length + <span class="hljs-number">1</span>}</span>`</span>;
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, newItem]);
  };

  <span class="hljs-keyword">const</span> removeItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>));
  };

  <span class="hljs-keyword">const</span> updateName = <span class="hljs-function">(<span class="hljs-params">newName</span>) =&gt;</span> {
    setName(newName);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"reference-stability-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Reference Stability Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"render-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Render #{renderCountRef.current}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Watch reference stability indicators below<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((c) =&gt; c + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count)}&gt;
            Force Re-render (same count)
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateName(e.target.value)}
            placeholder="Enter name"
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addItem}</span>&gt;</span>Add Item<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{removeItem}</span>&gt;</span>Remove Item<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Items: {items.join(", ")}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"reference-tracking"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Reference Stability Tracking<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stability-grid"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stability-item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Unstable Config Object<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">stability-indicator</span> ${
                <span class="hljs-attr">checkReferenceStability</span>("<span class="hljs-attr">unstableConfig</span>", <span class="hljs-attr">unstableConfig</span>)
                  ? "<span class="hljs-attr">stable</span>"
                  <span class="hljs-attr">:</span> "<span class="hljs-attr">unstable</span>"
              }`}
            &gt;</span>
              {checkReferenceStability("unstableConfig", unstableConfig)
                ? "✅ Stable"
                : "❌ New Reference"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(unstableConfig, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stability-item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Stable Config Object (useMemo)<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">stability-indicator</span> ${
                <span class="hljs-attr">checkReferenceStability</span>("<span class="hljs-attr">stableConfig</span>", <span class="hljs-attr">stableConfig</span>)
                  ? "<span class="hljs-attr">stable</span>"
                  <span class="hljs-attr">:</span> "<span class="hljs-attr">unstable</span>"
              }`}
            &gt;</span>
              {checkReferenceStability("stableConfig", stableConfig)
                ? "✅ Stable"
                : "🔄 Updated"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(stableConfig, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stability-item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Unstable Array<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">stability-indicator</span> ${
                <span class="hljs-attr">checkReferenceStability</span>("<span class="hljs-attr">unstableArray</span>", <span class="hljs-attr">unstableArray</span>)
                  ? "<span class="hljs-attr">stable</span>"
                  <span class="hljs-attr">:</span> "<span class="hljs-attr">unstable</span>"
              }`}
            &gt;</span>
              {checkReferenceStability("unstableArray", unstableArray)
                ? "✅ Stable"
                : "❌ New Reference"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Array: [{unstableArray.join(", ")}]<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stability-item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Stable Array (useMemo)<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
              <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">stability-indicator</span> ${
                <span class="hljs-attr">checkReferenceStability</span>("<span class="hljs-attr">stableArray</span>", <span class="hljs-attr">stableArray</span>)
                  ? "<span class="hljs-attr">stable</span>"
                  <span class="hljs-attr">:</span> "<span class="hljs-attr">unstable</span>"
              }`}
            &gt;</span>
              {checkReferenceStability("stableArray", stableArray)
                ? "✅ Stable"
                : "🔄 Updated"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Array: [{stableArray.join(", ")}]<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"complex-object"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Complex Configuration Object<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">stability-indicator</span> ${
              <span class="hljs-attr">checkReferenceStability</span>("<span class="hljs-attr">complexConfig</span>", <span class="hljs-attr">complexConfig</span>)
                ? "<span class="hljs-attr">stable</span>"
                <span class="hljs-attr">:</span> "<span class="hljs-attr">unstable</span>"
            }`}
          &gt;</span>
            {checkReferenceStability("complexConfig", complexConfig)
              ? "✅ Stable"
              : "🔄 Updated"}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">details</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">summary</span>&gt;</span>View Complex Config<span class="hljs-tag">&lt;/<span class="hljs-name">summary</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(complexConfig, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">details</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"processed-items"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Processed Items<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">stability-indicator</span> ${
              <span class="hljs-attr">checkReferenceStability</span>("<span class="hljs-attr">processedItems</span>", <span class="hljs-attr">processedItems</span>)
                ? "<span class="hljs-attr">stable</span>"
                <span class="hljs-attr">:</span> "<span class="hljs-attr">unstable</span>"
            }`}
          &gt;</span>
            {checkReferenceStability("processedItems", processedItems)
              ? "✅ Stable"
              : "🔄 Updated"}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"items-display"</span>&gt;</span>
            {processedItems.map((item) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"processed-item"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>{item.display}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>
                  Length: {item.metadata.length}, Vowels: {item.metadata.vowels}
                <span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"explanation"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Reference Stability Impact:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>❌ Unstable references:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Create new objects/arrays
            every render
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>✅ Stable references:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Only create new when
            dependencies change
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>🔄 Updated references:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> New reference due to
            dependency change
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Performance:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Stable references prevent unnecessary
            child re-renders
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>useEffect:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Stable references prevent infinite loops
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="child-component-re-render-prevention">Child Component Re-render Prevention</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Child component that shows re-render behavior</span>
<span class="hljs-keyword">const</span> ExpensiveChild = React.memo(<span class="hljs-function">(<span class="hljs-params">{ config, onAction }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> renderCount = useRef(<span class="hljs-number">0</span>);
  renderCount.current += <span class="hljs-number">1</span>;

  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`ExpensiveChild rendered <span class="hljs-subst">${renderCount.current}</span> times`</span>);

  <span class="hljs-comment">// Simulate expensive rendering</span>
  <span class="hljs-keyword">const</span> expensiveValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"ExpensiveChild: Performing expensive calculation"</span>);
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">100000</span>; i++) {
      result += <span class="hljs-built_in">Math</span>.random();
    }
    <span class="hljs-keyword">return</span> result;
  }, [config.seed]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"expensive-child"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Expensive Child Component<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Render count: {renderCount.current}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Config theme: {config.theme}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Config seed: {config.seed}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Expensive value: {expensiveValue.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onAction("child-action")}&gt;Child Action<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChildReRenderDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [parentCount, setParentCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [childSeed, setChildSeed] = useState(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> [theme, setTheme] = useState(<span class="hljs-string">"light"</span>);

  <span class="hljs-comment">// 🎯 Unstable config - causes unnecessary re-renders</span>
  <span class="hljs-keyword">const</span> unstableConfig = {
    theme,
    <span class="hljs-attr">seed</span>: childSeed,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(), <span class="hljs-comment">// ❌ Always different!</span>
  };

  <span class="hljs-comment">// 🎯 Stable config - only changes when dependencies change</span>
  <span class="hljs-keyword">const</span> stableConfig = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      theme,
      <span class="hljs-attr">seed</span>: childSeed,
      <span class="hljs-comment">// timestamp: Date.now() // ❌ Don't include changing values</span>
    }),
    [theme, childSeed]
  );

  <span class="hljs-comment">// 🎯 Unstable callback - new function every render</span>
  <span class="hljs-keyword">const</span> unstableCallback = <span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Action:"</span>, action, <span class="hljs-string">"Parent count:"</span>, parentCount);
  };

  <span class="hljs-comment">// 🎯 Stable callback - memoized function</span>
  <span class="hljs-keyword">const</span> stableCallback = useCallback(
    <span class="hljs-function">(<span class="hljs-params">action</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Action:"</span>, action, <span class="hljs-string">"Parent count:"</span>, parentCount);
    },
    [parentCount]
  );

  <span class="hljs-keyword">const</span> parentRenderCount = useRef(<span class="hljs-number">0</span>);
  parentRenderCount.current += <span class="hljs-number">1</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"child-rerender-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Child Re-render Prevention Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"parent-info"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Parent render count:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {parentRenderCount.current}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Check console for child render logs<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setParentCount((c) =&gt; c + 1)}&gt;
            Parent Count: {parentCount}
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>This should NOT cause child re-renders with stable props<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setChildSeed((s) =&gt; s + 1)}&gt;
            Child Seed: {childSeed}
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>This SHOULD cause child re-renders<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setTheme((t) =&gt; (t === "light" ? "dark" : "light"))}
          &gt;
            Theme: {theme}
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>This SHOULD cause child re-renders<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"children-comparison"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"child-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>❌ With Unstable Props<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Re-renders on every parent render<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveChild</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{unstableConfig}</span> <span class="hljs-attr">onAction</span>=<span class="hljs-string">{unstableCallback}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"child-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>✅ With Stable Props (useMemo + useCallback)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Only re-renders when props actually change<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveChild</span> <span class="hljs-attr">config</span>=<span class="hljs-string">{stableConfig}</span> <span class="hljs-attr">onAction</span>=<span class="hljs-string">{stableCallback}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"explanation"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Optimization Techniques:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>React.memo:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Prevents re-renders when props haven't
            changed
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>useMemo:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Stabilizes object/array references
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>useCallback:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Stabilizes function references
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Dependency arrays:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Control when memoization updates
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-dependency-array-best-practices">🎯 Dependency Array Best Practices</h2>
<h3 id="dependency-array-patterns">Dependency Array Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DependencyArrayDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({
    <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
  });
  <span class="hljs-keyword">const</span> [settings, setSettings] = useState({
    <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span>,
    <span class="hljs-attr">notifications</span>: <span class="hljs-literal">true</span>,
  });
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);
  <span class="hljs-keyword">const</span> [filter, setFilter] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// 🎯 Primitive dependencies</span>
  <span class="hljs-keyword">const</span> userDisplayName = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Computing user display name"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${user.name}</span> (<span class="hljs-subst">${user.age}</span> years old)`</span>;
  }, [user.name, user.age]); <span class="hljs-comment">// ✅ Only specific properties</span>

  <span class="hljs-comment">// ❌ WRONG: Entire object as dependency</span>
  <span class="hljs-keyword">const</span> wrongUserDisplay = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Computing wrong user display (will run too often)"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${user.name}</span> (<span class="hljs-subst">${user.age}</span> years old)`</span>;
  }, [user]); <span class="hljs-comment">// ❌ Runs when ANY user property changes</span>

  <span class="hljs-comment">// 🎯 Array length as dependency</span>
  <span class="hljs-keyword">const</span> itemsInfo = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Computing items info"</span>);
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">count</span>: items.length,
      <span class="hljs-attr">isEmpty</span>: items.length === <span class="hljs-number">0</span>,
      <span class="hljs-attr">hasMany</span>: items.length &gt; <span class="hljs-number">10</span>,
    };
  }, [items.length]); <span class="hljs-comment">// ✅ Only when length changes</span>

  <span class="hljs-comment">// 🎯 Computed dependencies</span>
  <span class="hljs-keyword">const</span> hasNotifications = settings.notifications;
  <span class="hljs-keyword">const</span> isDarkTheme = settings.theme === <span class="hljs-string">"dark"</span>;

  <span class="hljs-keyword">const</span> uiConfig = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Computing UI config"</span>);
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">showNotificationBadge</span>: hasNotifications,
      <span class="hljs-attr">darkMode</span>: isDarkTheme,
      <span class="hljs-attr">className</span>: <span class="hljs-string">`theme-<span class="hljs-subst">${settings.theme}</span> <span class="hljs-subst">${
        hasNotifications ? <span class="hljs-string">"with-notifications"</span> : <span class="hljs-string">""</span>
      }</span>`</span>,
      <span class="hljs-attr">styles</span>: {
        <span class="hljs-attr">backgroundColor</span>: isDarkTheme ? <span class="hljs-string">"#333"</span> : <span class="hljs-string">"#fff"</span>,
        <span class="hljs-attr">color</span>: isDarkTheme ? <span class="hljs-string">"#fff"</span> : <span class="hljs-string">"#333"</span>,
      },
    };
  }, [hasNotifications, isDarkTheme, settings.theme]); <span class="hljs-comment">// ✅ Specific computed values</span>

  <span class="hljs-comment">// 🎯 Complex filtering with multiple dependencies</span>
  <span class="hljs-keyword">const</span> filteredItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Filtering items"</span>);

    <span class="hljs-keyword">if</span> (!filter) <span class="hljs-keyword">return</span> items;

    <span class="hljs-keyword">return</span> items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> itemStr = item.toString();
      <span class="hljs-keyword">return</span> itemStr.includes(filter);
    });
  }, [items, filter]); <span class="hljs-comment">// ✅ Both items and filter</span>

  <span class="hljs-comment">// 🎯 Expensive calculation with conditional dependencies</span>
  <span class="hljs-keyword">const</span> expensiveCalculation = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Performing expensive calculation"</span>);

    <span class="hljs-comment">// Only calculate if we have items and user is adult</span>
    <span class="hljs-keyword">if</span> (items.length === <span class="hljs-number">0</span> || user.age &lt; <span class="hljs-number">18</span>) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">result</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">"No calculation needed"</span> };
    }

    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; items.length * <span class="hljs-number">1000</span>; i++) {
      result += <span class="hljs-built_in">Math</span>.random() * user.age;
    }

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">result</span>: result.toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">message</span>: <span class="hljs-string">`Calculated for <span class="hljs-subst">${items.length}</span> items and age <span class="hljs-subst">${user.age}</span>`</span>,
    };
  }, [items.length, user.age]); <span class="hljs-comment">// ✅ Only the values we actually use</span>

  <span class="hljs-comment">// 🎯 Object with stable keys</span>
  <span class="hljs-keyword">const</span> stableObjectKeys = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">Object</span>.keys(user).sort(), [user]);

  <span class="hljs-keyword">const</span> userMetadata = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Computing user metadata"</span>);
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">fieldCount</span>: stableObjectKeys.length,
      <span class="hljs-attr">hasEmail</span>: stableObjectKeys.includes(<span class="hljs-string">"email"</span>),
      <span class="hljs-attr">hasAge</span>: stableObjectKeys.includes(<span class="hljs-string">"age"</span>),
      <span class="hljs-attr">summary</span>: <span class="hljs-string">`User has <span class="hljs-subst">${
        stableObjectKeys.length
      }</span> fields: <span class="hljs-subst">${stableObjectKeys.join(<span class="hljs-string">", "</span>)}</span>`</span>,
    };
  }, [stableObjectKeys]); <span class="hljs-comment">// ✅ Depends on stable key array</span>

  <span class="hljs-comment">// 🎯 Functions in dependencies (should be memoized)</span>
  <span class="hljs-keyword">const</span> processItem = useCallback(
    <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">original</span>: item,
        <span class="hljs-attr">doubled</span>: item * <span class="hljs-number">2</span>,
        <span class="hljs-attr">userAgeMultiplied</span>: item * user.age,
      };
    },
    [user.age]
  );

  <span class="hljs-keyword">const</span> processedItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Processing items with function"</span>);
    <span class="hljs-keyword">return</span> filteredItems.map(processItem);
  }, [filteredItems, processItem]); <span class="hljs-comment">// ✅ processItem is memoized</span>

  <span class="hljs-keyword">const</span> updateUser = <span class="hljs-function">(<span class="hljs-params">field, value</span>) =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [field]: value }));
  };

  <span class="hljs-keyword">const</span> updateSettings = <span class="hljs-function">(<span class="hljs-params">field, value</span>) =&gt;</span> {
    setSettings(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [field]: value }));
  };

  <span class="hljs-keyword">const</span> addItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, <span class="hljs-built_in">Math</span>.max(...prev) + <span class="hljs-number">1</span>]);
  };

  <span class="hljs-keyword">const</span> removeItem = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dependency-array-demo"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Dependency Array Best Practices<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>User Controls<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Name:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{user.name}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateUser("name", e.target.value)}
            /&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Age:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{user.age}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateUser("age", Number(e.target.value))}
            /&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{user.email}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateUser("email", e.target.value)}
            /&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Settings Controls<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Theme:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{settings.theme}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateSettings("theme", e.target.value)}
            &gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"light"</span>&gt;</span>Light<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"dark"</span>&gt;</span>Dark<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
                <span class="hljs-attr">checked</span>=<span class="hljs-string">{settings.notifications}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
                  updateSettings("notifications", e.target.checked)
                }
              /&gt;
              Notifications
            <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Items Controls<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addItem}</span>&gt;</span>Add Item<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{removeItem}</span>&gt;</span>Remove Item<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Items: [{items.join(", ")}]<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Filter:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{filter}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFilter(e.target.value)}
              placeholder="Filter items"
            /&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"results"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>User Display Names<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Optimized (name + age only):<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {userDisplayName}
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Unoptimized (entire user object):<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>{" "}
            {wrongUserDisplay}
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>Check console - unoptimized version runs more often<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Items Information<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(itemsInfo, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>UI Configuration<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{uiConfig.styles}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{uiConfig.className}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Theme: {settings.theme}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
              Notifications: {settings.notifications ? "Enabled" : "Disabled"}
            <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Dark mode: {uiConfig.darkMode ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Filtered Items<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Filter: "{filter}"<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Results: [{filteredItems.join(", ")}]<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Expensive Calculation<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Result: {expensiveCalculation.result}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Message: {expensiveCalculation.message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>User Metadata<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(userMetadata, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Processed Items<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"processed-items"</span>&gt;</span>
            {processedItems.map((item, index) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"processed-item"</span>&gt;</span>
                Original: {item.original}, Doubled: {item.doubled}, Age
                Multiplied: {item.userAgeMultiplied}
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"best-practices"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Dependency Array Best Practices:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>✅ Use specific properties:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> [user.name, user.age]
            instead of [user]
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>✅ Use computed values:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> [items.length] instead of
            [items]
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>✅ Memoize functions:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Use useCallback for function
            dependencies
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>✅ Stable references:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Extract stable values outside
            useMemo
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>❌ Avoid objects/arrays:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Unless you need the entire
            reference
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>❌ Don't omit dependencies:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Include all values used
            inside
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes--anti-patterns">⚠️ Common Mistakes &amp; Anti-Patterns</h2>
<h3 id="1-premature-optimization">1. Premature Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Memoizing everything unnecessarily</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OverMemoizedComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// ❌ Unnecessary - simple calculation</span>
  <span class="hljs-keyword">const</span> doubledCount = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> count * <span class="hljs-number">2</span>, [count]);

  <span class="hljs-comment">// ❌ Unnecessary - primitive value</span>
  <span class="hljs-keyword">const</span> isEven = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> count % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>, [count]);

  <span class="hljs-comment">// ❌ Unnecessary - simple string</span>
  <span class="hljs-keyword">const</span> message = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">`Count is <span class="hljs-subst">${count}</span>`</span>, [count]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Doubled: {doubledCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Is Even: {isEven ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Only memoize when necessary</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimallyMemoizedComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// ✅ Simple calculations - no memo needed</span>
  <span class="hljs-keyword">const</span> doubledCount = count * <span class="hljs-number">2</span>;
  <span class="hljs-keyword">const</span> isEven = count % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> message = <span class="hljs-string">`Count is <span class="hljs-subst">${count}</span>`</span>;

  <span class="hljs-comment">// ✅ Only memoize expensive operations</span>
  <span class="hljs-keyword">const</span> expensiveCalculation = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; count * <span class="hljs-number">100000</span>; i++) {
      result += <span class="hljs-built_in">Math</span>.random();
    }
    <span class="hljs-keyword">return</span> result;
  }, [count]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Doubled: {doubledCount}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Is Even: {isEven ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Expensive: {expensiveCalculation.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-missing-dependencies">2. Missing Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Missing dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MissingDependenciesExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [multiplier, setMultiplier] = useState(<span class="hljs-number">2</span>);

  <span class="hljs-comment">// ❌ Missing 'multiplier' in dependencies</span>
  <span class="hljs-keyword">const</span> calculation = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> count * multiplier; <span class="hljs-comment">// Uses multiplier but not in deps</span>
  }, [count]); <span class="hljs-comment">// ❌ Stale closure!</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Multiplier: {multiplier}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Result: {calculation}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: All dependencies included</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CorrectDependenciesExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [multiplier, setMultiplier] = useState(<span class="hljs-number">2</span>);

  <span class="hljs-comment">// ✅ All dependencies included</span>
  <span class="hljs-keyword">const</span> calculation = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> count * multiplier;
  }, [count, multiplier]); <span class="hljs-comment">// ✅ Complete dependency array</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Multiplier: {multiplier}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Result: {calculation}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="3-objectarray-dependencies">3. Object/Array Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Using entire objects as dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WrongObjectDependencies</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({
    <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
  });

  <span class="hljs-comment">// ❌ Will run whenever ANY user property changes</span>
  <span class="hljs-keyword">const</span> userDisplayName = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${user.name}</span> (<span class="hljs-subst">${user.age}</span>)`</span>; <span class="hljs-comment">// Only uses name and age</span>
  }, [user]); <span class="hljs-comment">// ❌ Depends on entire user object</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{userDisplayName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ CORRECT: Use specific properties</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CorrectObjectDependencies</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({
    <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>,
    <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span>,
  });

  <span class="hljs-comment">// ✅ Only runs when name or age changes</span>
  <span class="hljs-keyword">const</span> userDisplayName = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${user.name}</span> (<span class="hljs-subst">${user.age}</span>)`</span>;
  }, [user.name, user.age]); <span class="hljs-comment">// ✅ Only specific properties</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{userDisplayName}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="4-expensive-dependency-calculations">4. Expensive Dependency Calculations</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ WRONG: Expensive calculations in dependency array</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveDependencyCalculation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);

  <span class="hljs-comment">// ❌ Expensive operation in dependency array</span>
  <span class="hljs-keyword">const</span> processedItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item * <span class="hljs-number">2</span>);
  }, [items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.toString())]); <span class="hljs-comment">// ❌ Creates new array every render!</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {processedItems.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item}</span>&gt;</span>{item}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ CORRECT: Simple dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SimpleDependencyCalculation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);

  <span class="hljs-comment">// ✅ Simple dependency</span>
  <span class="hljs-keyword">const</span> processedItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
      <span class="hljs-attr">original</span>: item,
      <span class="hljs-attr">doubled</span>: item * <span class="hljs-number">2</span>,
      <span class="hljs-attr">stringified</span>: item.toString(),
    }));
  }, [items]); <span class="hljs-comment">// ✅ Simple array reference</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {processedItems.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.original}</span>&gt;</span>
          {item.original} → {item.doubled} ({item.stringified})
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-mini-challenges">🧪 Mini Challenges</h2>
<h3 id="challenge-1-data-dashboard-optimization">Challenge 1: Data Dashboard Optimization</h3>
<p>Build a data dashboard that:</p>
<ul>
<li>Processes large datasets efficiently</li>
<li>Calculates multiple statistics</li>
<li>Filters and sorts data</li>
<li>Only recalculates when necessary</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataDashboard</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [rawData] = useState(
    <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">50000</span> }, (_, i) =&gt; ({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">1000</span>,
      <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>, <span class="hljs-string">"D"</span>][<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">4</span>)],
      <span class="hljs-attr">date</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(
        <span class="hljs-number">2023</span>,
        <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">12</span>),
        <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">28</span>) + <span class="hljs-number">1</span>
      ),
      <span class="hljs-attr">status</span>: [<span class="hljs-string">"active"</span>, <span class="hljs-string">"inactive"</span>, <span class="hljs-string">"pending"</span>][<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>)],
    }))
  );

  <span class="hljs-keyword">const</span> [filters, setFilters] = useState({
    <span class="hljs-attr">category</span>: <span class="hljs-string">"all"</span>,
    <span class="hljs-attr">status</span>: <span class="hljs-string">"all"</span>,
    <span class="hljs-attr">minValue</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">maxValue</span>: <span class="hljs-number">1000</span>,
    <span class="hljs-attr">dateRange</span>: <span class="hljs-string">"all"</span>,
  });

  <span class="hljs-keyword">const</span> [sortConfig, setSortConfig] = useState({
    <span class="hljs-attr">field</span>: <span class="hljs-string">"id"</span>,
    <span class="hljs-attr">direction</span>: <span class="hljs-string">"asc"</span>,
  });

  <span class="hljs-comment">// 🎯 Filtered data</span>
  <span class="hljs-keyword">const</span> filteredData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Data filtering"</span>);

    <span class="hljs-keyword">let</span> result = rawData;

    <span class="hljs-keyword">if</span> (filters.category !== <span class="hljs-string">"all"</span>) {
      result = result.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.category === filters.category);
    }

    <span class="hljs-keyword">if</span> (filters.status !== <span class="hljs-string">"all"</span>) {
      result = result.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.status === filters.status);
    }

    result = result.filter(
      <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.value &gt;= filters.minValue &amp;&amp; item.value &lt;= filters.maxValue
    );

    <span class="hljs-keyword">if</span> (filters.dateRange !== <span class="hljs-string">"all"</span>) {
      <span class="hljs-keyword">const</span> now = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
      <span class="hljs-keyword">const</span> cutoff = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();

      <span class="hljs-keyword">switch</span> (filters.dateRange) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"last30"</span>:
          cutoff.setDate(now.getDate() - <span class="hljs-number">30</span>);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"last90"</span>:
          cutoff.setDate(now.getDate() - <span class="hljs-number">90</span>);
          <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-string">"thisYear"</span>:
          cutoff.setFullYear(now.getFullYear(), <span class="hljs-number">0</span>, <span class="hljs-number">1</span>);
          <span class="hljs-keyword">break</span>;
      }

      result = result.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.date &gt;= cutoff);
    }

    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Data filtering"</span>);
    <span class="hljs-keyword">return</span> result;
  }, [rawData, filters]);

  <span class="hljs-comment">// 🎯 Sorted data</span>
  <span class="hljs-keyword">const</span> sortedData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Data sorting"</span>);

    <span class="hljs-keyword">const</span> result = [...filteredData].sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> aVal = a[sortConfig.field];
      <span class="hljs-keyword">const</span> bVal = b[sortConfig.field];

      <span class="hljs-keyword">let</span> comparison = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">if</span> (aVal &gt; bVal) comparison = <span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (aVal &lt; bVal) comparison = <span class="hljs-number">-1</span>;

      <span class="hljs-keyword">return</span> sortConfig.direction === <span class="hljs-string">"desc"</span> ? -comparison : comparison;
    });

    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Data sorting"</span>);
    <span class="hljs-keyword">return</span> result;
  }, [filteredData, sortConfig]);

  <span class="hljs-comment">// 🎯 Statistics</span>
  <span class="hljs-keyword">const</span> statistics = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Statistics calculation"</span>);

    <span class="hljs-keyword">if</span> (filteredData.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">sum</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">average</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">max</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">median</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">categoryBreakdown</span>: {},
        <span class="hljs-attr">statusBreakdown</span>: {},
      };
    }

    <span class="hljs-keyword">const</span> values = filteredData.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.value);
    <span class="hljs-keyword">const</span> sum = values.reduce(<span class="hljs-function">(<span class="hljs-params">acc, val</span>) =&gt;</span> acc + val, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">const</span> sortedValues = [...values].sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a - b);
    <span class="hljs-keyword">const</span> median =
      sortedValues.length % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>
        ? (sortedValues[sortedValues.length / <span class="hljs-number">2</span> - <span class="hljs-number">1</span>] +
            sortedValues[sortedValues.length / <span class="hljs-number">2</span>]) /
          <span class="hljs-number">2</span>
        : sortedValues[<span class="hljs-built_in">Math</span>.floor(sortedValues.length / <span class="hljs-number">2</span>)];

    <span class="hljs-keyword">const</span> categoryBreakdown = filteredData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> {
      acc[item.category] = (acc[item.category] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> acc;
    }, {});

    <span class="hljs-keyword">const</span> statusBreakdown = filteredData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> {
      acc[item.status] = (acc[item.status] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> acc;
    }, {});

    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Statistics calculation"</span>);

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">count</span>: filteredData.length,
      <span class="hljs-attr">sum</span>: sum.toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">average</span>: (sum / filteredData.length).toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">min</span>: <span class="hljs-built_in">Math</span>.min(...values).toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">max</span>: <span class="hljs-built_in">Math</span>.max(...values).toFixed(<span class="hljs-number">2</span>),
      <span class="hljs-attr">median</span>: median.toFixed(<span class="hljs-number">2</span>),
      categoryBreakdown,
      statusBreakdown,
    };
  }, [filteredData]);

  <span class="hljs-comment">// 🎯 Chart data</span>
  <span class="hljs-keyword">const</span> chartData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.time(<span class="hljs-string">"Chart data preparation"</span>);

    <span class="hljs-keyword">const</span> categoryData = <span class="hljs-built_in">Object</span>.entries(statistics.categoryBreakdown).map(
      <span class="hljs-function">(<span class="hljs-params">[category, count]</span>) =&gt;</span> ({
        category,
        count,
        <span class="hljs-attr">percentage</span>: ((count / statistics.count) * <span class="hljs-number">100</span>).toFixed(<span class="hljs-number">1</span>),
      })
    );

    <span class="hljs-keyword">const</span> statusData = <span class="hljs-built_in">Object</span>.entries(statistics.statusBreakdown).map(
      <span class="hljs-function">(<span class="hljs-params">[status, count]</span>) =&gt;</span> ({
        status,
        count,
        <span class="hljs-attr">percentage</span>: ((count / statistics.count) * <span class="hljs-number">100</span>).toFixed(<span class="hljs-number">1</span>),
      })
    );

    <span class="hljs-built_in">console</span>.timeEnd(<span class="hljs-string">"Chart data preparation"</span>);

    <span class="hljs-keyword">return</span> { categoryData, statusData };
  }, [statistics]);

  <span class="hljs-keyword">const</span> updateFilter = <span class="hljs-function">(<span class="hljs-params">key, value</span>) =&gt;</span> {
    setFilters(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [key]: value }));
  };

  <span class="hljs-keyword">const</span> updateSort = <span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
    setSortConfig(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      field,
      <span class="hljs-attr">direction</span>:
        prev.field === field &amp;&amp; prev.direction === <span class="hljs-string">"asc"</span> ? <span class="hljs-string">"desc"</span> : <span class="hljs-string">"asc"</span>,
    }));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-dashboard"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Optimized Data Dashboard<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Filters */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filters"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filter-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Category:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{filters.category}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateFilter("category", e.target.value)}
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"all"</span>&gt;</span>All<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"A"</span>&gt;</span>A<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"B"</span>&gt;</span>B<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"C"</span>&gt;</span>C<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"D"</span>&gt;</span>D<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filter-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Status:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{filters.status}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateFilter("status", e.target.value)}
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"all"</span>&gt;</span>All<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"active"</span>&gt;</span>Active<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"inactive"</span>&gt;</span>Inactive<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"pending"</span>&gt;</span>Pending<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filter-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Value Range:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span>
            <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span>
            <span class="hljs-attr">max</span>=<span class="hljs-string">"1000"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{filters.minValue}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateFilter("minValue", Number(e.target.value))}
          /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
            {filters.minValue} - {filters.maxValue}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"range"</span>
            <span class="hljs-attr">min</span>=<span class="hljs-string">"0"</span>
            <span class="hljs-attr">max</span>=<span class="hljs-string">"1000"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{filters.maxValue}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> updateFilter("maxValue", Number(e.target.value))}
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Statistics */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"statistics"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Statistics<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats-grid"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>Count: {statistics.count}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>Sum: {statistics.sum}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>Average: {statistics.average}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>Min: {statistics.min}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>Max: {statistics.max}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>Median: {statistics.median}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Charts */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"charts"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Category Breakdown<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
          {chartData.categoryData.map((item) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.category}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-bar"</span>&gt;</span>
              {item.category}: {item.count} ({item.percentage}%)
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Status Breakdown<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
          {chartData.statusData.map((item) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.status}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-bar"</span>&gt;</span>
              {item.status}: {item.count} ({item.percentage}%)
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Data Table */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-table"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Data (First 100 rows)<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateSort("id")}&gt;ID<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateSort("value")}&gt;Value<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateSort("category")}&gt;Category<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateSort("status")}&gt;Status<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateSort("date")}&gt;Date<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
            {sortedData.slice(0, 100).map((item) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.id}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.value.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.category}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.status}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.date.toLocaleDateString()}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-smart-shopping-cart">Challenge 2: Smart Shopping Cart</h3>
<p>Create a shopping cart that:</p>
<ul>
<li>Calculates totals, taxes, and discounts efficiently</li>
<li>Handles complex pricing rules</li>
<li>Updates only when necessary</li>
<li>Provides real-time validation</li>
</ul>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SmartShoppingCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Laptop"</span>,
      <span class="hljs-attr">price</span>: <span class="hljs-number">999.99</span>,
      <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">category</span>: <span class="hljs-string">"electronics"</span>,
      <span class="hljs-attr">taxable</span>: <span class="hljs-literal">true</span>,
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Book"</span>,
      <span class="hljs-attr">price</span>: <span class="hljs-number">29.99</span>,
      <span class="hljs-attr">quantity</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">category</span>: <span class="hljs-string">"books"</span>,
      <span class="hljs-attr">taxable</span>: <span class="hljs-literal">false</span>,
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Headphones"</span>,
      <span class="hljs-attr">price</span>: <span class="hljs-number">199.99</span>,
      <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">category</span>: <span class="hljs-string">"electronics"</span>,
      <span class="hljs-attr">taxable</span>: <span class="hljs-literal">true</span>,
    },
  ]);

  <span class="hljs-keyword">const</span> [discountCode, setDiscountCode] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [shippingMethod, setShippingMethod] = useState(<span class="hljs-string">"standard"</span>);
  <span class="hljs-keyword">const</span> [customerType, setCustomerType] = useState(<span class="hljs-string">"regular"</span>);

  <span class="hljs-comment">// 🎯 Discount rules</span>
  <span class="hljs-keyword">const</span> discountRules = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      <span class="hljs-attr">SAVE10</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"percentage"</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">0.1</span>, <span class="hljs-attr">minAmount</span>: <span class="hljs-number">50</span> },
      <span class="hljs-attr">ELECTRONICS20</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"percentage"</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-number">0.2</span>,
        <span class="hljs-attr">category</span>: <span class="hljs-string">"electronics"</span>,
      },
      <span class="hljs-attr">FREESHIP</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"shipping"</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">0</span> },
      <span class="hljs-attr">STUDENT15</span>: { <span class="hljs-attr">type</span>: <span class="hljs-string">"percentage"</span>, <span class="hljs-attr">value</span>: <span class="hljs-number">0.15</span>, <span class="hljs-attr">customerType</span>: <span class="hljs-string">"student"</span> },
    }),
    []
  );

  <span class="hljs-comment">// 🎯 Shipping rates</span>
  <span class="hljs-keyword">const</span> shippingRates = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      <span class="hljs-attr">standard</span>: <span class="hljs-number">9.99</span>,
      <span class="hljs-attr">express</span>: <span class="hljs-number">19.99</span>,
      <span class="hljs-attr">overnight</span>: <span class="hljs-number">39.99</span>,
      <span class="hljs-attr">free</span>: <span class="hljs-number">0</span>,
    }),
    []
  );

  <span class="hljs-comment">// 🎯 Tax rates by category</span>
  <span class="hljs-keyword">const</span> taxRates = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      <span class="hljs-attr">electronics</span>: <span class="hljs-number">0.08</span>,
      <span class="hljs-attr">books</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">clothing</span>: <span class="hljs-number">0.06</span>,
      <span class="hljs-attr">food</span>: <span class="hljs-number">0.03</span>,
    }),
    []
  );

  <span class="hljs-comment">// 🎯 Calculate subtotal</span>
  <span class="hljs-keyword">const</span> subtotal = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating subtotal"</span>);
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">total, item</span>) =&gt;</span> total + item.price * item.quantity, <span class="hljs-number">0</span>);
  }, [items]);

  <span class="hljs-comment">// 🎯 Calculate item-level discounts</span>
  <span class="hljs-keyword">const</span> itemDiscounts = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating item discounts"</span>);

    <span class="hljs-keyword">const</span> discount = discountRules[discountCode];
    <span class="hljs-keyword">if</span> (!discount) <span class="hljs-keyword">return</span> {};

    <span class="hljs-keyword">const</span> discounts = {};

    items.forEach(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">let</span> itemDiscount = <span class="hljs-number">0</span>;

      <span class="hljs-keyword">if</span> (discount.type === <span class="hljs-string">"percentage"</span>) {
        <span class="hljs-comment">// Category-specific discount</span>
        <span class="hljs-keyword">if</span> (discount.category &amp;&amp; item.category === discount.category) {
          itemDiscount = item.price * item.quantity * discount.value;
        }
        <span class="hljs-comment">// Customer type discount</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (
          discount.customerType &amp;&amp;
          customerType === discount.customerType
        ) {
          itemDiscount = item.price * item.quantity * discount.value;
        }
        <span class="hljs-comment">// General percentage discount</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!discount.category &amp;&amp; !discount.customerType) {
          itemDiscount = item.price * item.quantity * discount.value;
        }
      }

      <span class="hljs-keyword">if</span> (itemDiscount &gt; <span class="hljs-number">0</span>) {
        discounts[item.id] = itemDiscount;
      }
    });

    <span class="hljs-keyword">return</span> discounts;
  }, [items, discountCode, customerType, discountRules]);

  <span class="hljs-comment">// 🎯 Calculate total discount</span>
  <span class="hljs-keyword">const</span> totalDiscount = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating total discount"</span>);

    <span class="hljs-keyword">const</span> itemDiscountTotal = <span class="hljs-built_in">Object</span>.values(itemDiscounts).reduce(
      <span class="hljs-function">(<span class="hljs-params">sum, discount</span>) =&gt;</span> sum + discount,
      <span class="hljs-number">0</span>
    );
    <span class="hljs-keyword">const</span> discount = discountRules[discountCode];

    <span class="hljs-comment">// Check minimum amount requirement</span>
    <span class="hljs-keyword">if</span> (discount &amp;&amp; discount.minAmount &amp;&amp; subtotal &lt; discount.minAmount) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-keyword">return</span> itemDiscountTotal;
  }, [itemDiscounts, discountRules, discountCode, subtotal]);

  <span class="hljs-comment">// 🎯 Calculate taxes</span>
  <span class="hljs-keyword">const</span> taxes = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating taxes"</span>);

    <span class="hljs-keyword">const</span> discountedSubtotal = subtotal - totalDiscount;

    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">totalTax, item</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!item.taxable) <span class="hljs-keyword">return</span> totalTax;

      <span class="hljs-keyword">const</span> taxRate = taxRates[item.category] || <span class="hljs-number">0</span>;
      <span class="hljs-keyword">const</span> itemTotal = item.price * item.quantity;
      <span class="hljs-keyword">const</span> itemDiscountRatio = (itemDiscounts[item.id] || <span class="hljs-number">0</span>) / itemTotal;
      <span class="hljs-keyword">const</span> discountedItemTotal = itemTotal * (<span class="hljs-number">1</span> - itemDiscountRatio);

      <span class="hljs-keyword">return</span> totalTax + discountedItemTotal * taxRate;
    }, <span class="hljs-number">0</span>);
  }, [items, subtotal, totalDiscount, itemDiscounts, taxRates]);

  <span class="hljs-comment">// 🎯 Calculate shipping</span>
  <span class="hljs-keyword">const</span> shipping = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating shipping"</span>);

    <span class="hljs-keyword">const</span> discount = discountRules[discountCode];
    <span class="hljs-keyword">if</span> (discount &amp;&amp; discount.type === <span class="hljs-string">"shipping"</span>) {
      <span class="hljs-keyword">return</span> discount.value;
    }

    <span class="hljs-comment">// Free shipping for orders over $100</span>
    <span class="hljs-keyword">if</span> (subtotal - totalDiscount &gt; <span class="hljs-number">100</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    }

    <span class="hljs-keyword">return</span> shippingRates[shippingMethod] || <span class="hljs-number">0</span>;
  }, [
    discountCode,
    discountRules,
    subtotal,
    totalDiscount,
    shippingMethod,
    shippingRates,
  ]);

  <span class="hljs-comment">// 🎯 Calculate final total</span>
  <span class="hljs-keyword">const</span> total = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating final total"</span>);
    <span class="hljs-keyword">return</span> subtotal - totalDiscount + taxes + shipping;
  }, [subtotal, totalDiscount, taxes, shipping]);

  <span class="hljs-comment">// 🎯 Validation messages</span>
  <span class="hljs-keyword">const</span> validationMessages = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating validation messages"</span>);

    <span class="hljs-keyword">const</span> messages = [];
    <span class="hljs-keyword">const</span> discount = discountRules[discountCode];

    <span class="hljs-keyword">if</span> (discountCode &amp;&amp; !discount) {
      messages.push({ <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Invalid discount code"</span> });
    }

    <span class="hljs-keyword">if</span> (discount &amp;&amp; discount.minAmount &amp;&amp; subtotal &lt; discount.minAmount) {
      messages.push({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"warning"</span>,
        <span class="hljs-attr">text</span>: <span class="hljs-string">`Add $<span class="hljs-subst">${(discount.minAmount - subtotal).toFixed(
          <span class="hljs-number">2</span>
        )}</span> more to qualify for discount`</span>,
      });
    }

    <span class="hljs-keyword">if</span> (
      discount &amp;&amp;
      discount.customerType &amp;&amp;
      customerType !== discount.customerType
    ) {
      messages.push({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>,
        <span class="hljs-attr">text</span>: <span class="hljs-string">`This discount is only for <span class="hljs-subst">${discount.customerType}</span> customers`</span>,
      });
    }

    <span class="hljs-keyword">if</span> (subtotal - totalDiscount &gt; <span class="hljs-number">100</span> &amp;&amp; shipping &gt; <span class="hljs-number">0</span>) {
      messages.push({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"info"</span>,
        <span class="hljs-attr">text</span>: <span class="hljs-string">"You qualify for free shipping!"</span>,
      });
    }

    <span class="hljs-keyword">return</span> messages;
  }, [
    discountCode,
    discountRules,
    subtotal,
    totalDiscount,
    customerType,
    shipping,
  ]);

  <span class="hljs-keyword">const</span> updateQuantity = <span class="hljs-function">(<span class="hljs-params">id, quantity</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.id === id ? { ...item, <span class="hljs-attr">quantity</span>: <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, quantity) } : item
      )
    );
  };

  <span class="hljs-keyword">const</span> removeItem = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"smart-shopping-cart"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Smart Shopping Cart<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Controls */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Customer Type:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{customerType}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setCustomerType(e.target.value)}
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"regular"</span>&gt;</span>Regular<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"student"</span>&gt;</span>Student<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"premium"</span>&gt;</span>Premium<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Discount Code:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{discountCode}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setDiscountCode(e.target.value.toUpperCase())}
            placeholder="Enter discount code"
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Shipping:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{shippingMethod}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setShippingMethod(e.target.value)}
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"standard"</span>&gt;</span>Standard ($9.99)<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"express"</span>&gt;</span>Express ($19.99)<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"overnight"</span>&gt;</span>Overnight ($39.99)<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Validation Messages */}
      {validationMessages.length &gt; 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"validation-messages"</span>&gt;</span>
          {validationMessages.map((message, index) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">message</span> ${<span class="hljs-attr">message.type</span>}`}&gt;</span>
              {message.text}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      {/* Cart Items */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-items"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Cart Items<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        {items.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item-info"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Category: {item.category}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Price: ${item.price}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Taxable: {item.taxable ? "Yes" : "No"}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item-controls"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateQuantity(item.id, item.quantity - 1)}
              &gt;
                -
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Qty: {item.quantity}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateQuantity(item.id, item.quantity + 1)}
              &gt;
                +
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeItem(item.id)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"item-totals"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Subtotal: ${(item.price * item.quantity).toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              {itemDiscounts[item.id] &amp;&amp; (
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Discount: -${itemDiscounts[item.id].toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              )}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {/* Cart Summary */}
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-summary"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Order Summary<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"summary-line"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Subtotal:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>${subtotal.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        {totalDiscount &gt; 0 &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"summary-line discount"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Discount ({discountCode}):<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>-${totalDiscount.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"summary-line"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Taxes:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>${taxes.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"summary-line"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Shipping:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>${shipping.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"summary-line total"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Total:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>${total.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%93%8A-performance-measurement">📊 Performance Measurement</h2>
<h3 id="measuring-usememo-impact">Measuring useMemo Impact</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PerformanceMeasurement</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [dataSize, setDataSize] = useState(<span class="hljs-number">10000</span>);
  <span class="hljs-keyword">const</span> [useOptimization, setUseOptimization] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [triggerUpdate, setTriggerUpdate] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// Generate test data</span>
  <span class="hljs-keyword">const</span> testData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Generating test data"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: dataSize }, (_, i) =&gt; ({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>,
      <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>][<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>)],
    }));
  }, [dataSize]);

  <span class="hljs-comment">// 🎯 Performance timing hook</span>
  <span class="hljs-keyword">const</span> usePerformanceTimer = <span class="hljs-function">(<span class="hljs-params">label</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> startTimeRef = useRef(<span class="hljs-literal">null</span>);
    <span class="hljs-keyword">const</span> [duration, setDuration] = useState(<span class="hljs-number">0</span>);

    <span class="hljs-keyword">const</span> start = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      startTimeRef.current = performance.now();
    }, []);

    <span class="hljs-keyword">const</span> end = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (startTimeRef.current) {
        <span class="hljs-keyword">const</span> duration = performance.now() - startTimeRef.current;
        setDuration(duration);
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${label}</span>: <span class="hljs-subst">${duration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
      }
    }, [label]);

    <span class="hljs-keyword">return</span> { start, end, duration };
  };

  <span class="hljs-keyword">const</span> optimizedTimer = usePerformanceTimer(<span class="hljs-string">"Optimized calculation"</span>);
  <span class="hljs-keyword">const</span> unoptimizedTimer = usePerformanceTimer(<span class="hljs-string">"Unoptimized calculation"</span>);

  <span class="hljs-comment">// 🎯 Expensive calculation with optimization</span>
  <span class="hljs-keyword">const</span> optimizedResult = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!useOptimization) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    optimizedTimer.start();

    <span class="hljs-keyword">const</span> result = testData.reduce(
      <span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> {
        acc.total += item.value;
        acc.count += <span class="hljs-number">1</span>;
        acc.categories[item.category] =
          (acc.categories[item.category] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;

        <span class="hljs-keyword">if</span> (item.value &gt; acc.max) acc.max = item.value;
        <span class="hljs-keyword">if</span> (item.value &lt; acc.min) acc.min = item.value;

        <span class="hljs-keyword">return</span> acc;
      },
      {
        <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">categories</span>: {},
        <span class="hljs-attr">max</span>: -<span class="hljs-literal">Infinity</span>,
        <span class="hljs-attr">min</span>: <span class="hljs-literal">Infinity</span>,
      }
    );

    result.average = result.total / result.count;

    optimizedTimer.end();
    <span class="hljs-keyword">return</span> result;
  }, [testData, useOptimization, optimizedTimer]);

  <span class="hljs-comment">// 🎯 Expensive calculation without optimization</span>
  <span class="hljs-keyword">const</span> calculateUnoptimized = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (useOptimization) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    unoptimizedTimer.start();

    <span class="hljs-keyword">const</span> result = testData.reduce(
      <span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> {
        acc.total += item.value;
        acc.count += <span class="hljs-number">1</span>;
        acc.categories[item.category] =
          (acc.categories[item.category] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;

        <span class="hljs-keyword">if</span> (item.value &gt; acc.max) acc.max = item.value;
        <span class="hljs-keyword">if</span> (item.value &lt; acc.min) acc.min = item.value;

        <span class="hljs-keyword">return</span> acc;
      },
      {
        <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">categories</span>: {},
        <span class="hljs-attr">max</span>: -<span class="hljs-literal">Infinity</span>,
        <span class="hljs-attr">min</span>: <span class="hljs-literal">Infinity</span>,
      }
    );

    result.average = result.total / result.count;

    unoptimizedTimer.end();
    <span class="hljs-keyword">return</span> result;
  };

  <span class="hljs-keyword">const</span> unoptimizedResult = !useOptimization ? calculateUnoptimized() : <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">const</span> currentResult = useOptimization ? optimizedResult : unoptimizedResult;

  <span class="hljs-keyword">const</span> renderCount = useRef(<span class="hljs-number">0</span>);
  renderCount.current += <span class="hljs-number">1</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-measurement"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Performance Measurement Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Data Size:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{dataSize}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setDataSize(Number(e.target.value))}
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{1000}</span>&gt;</span>1,000 items<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{10000}</span>&gt;</span>10,000 items<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{50000}</span>&gt;</span>50,000 items<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{100000}</span>&gt;</span>100,000 items<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
              <span class="hljs-attr">checked</span>=<span class="hljs-string">{useOptimization}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setUseOptimization(e.target.checked)}
            /&gt;
            Use useMemo Optimization
          <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"control-group"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setTriggerUpdate((prev) =&gt; prev + 1)}&gt;
            Force Re-render (Trigger: {triggerUpdate})
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-stats"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Performance Statistics<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats-grid"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Render Count:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {renderCount.current}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Data Size:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {dataSize.toLocaleString()} items
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Optimization:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>{" "}
            {useOptimization ? "Enabled" : "Disabled"}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Last Calculation Time:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
            {useOptimization
              ? `${optimizedTimer.duration.toFixed(2)}ms`
              : `${unoptimizedTimer.duration.toFixed(2)}ms`}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {currentResult &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"calculation-results"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Calculation Results<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"results-grid"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Total:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {currentResult.total.toFixed(2)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Count:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {currentResult.count}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Average:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {currentResult.average.toFixed(2)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Min:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {currentResult.min.toFixed(2)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"result"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Max:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {currentResult.max.toFixed(2)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"category-breakdown"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h5</span>&gt;</span>Category Breakdown:<span class="hljs-tag">&lt;/<span class="hljs-name">h5</span>&gt;</span>
            {Object.entries(currentResult.categories).map(
              ([category, count]) =&gt; (
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{category}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"category-stat"</span>&gt;</span>
                  {category}: {count} items
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              )
            )}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-notes"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Performance Notes:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>With useMemo:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Calculation only runs when data
            changes
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Without useMemo:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Calculation runs on every render
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Force re-render:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Test how optimization affects
            performance
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Data size:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> Larger datasets show bigger performance
            differences
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when-and-why-usememo-decision-framework">🎯 When and Why: useMemo Decision Framework</h2>
<h3 id="quick-decision-tree">Quick Decision Tree</h3>
<pre class="hljs"><code><div>🤔 Should I use useMemo?

├── Is this an expensive calculation?
│   ├── Yes → Continue evaluation...
│   └── No → Don't use useMemo ❌
│
├── Does the calculation run on every render?
│   ├── Yes → Continue evaluation...
│   └── No → Don't use useMemo ❌
│
├── Do the inputs change frequently?
│   ├── Yes → useMemo might not help ⚠️
│   └── No → Continue evaluation...
│
├── Is this for reference stability?
│   ├── Yes → Use useMemo ✅
│   └── No → Continue evaluation...
│
├── Is this preventing child re-renders?
│   ├── Yes → Use useMemo ✅
│   └── No → Continue evaluation...
│
└── Is the calculation actually expensive?
    ├── Yes → Use useMemo ✅
    └── No → Don't use useMemo ❌
</div></code></pre>
<h3 id="performance-guidelines">Performance Guidelines</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 When TO use useMemo:</span>

<span class="hljs-comment">// ✅ Expensive calculations</span>
<span class="hljs-keyword">const</span> expensiveValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> heavyCalculation(data);
}, [data]);

<span class="hljs-comment">// ✅ Object/array reference stability</span>
<span class="hljs-keyword">const</span> stableConfig = useMemo(
  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>,
    <span class="hljs-attr">features</span>: [<span class="hljs-string">"a"</span>, <span class="hljs-string">"b"</span>, <span class="hljs-string">"c"</span>],
  }),
  []
);

<span class="hljs-comment">// ✅ Preventing child re-renders</span>
<span class="hljs-keyword">const</span> memoizedProps = useMemo(
  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">data</span>: processedData,
    <span class="hljs-attr">config</span>: settings,
  }),
  [processedData, settings]
);

<span class="hljs-comment">// ✅ Complex filtering/sorting</span>
<span class="hljs-keyword">const</span> filteredData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">return</span> data
    .filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.active)
    .sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a.name.localeCompare(b.name));
}, [data]);

<span class="hljs-comment">// 🎯 When NOT to use useMemo:</span>

<span class="hljs-comment">// ❌ Simple calculations</span>
<span class="hljs-keyword">const</span> doubled = count * <span class="hljs-number">2</span>; <span class="hljs-comment">// Don't memo</span>

<span class="hljs-comment">// ❌ Primitive values</span>
<span class="hljs-keyword">const</span> isEven = count % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>; <span class="hljs-comment">// Don't memo</span>

<span class="hljs-comment">// ❌ Always changing dependencies</span>
<span class="hljs-keyword">const</span> timestamp = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">Date</span>.now(), [<span class="hljs-built_in">Date</span>.now()]); <span class="hljs-comment">// Useless</span>

<span class="hljs-comment">// ❌ More expensive than the calculation</span>
<span class="hljs-keyword">const</span> simple = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> a + b, [a, b]); <span class="hljs-comment">// Overhead &gt; benefit</span>
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<ol>
<li>
<p><strong>&quot;When would you use useMemo?&quot;</strong></p>
<ul>
<li>Expensive calculations that don't need to run on every render</li>
<li>Object/array reference stability for child components</li>
<li>Complex data transformations (filtering, sorting, grouping)</li>
<li>Preventing unnecessary re-renders in React.memo components</li>
</ul>
</li>
<li>
<p><strong>&quot;What's the difference between useMemo and useCallback?&quot;</strong></p>
<ul>
<li>useMemo: Memoizes the result of a calculation</li>
<li>useCallback: Memoizes the function itself</li>
<li>Both prevent unnecessary re-computations</li>
<li>Show examples of when to use each</li>
</ul>
</li>
<li>
<p><strong>&quot;How do you measure if useMemo is actually helping?&quot;</strong></p>
<ul>
<li>Use React DevTools Profiler</li>
<li>Console.time() for manual timing</li>
<li>Performance.now() for precise measurements</li>
<li>Compare render times with/without memoization</li>
</ul>
</li>
<li>
<p><strong>&quot;What are the downsides of useMemo?&quot;</strong></p>
<ul>
<li>Memory overhead (storing cached values)</li>
<li>Comparison overhead (checking dependencies)</li>
<li>Can make code more complex</li>
<li>Premature optimization can hurt performance</li>
</ul>
</li>
</ol>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🚨 Red Flags in Interviews:</span>

<span class="hljs-comment">// ❌ Memoizing everything</span>
<span class="hljs-keyword">const</span> simple = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> a + b, [a, b]);

<span class="hljs-comment">// ❌ Missing dependencies</span>
<span class="hljs-keyword">const</span> calc = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> a * b * c, [a, b]); <span class="hljs-comment">// Missing 'c'</span>

<span class="hljs-comment">// ❌ Expensive dependencies</span>
<span class="hljs-keyword">const</span> result = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> process(data), [data.map(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x.id)]);

<span class="hljs-comment">// ❌ Object dependencies</span>
<span class="hljs-keyword">const</span> result = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> process(user.name), [user]); <span class="hljs-comment">// Use user.name</span>

<span class="hljs-comment">// ❌ Always changing dependencies</span>
<span class="hljs-keyword">const</span> result = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> calculate(), [<span class="hljs-built_in">Math</span>.random()]);
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<h3 id="mental-model">Mental Model</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🧠 Think of useMemo as:</span>

<span class="hljs-comment">// "A cache that stores the result of expensive calculations</span>
<span class="hljs-comment">//  and only recalculates when dependencies change"</span>

<span class="hljs-keyword">const</span> memoizedValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// This only runs when dependencies change</span>
  <span class="hljs-keyword">return</span> expensiveCalculation(dependencies);
}, [dependencies]);
</div></code></pre>
<h3 id="best-practices-summary">Best Practices Summary</h3>
<ol>
<li><strong>Profile first</strong> - Measure before optimizing</li>
<li><strong>Use for expensive operations</strong> - Not simple calculations</li>
<li><strong>Stabilize references</strong> - For objects/arrays passed to children</li>
<li><strong>Specific dependencies</strong> - Use primitive values when possible</li>
<li><strong>Don't over-memoize</strong> - It has overhead too</li>
<li><strong>Consider alternatives</strong> - Sometimes restructuring is better</li>
<li><strong>Test performance impact</strong> - Verify it actually helps</li>
</ol>
<h3 id="production-tips">Production Tips</h3>
<ul>
<li><strong>Start without useMemo</strong> - Add only when needed</li>
<li><strong>Use React DevTools Profiler</strong> - Identify actual bottlenecks</li>
<li><strong>Consider component splitting</strong> - Sometimes better than memoization</li>
<li><strong>Watch bundle size</strong> - Don't memoize everything</li>
<li><strong>Document expensive operations</strong> - Help future developers understand</li>
</ul>
<hr>
<p><strong>Next up</strong>: <a href="./10-useCallback-function-memoization.md">useCallback: Function Memoization</a> - Master function memoization and prevent unnecessary re-renders.</p>
<p><strong>Previous</strong>: <a href="./08-useRef-refs-vs-variables.md">useRef: Refs vs Variables</a></p>
<hr>
<p><em>💡 Pro tip: In interviews, always explain the trade-offs. Show that you understand useMemo has overhead and should only be used when the benefits outweigh the costs. Demonstrate performance measurement techniques.</em></p>
<h1 id="usecallback-function-memoization">useCallback: Function Memoization</h1>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>What useCallback is and when to use it</li>
<li>How function references affect React re-renders</li>
<li>The relationship between useCallback and React.memo</li>
<li>Performance implications and trade-offs</li>
<li>Common patterns and anti-patterns</li>
<li>Real-world optimization scenarios</li>
</ul>
<hr>
<h2 id="%F0%9F%A7%A0-what-is-usecallback">🧠 What is useCallback?</h2>
<p><code>useCallback</code> is a React Hook that <strong>memoizes a function</strong> and returns the same function reference between renders unless its dependencies change.</p>
<h3 id="the-problem-function-recreation">The Problem: Function Recreation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Problem: New function on every render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ParentComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// 🚨 This creates a NEW function on every render</span>
  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked!"</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setName(e.target.value)} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveChild</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// This component re-renders even when only 'name' changes!</span>
<span class="hljs-keyword">const</span> ExpensiveChild = React.memo(<span class="hljs-function">(<span class="hljs-params">{ onClick }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"ExpensiveChild rendered"</span>);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
});
</div></code></pre>
<h3 id="the-solution-usecallback">The Solution: useCallback</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Solution: Stable function reference</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ParentComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// 🎯 Same function reference unless dependencies change</span>
  <span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Button clicked!"</span>);
  }, []); <span class="hljs-comment">// Empty dependencies = never changes</span>

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setName(e.target.value)} /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveChild</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Now this only re-renders when onClick actually changes!</span>
<span class="hljs-keyword">const</span> ExpensiveChild = React.memo(<span class="hljs-function">(<span class="hljs-params">{ onClick }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"ExpensiveChild rendered"</span>);
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
});
</div></code></pre>
<h2 id="%F0%9F%94%8D-deep-dive-how-usecallback-works">🔍 Deep Dive: How useCallback Works</h2>
<h3 id="basic-syntax">Basic Syntax</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> memoizedCallback = useCallback(
  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Function body</span>
    doSomething(a, b);
  },
  [a, b] <span class="hljs-comment">// Dependencies</span>
);
</div></code></pre>
<h3 id="dependency-array-behavior">Dependency Array Behavior</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CallbackDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [multiplier, setMultiplier] = useState(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> [name, setName] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// 🎯 No dependencies - function never changes</span>
  <span class="hljs-keyword">const</span> handleReset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-number">0</span>);
    setMultiplier(<span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-comment">// 🎯 Depends on count - changes when count changes</span>
  <span class="hljs-keyword">const</span> handleIncrement = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []); <span class="hljs-comment">// ✅ No dependencies needed (using functional update)</span>

  <span class="hljs-comment">// 🎯 Depends on count and multiplier</span>
  <span class="hljs-keyword">const</span> handleCalculate = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> count * multiplier;
  }, [count, multiplier]);

  <span class="hljs-comment">// 🎯 Depends on external value</span>
  <span class="hljs-keyword">const</span> handleLog = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Current name: <span class="hljs-subst">${name}</span>`</span>);
  }, [name]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Multiplier: {multiplier}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Name: {name}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleIncrement}</span>&gt;</span>Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleReset}</span>&gt;</span>Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleLog}</span>&gt;</span>Log Name<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{name}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setName(e.target.value)}
        placeholder="Enter name"
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{multiplier}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setMultiplier(Number(e.target.value))}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-usecallback-vs-usememo-key-differences">🎯 useCallback vs useMemo: Key Differences</h2>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ComparisonDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>]);

  <span class="hljs-comment">// 🎯 useMemo: Memoizes the RESULT of a calculation</span>
  <span class="hljs-keyword">const</span> expensiveValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating expensive value"</span>);
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item * item, <span class="hljs-number">0</span>);
  }, [items]);

  <span class="hljs-comment">// 🎯 useCallback: Memoizes the FUNCTION itself</span>
  <span class="hljs-keyword">const</span> expensiveFunction = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Creating expensive function"</span>);
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item * item, <span class="hljs-number">0</span>);
  }, [items]);

  <span class="hljs-comment">// 🎯 Alternative: useMemo to create a function</span>
  <span class="hljs-keyword">const</span> expensiveFunctionAlt = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Creating function with useMemo"</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item * item, <span class="hljs-number">0</span>);
  }, [items]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Expensive Value: {expensiveValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> console.log(expensiveFunction())}&gt;
        Call Function
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> console.log(expensiveFunctionAlt())}&gt;
        Call Alt Function
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="mental-model">Mental Model</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🧠 Think of it this way:</span>

<span class="hljs-comment">// useMemo: "Remember this VALUE"</span>
<span class="hljs-keyword">const</span> value = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> expensiveCalculation(), [deps]);

<span class="hljs-comment">// useCallback: "Remember this FUNCTION"</span>
<span class="hljs-keyword">const</span> func = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> doSomething(), [deps]);

<span class="hljs-comment">// They're equivalent:</span>
useCallback(fn, deps) === useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> fn, deps);
</div></code></pre>
<h2 id="%F0%9F%9A%80-real-world-patterns">🚀 Real-World Patterns</h2>
<h3 id="pattern-1-event-handlers-with-parameters">Pattern 1: Event Handlers with Parameters</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Learn React"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Build an app"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Deploy to production"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span> },
  ]);

  <span class="hljs-comment">// ❌ Bad: Creates new function for each todo</span>
  <span class="hljs-keyword">const</span> badRender = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span>
        <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>
        <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span>
        <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleTodo(todo.id)} // New function every render!
        onDelete={() =&gt; deleteTodo(todo.id)} // New function every render!
      /&gt;</span>
    ));
  };

  <span class="hljs-comment">// ✅ Good: Stable function references</span>
  <span class="hljs-keyword">const</span> handleToggle = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
        todo.id === id ? { ...todo, <span class="hljs-attr">completed</span>: !todo.completed } : todo
      )
    );
  }, []);

  <span class="hljs-keyword">const</span> handleDelete = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.id !== id));
  }, []);

  <span class="hljs-keyword">const</span> handleAdd = useCallback(<span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> newTodo = {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
      text,
      <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
    };
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, newTodo]);
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-list"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AddTodoForm</span> <span class="hljs-attr">onAdd</span>=<span class="hljs-string">{handleAdd}</span> /&gt;</span>
      {todos.map((todo) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>
          <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span>
          <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{handleToggle}</span>
          <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{handleDelete}</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Optimized child component</span>
<span class="hljs-keyword">const</span> TodoItem = React.memo(<span class="hljs-function">(<span class="hljs-params">{ todo, onToggle, onDelete }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Rendering todo: <span class="hljs-subst">${todo.id}</span>`</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">todo-item</span> ${<span class="hljs-attr">todo.completed</span> ? "<span class="hljs-attr">completed</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onToggle(todo.id)}&gt;Toggle<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onDelete(todo.id)}&gt;Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-keyword">const</span> AddTodoForm = React.memo(<span class="hljs-function">(<span class="hljs-params">{ onAdd }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [text, setText] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> handleSubmit = useCallback(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      e.preventDefault();
      <span class="hljs-keyword">if</span> (text.trim()) {
        onAdd(text.trim());
        setText(<span class="hljs-string">""</span>);
      }
    },
    [text, onAdd]
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{text}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setText(e.target.value)}
        placeholder="Add new todo"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Add<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
});
</div></code></pre>
<h3 id="pattern-2-api-calls-and-async-operations">Pattern 2: API Calls and Async Operations</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ userId }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// 🎯 Stable API call function</span>
  <span class="hljs-keyword">const</span> fetchUser = useCallback(<span class="hljs-keyword">async</span> (id) =&gt; {
    setLoading(<span class="hljs-literal">true</span>);
    setError(<span class="hljs-literal">null</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${id}</span>`</span>);
      <span class="hljs-keyword">if</span> (!response.ok) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed to fetch user"</span>);

      <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
      setUser(userData);
    } <span class="hljs-keyword">catch</span> (err) {
      setError(err.message);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  }, []); <span class="hljs-comment">// No dependencies - function is stable</span>

  <span class="hljs-comment">// 🎯 Refresh function</span>
  <span class="hljs-keyword">const</span> refreshUser = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (userId) {
      fetchUser(userId);
    }
  }, [userId, fetchUser]);

  <span class="hljs-comment">// 🎯 Update user function</span>
  <span class="hljs-keyword">const</span> updateUser = useCallback(
    <span class="hljs-keyword">async</span> (updates) =&gt; {
      setLoading(<span class="hljs-literal">true</span>);

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/users/<span class="hljs-subst">${userId}</span>`</span>, {
          <span class="hljs-attr">method</span>: <span class="hljs-string">"PATCH"</span>,
          <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
          <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(updates),
        });

        <span class="hljs-keyword">if</span> (!response.ok) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed to update user"</span>);

        <span class="hljs-keyword">const</span> updatedUser = <span class="hljs-keyword">await</span> response.json();
        setUser(updatedUser);
      } <span class="hljs-keyword">catch</span> (err) {
        setError(err.message);
      } <span class="hljs-keyword">finally</span> {
        setLoading(<span class="hljs-literal">false</span>);
      }
    },
    [userId]
  );

  <span class="hljs-comment">// Fetch user on mount and when userId changes</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (userId) {
      fetchUser(userId);
    }
  }, [userId, fetchUser]);

  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (!user) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>No user found<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-profile"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Email: {user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Role: {user.role}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">UserActions</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">onRefresh</span>=<span class="hljs-string">{refreshUser}</span> <span class="hljs-attr">onUpdate</span>=<span class="hljs-string">{updateUser}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> UserActions = React.memo(<span class="hljs-function">(<span class="hljs-params">{ user, onRefresh, onUpdate }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> [isEditing, setIsEditing] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [formData, setFormData] = useState({
    <span class="hljs-attr">name</span>: user.name,
    <span class="hljs-attr">email</span>: user.email,
  });

  <span class="hljs-keyword">const</span> handleSave = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    onUpdate(formData);
    setIsEditing(<span class="hljs-literal">false</span>);
  }, [formData, onUpdate]);

  <span class="hljs-keyword">const</span> handleCancel = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setFormData({ <span class="hljs-attr">name</span>: user.name, <span class="hljs-attr">email</span>: user.email });
    setIsEditing(<span class="hljs-literal">false</span>);
  }, [user.name, user.email]);

  <span class="hljs-keyword">if</span> (isEditing) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"edit-form"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.name}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
            setFormData((prev) =&gt; ({ ...prev, name: e.target.value }))
          }
          placeholder="Name"
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
            setFormData((prev) =&gt; ({ ...prev, email: e.target.value }))
          }
          placeholder="Email"
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSave}</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCancel}</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-actions"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsEditing(true)}&gt;Edit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onRefresh}</span>&gt;</span>Refresh<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});
</div></code></pre>
<h3 id="pattern-3-custom-hooks-with-callbacks">Pattern 3: Custom Hooks with Callbacks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Custom hook for debounced callbacks</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDebounceCallback</span>(<span class="hljs-params">callback, delay</span>) </span>{
  <span class="hljs-keyword">const</span> timeoutRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> debouncedCallback = useCallback(
    <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }

      timeoutRef.current = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        callback(...args);
      }, delay);
    },
    [callback, delay]
  );

  <span class="hljs-comment">// Cleanup on unmount</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (timeoutRef.current) {
        clearTimeout(timeoutRef.current);
      }
    };
  }, []);

  <span class="hljs-keyword">return</span> debouncedCallback;
}

<span class="hljs-comment">// 🎯 Custom hook for throttled callbacks</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useThrottleCallback</span>(<span class="hljs-params">callback, delay</span>) </span>{
  <span class="hljs-keyword">const</span> lastRun = useRef(<span class="hljs-built_in">Date</span>.now());

  <span class="hljs-keyword">const</span> throttledCallback = useCallback(
    <span class="hljs-function">(<span class="hljs-params">...args</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Date</span>.now() - lastRun.current &gt;= delay) {
        callback(...args);
        lastRun.current = <span class="hljs-built_in">Date</span>.now();
      }
    },
    [callback, delay]
  );

  <span class="hljs-keyword">return</span> throttledCallback;
}

<span class="hljs-comment">// 🎯 Usage example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SearchComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [query, setQuery] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [results, setResults] = useState([]);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// 🎯 Actual search function</span>
  <span class="hljs-keyword">const</span> performSearch = useCallback(<span class="hljs-keyword">async</span> (searchQuery) =&gt; {
    <span class="hljs-keyword">if</span> (!searchQuery.trim()) {
      setResults([]);
      <span class="hljs-keyword">return</span>;
    }

    setLoading(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(
        <span class="hljs-string">`/api/search?q=<span class="hljs-subst">${<span class="hljs-built_in">encodeURIComponent</span>(searchQuery)}</span>`</span>
      );
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
      setResults(data.results || []);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Search failed:"</span>, error);
      setResults([]);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  }, []);

  <span class="hljs-comment">// 🎯 Debounced search (waits 300ms after user stops typing)</span>
  <span class="hljs-keyword">const</span> debouncedSearch = useDebounceCallback(performSearch, <span class="hljs-number">300</span>);

  <span class="hljs-comment">// 🎯 Throttled search (max once per 1000ms)</span>
  <span class="hljs-keyword">const</span> throttledSearch = useThrottleCallback(performSearch, <span class="hljs-number">1000</span>);

  <span class="hljs-comment">// 🎯 Handle input change</span>
  <span class="hljs-keyword">const</span> handleInputChange = useCallback(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> value = e.target.value;
      setQuery(value);
      debouncedSearch(value);
    },
    [debouncedSearch]
  );

  <span class="hljs-comment">// 🎯 Handle manual search</span>
  <span class="hljs-keyword">const</span> handleManualSearch = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    throttledSearch(query);
  }, [query, throttledSearch]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"search-component"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"search-input"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{query}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Search..."</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleManualSearch}</span>&gt;</span>Search<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {loading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"loading"</span>&gt;</span>Searching...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"search-results"</span>&gt;</span>
        {results.map((result, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{result.id</span> || <span class="hljs-attr">index</span>} <span class="hljs-attr">className</span>=<span class="hljs-string">"search-result"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{result.title}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{result.description}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes-and-anti-patterns">⚠️ Common Mistakes and Anti-Patterns</h2>
<h3 id="mistake-1-unnecessary-usecallback">Mistake 1: Unnecessary useCallback</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: useCallback for simple functions that don't need optimization</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SimpleComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// ❌ Unnecessary - this function is simple and not passed to children</span>
  <span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-comment">// ✅ Better - just use a regular function</span>
  <span class="hljs-keyword">const</span> handleClickBetter = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="mistake-2-missing-dependencies">Mistake 2: Missing Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Missing dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BuggyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [multiplier, setMultiplier] = useState(<span class="hljs-number">2</span>);

  <span class="hljs-comment">// ❌ Missing 'multiplier' in dependencies</span>
  <span class="hljs-keyword">const</span> handleCalculate = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(count * multiplier); <span class="hljs-comment">// This will use stale 'multiplier'</span>
  }, [count]); <span class="hljs-comment">// Missing multiplier!</span>

  <span class="hljs-comment">// ✅ Correct dependencies</span>
  <span class="hljs-keyword">const</span> handleCalculateFixed = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(count * multiplier);
  }, [count, multiplier]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Multiplier: {multiplier}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCalculate}</span>&gt;</span>Calculate (Buggy)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCalculateFixed}</span>&gt;</span>Calculate (Fixed)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="mistake-3-objectarray-dependencies">Mistake 3: Object/Array Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Object as dependency</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProblematicComponent</span>(<span class="hljs-params">{ config }</span>) </span>{
  <span class="hljs-comment">// ❌ 'config' object changes on every render</span>
  <span class="hljs-keyword">const</span> handleProcess = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    processData(config);
  }, [config]); <span class="hljs-comment">// This will recreate the function every time!</span>

  <span class="hljs-comment">// ✅ Better: Extract specific properties</span>
  <span class="hljs-keyword">const</span> handleProcessFixed = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    processData(config);
  }, [config.apiUrl, config.timeout]); <span class="hljs-comment">// Use specific properties</span>

  <span class="hljs-comment">// ✅ Even better: Memoize the config object in parent</span>
  <span class="hljs-comment">// const config = useMemo(() =&gt; ({ apiUrl, timeout }), [apiUrl, timeout]);</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ProcessButton</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleProcess}</span> /&gt;</span></span>;
}
</div></code></pre>
<h3 id="mistake-4-inline-object-creation">Mistake 4: Inline Object Creation</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Creating objects inline</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadParent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);

  <span class="hljs-keyword">const</span> handleUpdate = useCallback(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    setData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.map(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> (d.id === item.id ? item : d)));
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {data.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
          <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
          <span class="hljs-attr">onUpdate</span>=<span class="hljs-string">{handleUpdate}</span>
          // ❌ <span class="hljs-attr">This</span> <span class="hljs-attr">creates</span> <span class="hljs-attr">a</span> <span class="hljs-attr">new</span> <span class="hljs-attr">object</span> <span class="hljs-attr">every</span> <span class="hljs-attr">render</span>!
          <span class="hljs-attr">config</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">theme:</span> "<span class="hljs-attr">dark</span>", <span class="hljs-attr">size:</span> "<span class="hljs-attr">large</span>" }}
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Good: Memoize objects</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodParent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);

  <span class="hljs-keyword">const</span> handleUpdate = useCallback(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    setData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.map(<span class="hljs-function">(<span class="hljs-params">d</span>) =&gt;</span> (d.id === item.id ? item : d)));
  }, []);

  <span class="hljs-comment">// ✅ Stable object reference</span>
  <span class="hljs-keyword">const</span> config = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>, <span class="hljs-attr">size</span>: <span class="hljs-string">"large"</span> }), []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {data.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
          <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
          <span class="hljs-attr">onUpdate</span>=<span class="hljs-string">{handleUpdate}</span>
          <span class="hljs-attr">config</span>=<span class="hljs-string">{config}</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F%E2%80%8D%E2%99%82%EF%B8%8F-mini-challenges">🏋️‍♂️ Mini-Challenges</h2>
<h3 id="challenge-1-optimized-data-table">Challenge 1: Optimized Data Table</h3>
<p>Create a data table with sorting, filtering, and pagination that doesn't re-render unnecessarily.</p>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedDataTable</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">department</span>: <span class="hljs-string">"Engineering"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">75000</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Bob"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>, <span class="hljs-attr">department</span>: <span class="hljs-string">"Design"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">65000</span> },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">name</span>: <span class="hljs-string">"Charlie"</span>,
      <span class="hljs-attr">age</span>: <span class="hljs-number">35</span>,
      <span class="hljs-attr">department</span>: <span class="hljs-string">"Engineering"</span>,
      <span class="hljs-attr">salary</span>: <span class="hljs-number">85000</span>,
    },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Diana"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">28</span>, <span class="hljs-attr">department</span>: <span class="hljs-string">"Marketing"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">60000</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Eve"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">32</span>, <span class="hljs-attr">department</span>: <span class="hljs-string">"Engineering"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">80000</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">6</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Frank"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">29</span>, <span class="hljs-attr">department</span>: <span class="hljs-string">"Design"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">70000</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">7</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Grace"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">31</span>, <span class="hljs-attr">department</span>: <span class="hljs-string">"Marketing"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">62000</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">8</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Henry"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">27</span>, <span class="hljs-attr">department</span>: <span class="hljs-string">"Engineering"</span>, <span class="hljs-attr">salary</span>: <span class="hljs-number">78000</span> },
  ]);

  <span class="hljs-keyword">const</span> [sortConfig, setSortConfig] = useState({ <span class="hljs-attr">key</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">direction</span>: <span class="hljs-string">"asc"</span> });
  <span class="hljs-keyword">const</span> [filterText, setFilterText] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [currentPage, setCurrentPage] = useState(<span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> [pageSize, setPageSize] = useState(<span class="hljs-number">5</span>);

  <span class="hljs-comment">// 🎯 Memoized filtered data</span>
  <span class="hljs-keyword">const</span> filteredData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!filterText) <span class="hljs-keyword">return</span> data;

    <span class="hljs-keyword">return</span> data.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
      <span class="hljs-built_in">Object</span>.values(item).some(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span>
        value.toString().toLowerCase().includes(filterText.toLowerCase())
      )
    );
  }, [data, filterText]);

  <span class="hljs-comment">// 🎯 Memoized sorted data</span>
  <span class="hljs-keyword">const</span> sortedData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!sortConfig.key) <span class="hljs-keyword">return</span> filteredData;

    <span class="hljs-keyword">return</span> [...filteredData].sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> aValue = a[sortConfig.key];
      <span class="hljs-keyword">const</span> bValue = b[sortConfig.key];

      <span class="hljs-keyword">if</span> (aValue &lt; bValue) <span class="hljs-keyword">return</span> sortConfig.direction === <span class="hljs-string">"asc"</span> ? <span class="hljs-number">-1</span> : <span class="hljs-number">1</span>;
      <span class="hljs-keyword">if</span> (aValue &gt; bValue) <span class="hljs-keyword">return</span> sortConfig.direction === <span class="hljs-string">"asc"</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">-1</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    });
  }, [filteredData, sortConfig]);

  <span class="hljs-comment">// 🎯 Memoized paginated data</span>
  <span class="hljs-keyword">const</span> paginatedData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> startIndex = (currentPage - <span class="hljs-number">1</span>) * pageSize;
    <span class="hljs-keyword">return</span> sortedData.slice(startIndex, startIndex + pageSize);
  }, [sortedData, currentPage, pageSize]);

  <span class="hljs-comment">// 🎯 Memoized pagination info</span>
  <span class="hljs-keyword">const</span> paginationInfo = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> totalItems = sortedData.length;
    <span class="hljs-keyword">const</span> totalPages = <span class="hljs-built_in">Math</span>.ceil(totalItems / pageSize);
    <span class="hljs-keyword">const</span> startItem = (currentPage - <span class="hljs-number">1</span>) * pageSize + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">const</span> endItem = <span class="hljs-built_in">Math</span>.min(currentPage * pageSize, totalItems);

    <span class="hljs-keyword">return</span> { totalItems, totalPages, startItem, endItem };
  }, [sortedData.length, currentPage, pageSize]);

  <span class="hljs-comment">// 🎯 Stable callback functions</span>
  <span class="hljs-keyword">const</span> handleSort = useCallback(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
    setSortConfig(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      key,
      <span class="hljs-attr">direction</span>: prev.key === key &amp;&amp; prev.direction === <span class="hljs-string">"asc"</span> ? <span class="hljs-string">"desc"</span> : <span class="hljs-string">"asc"</span>,
    }));
  }, []);

  <span class="hljs-keyword">const</span> handleFilter = useCallback(<span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    setFilterText(text);
    setCurrentPage(<span class="hljs-number">1</span>); <span class="hljs-comment">// Reset to first page when filtering</span>
  }, []);

  <span class="hljs-keyword">const</span> handlePageChange = useCallback(<span class="hljs-function">(<span class="hljs-params">page</span>) =&gt;</span> {
    setCurrentPage(page);
  }, []);

  <span class="hljs-keyword">const</span> handlePageSizeChange = useCallback(<span class="hljs-function">(<span class="hljs-params">size</span>) =&gt;</span> {
    setPageSize(size);
    setCurrentPage(<span class="hljs-number">1</span>); <span class="hljs-comment">// Reset to first page when changing page size</span>
  }, []);

  <span class="hljs-keyword">const</span> handleEdit = useCallback(<span class="hljs-function">(<span class="hljs-params">id, field, value</span>) =&gt;</span> {
    setData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> (item.id === id ? { ...item, [field]: value } : item))
    );
  }, []);

  <span class="hljs-keyword">const</span> handleDelete = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id));
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"optimized-data-table"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Optimized Data Table<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      {/* Controls */}
      <span class="hljs-tag">&lt;<span class="hljs-name">TableControls</span>
        <span class="hljs-attr">filterText</span>=<span class="hljs-string">{filterText}</span>
        <span class="hljs-attr">onFilter</span>=<span class="hljs-string">{handleFilter}</span>
        <span class="hljs-attr">pageSize</span>=<span class="hljs-string">{pageSize}</span>
        <span class="hljs-attr">onPageSizeChange</span>=<span class="hljs-string">{handlePageSizeChange}</span>
        <span class="hljs-attr">paginationInfo</span>=<span class="hljs-string">{paginationInfo}</span>
      /&gt;</span>

      {/* Table */}
      <span class="hljs-tag">&lt;<span class="hljs-name">DataTable</span>
        <span class="hljs-attr">data</span>=<span class="hljs-string">{paginatedData}</span>
        <span class="hljs-attr">sortConfig</span>=<span class="hljs-string">{sortConfig}</span>
        <span class="hljs-attr">onSort</span>=<span class="hljs-string">{handleSort}</span>
        <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{handleEdit}</span>
        <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{handleDelete}</span>
      /&gt;</span>

      {/* Pagination */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Pagination</span>
        <span class="hljs-attr">currentPage</span>=<span class="hljs-string">{currentPage}</span>
        <span class="hljs-attr">totalPages</span>=<span class="hljs-string">{paginationInfo.totalPages}</span>
        <span class="hljs-attr">onPageChange</span>=<span class="hljs-string">{handlePageChange}</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Memoized table controls</span>
<span class="hljs-keyword">const</span> TableControls = React.memo(
  <span class="hljs-function">(<span class="hljs-params">{ filterText, onFilter, pageSize, onPageSizeChange, paginationInfo }</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"TableControls rendered"</span>);

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"table-controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filter-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{filterText}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onFilter(e.target.value)}
            placeholder="Filter data..."
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"page-size-section"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>Items per page:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{pageSize}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onPageSizeChange(Number(e.target.value))}
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{5}</span>&gt;</span>5<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{10}</span>&gt;</span>10<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{20}</span>&gt;</span>20<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"info-section"</span>&gt;</span>
          Showing {paginationInfo.startItem}-{paginationInfo.endItem} of{" "}
          {paginationInfo.totalItems} items
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }
);

<span class="hljs-comment">// Memoized data table</span>
<span class="hljs-keyword">const</span> DataTable = React.memo(
  <span class="hljs-function">(<span class="hljs-params">{ data, sortConfig, onSort, onEdit, onDelete }</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"DataTable rendered"</span>);

    <span class="hljs-keyword">const</span> columns = [
      { <span class="hljs-attr">key</span>: <span class="hljs-string">"name"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Name"</span>, <span class="hljs-attr">sortable</span>: <span class="hljs-literal">true</span> },
      { <span class="hljs-attr">key</span>: <span class="hljs-string">"age"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Age"</span>, <span class="hljs-attr">sortable</span>: <span class="hljs-literal">true</span> },
      { <span class="hljs-attr">key</span>: <span class="hljs-string">"department"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Department"</span>, <span class="hljs-attr">sortable</span>: <span class="hljs-literal">true</span> },
      { <span class="hljs-attr">key</span>: <span class="hljs-string">"salary"</span>, <span class="hljs-attr">label</span>: <span class="hljs-string">"Salary"</span>, <span class="hljs-attr">sortable</span>: <span class="hljs-literal">true</span> },
    ];

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-table"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
            {columns.map((column) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">TableHeader</span>
                <span class="hljs-attr">key</span>=<span class="hljs-string">{column.key}</span>
                <span class="hljs-attr">column</span>=<span class="hljs-string">{column}</span>
                <span class="hljs-attr">sortConfig</span>=<span class="hljs-string">{sortConfig}</span>
                <span class="hljs-attr">onSort</span>=<span class="hljs-string">{onSort}</span>
              /&gt;</span>
            ))}
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Actions<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
          {data.map((item) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">TableRow</span>
              <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
              <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
              <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{onEdit}</span>
              <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{onDelete}</span>
            /&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span></span>
    );
  }
);

<span class="hljs-comment">// Memoized table header</span>
<span class="hljs-keyword">const</span> TableHeader = React.memo(<span class="hljs-function">(<span class="hljs-params">{ column, sortConfig, onSort }</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (column.sortable) {
      onSort(column.key);
    }
  }, [column.key, column.sortable, onSort]);

  <span class="hljs-keyword">const</span> getSortIcon = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (sortConfig.key !== column.key) <span class="hljs-keyword">return</span> <span class="hljs-string">"↕️"</span>;
    <span class="hljs-keyword">return</span> sortConfig.direction === <span class="hljs-string">"asc"</span> ? <span class="hljs-string">"↑"</span> : <span class="hljs-string">"↓"</span>;
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">th</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{column.sortable</span> ? "<span class="hljs-attr">sortable</span>" <span class="hljs-attr">:</span> ""} <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>
      {column.label}
      {column.sortable &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"sort-icon"</span>&gt;</span>{getSortIcon()}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Memoized table row</span>
<span class="hljs-keyword">const</span> TableRow = React.memo(<span class="hljs-function">(<span class="hljs-params">{ item, onEdit, onDelete }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Rendering row for <span class="hljs-subst">${item.name}</span>`</span>);

  <span class="hljs-keyword">const</span> [isEditing, setIsEditing] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [editData, setEditData] = useState(item);

  <span class="hljs-keyword">const</span> handleEdit = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setIsEditing(<span class="hljs-literal">true</span>);
    setEditData(item);
  }, [item]);

  <span class="hljs-keyword">const</span> handleSave = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">Object</span>.keys(editData).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (editData[key] !== item[key]) {
        onEdit(item.id, key, editData[key]);
      }
    });
    setIsEditing(<span class="hljs-literal">false</span>);
  }, [editData, item, onEdit]);

  <span class="hljs-keyword">const</span> handleCancel = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setEditData(item);
    setIsEditing(<span class="hljs-literal">false</span>);
  }, [item]);

  <span class="hljs-keyword">const</span> handleDelete = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.confirm(<span class="hljs-string">`Delete <span class="hljs-subst">${item.name}</span>?`</span>)) {
      onDelete(item.id);
    }
  }, [item.id, item.name, onDelete]);

  <span class="hljs-keyword">if</span> (isEditing) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"editing"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{editData.name}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
              setEditData((prev) =&gt; ({ ...prev, name: e.target.value }))
            }
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{editData.age}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
              setEditData((prev) =&gt; ({ ...prev, age: Number(e.target.value) }))
            }
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{editData.department}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
              setEditData((prev) =&gt; ({ ...prev, department: e.target.value }))
            }
          &gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Engineering"</span>&gt;</span>Engineering<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Design"</span>&gt;</span>Design<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"Marketing"</span>&gt;</span>Marketing<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{editData.salary}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
              setEditData((prev) =&gt; ({
                ...prev,
                salary: Number(e.target.value),
              }))
            }
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSave}</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCancel}</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.age}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.department}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>${item.salary.toLocaleString()}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleEdit}</span>&gt;</span>Edit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleDelete}</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Memoized pagination</span>
<span class="hljs-keyword">const</span> Pagination = React.memo(<span class="hljs-function">(<span class="hljs-params">{ currentPage, totalPages, onPageChange }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Pagination rendered"</span>);

  <span class="hljs-keyword">const</span> handlePrevious = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (currentPage &gt; <span class="hljs-number">1</span>) {
      onPageChange(currentPage - <span class="hljs-number">1</span>);
    }
  }, [currentPage, onPageChange]);

  <span class="hljs-keyword">const</span> handleNext = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (currentPage &lt; totalPages) {
      onPageChange(currentPage + <span class="hljs-number">1</span>);
    }
  }, [currentPage, totalPages, onPageChange]);

  <span class="hljs-keyword">const</span> handlePageClick = useCallback(
    <span class="hljs-function">(<span class="hljs-params">page</span>) =&gt;</span> {
      onPageChange(page);
    },
    [onPageChange]
  );

  <span class="hljs-keyword">const</span> getPageNumbers = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> pages = [];
    <span class="hljs-keyword">const</span> maxVisible = <span class="hljs-number">5</span>;

    <span class="hljs-keyword">let</span> start = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">1</span>, currentPage - <span class="hljs-built_in">Math</span>.floor(maxVisible / <span class="hljs-number">2</span>));
    <span class="hljs-keyword">let</span> end = <span class="hljs-built_in">Math</span>.min(totalPages, start + maxVisible - <span class="hljs-number">1</span>);

    <span class="hljs-keyword">if</span> (end - start + <span class="hljs-number">1</span> &lt; maxVisible) {
      start = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">1</span>, end - maxVisible + <span class="hljs-number">1</span>);
    }

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = start; i &lt;= end; i++) {
      pages.push(i);
    }

    <span class="hljs-keyword">return</span> pages;
  };

  <span class="hljs-keyword">if</span> (totalPages &lt;= <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"pagination"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handlePrevious}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{currentPage</span> === <span class="hljs-string">1}</span>&gt;</span>
        Previous
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {getPageNumbers().map((page) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{page}</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handlePageClick(page)}
          className={page === currentPage ? "active" : ""}
        &gt;
          {page}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      ))}

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleNext}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{currentPage</span> === <span class="hljs-string">totalPages}</span>&gt;</span>
        Next
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});
</div></code></pre>
</details>
<h3 id="challenge-2-real-time-chat-interface">Challenge 2: Real-time Chat Interface</h3>
<p>Build a chat interface with message sending, typing indicators, and user presence that optimizes re-renders.</p>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ChatInterface</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [messages, setMessages] = useState([
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
      <span class="hljs-attr">user</span>: <span class="hljs-string">"Alice"</span>,
      <span class="hljs-attr">text</span>: <span class="hljs-string">"Hello everyone!"</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now() - <span class="hljs-number">60000</span>,
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
      <span class="hljs-attr">user</span>: <span class="hljs-string">"Bob"</span>,
      <span class="hljs-attr">text</span>: <span class="hljs-string">"Hey Alice! How are you?"</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now() - <span class="hljs-number">45000</span>,
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
      <span class="hljs-attr">user</span>: <span class="hljs-string">"Alice"</span>,
      <span class="hljs-attr">text</span>: <span class="hljs-string">"I'm doing great, thanks!"</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now() - <span class="hljs-number">30000</span>,
    },
  ]);

  <span class="hljs-keyword">const</span> [currentUser, setCurrentUser] = useState(<span class="hljs-string">"Charlie"</span>);
  <span class="hljs-keyword">const</span> [newMessage, setNewMessage] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [typingUsers, setTypingUsers] = useState([]);
  <span class="hljs-keyword">const</span> [onlineUsers, setOnlineUsers] = useState([
    <span class="hljs-string">"Alice"</span>,
    <span class="hljs-string">"Bob"</span>,
    <span class="hljs-string">"Charlie"</span>,
    <span class="hljs-string">"Diana"</span>,
  ]);
  <span class="hljs-keyword">const</span> [isConnected, setIsConnected] = useState(<span class="hljs-literal">true</span>);

  <span class="hljs-comment">// 🎯 Stable message sending function</span>
  <span class="hljs-keyword">const</span> sendMessage = useCallback(
    <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!text.trim()) <span class="hljs-keyword">return</span>;

      <span class="hljs-keyword">const</span> newMsg = {
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
        <span class="hljs-attr">user</span>: currentUser,
        <span class="hljs-attr">text</span>: text.trim(),
        <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
      };

      setMessages(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, newMsg]);
      setNewMessage(<span class="hljs-string">""</span>);

      <span class="hljs-comment">// Simulate removing typing indicator</span>
      setTypingUsers(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user !== currentUser));
    },
    [currentUser]
  );

  <span class="hljs-comment">// 🎯 Stable typing handler</span>
  <span class="hljs-keyword">const</span> handleTyping = useCallback(<span class="hljs-function">(<span class="hljs-params">user, isTyping</span>) =&gt;</span> {
    setTypingUsers(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (isTyping) {
        <span class="hljs-keyword">return</span> prev.includes(user) ? prev : [...prev, user];
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">u</span>) =&gt;</span> u !== user);
      }
    });
  }, []);

  <span class="hljs-comment">// 🎯 Stable user presence handler</span>
  <span class="hljs-keyword">const</span> handleUserPresence = useCallback(<span class="hljs-function">(<span class="hljs-params">user, isOnline</span>) =&gt;</span> {
    setOnlineUsers(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (isOnline) {
        <span class="hljs-keyword">return</span> prev.includes(user) ? prev : [...prev, user];
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">u</span>) =&gt;</span> u !== user);
      }
    });
  }, []);

  <span class="hljs-comment">// 🎯 Stable message deletion</span>
  <span class="hljs-keyword">const</span> deleteMessage = useCallback(<span class="hljs-function">(<span class="hljs-params">messageId</span>) =&gt;</span> {
    setMessages(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span> msg.id !== messageId));
  }, []);

  <span class="hljs-comment">// 🎯 Stable message editing</span>
  <span class="hljs-keyword">const</span> editMessage = useCallback(<span class="hljs-function">(<span class="hljs-params">messageId, newText</span>) =&gt;</span> {
    setMessages(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">msg</span>) =&gt;</span>
        msg.id === messageId ? { ...msg, <span class="hljs-attr">text</span>: newText, <span class="hljs-attr">edited</span>: <span class="hljs-literal">true</span> } : msg
      )
    );
  }, []);

  <span class="hljs-comment">// 🎯 Simulate typing detection</span>
  <span class="hljs-keyword">const</span> typingTimeoutRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> handleInputChange = useCallback(
    <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
      setNewMessage(value);

      <span class="hljs-comment">// Start typing indicator</span>
      handleTyping(currentUser, <span class="hljs-literal">true</span>);

      <span class="hljs-comment">// Clear existing timeout</span>
      <span class="hljs-keyword">if</span> (typingTimeoutRef.current) {
        clearTimeout(typingTimeoutRef.current);
      }

      <span class="hljs-comment">// Stop typing after 1 second of inactivity</span>
      typingTimeoutRef.current = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        handleTyping(currentUser, <span class="hljs-literal">false</span>);
      }, <span class="hljs-number">1000</span>);
    },
    [currentUser, handleTyping]
  );

  <span class="hljs-comment">// 🎯 Cleanup typing timeout</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (typingTimeoutRef.current) {
        clearTimeout(typingTimeoutRef.current);
      }
    };
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chat-interface"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ChatHeader</span>
        <span class="hljs-attr">isConnected</span>=<span class="hljs-string">{isConnected}</span>
        <span class="hljs-attr">onlineUsers</span>=<span class="hljs-string">{onlineUsers}</span>
        <span class="hljs-attr">currentUser</span>=<span class="hljs-string">{currentUser}</span>
        <span class="hljs-attr">onUserChange</span>=<span class="hljs-string">{setCurrentUser}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">MessageList</span>
        <span class="hljs-attr">messages</span>=<span class="hljs-string">{messages}</span>
        <span class="hljs-attr">currentUser</span>=<span class="hljs-string">{currentUser}</span>
        <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{deleteMessage}</span>
        <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{editMessage}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">TypingIndicator</span>
        <span class="hljs-attr">typingUsers</span>=<span class="hljs-string">{typingUsers.filter((user)</span> =&gt;</span> user !== currentUser)}
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">MessageInput</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{newMessage}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleInputChange}</span>
        <span class="hljs-attr">onSend</span>=<span class="hljs-string">{sendMessage}</span>
        <span class="hljs-attr">disabled</span>=<span class="hljs-string">{!isConnected}</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Memoized chat header</span>
<span class="hljs-keyword">const</span> ChatHeader = React.memo(
  <span class="hljs-function">(<span class="hljs-params">{ isConnected, onlineUsers, currentUser, onUserChange }</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"ChatHeader rendered"</span>);

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chat-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"connection-status"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">status-indicator</span> ${
              <span class="hljs-attr">isConnected</span> ? "<span class="hljs-attr">connected</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">disconnected</span>"
            }`}
          &gt;</span>
            {isConnected ? "🟢" : "🔴"}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          {isConnected ? "Connected" : "Disconnected"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-selector"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>You are:<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{currentUser}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onUserChange(e.target.value)}
          &gt;
            {onlineUsers.map((user) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{user}</span>&gt;</span>
                {user}
              <span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"online-users"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Online: {onlineUsers.length}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-list"</span>&gt;</span>
            {onlineUsers.map((user) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"online-user"</span>&gt;</span>
                🟢 {user}
              <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }
);

<span class="hljs-comment">// Memoized message list</span>
<span class="hljs-keyword">const</span> MessageList = React.memo(
  <span class="hljs-function">(<span class="hljs-params">{ messages, currentUser, onDelete, onEdit }</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"MessageList rendered"</span>);

    <span class="hljs-keyword">const</span> messagesEndRef = useRef(<span class="hljs-literal">null</span>);

    <span class="hljs-comment">// Auto-scroll to bottom</span>
    useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      messagesEndRef.current?.scrollIntoView({ <span class="hljs-attr">behavior</span>: <span class="hljs-string">"smooth"</span> });
    }, [messages]);

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-list"</span>&gt;</span>
        {messages.map((message) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">Message</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{message.id}</span>
            <span class="hljs-attr">message</span>=<span class="hljs-string">{message}</span>
            <span class="hljs-attr">isOwn</span>=<span class="hljs-string">{message.user</span> === <span class="hljs-string">currentUser}</span>
            <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{onDelete}</span>
            <span class="hljs-attr">onEdit</span>=<span class="hljs-string">{onEdit}</span>
          /&gt;</span>
        ))}
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">{messagesEndRef}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }
);

<span class="hljs-comment">// Memoized individual message</span>
<span class="hljs-keyword">const</span> Message = React.memo(<span class="hljs-function">(<span class="hljs-params">{ message, isOwn, onDelete, onEdit }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Rendering message <span class="hljs-subst">${message.id}</span>`</span>);

  <span class="hljs-keyword">const</span> [isEditing, setIsEditing] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [editText, setEditText] = useState(message.text);

  <span class="hljs-keyword">const</span> handleEdit = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setIsEditing(<span class="hljs-literal">true</span>);
    setEditText(message.text);
  }, [message.text]);

  <span class="hljs-keyword">const</span> handleSave = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (editText.trim() &amp;&amp; editText !== message.text) {
      onEdit(message.id, editText.trim());
    }
    setIsEditing(<span class="hljs-literal">false</span>);
  }, [editText, message.id, message.text, onEdit]);

  <span class="hljs-keyword">const</span> handleCancel = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setEditText(message.text);
    setIsEditing(<span class="hljs-literal">false</span>);
  }, [message.text]);

  <span class="hljs-keyword">const</span> handleDelete = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.confirm(<span class="hljs-string">"Delete this message?"</span>)) {
      onDelete(message.id);
    }
  }, [message.id, onDelete]);

  <span class="hljs-keyword">const</span> formatTime = <span class="hljs-function">(<span class="hljs-params">timestamp</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp).toLocaleTimeString([], {
      <span class="hljs-attr">hour</span>: <span class="hljs-string">"2-digit"</span>,
      <span class="hljs-attr">minute</span>: <span class="hljs-string">"2-digit"</span>,
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">message</span> ${<span class="hljs-attr">isOwn</span> ? "<span class="hljs-attr">own</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">other</span>"}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"username"</span>&gt;</span>{message.user}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"timestamp"</span>&gt;</span>{formatTime(message.timestamp)}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        {message.edited &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"edited-indicator"</span>&gt;</span>(edited)<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-content"</span>&gt;</span>
        {isEditing ? (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"edit-form"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{editText}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setEditText(e.target.value)}
              onKeyDown={(e) =&gt; {
                if (e.key === "Enter" &amp;&amp; !e.shiftKey) {
                  e.preventDefault();
                  handleSave();
                } else if (e.key === "Escape") {
                  handleCancel();
                }
              }}
            /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"edit-actions"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSave}</span>&gt;</span>Save<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleCancel}</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ) : (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-text"</span>&gt;</span>{message.text}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {isOwn &amp;&amp; !isEditing &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-actions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleEdit}</span>&gt;</span>Edit<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleDelete}</span>&gt;</span>Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Memoized typing indicator</span>
<span class="hljs-keyword">const</span> TypingIndicator = React.memo(<span class="hljs-function">(<span class="hljs-params">{ typingUsers }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"TypingIndicator rendered"</span>);

  <span class="hljs-keyword">if</span> (typingUsers.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">const</span> getTypingText = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (typingUsers.length === <span class="hljs-number">1</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${typingUsers[<span class="hljs-number">0</span>]}</span> is typing...`</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (typingUsers.length === <span class="hljs-number">2</span>) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${typingUsers[<span class="hljs-number">0</span>]}</span> and <span class="hljs-subst">${typingUsers[<span class="hljs-number">1</span>]}</span> are typing...`</span>;
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${typingUsers.length}</span> people are typing...`</span>;
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"typing-indicator"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"typing-text"</span>&gt;</span>{getTypingText()}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"typing-dots"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>.<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Memoized message input</span>
<span class="hljs-keyword">const</span> MessageInput = React.memo(<span class="hljs-function">(<span class="hljs-params">{ value, onChange, onSend, disabled }</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"MessageInput rendered"</span>);

  <span class="hljs-keyword">const</span> handleSubmit = useCallback(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      e.preventDefault();
      onSend(value);
    },
    [value, onSend]
  );

  <span class="hljs-keyword">const</span> handleKeyDown = useCallback(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">"Enter"</span> &amp;&amp; !e.shiftKey) {
        e.preventDefault();
        onSend(value);
      }
    },
    [value, onSend]
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"message-input"</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onChange(e.target.value)}
        onKeyDown={handleKeyDown}
        placeholder={disabled ? "Disconnected..." : "Type a message..."}
        disabled={disabled}
        rows={3}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{disabled</span> || !<span class="hljs-attr">value.trim</span>()}&gt;</span>
        Send
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
});
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%AF-when-and-why-usecallback-decision-framework">🎯 When and Why: useCallback Decision Framework</h2>
<h3 id="quick-decision-tree">Quick Decision Tree</h3>
<pre class="hljs"><code><div>🤔 Should I use useCallback?

├── Is this function passed to a child component?
│   ├── Yes → Continue evaluation...
│   └── No → Probably don't need useCallback ❌
│
├── Is the child component wrapped in React.memo?
│   ├── Yes → Use useCallback ✅
│   └── No → Continue evaluation...
│
├── Is this function used in a dependency array?
│   ├── Yes → Use useCallback ✅
│   └── No → Continue evaluation...
│
├── Is this an expensive function to recreate?
│   ├── Yes → Use useCallback ✅
│   └── No → Continue evaluation...
│
└── Does the function have complex dependencies?
    ├── Yes → Consider useCallback ⚠️
    └── No → Probably don't need useCallback ❌
</div></code></pre>
<h3 id="performance-guidelines">Performance Guidelines</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 When TO use useCallback:</span>

<span class="hljs-comment">// ✅ Passed to memoized children</span>
<span class="hljs-keyword">const</span> ExpensiveChild = React.memo(<span class="hljs-function">(<span class="hljs-params">{ onClick }</span>) =&gt;</span> {
  <span class="hljs-comment">/* ... */</span>
});
<span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">/* ... */</span>
}, []);
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveChild</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> /&gt;</span></span>;

<span class="hljs-comment">// ✅ Used in dependency arrays</span>
<span class="hljs-keyword">const</span> fetchData = useCallback(<span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-comment">/* ... */</span>
}, [userId]);
useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  fetchData();
}, [fetchData]);

<span class="hljs-comment">// ✅ Event handlers with parameters</span>
<span class="hljs-keyword">const</span> handleItemClick = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
  <span class="hljs-comment">/* ... */</span>
}, []);

<span class="hljs-comment">// ✅ Custom hook callbacks</span>
<span class="hljs-keyword">const</span> debouncedCallback = useDebounceCallback(callback, <span class="hljs-number">300</span>);

<span class="hljs-comment">// 🎯 When NOT to use useCallback:</span>

<span class="hljs-comment">// ❌ Simple event handlers not passed to children</span>
<span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>); <span class="hljs-comment">// Don't memo</span>

<span class="hljs-comment">// ❌ Functions that change on every render anyway</span>
<span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">Math</span>.random()); <span class="hljs-comment">// Dependencies change constantly</span>
}, [<span class="hljs-built_in">Math</span>.random()]);

<span class="hljs-comment">// ❌ More overhead than benefit</span>
<span class="hljs-keyword">const</span> simple = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> a + b, [a, b]); <span class="hljs-comment">// Too simple</span>
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-interview-questions">Common Interview Questions</h3>
<ol>
<li>
<p><strong>&quot;What's the difference between useCallback and useMemo?&quot;</strong></p>
<ul>
<li>useCallback memoizes functions, useMemo memoizes values</li>
<li>useCallback(fn, deps) === useMemo(() =&gt; fn, deps)</li>
<li>Show practical examples of when to use each</li>
</ul>
</li>
<li>
<p><strong>&quot;When would you use useCallback?&quot;</strong></p>
<ul>
<li>Preventing unnecessary re-renders of memoized children</li>
<li>Stabilizing function references for dependency arrays</li>
<li>Optimizing expensive function creation</li>
<li>Custom hooks that return callbacks</li>
</ul>
</li>
<li>
<p><strong>&quot;How does useCallback help with React.memo?&quot;</strong></p>
<ul>
<li>React.memo does shallow comparison of props</li>
<li>Functions are recreated on every render (new reference)</li>
<li>useCallback provides stable function reference</li>
<li>Prevents unnecessary child re-renders</li>
</ul>
</li>
<li>
<p><strong>&quot;What are the trade-offs of useCallback?&quot;</strong></p>
<ul>
<li>Memory overhead (storing function reference)</li>
<li>Comparison overhead (checking dependencies)</li>
<li>Code complexity</li>
<li>Can prevent garbage collection if overused</li>
</ul>
</li>
</ol>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🚨 Red Flags in Interviews:</span>

<span class="hljs-comment">// ❌ Using useCallback everywhere</span>
<span class="hljs-keyword">const</span> simple = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>), []);

<span class="hljs-comment">// ❌ Missing dependencies</span>
<span class="hljs-keyword">const</span> handler = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(name); <span class="hljs-comment">// Uses 'name' but not in deps</span>
}, []); <span class="hljs-comment">// Missing 'name'</span>

<span class="hljs-comment">// ❌ Expensive dependencies</span>
<span class="hljs-keyword">const</span> handler = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  process(data);
}, [data.map(<span class="hljs-function">(<span class="hljs-params">x</span>) =&gt;</span> x.id)]); <span class="hljs-comment">// Creates new array every time</span>

<span class="hljs-comment">// ❌ Not using with React.memo</span>
<span class="hljs-keyword">const</span> Child = <span class="hljs-function">(<span class="hljs-params">{ onClick }</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>Click<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
<span class="hljs-keyword">const</span> handler = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {}, []); <span class="hljs-comment">// Useless without memo</span>

<span class="hljs-comment">// ❌ Inline object creation</span>
<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Child</span>
  <span class="hljs-attr">onClick</span>=<span class="hljs-string">{useCallback(()</span> =&gt;</span> {}, [])}
  config={{ theme: "dark" }} // This breaks memoization anyway!
/&gt;</span>;
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<h3 id="mental-model">Mental Model</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🧠 Think of useCallback as:</span>

<span class="hljs-comment">// "Give me the same function reference unless dependencies change"</span>

<span class="hljs-keyword">const</span> stableFunction = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-comment">// This function object stays the same</span>
  <span class="hljs-comment">// unless dependencies in the array change</span>
}, [dependencies]);
</div></code></pre>
<h3 id="best-practices-summary">Best Practices Summary</h3>
<ol>
<li><strong>Use with React.memo</strong> - Primary use case for optimization</li>
<li><strong>Stabilize dependencies</strong> - For useEffect and other hooks</li>
<li><strong>Don't overuse</strong> - Has overhead, use judiciously</li>
<li><strong>Include all dependencies</strong> - Avoid stale closures</li>
<li><strong>Consider alternatives</strong> - Sometimes restructuring is better</li>
<li><strong>Profile performance</strong> - Measure actual impact</li>
<li><strong>Use ESLint rules</strong> - Catch missing dependencies</li>
</ol>
<h3 id="production-tips">Production Tips</h3>
<ul>
<li><strong>Start without useCallback</strong> - Add only when needed</li>
<li><strong>Use React DevTools Profiler</strong> - Identify actual bottlenecks</li>
<li><strong>Combine with useMemo</strong> - For complete optimization</li>
<li><strong>Watch for stale closures</strong> - Common bug with missing deps</li>
<li><strong>Document optimization intent</strong> - Help future developers</li>
</ul>
<hr>
<p><strong>Next up</strong>: <a href="./11-useContext-global-state.md">useContext: Global State Management</a> - Master React's built-in state management solution.</p>
<p><strong>Previous</strong>: <a href="./09-useMemo-what-when-why.md">useMemo: What, When, Why</a></p>
<hr>
<p><em>💡 Pro tip: In interviews, demonstrate that you understand useCallback is an optimization tool, not a requirement. Show that you can identify when it's beneficial vs. when it adds unnecessary complexity.</em></p>
<h1 id="usecontext-global-state-management">useContext: Global State Management</h1>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>What React Context is and when to use it</li>
<li>How to create and consume context effectively</li>
<li>Context vs prop drilling solutions</li>
<li>Performance implications and optimization strategies</li>
<li>Common patterns and anti-patterns</li>
<li>Real-world state management scenarios</li>
</ul>
<hr>
<h2 id="%F0%9F%A7%A0-what-is-usecontext">🧠 What is useContext?</h2>
<p><code>useContext</code> is a React Hook that allows you to <strong>consume context values</strong> without wrapping your component in a Context Consumer. It provides a way to share data across the component tree without passing props down manually at every level.</p>
<h3 id="the-problem-prop-drilling">The Problem: Prop Drilling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Problem: Prop drilling through multiple levels</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span> });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Main</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Header</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Navigation</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Navigation</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Welcome, {user.name}!<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Main</span>(<span class="hljs-params">{ user, setUser }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Content</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Content</span>(<span class="hljs-params">{ user, setUser }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Settings</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Settings</span>(<span class="hljs-params">{ user, setUser }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeToggle</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">setUser</span>=<span class="hljs-string">{setUser}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThemeToggle</span>(<span class="hljs-params">{ user, setUser }</span>) </span>{
  <span class="hljs-keyword">const</span> toggleTheme = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setUser(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">theme</span>: prev.theme === <span class="hljs-string">"dark"</span> ? <span class="hljs-string">"light"</span> : <span class="hljs-string">"dark"</span>,
    }));
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleTheme}</span>&gt;</span>Current theme: {user.theme}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="the-solution-context">The Solution: Context</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Solution: Context eliminates prop drilling</span>
<span class="hljs-keyword">import</span> { createContext, useContext, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-comment">// 🎯 Create context</span>
<span class="hljs-keyword">const</span> UserContext = createContext();

<span class="hljs-comment">// 🎯 Context provider component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">"Alice"</span>, <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span> });

  <span class="hljs-keyword">const</span> value = {
    user,
    setUser,
    <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setUser(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
        ...prev,
        <span class="hljs-attr">theme</span>: prev.theme === <span class="hljs-string">"dark"</span> ? <span class="hljs-string">"light"</span> : <span class="hljs-string">"dark"</span>,
      }));
    },
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-comment">// 🎯 Custom hook for consuming context</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useUser</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(UserContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useUser must be used within a UserProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// 🎯 Clean component tree</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Main</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserProvider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Header</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Navigation</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Navigation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { user } = useUser(); <span class="hljs-comment">// Direct access!</span>
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Welcome, {user.name}!<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Main</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Content</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Content</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Settings</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Settings</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeToggle</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThemeToggle</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { user, toggleTheme } = useUser(); <span class="hljs-comment">// Direct access!</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleTheme}</span>&gt;</span>Current theme: {user.theme}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}
</div></code></pre>
<h2 id="%F0%9F%94%8D-deep-dive-context-fundamentals">🔍 Deep Dive: Context Fundamentals</h2>
<h3 id="creating-context">Creating Context</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { createContext } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-comment">// 🎯 Basic context creation</span>
<span class="hljs-keyword">const</span> MyContext = createContext();

<span class="hljs-comment">// 🎯 Context with default value</span>
<span class="hljs-keyword">const</span> ThemeContext = createContext(<span class="hljs-string">"light"</span>);

<span class="hljs-comment">// 🎯 Context with complex default value</span>
<span class="hljs-keyword">const</span> AppContext = createContext({
  <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span>,
  <span class="hljs-attr">language</span>: <span class="hljs-string">"en"</span>,
  <span class="hljs-attr">updateUser</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {},
  <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {},
  <span class="hljs-attr">setLanguage</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {},
});

<span class="hljs-comment">// 🎯 Context with TypeScript (if using TypeScript)</span>
<span class="hljs-comment">// interface UserContextType {</span>
<span class="hljs-comment">//   user: User | null;</span>
<span class="hljs-comment">//   login: (user: User) =&gt; void;</span>
<span class="hljs-comment">//   logout: () =&gt; void;</span>
<span class="hljs-comment">// }</span>
<span class="hljs-comment">// const UserContext = createContext&lt;UserContextType | undefined&gt;(undefined);</span>
</div></code></pre>
<h3 id="provider-pattern">Provider Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ContextDemo</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// 🎯 Multiple context providers</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LanguageProvider</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LanguageProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">UserProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 🎯 Theme context</span>
<span class="hljs-keyword">const</span> ThemeContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThemeProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [theme, setTheme] = useState(<span class="hljs-string">"light"</span>);
  <span class="hljs-keyword">const</span> [primaryColor, setPrimaryColor] = useState(<span class="hljs-string">"#007bff"</span>);

  <span class="hljs-keyword">const</span> value = {
    theme,
    primaryColor,
    setTheme,
    setPrimaryColor,
    <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
      setTheme(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> (prev === <span class="hljs-string">"light"</span> ? <span class="hljs-string">"dark"</span> : <span class="hljs-string">"light"</span>)),
    <span class="hljs-attr">isDark</span>: theme === <span class="hljs-string">"dark"</span>,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 🎯 User context</span>
<span class="hljs-keyword">const</span> UserContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [isLoading, setIsLoading] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> login = <span class="hljs-keyword">async</span> (credentials) =&gt; {
    setIsLoading(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/login"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(credentials),
      });
      <span class="hljs-keyword">const</span> userData = <span class="hljs-keyword">await</span> response.json();
      setUser(userData);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Login failed:"</span>, error);
    } <span class="hljs-keyword">finally</span> {
      setIsLoading(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-keyword">const</span> logout = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setUser(<span class="hljs-literal">null</span>);
    localStorage.removeItem(<span class="hljs-string">"token"</span>);
  };

  <span class="hljs-keyword">const</span> value = {
    user,
    isLoading,
    login,
    logout,
    <span class="hljs-attr">isAuthenticated</span>: !!user,
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-comment">// 🎯 Language context</span>
<span class="hljs-keyword">const</span> LanguageContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LanguageProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [language, setLanguage] = useState(<span class="hljs-string">"en"</span>);
  <span class="hljs-keyword">const</span> [translations, setTranslations] = useState({});

  <span class="hljs-keyword">const</span> loadTranslations = <span class="hljs-keyword">async</span> (lang) =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`/api/translations/<span class="hljs-subst">${lang}</span>`</span>);
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
      setTranslations(data);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to load translations:"</span>, error);
    }
  };

  <span class="hljs-keyword">const</span> translate = <span class="hljs-function">(<span class="hljs-params">key, fallback = key</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> translations[key] || fallback;
  };

  <span class="hljs-keyword">const</span> value = {
    language,
    setLanguage,
    translate,
    loadTranslations,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LanguageContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">LanguageContext.Provider</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="custom-hooks-for-context">Custom Hooks for Context</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Custom hooks with error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useTheme</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(ThemeContext);
  <span class="hljs-keyword">if</span> (context === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useTheme must be used within a ThemeProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useUser</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(UserContext);
  <span class="hljs-keyword">if</span> (context === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useUser must be used within a UserProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useLanguage</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(LanguageContext);
  <span class="hljs-keyword">if</span> (context === <span class="hljs-literal">undefined</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useLanguage must be used within a LanguageProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// 🎯 Selective context consumption</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useThemeActions</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { setTheme, setPrimaryColor, toggleTheme } = useTheme();
  <span class="hljs-keyword">return</span> { setTheme, setPrimaryColor, toggleTheme };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useThemeValues</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { theme, primaryColor, isDark } = useTheme();
  <span class="hljs-keyword">return</span> { theme, primaryColor, isDark };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAuth</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { user, isAuthenticated, login, logout } = useUser();
  <span class="hljs-keyword">return</span> { user, isAuthenticated, login, logout };
}
</div></code></pre>
<h2 id="%F0%9F%9A%80-real-world-patterns">🚀 Real-World Patterns</h2>
<h3 id="pattern-1-shopping-cart-context">Pattern 1: Shopping Cart Context</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> CartContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CartProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [items, setItems] = useState([]);
  <span class="hljs-keyword">const</span> [isOpen, setIsOpen] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// 🎯 Cart calculations</span>
  <span class="hljs-keyword">const</span> totalItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.quantity, <span class="hljs-number">0</span>);
  }, [items]);

  <span class="hljs-keyword">const</span> totalPrice = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.price * item.quantity, <span class="hljs-number">0</span>);
  }, [items]);

  <span class="hljs-comment">// 🎯 Cart actions</span>
  <span class="hljs-keyword">const</span> addItem = useCallback(<span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> existingItem = prev.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === product.id);

      <span class="hljs-keyword">if</span> (existingItem) {
        <span class="hljs-keyword">return</span> prev.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id === product.id
            ? { ...item, <span class="hljs-attr">quantity</span>: item.quantity + <span class="hljs-number">1</span> }
            : item
        );
      }

      <span class="hljs-keyword">return</span> [...prev, { ...product, <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span> }];
    });
  }, []);

  <span class="hljs-keyword">const</span> removeItem = useCallback(<span class="hljs-function">(<span class="hljs-params">productId</span>) =&gt;</span> {
    setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== productId));
  }, []);

  <span class="hljs-keyword">const</span> updateQuantity = useCallback(
    <span class="hljs-function">(<span class="hljs-params">productId, quantity</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (quantity &lt;= <span class="hljs-number">0</span>) {
        removeItem(productId);
        <span class="hljs-keyword">return</span>;
      }

      setItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
        prev.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id === productId ? { ...item, quantity } : item
        )
      );
    },
    [removeItem]
  );

  <span class="hljs-keyword">const</span> clearCart = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setItems([]);
  }, []);

  <span class="hljs-keyword">const</span> toggleCart = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setIsOpen(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> !prev);
  }, []);

  <span class="hljs-comment">// 🎯 Persist cart to localStorage</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> savedCart = localStorage.getItem(<span class="hljs-string">"cart"</span>);
    <span class="hljs-keyword">if</span> (savedCart) {
      <span class="hljs-keyword">try</span> {
        setItems(<span class="hljs-built_in">JSON</span>.parse(savedCart));
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to load cart from localStorage:"</span>, error);
      }
    }
  }, []);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    localStorage.setItem(<span class="hljs-string">"cart"</span>, <span class="hljs-built_in">JSON</span>.stringify(items));
  }, [items]);

  <span class="hljs-keyword">const</span> value = {
    items,
    totalItems,
    totalPrice,
    isOpen,
    addItem,
    removeItem,
    updateQuantity,
    clearCart,
    toggleCart,
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CartContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">CartContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(CartContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useCart must be used within a CartProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// 🎯 Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProductCard</span>(<span class="hljs-params">{ product }</span>) </span>{
  <span class="hljs-keyword">const</span> { addItem } = useCart();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>${product.price}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> addItem(product)}&gt;Add to Cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CartIcon</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { totalItems, toggleCart } = useCart();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-icon"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleCart}</span>&gt;</span>
      🛒 {totalItems &gt; 0 &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"badge"</span>&gt;</span>{totalItems}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CartSidebar</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { items, totalPrice, isOpen, updateQuantity, removeItem, clearCart } =
    useCart();

  <span class="hljs-keyword">if</span> (!isOpen) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-sidebar"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Shopping Cart<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

      {items.length === 0 ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Your cart is empty<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;&gt;</span>
          {items.map((item) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-item"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>${item.price} each<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"quantity-controls"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                  <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateQuantity(item.id, item.quantity - 1)}
                &gt;
                  -
                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{item.quantity}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                  <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> updateQuantity(item.id, item.quantity + 1)}
                &gt;
                  +
                <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> removeItem(item.id)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-total"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Total: ${totalPrice.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-actions"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearCart}</span>&gt;</span>Clear Cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"checkout-btn"</span>&gt;</span>Checkout<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      )}
    &lt;<span class="hljs-regexp">/div&gt;
  );
}
</span></div></code></pre>
<h3 id="pattern-2-notification-system">Pattern 2: Notification System</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> NotificationContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NotificationProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [notifications, setNotifications] = useState([]);

  <span class="hljs-keyword">const</span> addNotification = useCallback(<span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">Date</span>.now() + <span class="hljs-built_in">Math</span>.random();
    <span class="hljs-keyword">const</span> newNotification = {
      id,
      <span class="hljs-attr">type</span>: <span class="hljs-string">"info"</span>,
      <span class="hljs-attr">duration</span>: <span class="hljs-number">5000</span>,
      ...notification,
    };

    setNotifications(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, newNotification]);

    <span class="hljs-comment">// Auto-remove after duration</span>
    <span class="hljs-keyword">if</span> (newNotification.duration &gt; <span class="hljs-number">0</span>) {
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        removeNotification(id);
      }, newNotification.duration);
    }
  }, []);

  <span class="hljs-keyword">const</span> removeNotification = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setNotifications(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.filter(<span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> notification.id !== id)
    );
  }, []);

  <span class="hljs-keyword">const</span> clearAll = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setNotifications([]);
  }, []);

  <span class="hljs-comment">// 🎯 Convenience methods</span>
  <span class="hljs-keyword">const</span> showSuccess = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message, options = {}</span>) =&gt;</span> {
      addNotification({ <span class="hljs-attr">type</span>: <span class="hljs-string">"success"</span>, message, ...options });
    },
    [addNotification]
  );

  <span class="hljs-keyword">const</span> showError = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message, options = {}</span>) =&gt;</span> {
      addNotification({ <span class="hljs-attr">type</span>: <span class="hljs-string">"error"</span>, message, <span class="hljs-attr">duration</span>: <span class="hljs-number">0</span>, ...options });
    },
    [addNotification]
  );

  <span class="hljs-keyword">const</span> showWarning = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message, options = {}</span>) =&gt;</span> {
      addNotification({ <span class="hljs-attr">type</span>: <span class="hljs-string">"warning"</span>, message, ...options });
    },
    [addNotification]
  );

  <span class="hljs-keyword">const</span> showInfo = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message, options = {}</span>) =&gt;</span> {
      addNotification({ <span class="hljs-attr">type</span>: <span class="hljs-string">"info"</span>, message, ...options });
    },
    [addNotification]
  );

  <span class="hljs-keyword">const</span> value = {
    notifications,
    addNotification,
    removeNotification,
    clearAll,
    showSuccess,
    showError,
    showWarning,
    showInfo,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">NotificationContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      {children}
      <span class="hljs-tag">&lt;<span class="hljs-name">NotificationContainer</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">NotificationContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useNotifications</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(NotificationContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">"useNotifications must be used within a NotificationProvider"</span>
    );
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NotificationContainer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { notifications } = useNotifications();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"notification-container"</span>&gt;</span>
      {notifications.map((notification) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Notification</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{notification.id}</span> <span class="hljs-attr">notification</span>=<span class="hljs-string">{notification}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Notification</span>(<span class="hljs-params">{ notification }</span>) </span>{
  <span class="hljs-keyword">const</span> { removeNotification } = useNotifications();
  <span class="hljs-keyword">const</span> [isVisible, setIsVisible] = useState(<span class="hljs-literal">false</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Trigger animation</span>
    <span class="hljs-keyword">const</span> timer = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setIsVisible(<span class="hljs-literal">true</span>), <span class="hljs-number">10</span>);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearTimeout(timer);
  }, []);

  <span class="hljs-keyword">const</span> handleClose = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setIsVisible(<span class="hljs-literal">false</span>);
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> removeNotification(notification.id), <span class="hljs-number">300</span>);
  };

  <span class="hljs-keyword">const</span> getIcon = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (notification.type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"success"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"✅"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"error"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"❌"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"warning"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"⚠️"</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"ℹ️"</span>;
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">notification</span> <span class="hljs-attr">notification-</span>${<span class="hljs-attr">notification.type</span>} ${
        <span class="hljs-attr">isVisible</span> ? "<span class="hljs-attr">visible</span>" <span class="hljs-attr">:</span> ""
      }`}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"notification-icon"</span>&gt;</span>{getIcon()}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"notification-message"</span>&gt;</span>{notification.message}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"notification-close"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClose}</span>&gt;</span>
        ×
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 🎯 Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LoginForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { showSuccess, showError } = useNotifications();
  <span class="hljs-keyword">const</span> [credentials, setCredentials] = useState({ <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">password</span>: <span class="hljs-string">""</span> });

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> (e) =&gt; {
    e.preventDefault();

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/login"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(credentials),
      });

      <span class="hljs-keyword">if</span> (response.ok) {
        showSuccess(<span class="hljs-string">"Login successful! Welcome back."</span>);
      } <span class="hljs-keyword">else</span> {
        showError(<span class="hljs-string">"Login failed. Please check your credentials."</span>);
      }
    } <span class="hljs-keyword">catch</span> (error) {
      showError(<span class="hljs-string">"Network error. Please try again."</span>);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{credentials.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
          setCredentials((prev) =&gt; ({ ...prev, email: e.target.value }))
        }
        placeholder="Email"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{credentials.password}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
          setCredentials((prev) =&gt; ({ ...prev, password: e.target.value }))
        }
        placeholder="Password"
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="pattern-3-modal-management">Pattern 3: Modal Management</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> ModalContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ModalProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [modals, setModals] = useState([]);

  <span class="hljs-keyword">const</span> openModal = useCallback(<span class="hljs-function">(<span class="hljs-params">modalConfig</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">Date</span>.now() + <span class="hljs-built_in">Math</span>.random();
    <span class="hljs-keyword">const</span> modal = {
      id,
      ...modalConfig,
    };

    setModals(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, modal]);
    <span class="hljs-keyword">return</span> id;
  }, []);

  <span class="hljs-keyword">const</span> closeModal = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setModals(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">modal</span>) =&gt;</span> modal.id !== id));
  }, []);

  <span class="hljs-keyword">const</span> closeAllModals = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setModals([]);
  }, []);

  <span class="hljs-keyword">const</span> updateModal = useCallback(<span class="hljs-function">(<span class="hljs-params">id, updates</span>) =&gt;</span> {
    setModals(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">modal</span>) =&gt;</span> (modal.id === id ? { ...modal, ...updates } : modal))
    );
  }, []);

  <span class="hljs-comment">// 🎯 Convenience methods</span>
  <span class="hljs-keyword">const</span> confirm = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message, options = {}</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> id = openModal({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"confirm"</span>,
          message,
          <span class="hljs-attr">onConfirm</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            closeModal(id);
            resolve(<span class="hljs-literal">true</span>);
          },
          <span class="hljs-attr">onCancel</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            closeModal(id);
            resolve(<span class="hljs-literal">false</span>);
          },
          ...options,
        });
      });
    },
    [openModal, closeModal]
  );

  <span class="hljs-keyword">const</span> alert = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message, options = {}</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> id = openModal({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"alert"</span>,
          message,
          <span class="hljs-attr">onClose</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            closeModal(id);
            resolve();
          },
          ...options,
        });
      });
    },
    [openModal, closeModal]
  );

  <span class="hljs-keyword">const</span> prompt = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message, defaultValue = <span class="hljs-string">""</span>, options = {}</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> id = openModal({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"prompt"</span>,
          message,
          defaultValue,
          <span class="hljs-attr">onSubmit</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
            closeModal(id);
            resolve(value);
          },
          <span class="hljs-attr">onCancel</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
            closeModal(id);
            resolve(<span class="hljs-literal">null</span>);
          },
          ...options,
        });
      });
    },
    [openModal, closeModal]
  );

  <span class="hljs-keyword">const</span> value = {
    modals,
    openModal,
    closeModal,
    closeAllModals,
    updateModal,
    confirm,
    alert,
    prompt,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ModalContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      {children}
      <span class="hljs-tag">&lt;<span class="hljs-name">ModalContainer</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ModalContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useModal</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(ModalContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useModal must be used within a ModalProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ModalContainer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { modals } = useModal();

  <span class="hljs-keyword">if</span> (modals.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-overlay"</span>&gt;</span>
      {modals.map((modal) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Modal</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{modal.id}</span> <span class="hljs-attr">modal</span>=<span class="hljs-string">{modal}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Modal</span>(<span class="hljs-params">{ modal }</span>) </span>{
  <span class="hljs-keyword">const</span> { closeModal } = useModal();
  <span class="hljs-keyword">const</span> [inputValue, setInputValue] = useState(modal.defaultValue || <span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> handleBackdropClick = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.target === e.currentTarget &amp;&amp; modal.closeOnBackdrop !== <span class="hljs-literal">false</span>) {
      closeModal(modal.id);
    }
  };

  <span class="hljs-keyword">const</span> handleKeyDown = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">"Escape"</span> &amp;&amp; modal.closeOnEscape !== <span class="hljs-literal">false</span>) {
      closeModal(modal.id);
    }
  };

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleKeyDown);
  }, []);

  <span class="hljs-keyword">const</span> renderContent = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (modal.type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"confirm"</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{modal.title || "Confirm"}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{modal.message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-actions"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{modal.onCancel}</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{modal.onConfirm}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"primary"</span>&gt;</span>
                Confirm
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );

      <span class="hljs-keyword">case</span> <span class="hljs-string">"alert"</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{modal.title || "Alert"}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{modal.message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-actions"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{modal.onClose}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"primary"</span>&gt;</span>
                OK
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );

      <span class="hljs-keyword">case</span> <span class="hljs-string">"prompt"</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{modal.title || "Input Required"}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{modal.message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
              <span class="hljs-attr">value</span>=<span class="hljs-string">{inputValue}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setInputValue(e.target.value)}
              placeholder={modal.placeholder}
              autoFocus
            /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-actions"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{modal.onCancel}</span>&gt;</span>Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
                <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> modal.onSubmit(inputValue)}
                className="primary"
              &gt;
                Submit
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );

      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> modal.content;
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-backdrop"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleBackdropClick}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal"</span>&gt;</span>{renderContent()}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 🎯 Usage examples</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DeleteButton</span>(<span class="hljs-params">{ itemId, itemName }</span>) </span>{
  <span class="hljs-keyword">const</span> { confirm } = useModal();

  <span class="hljs-keyword">const</span> handleDelete = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> confirmed = <span class="hljs-keyword">await</span> confirm(
      <span class="hljs-string">`Are you sure you want to delete "<span class="hljs-subst">${itemName}</span>"? This action cannot be undone.`</span>,
      { <span class="hljs-attr">title</span>: <span class="hljs-string">"Delete Item"</span> }
    );

    <span class="hljs-keyword">if</span> (confirmed) {
      <span class="hljs-comment">// Proceed with deletion</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Deleting item:"</span>, itemId);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleDelete}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"delete-btn"</span>&gt;</span>
      Delete
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">RenameButton</span>(<span class="hljs-params">{ itemId, currentName }</span>) </span>{
  <span class="hljs-keyword">const</span> { prompt } = useModal();

  <span class="hljs-keyword">const</span> handleRename = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> newName = <span class="hljs-keyword">await</span> prompt(<span class="hljs-string">"Enter a new name:"</span>, currentName, {
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Rename Item"</span>,
      <span class="hljs-attr">placeholder</span>: <span class="hljs-string">"Item name"</span>,
    });

    <span class="hljs-keyword">if</span> (newName &amp;&amp; newName !== currentName) {
      <span class="hljs-comment">// Proceed with rename</span>
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Renaming item:"</span>, itemId, <span class="hljs-string">"to:"</span>, newName);
    }
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleRename}</span>&gt;</span>Rename<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes-and-anti-patterns">⚠️ Common Mistakes and Anti-Patterns</h2>
<h3 id="mistake-1-context-for-everything">Mistake 1: Context for Everything</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Using context for local state</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Don't create context for state that's only used in one component</span>
  <span class="hljs-keyword">const</span> CountContext = createContext();

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CountProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
    <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CountContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">count</span>, <span class="hljs-attr">setCount</span> }}&gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">CountContext.Provider</span>&gt;</span></span>
    );
  }

  <span class="hljs-comment">// This is overkill for local state</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CountProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Counter</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">CountProvider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Good: Use local state for local concerns</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount((c) =&gt; c + 1)}&gt;Increment<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="mistake-2-not-memoizing-context-values">Mistake 2: Not Memoizing Context Values</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Creating new objects on every render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// This creates a new object on every render!</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">user</span>, <span class="hljs-attr">setUser</span> }}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Good: Memoize the context value</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      user,
      setUser,
    }),
    [user]
  );

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ Even better: Separate stable and changing values</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BetterProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> actions = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      setUser,
      <span class="hljs-attr">login</span>: <span class="hljs-keyword">async</span> (credentials) =&gt; {
        <span class="hljs-comment">/* ... */</span>
      },
      <span class="hljs-attr">logout</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setUser(<span class="hljs-literal">null</span>),
    }),
    []
  ); <span class="hljs-comment">// Stable functions</span>

  <span class="hljs-keyword">const</span> state = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      user,
      <span class="hljs-attr">isAuthenticated</span>: !!user,
    }),
    [user]
  ); <span class="hljs-comment">// Changing state</span>

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      ...state,
      ...actions,
    }),
    [state, actions]
  );

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="mistake-3-too-many-contexts">Mistake 3: Too Many Contexts</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Separate context for every piece of state</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadApp</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">LanguageProvider</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">NotificationProvider</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">CartProvider</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">ModalProvider</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">LoadingProvider</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">ErrorProvider</span>&gt;</span>
                    <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
                  <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorProvider</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">LoadingProvider</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">ModalProvider</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">CartProvider</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">NotificationProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">LanguageProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserProvider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Good: Combine related contexts</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodApp</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppProvider</span>&gt;</span>
      {" "}
      {/* Combines user, theme, language */}
      <span class="hljs-tag">&lt;<span class="hljs-name">UIProvider</span>&gt;</span>
        {" "}
        {/* Combines notifications, modals, loading */}
        <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingProvider</span>&gt;</span>
          {" "}
          {/* Combines cart, wishlist, orders */}
          <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ShoppingProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">UIProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">AppProvider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Combined context example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AppProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [theme, setTheme] = useState(<span class="hljs-string">"light"</span>);
  <span class="hljs-keyword">const</span> [language, setLanguage] = useState(<span class="hljs-string">"en"</span>);

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      <span class="hljs-comment">// User state</span>
      user,
      setUser,
      <span class="hljs-attr">isAuthenticated</span>: !!user,

      <span class="hljs-comment">// Theme state</span>
      theme,
      setTheme,
      <span class="hljs-attr">toggleTheme</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
        setTheme(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> (prev === <span class="hljs-string">"light"</span> ? <span class="hljs-string">"dark"</span> : <span class="hljs-string">"light"</span>)),

      <span class="hljs-comment">// Language state</span>
      language,
      setLanguage,
    }),
    [user, theme, language]
  );

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">AppContext.Provider</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="mistake-4-context-performance-issues">Mistake 4: Context Performance Issues</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Single context with frequently changing values</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadPerformanceProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [mousePosition, setMousePosition] = useState({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> });

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleMouseMove = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      setMousePosition({ <span class="hljs-attr">x</span>: e.clientX, <span class="hljs-attr">y</span>: e.clientY }); <span class="hljs-comment">// Causes all consumers to re-render!</span>
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
  }, []);

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      user,
      setUser,
      mousePosition, <span class="hljs-comment">// This changes constantly!</span>
    }),
    [user, mousePosition]
  );

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">AppContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-comment">// ✅ Good: Separate contexts for different update frequencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodPerformanceProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProvider</span>&gt;</span>
      {" "}
      {/* Stable user data */}
      <span class="hljs-tag">&lt;<span class="hljs-name">MouseProvider</span>&gt;</span>
        {" "}
        {/* Frequently changing mouse data */}
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">MouseProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">UserProvider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      user,
      setUser,
    }),
    [user]
  );

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">UserContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MouseProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [mousePosition, setMousePosition] = useState({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> });

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleMouseMove = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      setMousePosition({ <span class="hljs-attr">x</span>: e.clientX, <span class="hljs-attr">y</span>: e.clientY });
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">MouseContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{mousePosition}</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">MouseContext.Provider</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F%E2%80%8D%E2%99%82%EF%B8%8F-mini-challenges">🏋️‍♂️ Mini-Challenges</h2>
<h3 id="challenge-1-multi-step-form-context">Challenge 1: Multi-Step Form Context</h3>
<p>Create a context for managing a multi-step form with validation, progress tracking, and data persistence.</p>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> FormContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [currentStep, setCurrentStep] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [formData, setFormData] = useState({
    <span class="hljs-attr">personal</span>: { <span class="hljs-attr">firstName</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">lastName</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">""</span> },
    <span class="hljs-attr">address</span>: { <span class="hljs-attr">street</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">city</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">state</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">zipCode</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">country</span>: <span class="hljs-string">""</span> },
    <span class="hljs-attr">preferences</span>: { <span class="hljs-attr">newsletter</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">notifications</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span> },
  });
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
  <span class="hljs-keyword">const</span> [isSubmitting, setIsSubmitting] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> steps = [
    {
      <span class="hljs-attr">id</span>: <span class="hljs-string">"personal"</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Personal Information"</span>,
      <span class="hljs-attr">fields</span>: [<span class="hljs-string">"firstName"</span>, <span class="hljs-string">"lastName"</span>, <span class="hljs-string">"email"</span>, <span class="hljs-string">"phone"</span>],
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-string">"address"</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Address Information"</span>,
      <span class="hljs-attr">fields</span>: [<span class="hljs-string">"street"</span>, <span class="hljs-string">"city"</span>, <span class="hljs-string">"state"</span>, <span class="hljs-string">"zipCode"</span>, <span class="hljs-string">"country"</span>],
    },
    {
      <span class="hljs-attr">id</span>: <span class="hljs-string">"preferences"</span>,
      <span class="hljs-attr">title</span>: <span class="hljs-string">"Preferences"</span>,
      <span class="hljs-attr">fields</span>: [<span class="hljs-string">"newsletter"</span>, <span class="hljs-string">"notifications"</span>, <span class="hljs-string">"theme"</span>],
    },
    { <span class="hljs-attr">id</span>: <span class="hljs-string">"review"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Review &amp; Submit"</span>, <span class="hljs-attr">fields</span>: [] },
  ];

  <span class="hljs-comment">// 🎯 Validation rules</span>
  <span class="hljs-keyword">const</span> validationRules = {
    <span class="hljs-attr">firstName</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">minLength</span>: <span class="hljs-number">2</span> },
    <span class="hljs-attr">lastName</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">minLength</span>: <span class="hljs-number">2</span> },
    <span class="hljs-attr">email</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">pattern</span>: <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span> },
    <span class="hljs-attr">phone</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">pattern</span>: <span class="hljs-regexp">/^[\d\s\-\(\)\+]+$/</span> },
    <span class="hljs-attr">street</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">minLength</span>: <span class="hljs-number">5</span> },
    <span class="hljs-attr">city</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">minLength</span>: <span class="hljs-number">2</span> },
    <span class="hljs-attr">state</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">minLength</span>: <span class="hljs-number">2</span> },
    <span class="hljs-attr">zipCode</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">pattern</span>: <span class="hljs-regexp">/^\d{5}(-\d{4})?$/</span> },
    <span class="hljs-attr">country</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  };

  <span class="hljs-comment">// 🎯 Validate field</span>
  <span class="hljs-keyword">const</span> validateField = useCallback(<span class="hljs-function">(<span class="hljs-params">field, value</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> rules = validationRules[field];
    <span class="hljs-keyword">if</span> (!rules) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">if</span> (rules.required &amp;&amp; (!value || value.toString().trim() === <span class="hljs-string">""</span>)) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${field}</span> is required`</span>;
    }

    <span class="hljs-keyword">if</span> (rules.minLength &amp;&amp; value.length &lt; rules.minLength) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${field}</span> must be at least <span class="hljs-subst">${rules.minLength}</span> characters`</span>;
    }

    <span class="hljs-keyword">if</span> (rules.pattern &amp;&amp; !rules.pattern.test(value)) {
      <span class="hljs-keyword">return</span> <span class="hljs-string">`<span class="hljs-subst">${field}</span> format is invalid`</span>;
    }

    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }, []);

  <span class="hljs-comment">// 🎯 Validate step</span>
  <span class="hljs-keyword">const</span> validateStep = useCallback(
    <span class="hljs-function">(<span class="hljs-params">stepIndex</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> step = steps[stepIndex];
      <span class="hljs-keyword">const</span> stepErrors = {};

      step.fields.forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> section = <span class="hljs-built_in">Object</span>.keys(formData).find(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span>
          formData[key].hasOwnProperty(field)
        );

        <span class="hljs-keyword">if</span> (section) {
          <span class="hljs-keyword">const</span> error = validateField(field, formData[section][field]);
          <span class="hljs-keyword">if</span> (error) {
            stepErrors[field] = error;
          }
        }
      });

      <span class="hljs-keyword">return</span> stepErrors;
    },
    [formData, validateField, steps]
  );

  <span class="hljs-comment">// 🎯 Update form data</span>
  <span class="hljs-keyword">const</span> updateFormData = useCallback(<span class="hljs-function">(<span class="hljs-params">section, field, value</span>) =&gt;</span> {
    setFormData(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      [section]: {
        ...prev[section],
        [field]: value,
      },
    }));

    <span class="hljs-comment">// Clear error for this field</span>
    setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> newErrors = { ...prev };
      <span class="hljs-keyword">delete</span> newErrors[field];
      <span class="hljs-keyword">return</span> newErrors;
    });
  }, []);

  <span class="hljs-comment">// 🎯 Navigation</span>
  <span class="hljs-keyword">const</span> nextStep = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> stepErrors = validateStep(currentStep);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(stepErrors).length &gt; <span class="hljs-number">0</span>) {
      setErrors(stepErrors);
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    setErrors({});
    setCurrentStep(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> <span class="hljs-built_in">Math</span>.min(prev + <span class="hljs-number">1</span>, steps.length - <span class="hljs-number">1</span>));
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }, [currentStep, validateStep, steps.length]);

  <span class="hljs-keyword">const</span> prevStep = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCurrentStep(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> <span class="hljs-built_in">Math</span>.max(prev - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>));
    setErrors({});
  }, []);

  <span class="hljs-keyword">const</span> goToStep = useCallback(
    <span class="hljs-function">(<span class="hljs-params">stepIndex</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (stepIndex &gt;= <span class="hljs-number">0</span> &amp;&amp; stepIndex &lt; steps.length) {
        setCurrentStep(stepIndex);
        setErrors({});
      }
    },
    [steps.length]
  );

  <span class="hljs-comment">// 🎯 Submit form</span>
  <span class="hljs-keyword">const</span> submitForm = useCallback(<span class="hljs-keyword">async</span> () =&gt; {
    setIsSubmitting(<span class="hljs-literal">true</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/submit-form"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(formData),
      });

      <span class="hljs-keyword">if</span> (response.ok) {
        <span class="hljs-comment">// Clear form data</span>
        setFormData({
          <span class="hljs-attr">personal</span>: { <span class="hljs-attr">firstName</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">lastName</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">phone</span>: <span class="hljs-string">""</span> },
          <span class="hljs-attr">address</span>: {
            <span class="hljs-attr">street</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">city</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">state</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">zipCode</span>: <span class="hljs-string">""</span>,
            <span class="hljs-attr">country</span>: <span class="hljs-string">""</span>,
          },
          <span class="hljs-attr">preferences</span>: {
            <span class="hljs-attr">newsletter</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">notifications</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span>,
          },
        });
        setCurrentStep(<span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span> };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-string">"Submission failed"</span> };
      }
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: error.message };
    } <span class="hljs-keyword">finally</span> {
      setIsSubmitting(<span class="hljs-literal">false</span>);
    }
  }, [formData]);

  <span class="hljs-comment">// 🎯 Progress calculation</span>
  <span class="hljs-keyword">const</span> progress = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> ((currentStep + <span class="hljs-number">1</span>) / steps.length) * <span class="hljs-number">100</span>;
  }, [currentStep, steps.length]);

  <span class="hljs-comment">// 🎯 Completion status</span>
  <span class="hljs-keyword">const</span> isStepComplete = useCallback(
    <span class="hljs-function">(<span class="hljs-params">stepIndex</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> stepErrors = validateStep(stepIndex);
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(stepErrors).length === <span class="hljs-number">0</span>;
    },
    [validateStep]
  );

  <span class="hljs-comment">// 🎯 Persist to localStorage</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> savedData = localStorage.getItem(<span class="hljs-string">"multiStepForm"</span>);
    <span class="hljs-keyword">if</span> (savedData) {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> parsed = <span class="hljs-built_in">JSON</span>.parse(savedData);
        setFormData(parsed.formData || formData);
        setCurrentStep(parsed.currentStep || <span class="hljs-number">0</span>);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to load form data:"</span>, error);
      }
    }
  }, []);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    localStorage.setItem(
      <span class="hljs-string">"multiStepForm"</span>,
      <span class="hljs-built_in">JSON</span>.stringify({
        formData,
        currentStep,
      })
    );
  }, [formData, currentStep]);

  <span class="hljs-keyword">const</span> value = {
    <span class="hljs-comment">// State</span>
    currentStep,
    formData,
    errors,
    isSubmitting,
    steps,
    progress,

    <span class="hljs-comment">// Actions</span>
    updateFormData,
    nextStep,
    prevStep,
    goToStep,
    submitForm,
    validateField,
    validateStep,
    isStepComplete,
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FormContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">FormContext.Provider</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(FormContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useForm must be used within a FormProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// 🎯 Form components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MultiStepForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { currentStep, steps } = useForm();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"multi-step-form"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormProgress</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormSteps</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">FormNavigation</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormProgress</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { progress, currentStep, steps } = useForm();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-progress"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"progress-bar"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"progress-fill"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> `${<span class="hljs-attr">progress</span>}%` }} /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"step-indicators"</span>&gt;</span>
        {steps.map((step, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">StepIndicator</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{step.id}</span> <span class="hljs-attr">step</span>=<span class="hljs-string">{step}</span> <span class="hljs-attr">index</span>=<span class="hljs-string">{index}</span> /&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">StepIndicator</span>(<span class="hljs-params">{ step, index }</span>) </span>{
  <span class="hljs-keyword">const</span> { currentStep, goToStep, isStepComplete } = useForm();

  <span class="hljs-keyword">const</span> isActive = index === currentStep;
  <span class="hljs-keyword">const</span> isComplete = index &lt; currentStep || isStepComplete(index);
  <span class="hljs-keyword">const</span> isClickable = index &lt;= currentStep;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">step-indicator</span> ${<span class="hljs-attr">isActive</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""} ${
        <span class="hljs-attr">isComplete</span> ? "<span class="hljs-attr">complete</span>" <span class="hljs-attr">:</span> ""
      } ${<span class="hljs-attr">isClickable</span> ? "<span class="hljs-attr">clickable</span>" <span class="hljs-attr">:</span> ""}`}
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> isClickable &amp;&amp; goToStep(index)}
    &gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"step-number"</span>&gt;</span>{isComplete ? "✓" : index + 1}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"step-title"</span>&gt;</span>{step.title}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormSteps</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { currentStep } = useForm();

  <span class="hljs-keyword">const</span> renderStep = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (currentStep) {
      <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PersonalInfoStep</span> /&gt;</span></span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AddressInfoStep</span> /&gt;</span></span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PreferencesStep</span> /&gt;</span></span>;
      <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ReviewStep</span> /&gt;</span></span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  };

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-steps"</span>&gt;</span>{renderStep()}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PersonalInfoStep</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { formData, updateFormData, errors } = useForm();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-step"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Personal Information<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"First Name"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.personal.firstName}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("personal", "firstName", value)}
        error={errors.firstName}
        required
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Last Name"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.personal.lastName}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("personal", "lastName", value)}
        error={errors.lastName}
        required
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Email"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.personal.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("personal", "email", value)}
        error={errors.email}
        required
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Phone"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"tel"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.personal.phone}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("personal", "phone", value)}
        error={errors.phone}
        required
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AddressInfoStep</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { formData, updateFormData, errors } = useForm();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-step"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Address Information<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Street Address"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.address.street}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("address", "street", value)}
        error={errors.street}
        required
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-row"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"City"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.address.city}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("address", "city", value)}
          error={errors.city}
          required
        /&gt;

        <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"State"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.address.state}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("address", "state", value)}
          error={errors.state}
          required
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-row"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"ZIP Code"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.address.zipCode}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("address", "zipCode", value)}
          error={errors.zipCode}
          required
        /&gt;

        <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">"Country"</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"select"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.address.country}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("address", "country", value)}
          error={errors.country}
          options={[
            { value: "", label: "Select Country" },
            { value: "US", label: "United States" },
            { value: "CA", label: "Canada" },
            { value: "UK", label: "United Kingdom" },
          ]}
          required
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PreferencesStep</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { formData, updateFormData } = useForm();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-step"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Preferences<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Newsletter Subscription"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
        <span class="hljs-attr">checked</span>=<span class="hljs-string">{formData.preferences.newsletter}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(checked)</span> =&gt;</span>
          updateFormData("preferences", "newsletter", checked)
        }
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Email Notifications"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
        <span class="hljs-attr">checked</span>=<span class="hljs-string">{formData.preferences.notifications}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(checked)</span> =&gt;</span>
          updateFormData("preferences", "notifications", checked)
        }
      /&gt;

      <span class="hljs-tag">&lt;<span class="hljs-name">FormField</span>
        <span class="hljs-attr">label</span>=<span class="hljs-string">"Theme Preference"</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"select"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{formData.preferences.theme}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value)</span> =&gt;</span> updateFormData("preferences", "theme", value)}
        options={[
          { value: "light", label: "Light" },
          { value: "dark", label: "Dark" },
          { value: "auto", label: "Auto" },
        ]}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ReviewStep</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { formData, submitForm, isSubmitting } = useForm();
  <span class="hljs-keyword">const</span> [submitResult, setSubmitResult] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> submitForm();
    setSubmitResult(result);
  };

  <span class="hljs-keyword">if</span> (submitResult?.success) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-step"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"success-message"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>✅ Form Submitted Successfully!<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Thank you for your submission. We'll be in touch soon.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-step"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Review &amp; Submit<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"review-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Personal Information<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Name:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formData.personal.firstName}{" "}
          {formData.personal.lastName}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Email:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formData.personal.email}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Phone:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formData.personal.phone}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"review-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Address<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Street:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formData.address.street}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>City:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formData.address.city},{" "}
          {formData.address.state} {formData.address.zipCode}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Country:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formData.address.country}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"review-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Preferences<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Newsletter:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>{" "}
          {formData.preferences.newsletter ? "Yes" : "No"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Notifications:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>{" "}
          {formData.preferences.notifications ? "Yes" : "No"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Theme:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {formData.preferences.theme}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      {submitResult?.error &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-message"</span>&gt;</span>Error: {submitResult.error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSubmit}</span>
        <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isSubmitting}</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">"submit-btn"</span>
      &gt;</span>
        {isSubmitting ? "Submitting..." : "Submit Form"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormField</span>(<span class="hljs-params">{
  label,
  type = <span class="hljs-string">"text"</span>,
  value,
  checked,
  onChange,
  error,
  required,
  options,
  ...props
}</span>) </span>{
  <span class="hljs-keyword">const</span> renderInput = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (type) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"checkbox"</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
            <span class="hljs-attr">checked</span>=<span class="hljs-string">{checked}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onChange(e.target.checked)}
            {...props}
          /&gt;</span>
        );

      <span class="hljs-keyword">case</span> <span class="hljs-string">"select"</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">select</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onChange(e.target.value)}
            {...props}
          &gt;
            {options?.map((option) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{option.value}</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{option.value}</span>&gt;</span>
                {option.label}
              <span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span></span>
        );

      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span>
            <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
            <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> onChange(e.target.value)}
            {...props}
          /&gt;</span>
        );
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">form-field</span> ${<span class="hljs-attr">error</span> ? "<span class="hljs-attr">error</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">label</span>&gt;</span>
        {label} {required &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"required"</span>&gt;</span>*<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
      {renderInput()}
      {error &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-text"</span>&gt;</span>{error}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormNavigation</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { currentStep, steps, nextStep, prevStep, isStepComplete } = useForm();

  <span class="hljs-keyword">const</span> canGoNext = currentStep &lt; steps.length - <span class="hljs-number">1</span>;
  <span class="hljs-keyword">const</span> canGoPrev = currentStep &gt; <span class="hljs-number">0</span>;
  <span class="hljs-keyword">const</span> isLastStep = currentStep === steps.length - <span class="hljs-number">1</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-navigation"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{prevStep}</span>
        <span class="hljs-attr">disabled</span>=<span class="hljs-string">{!canGoPrev}</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">"nav-btn prev-btn"</span>
      &gt;</span>
        Previous
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {!isLastStep &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{nextStep}</span>
          <span class="hljs-attr">disabled</span>=<span class="hljs-string">{!canGoNext}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"nav-btn next-btn"</span>
        &gt;</span>
          Next
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-real-time-collaboration-context">Challenge 2: Real-time Collaboration Context</h3>
<p>Build a context for managing real-time collaboration features like user presence, cursors, and live updates.</p>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> CollaborationContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CollaborationProvider</span>(<span class="hljs-params">{ children, documentId }</span>) </span>{
  <span class="hljs-keyword">const</span> [currentUser, setCurrentUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [connectedUsers, setConnectedUsers] = useState([]);
  <span class="hljs-keyword">const</span> [userCursors, setUserCursors] = useState({});
  <span class="hljs-keyword">const</span> [documentContent, setDocumentContent] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [isConnected, setIsConnected] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [connectionStatus, setConnectionStatus] = useState(<span class="hljs-string">"disconnected"</span>);
  <span class="hljs-keyword">const</span> [lastSaved, setLastSaved] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> wsRef = useRef(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> saveTimeoutRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// 🎯 WebSocket connection</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!documentId || !currentUser) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> ws = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">`ws://localhost:8080/collaborate/<span class="hljs-subst">${documentId}</span>`</span>);
    wsRef.current = ws;

    ws.onopen = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setIsConnected(<span class="hljs-literal">true</span>);
      setConnectionStatus(<span class="hljs-string">"connected"</span>);

      <span class="hljs-comment">// Send user join message</span>
      ws.send(
        <span class="hljs-built_in">JSON</span>.stringify({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"user_join"</span>,
          <span class="hljs-attr">user</span>: currentUser,
        })
      );
    };

    ws.onmessage = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> message = <span class="hljs-built_in">JSON</span>.parse(event.data);
      handleWebSocketMessage(message);
    };

    ws.onclose = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setIsConnected(<span class="hljs-literal">false</span>);
      setConnectionStatus(<span class="hljs-string">"disconnected"</span>);
    };

    ws.onerror = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setConnectionStatus(<span class="hljs-string">"error"</span>);
    };

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (ws.readyState === WebSocket.OPEN) {
        ws.send(
          <span class="hljs-built_in">JSON</span>.stringify({
            <span class="hljs-attr">type</span>: <span class="hljs-string">"user_leave"</span>,
            <span class="hljs-attr">user</span>: currentUser,
          })
        );
      }
      ws.close();
    };
  }, [documentId, currentUser]);

  <span class="hljs-comment">// 🎯 Handle WebSocket messages</span>
  <span class="hljs-keyword">const</span> handleWebSocketMessage = useCallback(
    <span class="hljs-function">(<span class="hljs-params">message</span>) =&gt;</span> {
      <span class="hljs-keyword">switch</span> (message.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"user_joined"</span>:
          setConnectedUsers(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
            <span class="hljs-keyword">if</span> (prev.find(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id === message.user.id)) {
              <span class="hljs-keyword">return</span> prev;
            }
            <span class="hljs-keyword">return</span> [...prev, message.user];
          });
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">"user_left"</span>:
          setConnectedUsers(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
            prev.filter(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id !== message.user.id)
          );
          setUserCursors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> newCursors = { ...prev };
            <span class="hljs-keyword">delete</span> newCursors[message.user.id];
            <span class="hljs-keyword">return</span> newCursors;
          });
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">"users_list"</span>:
          setConnectedUsers(
            message.users.filter(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> user.id !== currentUser?.id)
          );
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">"cursor_update"</span>:
          setUserCursors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
            ...prev,
            [message.userId]: {
              <span class="hljs-attr">position</span>: message.position,
              <span class="hljs-attr">selection</span>: message.selection,
              <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
            },
          }));
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">"content_update"</span>:
          setDocumentContent(message.content);
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">case</span> <span class="hljs-string">"document_saved"</span>:
          setLastSaved(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(message.timestamp));
          <span class="hljs-keyword">break</span>;

        <span class="hljs-keyword">default</span>:
          <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Unknown message type:"</span>, message.type);
      }
    },
    [currentUser]
  );

  <span class="hljs-comment">// 🎯 Send cursor position</span>
  <span class="hljs-keyword">const</span> updateCursor = useCallback(
    <span class="hljs-function">(<span class="hljs-params">position, selection = <span class="hljs-literal">null</span></span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!wsRef.current || wsRef.current.readyState !== WebSocket.OPEN) <span class="hljs-keyword">return</span>;

      wsRef.current.send(
        <span class="hljs-built_in">JSON</span>.stringify({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"cursor_update"</span>,
          position,
          selection,
          <span class="hljs-attr">userId</span>: currentUser?.id,
        })
      );
    },
    [currentUser]
  );

  <span class="hljs-comment">// 🎯 Update document content</span>
  <span class="hljs-keyword">const</span> updateContent = useCallback(
    <span class="hljs-function">(<span class="hljs-params">content</span>) =&gt;</span> {
      setDocumentContent(content);

      <span class="hljs-comment">// Debounced save</span>
      <span class="hljs-keyword">if</span> (saveTimeoutRef.current) {
        clearTimeout(saveTimeoutRef.current);
      }

      saveTimeoutRef.current = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-keyword">if</span> (wsRef.current &amp;&amp; wsRef.current.readyState === WebSocket.OPEN) {
          wsRef.current.send(
            <span class="hljs-built_in">JSON</span>.stringify({
              <span class="hljs-attr">type</span>: <span class="hljs-string">"content_update"</span>,
              content,
              <span class="hljs-attr">userId</span>: currentUser?.id,
            })
          );
        }
      }, <span class="hljs-number">500</span>);
    },
    [currentUser]
  );

  <span class="hljs-comment">// 🎯 Join collaboration session</span>
  <span class="hljs-keyword">const</span> joinSession = useCallback(<span class="hljs-function">(<span class="hljs-params">user</span>) =&gt;</span> {
    setCurrentUser(user);
  }, []);

  <span class="hljs-comment">// 🎯 Leave collaboration session</span>
  <span class="hljs-keyword">const</span> leaveSession = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (wsRef.current &amp;&amp; wsRef.current.readyState === WebSocket.OPEN) {
      wsRef.current.send(
        <span class="hljs-built_in">JSON</span>.stringify({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"user_leave"</span>,
          <span class="hljs-attr">user</span>: currentUser,
        })
      );
    }
    setCurrentUser(<span class="hljs-literal">null</span>);
    setConnectedUsers([]);
    setUserCursors({});
  }, [currentUser]);

  <span class="hljs-comment">// 🎯 Get user color</span>
  <span class="hljs-keyword">const</span> getUserColor = useCallback(<span class="hljs-function">(<span class="hljs-params">userId</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> colors = [
      <span class="hljs-string">"#FF6B6B"</span>,
      <span class="hljs-string">"#4ECDC4"</span>,
      <span class="hljs-string">"#45B7D1"</span>,
      <span class="hljs-string">"#96CEB4"</span>,
      <span class="hljs-string">"#FFEAA7"</span>,
      <span class="hljs-string">"#DDA0DD"</span>,
      <span class="hljs-string">"#98D8C8"</span>,
    ];
    <span class="hljs-keyword">const</span> index = userId.charCodeAt(<span class="hljs-number">0</span>) % colors.length;
    <span class="hljs-keyword">return</span> colors[index];
  }, []);

  <span class="hljs-comment">// 🎯 Clean up old cursors</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> interval = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> now = <span class="hljs-built_in">Date</span>.now();
      setUserCursors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> filtered = {};
        <span class="hljs-built_in">Object</span>.entries(prev).forEach(<span class="hljs-function">(<span class="hljs-params">[userId, cursor]</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (now - cursor.timestamp &lt; <span class="hljs-number">10000</span>) {
            <span class="hljs-comment">// Keep cursors for 10 seconds</span>
            filtered[userId] = cursor;
          }
        });
        <span class="hljs-keyword">return</span> filtered;
      });
    }, <span class="hljs-number">5000</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearInterval(interval);
  }, []);

  <span class="hljs-keyword">const</span> value = {
    <span class="hljs-comment">// State</span>
    currentUser,
    connectedUsers,
    userCursors,
    documentContent,
    isConnected,
    connectionStatus,
    lastSaved,

    <span class="hljs-comment">// Actions</span>
    joinSession,
    leaveSession,
    updateCursor,
    updateContent,
    getUserColor,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">CollaborationContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">CollaborationContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCollaboration</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(CollaborationContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
      <span class="hljs-string">"useCollaboration must be used within a CollaborationProvider"</span>
    );
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// 🎯 Collaboration components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CollaborativeEditor</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> {
    documentContent,
    updateContent,
    updateCursor,
    connectedUsers,
    userCursors,
    getUserColor,
  } = useCollaboration();

  <span class="hljs-keyword">const</span> editorRef = useRef(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> handleContentChange = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    updateContent(e.target.value);
  };

  <span class="hljs-keyword">const</span> handleSelectionChange = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!editorRef.current) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> { selectionStart, selectionEnd } = editorRef.current;
    updateCursor(selectionStart, { <span class="hljs-attr">start</span>: selectionStart, <span class="hljs-attr">end</span>: selectionEnd });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"collaborative-editor"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"editor-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">UserPresence</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ConnectionStatus</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"editor-container"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
          <span class="hljs-attr">ref</span>=<span class="hljs-string">{editorRef}</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{documentContent}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleContentChange}</span>
          <span class="hljs-attr">onSelect</span>=<span class="hljs-string">{handleSelectionChange}</span>
          <span class="hljs-attr">onKeyUp</span>=<span class="hljs-string">{handleSelectionChange}</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleSelectionChange}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"editor-textarea"</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Start typing..."</span>
        /&gt;</span>

        {/* Render user cursors */}
        {Object.entries(userCursors).map(([userId, cursor]) =&gt; {
          const user = connectedUsers.find((u) =&gt; u.id === userId);
          if (!user) return null;

          return (
            <span class="hljs-tag">&lt;<span class="hljs-name">UserCursor</span>
              <span class="hljs-attr">key</span>=<span class="hljs-string">{userId}</span>
              <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span>
              <span class="hljs-attr">cursor</span>=<span class="hljs-string">{cursor}</span>
              <span class="hljs-attr">color</span>=<span class="hljs-string">{getUserColor(userId)}</span>
            /&gt;</span>
          );
        })}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserPresence</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { connectedUsers, getUserColor } = useCollaboration();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"user-presence"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"presence-label"</span>&gt;</span>Online:<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      {connectedUsers.map((user) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"user-avatar"</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">getUserColor</span>(<span class="hljs-attr">user.id</span>) }}
          <span class="hljs-attr">title</span>=<span class="hljs-string">{user.name}</span>
        &gt;</span>
          {user.name.charAt(0).toUpperCase()}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConnectionStatus</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { connectionStatus, lastSaved } = useCollaboration();

  <span class="hljs-keyword">const</span> getStatusIcon = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (connectionStatus) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"connected"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"🟢"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"disconnected"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"🔴"</span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"error"</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"🟡"</span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-string">"⚪"</span>;
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"connection-status"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"status-indicator"</span>&gt;</span>
        {getStatusIcon()} {connectionStatus}
      <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      {lastSaved &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"last-saved"</span>&gt;</span>
          Last saved: {lastSaved.toLocaleTimeString()}
        <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserCursor</span>(<span class="hljs-params">{ user, cursor, color }</span>) </span>{
  <span class="hljs-keyword">const</span> [position, setPosition] = useState({ <span class="hljs-attr">top</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">0</span> });

  <span class="hljs-comment">// Calculate cursor position based on text position</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// This would need more complex calculation in a real implementation</span>
    <span class="hljs-comment">// For demo purposes, we'll use a simple approximation</span>
    <span class="hljs-keyword">const</span> lineHeight = <span class="hljs-number">20</span>;
    <span class="hljs-keyword">const</span> charWidth = <span class="hljs-number">8</span>;
    <span class="hljs-keyword">const</span> line = <span class="hljs-built_in">Math</span>.floor(cursor.position / <span class="hljs-number">80</span>); <span class="hljs-comment">// Assuming 80 chars per line</span>
    <span class="hljs-keyword">const</span> char = cursor.position % <span class="hljs-number">80</span>;

    setPosition({
      <span class="hljs-attr">top</span>: line * lineHeight,
      <span class="hljs-attr">left</span>: char * charWidth,
    });
  }, [cursor.position]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">"user-cursor"</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
        <span class="hljs-attr">top:</span> <span class="hljs-attr">position.top</span>,
        <span class="hljs-attr">left:</span> <span class="hljs-attr">position.left</span>,
        <span class="hljs-attr">borderColor:</span> <span class="hljs-attr">color</span>,
      }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cursor-line"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">color</span> }} /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cursor-label"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">color</span> }}&gt;</span>
        {user.name}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%AF-when-and-why-to-use-context">🎯 When and Why to Use Context</h2>
<h3 id="%E2%9C%85-good-use-cases">✅ Good Use Cases</h3>
<ol>
<li><strong>Theme/UI State</strong>: Colors, fonts, layout preferences</li>
<li><strong>User Authentication</strong>: Current user, permissions, auth status</li>
<li><strong>Language/Localization</strong>: Current language, translations</li>
<li><strong>Global App State</strong>: Shopping cart, notifications, modals</li>
<li><strong>Feature Flags</strong>: A/B testing, feature toggles</li>
<li><strong>API Configuration</strong>: Base URLs, auth tokens, request settings</li>
</ol>
<h3 id="%E2%9D%8C-avoid-context-for">❌ Avoid Context For</h3>
<ol>
<li><strong>Local Component State</strong>: State used by only one component</li>
<li><strong>Frequently Changing Values</strong>: Mouse position, scroll position</li>
<li><strong>Performance-Critical Data</strong>: Large datasets, real-time updates</li>
<li><strong>Server State</strong>: Use React Query, SWR, or similar instead</li>
<li><strong>Form State</strong>: Use local state or form libraries</li>
</ol>
<h3 id="%F0%9F%A4%94-decision-framework">🤔 Decision Framework</h3>
<pre class="hljs"><code><div>Do multiple components need this data?
├─ No → Use local state
└─ Yes
   ├─ Does it change frequently?
   │  ├─ Yes → Consider alternatives (state management library)
   │  └─ No → Context is good
   └─ Is it server data?
      ├─ Yes → Use data fetching library
      └─ No → Context is perfect
</div></code></pre>
<h2 id="%F0%9F%9A%80-performance-optimization">🚀 Performance Optimization</h2>
<h3 id="split-contexts-by-update-frequency">Split Contexts by Update Frequency</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Separate stable and changing values</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">StableDataProvider</span>&gt;</span>
      {" "}
      {/* User, theme, config */}
      <span class="hljs-tag">&lt;<span class="hljs-name">ChangingDataProvider</span>&gt;</span>
        {" "}
        {/* Notifications, real-time data */}
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ChangingDataProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">StableDataProvider</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="use-reactmemo-with-context">Use React.memo with Context</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Prevent unnecessary re-renders</span>
<span class="hljs-keyword">const</span> ExpensiveComponent = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { stableValue } = useStableContext();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* Expensive rendering logic */}
      {stableValue}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});
</div></code></pre>
<h3 id="selective-context-consumption">Selective Context Consumption</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Only consume what you need</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useThemeActions</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { setTheme, toggleTheme } = useTheme();
  <span class="hljs-keyword">return</span> useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ setTheme, toggleTheme }), [setTheme, toggleTheme]);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useThemeValues</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { theme, colors } = useTheme();
  <span class="hljs-keyword">return</span> useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ theme, colors }), [theme, colors]);
}
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-questions">Common Questions</h3>
<p><strong>Q: When would you use Context vs Redux?</strong></p>
<p>A: Context is great for:</p>
<ul>
<li>Simple global state</li>
<li>Theme/user preferences</li>
<li>Authentication state</li>
<li>Small to medium apps</li>
</ul>
<p>Redux is better for:</p>
<ul>
<li>Complex state logic</li>
<li>Time-travel debugging</li>
<li>Predictable state updates</li>
<li>Large applications</li>
<li>Team collaboration</li>
</ul>
<p><strong>Q: How do you prevent Context performance issues?</strong></p>
<p>A:</p>
<ol>
<li>Split contexts by update frequency</li>
<li>Memoize context values</li>
<li>Use React.memo for expensive components</li>
<li>Avoid putting frequently changing data in context</li>
<li>Consider state colocation</li>
</ol>
<p><strong>Q: What's the difference between Context and prop drilling?</strong></p>
<p>A: Prop drilling passes data through intermediate components that don't use it. Context allows direct access to data from any component in the tree, eliminating unnecessary prop passing.</p>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<p>❌ <strong>Creating context for every piece of state</strong>
❌ <strong>Not memoizing context values</strong>
❌ <strong>Putting frequently changing data in context</strong>
❌ <strong>Missing error boundaries around context providers</strong>
❌ <strong>Not providing default values</strong>
❌ <strong>Using context for server state</strong></p>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Context solves prop drilling</strong> - Share data across component trees</li>
<li><strong>Not a replacement for all state management</strong> - Use appropriately</li>
<li><strong>Performance matters</strong> - Memoize values and split contexts</li>
<li><strong>Custom hooks improve DX</strong> - Encapsulate context logic</li>
<li><strong>Error handling is crucial</strong> - Always check if context exists</li>
<li><strong>Default values help</strong> - Provide sensible defaults</li>
<li><strong>Think about update frequency</strong> - Separate stable from changing data</li>
</ol>
<h2 id="%F0%9F%8F%86-best-practices">🏆 Best Practices</h2>
<ol>
<li><strong>Always provide custom hooks</strong> for consuming context</li>
<li><strong>Memoize context values</strong> to prevent unnecessary re-renders</li>
<li><strong>Split contexts</strong> by concern and update frequency</li>
<li><strong>Use TypeScript</strong> for better developer experience</li>
<li><strong>Provide meaningful error messages</strong> when context is missing</li>
<li><strong>Keep context values focused</strong> - single responsibility</li>
<li><strong>Document your contexts</strong> - explain when and how to use them</li>
</ol>
<h2 id="%F0%9F%94%A7-production-tips">🔧 Production Tips</h2>
<ul>
<li><strong>Monitor context re-renders</strong> with React DevTools Profiler</li>
<li><strong>Use React.StrictMode</strong> to catch context-related issues</li>
<li><strong>Consider context composition</strong> for complex applications</li>
<li><strong>Implement proper error boundaries</strong> around providers</li>
<li><strong>Test context providers</strong> in isolation</li>
<li><strong>Use context for configuration</strong> that rarely changes</li>
<li><strong>Avoid context for derived state</strong> - compute in components instead</li>
</ul>
<hr>
<p><strong>Next up</strong>: We'll explore <code>useMemo</code> and learn how to optimize expensive calculations and prevent unnecessary re-renders! 🚀</p>
<h1 id="usereducer-complex-state-management">useReducer: Complex State Management</h1>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>What <code>useReducer</code> is and when to use it over <code>useState</code></li>
<li>How to design reducer functions and action patterns</li>
<li>State management patterns for complex applications</li>
<li>Integration with Context for global state</li>
<li>Performance optimization techniques</li>
<li>Real-world state machine implementations</li>
</ul>
<hr>
<h2 id="%F0%9F%A7%A0-what-is-usereducer">🧠 What is useReducer?</h2>
<p><code>useReducer</code> is a React Hook that provides an alternative to <code>useState</code> for managing <strong>complex state logic</strong>. It's particularly useful when:</p>
<ul>
<li>State has multiple sub-values</li>
<li>Next state depends on the previous state</li>
<li>State transitions are complex</li>
<li>You need predictable state updates</li>
</ul>
<h3 id="the-problem-complex-state-with-usestate">The Problem: Complex State with useState</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Complex state management with useState becomes unwieldy</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ComplexForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [firstName, setFirstName] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [lastName, setLastName] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [email, setEmail] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [password, setPassword] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [confirmPassword, setConfirmPassword] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
  <span class="hljs-keyword">const</span> [isSubmitting, setIsSubmitting] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [isValid, setIsValid] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [touched, setTouched] = useState({});
  <span class="hljs-keyword">const</span> [submitCount, setSubmitCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// Multiple state updates scattered throughout</span>
  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> () =&gt; {
    setIsSubmitting(<span class="hljs-literal">true</span>);
    setSubmitCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
    setErrors({});

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Validation logic</span>
      <span class="hljs-keyword">const</span> newErrors = {};
      <span class="hljs-keyword">if</span> (!firstName) newErrors.firstName = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!lastName) newErrors.lastName = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (!email) newErrors.email = <span class="hljs-string">"Required"</span>;
      <span class="hljs-keyword">if</span> (password !== confirmPassword)
        newErrors.confirmPassword = <span class="hljs-string">"Passwords must match"</span>;

      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(newErrors).length &gt; <span class="hljs-number">0</span>) {
        setErrors(newErrors);
        setIsValid(<span class="hljs-literal">false</span>);
        setIsSubmitting(<span class="hljs-literal">false</span>);
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-comment">// Submit logic</span>
      <span class="hljs-keyword">await</span> submitForm({ firstName, lastName, email, password });

      <span class="hljs-comment">// Reset form</span>
      setFirstName(<span class="hljs-string">""</span>);
      setLastName(<span class="hljs-string">""</span>);
      setEmail(<span class="hljs-string">""</span>);
      setPassword(<span class="hljs-string">""</span>);
      setConfirmPassword(<span class="hljs-string">""</span>);
      setErrors({});
      setIsValid(<span class="hljs-literal">false</span>);
      setTouched({});
    } <span class="hljs-keyword">catch</span> (error) {
      setErrors({ <span class="hljs-attr">submit</span>: error.message });
    } <span class="hljs-keyword">finally</span> {
      setIsSubmitting(<span class="hljs-literal">false</span>);
    }
  };

  <span class="hljs-comment">// More scattered state updates...</span>
}
</div></code></pre>
<h3 id="the-solution-usereducer">The Solution: useReducer</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Clean, predictable state management with useReducer</span>
<span class="hljs-keyword">const</span> initialState = {
  <span class="hljs-attr">fields</span>: {
    <span class="hljs-attr">firstName</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">lastName</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">password</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">confirmPassword</span>: <span class="hljs-string">""</span>,
  },
  <span class="hljs-attr">errors</span>: {},
  <span class="hljs-attr">touched</span>: {},
  <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">isValid</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">submitCount</span>: <span class="hljs-number">0</span>,
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">formReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"FIELD_CHANGE"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">fields</span>: {
          ...state.fields,
          [action.field]: action.value,
        },
        <span class="hljs-attr">errors</span>: {
          ...state.errors,
          [action.field]: <span class="hljs-literal">undefined</span>, <span class="hljs-comment">// Clear error for this field</span>
        },
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"FIELD_BLUR"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">touched</span>: {
          ...state.touched,
          [action.field]: <span class="hljs-literal">true</span>,
        },
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SUBMIT_START"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">submitCount</span>: state.submitCount + <span class="hljs-number">1</span>,
        <span class="hljs-attr">errors</span>: {},
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SUBMIT_SUCCESS"</span>:
      <span class="hljs-keyword">return</span> {
        ...initialState, <span class="hljs-comment">// Reset to initial state</span>
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SUBMIT_ERROR"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">errors</span>: action.errors,
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"VALIDATION_RESULT"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">isValid</span>: action.isValid,
        <span class="hljs-attr">errors</span>: {
          ...state.errors,
          ...action.errors,
        },
      };

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CleanForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(formReducer, initialState);

  <span class="hljs-keyword">const</span> handleFieldChange = <span class="hljs-function">(<span class="hljs-params">field, value</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"FIELD_CHANGE"</span>, field, value });
  };

  <span class="hljs-keyword">const</span> handleFieldBlur = <span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"FIELD_BLUR"</span>, field });
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-keyword">async</span> () =&gt; {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SUBMIT_START"</span> });

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Validation</span>
      <span class="hljs-keyword">const</span> errors = validateForm(state.fields);
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(errors).length &gt; <span class="hljs-number">0</span>) {
        dispatch({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"VALIDATION_RESULT"</span>,
          <span class="hljs-attr">isValid</span>: <span class="hljs-literal">false</span>,
          errors,
        });
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-comment">// Submit</span>
      <span class="hljs-keyword">await</span> submitForm(state.fields);
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SUBMIT_SUCCESS"</span> });
    } <span class="hljs-keyword">catch</span> (error) {
      dispatch({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"SUBMIT_ERROR"</span>,
        <span class="hljs-attr">errors</span>: { <span class="hljs-attr">submit</span>: error.message },
      });
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      {/* Form fields using state and dispatch */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%8D-deep-dive-usereducer-fundamentals">🔍 Deep Dive: useReducer Fundamentals</h2>
<h3 id="basic-syntax">Basic Syntax</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialState, init?);
</div></code></pre>
<ul>
<li><strong>reducer</strong>: <code>(state, action) =&gt; newState</code></li>
<li><strong>initialState</strong>: The initial state value</li>
<li><strong>init</strong>: Optional lazy initialization function</li>
<li><strong>state</strong>: Current state value</li>
<li><strong>dispatch</strong>: Function to trigger state updates</li>
</ul>
<h3 id="reducer-function-patterns">Reducer Function Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Basic reducer pattern</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">counterReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"INCREMENT"</span>:
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: state.count + <span class="hljs-number">1</span> };
    <span class="hljs-keyword">case</span> <span class="hljs-string">"DECREMENT"</span>:
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: state.count - <span class="hljs-number">1</span> };
    <span class="hljs-keyword">case</span> <span class="hljs-string">"RESET"</span>:
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> };
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Unknown action type: <span class="hljs-subst">${action.type}</span>`</span>);
  }
}

<span class="hljs-comment">// 🎯 Reducer with payload</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">todoReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_TODO"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: [
          ...state.todos,
          {
            <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
            <span class="hljs-attr">text</span>: action.payload.text,
            <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
          },
        ],
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"TOGGLE_TODO"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: state.todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
          todo.id === action.payload.id
            ? { ...todo, <span class="hljs-attr">completed</span>: !todo.completed }
            : todo
        ),
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"DELETE_TODO"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.id !== action.payload.id),
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"EDIT_TODO"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: state.todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
          todo.id === action.payload.id
            ? { ...todo, <span class="hljs-attr">text</span>: action.payload.text }
            : todo
        ),
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"CLEAR_COMPLETED"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> !todo.completed),
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SET_FILTER"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">filter</span>: action.payload.filter,
      };

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-comment">// 🎯 Reducer with complex state updates</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">shoppingCartReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_ITEM"</span>: {
      <span class="hljs-keyword">const</span> { product } = action.payload;
      <span class="hljs-keyword">const</span> existingItem = state.items.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === product.id);

      <span class="hljs-keyword">if</span> (existingItem) {
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">items</span>: state.items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
            item.id === product.id
              ? { ...item, <span class="hljs-attr">quantity</span>: item.quantity + <span class="hljs-number">1</span> }
              : item
          ),
        };
      }

      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: [...state.items, { ...product, <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span> }],
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"REMOVE_ITEM"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: state.items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== action.payload.id),
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_QUANTITY"</span>: {
      <span class="hljs-keyword">const</span> { id, quantity } = action.payload;

      <span class="hljs-keyword">if</span> (quantity &lt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">items</span>: state.items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id),
        };
      }

      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: state.items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id === id ? { ...item, quantity } : item
        ),
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"APPLY_DISCOUNT"</span>: {
      <span class="hljs-keyword">const</span> { code, percentage } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">discount</span>: {
          code,
          percentage,
          <span class="hljs-attr">applied</span>: <span class="hljs-literal">true</span>,
        },
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"CLEAR_CART"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: [],
        <span class="hljs-attr">discount</span>: <span class="hljs-literal">null</span>,
      };

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</div></code></pre>
<h3 id="action-creators-pattern">Action Creators Pattern</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Action creators for better maintainability</span>
<span class="hljs-keyword">const</span> todoActions = {
  <span class="hljs-attr">addTodo</span>: <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_TODO"</span>,
    <span class="hljs-attr">payload</span>: { text },
  }),

  <span class="hljs-attr">toggleTodo</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"TOGGLE_TODO"</span>,
    <span class="hljs-attr">payload</span>: { id },
  }),

  <span class="hljs-attr">deleteTodo</span>: <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"DELETE_TODO"</span>,
    <span class="hljs-attr">payload</span>: { id },
  }),

  <span class="hljs-attr">editTodo</span>: <span class="hljs-function">(<span class="hljs-params">id, text</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"EDIT_TODO"</span>,
    <span class="hljs-attr">payload</span>: { id, text },
  }),

  <span class="hljs-attr">clearCompleted</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"CLEAR_COMPLETED"</span>,
  }),

  <span class="hljs-attr">setFilter</span>: <span class="hljs-function">(<span class="hljs-params">filter</span>) =&gt;</span> ({
    <span class="hljs-attr">type</span>: <span class="hljs-string">"SET_FILTER"</span>,
    <span class="hljs-attr">payload</span>: { filter },
  }),
};

<span class="hljs-comment">// 🎯 Usage with action creators</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoApp</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(todoReducer, initialState);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    dispatch(todoActions.addTodo(text));
  };

  <span class="hljs-keyword">const</span> toggleTodo = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    dispatch(todoActions.toggleTodo(id));
  };

  <span class="hljs-comment">// ... rest of component</span>
}
</div></code></pre>
<h2 id="%F0%9F%9A%80-real-world-patterns">🚀 Real-World Patterns</h2>
<h3 id="pattern-1-state-machine-with-usereducer">Pattern 1: State Machine with useReducer</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Async data fetching state machine</span>
<span class="hljs-keyword">const</span> initialState = {
  <span class="hljs-attr">status</span>: <span class="hljs-string">"idle"</span>, <span class="hljs-comment">// idle | loading | success | error</span>
  <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">retryCount</span>: <span class="hljs-number">0</span>,
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">dataFetchReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"FETCH_START"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">status</span>: <span class="hljs-string">"loading"</span>,
        <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"FETCH_SUCCESS"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">status</span>: <span class="hljs-string">"success"</span>,
        <span class="hljs-attr">data</span>: action.payload.data,
        <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">retryCount</span>: <span class="hljs-number">0</span>,
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"FETCH_ERROR"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">status</span>: <span class="hljs-string">"error"</span>,
        <span class="hljs-attr">error</span>: action.payload.error,
        <span class="hljs-attr">data</span>: <span class="hljs-literal">null</span>,
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"RETRY"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">status</span>: <span class="hljs-string">"loading"</span>,
        <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">retryCount</span>: state.retryCount + <span class="hljs-number">1</span>,
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"RESET"</span>:
      <span class="hljs-keyword">return</span> initialState;

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAsyncData</span>(<span class="hljs-params">url</span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(dataFetchReducer, initialState);

  <span class="hljs-keyword">const</span> fetchData = useCallback(<span class="hljs-keyword">async</span> () =&gt; {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"FETCH_START"</span> });

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url);
      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
      }
      <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"FETCH_SUCCESS"</span>, <span class="hljs-attr">payload</span>: { data } });
    } <span class="hljs-keyword">catch</span> (error) {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"FETCH_ERROR"</span>, <span class="hljs-attr">payload</span>: { <span class="hljs-attr">error</span>: error.message } });
    }
  }, [url]);

  <span class="hljs-keyword">const</span> retry = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (state.retryCount &lt; <span class="hljs-number">3</span>) {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"RETRY"</span> });
      fetchData();
    }
  }, [fetchData, state.retryCount]);

  <span class="hljs-keyword">const</span> reset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"RESET"</span> });
  }, []);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetchData();
  }, [fetchData]);

  <span class="hljs-keyword">return</span> {
    ...state,
    <span class="hljs-attr">refetch</span>: fetchData,
    retry,
    reset,
    <span class="hljs-attr">canRetry</span>: state.retryCount &lt; <span class="hljs-number">3</span>,
  };
}

<span class="hljs-comment">// 🎯 Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { status, data, error, retry, canRetry } = useAsyncData(<span class="hljs-string">"/api/users"</span>);

  <span class="hljs-keyword">if</span> (status === <span class="hljs-string">"loading"</span>) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">if</span> (status === <span class="hljs-string">"error"</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        {canRetry &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{retry}</span>&gt;</span>Retry<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">if</span> (status === <span class="hljs-string">"success"</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        {data.map((user) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}
</div></code></pre>
<h3 id="pattern-2-multi-step-wizard">Pattern 2: Multi-Step Wizard</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Multi-step wizard with validation</span>
<span class="hljs-keyword">const</span> wizardSteps = [
  { <span class="hljs-attr">id</span>: <span class="hljs-string">"personal"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Personal Info"</span>, <span class="hljs-attr">component</span>: PersonalStep },
  { <span class="hljs-attr">id</span>: <span class="hljs-string">"address"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Address"</span>, <span class="hljs-attr">component</span>: AddressStep },
  { <span class="hljs-attr">id</span>: <span class="hljs-string">"payment"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Payment"</span>, <span class="hljs-attr">component</span>: PaymentStep },
  { <span class="hljs-attr">id</span>: <span class="hljs-string">"review"</span>, <span class="hljs-attr">title</span>: <span class="hljs-string">"Review"</span>, <span class="hljs-attr">component</span>: ReviewStep },
];

<span class="hljs-keyword">const</span> initialWizardState = {
  <span class="hljs-attr">currentStep</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">data</span>: {
    <span class="hljs-attr">personal</span>: {},
    <span class="hljs-attr">address</span>: {},
    <span class="hljs-attr">payment</span>: {},
  },
  <span class="hljs-attr">errors</span>: {},
  <span class="hljs-attr">touched</span>: {},
  <span class="hljs-attr">isValid</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">completedSteps</span>: [],
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">wizardReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"NEXT_STEP"</span>: {
      <span class="hljs-keyword">const</span> nextStep = <span class="hljs-built_in">Math</span>.min(state.currentStep + <span class="hljs-number">1</span>, wizardSteps.length - <span class="hljs-number">1</span>);
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">currentStep</span>: nextStep,
        <span class="hljs-attr">completedSteps</span>: [
          ...new <span class="hljs-built_in">Set</span>([...state.completedSteps, state.currentStep]),
        ],
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"PREV_STEP"</span>: {
      <span class="hljs-keyword">const</span> prevStep = <span class="hljs-built_in">Math</span>.max(state.currentStep - <span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">currentStep</span>: prevStep,
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"GO_TO_STEP"</span>: {
      <span class="hljs-keyword">const</span> { step } = action.payload;
      <span class="hljs-comment">// Only allow going to completed steps or next step</span>
      <span class="hljs-keyword">if</span> (
        state.completedSteps.includes(step) ||
        step === state.currentStep + <span class="hljs-number">1</span>
      ) {
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">currentStep</span>: step,
        };
      }
      <span class="hljs-keyword">return</span> state;
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_STEP_DATA"</span>: {
      <span class="hljs-keyword">const</span> { step, data } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">data</span>: {
          ...state.data,
          [step]: {
            ...state.data[step],
            ...data,
          },
        },
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SET_STEP_ERRORS"</span>: {
      <span class="hljs-keyword">const</span> { step, errors } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">errors</span>: {
          ...state.errors,
          [step]: errors,
        },
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SET_STEP_TOUCHED"</span>: {
      <span class="hljs-keyword">const</span> { step, touched } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">touched</span>: {
          ...state.touched,
          [step]: {
            ...state.touched[step],
            ...touched,
          },
        },
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"VALIDATE_STEP"</span>: {
      <span class="hljs-keyword">const</span> { step, isValid, errors } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        isValid,
        <span class="hljs-attr">errors</span>: {
          ...state.errors,
          [step]: errors,
        },
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SUBMIT_START"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">true</span>,
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SUBMIT_SUCCESS"</span>:
      <span class="hljs-keyword">return</span> {
        ...initialWizardState,
        <span class="hljs-comment">// Maybe keep some success state</span>
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SUBMIT_ERROR"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">isSubmitting</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">errors</span>: {
          ...state.errors,
          <span class="hljs-attr">submit</span>: action.payload.error,
        },
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"RESET_WIZARD"</span>:
      <span class="hljs-keyword">return</span> initialWizardState;

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useWizard</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(wizardReducer, initialWizardState);

  <span class="hljs-keyword">const</span> nextStep = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> currentStepId = wizardSteps[state.currentStep].id;
    <span class="hljs-keyword">const</span> stepData = state.data[currentStepId];
    <span class="hljs-keyword">const</span> errors = validateStep(currentStepId, stepData);

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(errors).length === <span class="hljs-number">0</span>) {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"NEXT_STEP"</span> });
    } <span class="hljs-keyword">else</span> {
      dispatch({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"VALIDATE_STEP"</span>,
        <span class="hljs-attr">payload</span>: { <span class="hljs-attr">step</span>: currentStepId, <span class="hljs-attr">isValid</span>: <span class="hljs-literal">false</span>, errors },
      });
    }
  }, [state.currentStep, state.data]);

  <span class="hljs-keyword">const</span> prevStep = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"PREV_STEP"</span> });
  }, []);

  <span class="hljs-keyword">const</span> goToStep = useCallback(<span class="hljs-function">(<span class="hljs-params">step</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"GO_TO_STEP"</span>, <span class="hljs-attr">payload</span>: { step } });
  }, []);

  <span class="hljs-keyword">const</span> updateStepData = useCallback(<span class="hljs-function">(<span class="hljs-params">step, data</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"UPDATE_STEP_DATA"</span>, <span class="hljs-attr">payload</span>: { step, data } });
  }, []);

  <span class="hljs-keyword">const</span> submitWizard = useCallback(<span class="hljs-keyword">async</span> () =&gt; {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SUBMIT_START"</span> });

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Validate all steps</span>
      <span class="hljs-keyword">const</span> allErrors = {};
      <span class="hljs-keyword">let</span> hasErrors = <span class="hljs-literal">false</span>;

      <span class="hljs-built_in">Object</span>.keys(state.data).forEach(<span class="hljs-function">(<span class="hljs-params">step</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> errors = validateStep(step, state.data[step]);
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(errors).length &gt; <span class="hljs-number">0</span>) {
          allErrors[step] = errors;
          hasErrors = <span class="hljs-literal">true</span>;
        }
      });

      <span class="hljs-keyword">if</span> (hasErrors) {
        dispatch({
          <span class="hljs-attr">type</span>: <span class="hljs-string">"SUBMIT_ERROR"</span>,
          <span class="hljs-attr">payload</span>: { <span class="hljs-attr">error</span>: <span class="hljs-string">"Please fix validation errors"</span> },
        });
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-comment">// Submit data</span>
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/wizard-submit"</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(state.data),
      });

      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Submission failed"</span>);
      }

      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SUBMIT_SUCCESS"</span> });
    } <span class="hljs-keyword">catch</span> (error) {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SUBMIT_ERROR"</span>, <span class="hljs-attr">payload</span>: { <span class="hljs-attr">error</span>: error.message } });
    }
  }, [state.data]);

  <span class="hljs-keyword">return</span> {
    ...state,
    nextStep,
    prevStep,
    goToStep,
    updateStepData,
    submitWizard,
    <span class="hljs-attr">currentStepData</span>: state.data[wizardSteps[state.currentStep]?.id] || {},
    <span class="hljs-attr">canGoNext</span>: state.currentStep &lt; wizardSteps.length - <span class="hljs-number">1</span>,
    <span class="hljs-attr">canGoPrev</span>: state.currentStep &gt; <span class="hljs-number">0</span>,
    <span class="hljs-attr">isLastStep</span>: state.currentStep === wizardSteps.length - <span class="hljs-number">1</span>,
  };
}

<span class="hljs-comment">// 🎯 Wizard component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MultiStepWizard</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> wizard = useWizard();
  <span class="hljs-keyword">const</span> currentStep = wizardSteps[wizard.currentStep];
  <span class="hljs-keyword">const</span> StepComponent = currentStep.component;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"wizard"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">WizardProgress</span>
        <span class="hljs-attr">steps</span>=<span class="hljs-string">{wizardSteps}</span>
        <span class="hljs-attr">currentStep</span>=<span class="hljs-string">{wizard.currentStep}</span>
        <span class="hljs-attr">completedSteps</span>=<span class="hljs-string">{wizard.completedSteps}</span>
        <span class="hljs-attr">onStepClick</span>=<span class="hljs-string">{wizard.goToStep}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"wizard-content"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">StepComponent</span>
          <span class="hljs-attr">data</span>=<span class="hljs-string">{wizard.currentStepData}</span>
          <span class="hljs-attr">errors</span>=<span class="hljs-string">{wizard.errors[currentStep.id]</span> || {}}
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(data)</span> =&gt;</span> wizard.updateStepData(currentStep.id, data)}
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">WizardNavigation</span>
        <span class="hljs-attr">canGoNext</span>=<span class="hljs-string">{wizard.canGoNext}</span>
        <span class="hljs-attr">canGoPrev</span>=<span class="hljs-string">{wizard.canGoPrev}</span>
        <span class="hljs-attr">isLastStep</span>=<span class="hljs-string">{wizard.isLastStep}</span>
        <span class="hljs-attr">isSubmitting</span>=<span class="hljs-string">{wizard.isSubmitting}</span>
        <span class="hljs-attr">onNext</span>=<span class="hljs-string">{wizard.nextStep}</span>
        <span class="hljs-attr">onPrev</span>=<span class="hljs-string">{wizard.prevStep}</span>
        <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{wizard.submitWizard}</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="pattern-3-game-state-management">Pattern 3: Game State Management</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Tic-tac-toe game with useReducer</span>
<span class="hljs-keyword">const</span> initialGameState = {
  <span class="hljs-attr">board</span>: <span class="hljs-built_in">Array</span>(<span class="hljs-number">9</span>).fill(<span class="hljs-literal">null</span>),
  <span class="hljs-attr">currentPlayer</span>: <span class="hljs-string">"X"</span>,
  <span class="hljs-attr">winner</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">gameStatus</span>: <span class="hljs-string">"playing"</span>, <span class="hljs-comment">// playing | won | draw</span>
  <span class="hljs-attr">moveHistory</span>: [],
  <span class="hljs-attr">scores</span>: { <span class="hljs-attr">X</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">O</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">draws</span>: <span class="hljs-number">0</span> },
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gameReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"MAKE_MOVE"</span>: {
      <span class="hljs-keyword">const</span> { index } = action.payload;

      <span class="hljs-comment">// Invalid move</span>
      <span class="hljs-keyword">if</span> (state.board[index] || state.winner) {
        <span class="hljs-keyword">return</span> state;
      }

      <span class="hljs-keyword">const</span> newBoard = [...state.board];
      newBoard[index] = state.currentPlayer;

      <span class="hljs-keyword">const</span> winner = calculateWinner(newBoard);
      <span class="hljs-keyword">const</span> isDraw = !winner &amp;&amp; newBoard.every(<span class="hljs-function">(<span class="hljs-params">cell</span>) =&gt;</span> cell !== <span class="hljs-literal">null</span>);

      <span class="hljs-keyword">let</span> newScores = state.scores;
      <span class="hljs-keyword">let</span> gameStatus = <span class="hljs-string">"playing"</span>;

      <span class="hljs-keyword">if</span> (winner) {
        gameStatus = <span class="hljs-string">"won"</span>;
        newScores = {
          ...state.scores,
          [winner]: state.scores[winner] + <span class="hljs-number">1</span>,
        };
      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isDraw) {
        gameStatus = <span class="hljs-string">"draw"</span>;
        newScores = {
          ...state.scores,
          <span class="hljs-attr">draws</span>: state.scores.draws + <span class="hljs-number">1</span>,
        };
      }

      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">board</span>: newBoard,
        <span class="hljs-attr">currentPlayer</span>: state.currentPlayer === <span class="hljs-string">"X"</span> ? <span class="hljs-string">"O"</span> : <span class="hljs-string">"X"</span>,
        winner,
        gameStatus,
        <span class="hljs-attr">scores</span>: newScores,
        <span class="hljs-attr">moveHistory</span>: [
          ...state.moveHistory,
          {
            <span class="hljs-attr">player</span>: state.currentPlayer,
            index,
            <span class="hljs-attr">board</span>: newBoard,
            <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
          },
        ],
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"RESET_GAME"</span>:
      <span class="hljs-keyword">return</span> {
        ...initialGameState,
        <span class="hljs-attr">scores</span>: state.scores, <span class="hljs-comment">// Keep scores</span>
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"NEW_GAME"</span>:
      <span class="hljs-keyword">return</span> initialGameState;

    <span class="hljs-keyword">case</span> <span class="hljs-string">"UNDO_MOVE"</span>: {
      <span class="hljs-keyword">if</span> (state.moveHistory.length === <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> state;
      }

      <span class="hljs-keyword">const</span> newHistory = state.moveHistory.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>);
      <span class="hljs-keyword">const</span> lastMove = newHistory[newHistory.length - <span class="hljs-number">1</span>];

      <span class="hljs-keyword">if</span> (lastMove) {
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">board</span>: lastMove.board,
          <span class="hljs-attr">currentPlayer</span>: lastMove.player === <span class="hljs-string">"X"</span> ? <span class="hljs-string">"O"</span> : <span class="hljs-string">"X"</span>,
          <span class="hljs-attr">winner</span>: calculateWinner(lastMove.board),
          <span class="hljs-attr">gameStatus</span>: <span class="hljs-string">"playing"</span>,
          <span class="hljs-attr">moveHistory</span>: newHistory,
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">board</span>: <span class="hljs-built_in">Array</span>(<span class="hljs-number">9</span>).fill(<span class="hljs-literal">null</span>),
          <span class="hljs-attr">currentPlayer</span>: <span class="hljs-string">"X"</span>,
          <span class="hljs-attr">winner</span>: <span class="hljs-literal">null</span>,
          <span class="hljs-attr">gameStatus</span>: <span class="hljs-string">"playing"</span>,
          <span class="hljs-attr">moveHistory</span>: [],
        };
      }
    }

    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateWinner</span>(<span class="hljs-params">board</span>) </span>{
  <span class="hljs-keyword">const</span> lines = [
    [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>],
    [<span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>],
    [<span class="hljs-number">6</span>, <span class="hljs-number">7</span>, <span class="hljs-number">8</span>], <span class="hljs-comment">// rows</span>
    [<span class="hljs-number">0</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>],
    [<span class="hljs-number">1</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>],
    [<span class="hljs-number">2</span>, <span class="hljs-number">5</span>, <span class="hljs-number">8</span>], <span class="hljs-comment">// columns</span>
    [<span class="hljs-number">0</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>],
    [<span class="hljs-number">2</span>, <span class="hljs-number">4</span>, <span class="hljs-number">6</span>], <span class="hljs-comment">// diagonals</span>
  ];

  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> line <span class="hljs-keyword">of</span> lines) {
    <span class="hljs-keyword">const</span> [a, b, c] = line;
    <span class="hljs-keyword">if</span> (board[a] &amp;&amp; board[a] === board[b] &amp;&amp; board[a] === board[c]) {
      <span class="hljs-keyword">return</span> board[a];
    }
  }

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TicTacToe</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(gameReducer, initialGameState);

  <span class="hljs-keyword">const</span> makeMove = <span class="hljs-function">(<span class="hljs-params">index</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"MAKE_MOVE"</span>, <span class="hljs-attr">payload</span>: { index } });
  };

  <span class="hljs-keyword">const</span> resetGame = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"RESET_GAME"</span> });
  };

  <span class="hljs-keyword">const</span> newGame = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"NEW_GAME"</span> });
  };

  <span class="hljs-keyword">const</span> undoMove = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"UNDO_MOVE"</span> });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"tic-tac-toe"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"game-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"scores"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>X: {state.scores.X}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>O: {state.scores.O}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Draws: {state.scores.draws}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"game-controls"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{undoMove}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{state.moveHistory.length</span> === <span class="hljs-string">0}</span>&gt;</span>
            Undo
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{resetGame}</span>&gt;</span>Reset Game<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{newGame}</span>&gt;</span>New Game<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"game-status"</span>&gt;</span>
        {state.gameStatus === "won" &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>🎉 Player {state.winner} wins!<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>}
        {state.gameStatus === "draw" &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>🤝 It's a draw!<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>}
        {state.gameStatus === "playing" &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Current player: {state.currentPlayer}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"board"</span>&gt;</span>
        {state.board.map((cell, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">"cell"</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> makeMove(index)}
            disabled={cell !== null || state.gameStatus !== "playing"}
          &gt;
            {cell}
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"move-history"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Move History<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        {state.moveHistory.map((move, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"move"</span>&gt;</span>
            Move {index + 1}: Player {move.player} → Position {move.index}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-usereducer--context-pattern">🔄 useReducer + Context Pattern</h2>
<pre class="hljs"><code><div><span class="hljs-comment">// 🎯 Global state management with useReducer + Context</span>
<span class="hljs-keyword">const</span> AppStateContext = createContext();
<span class="hljs-keyword">const</span> AppDispatchContext = createContext();

<span class="hljs-keyword">const</span> initialAppState = {
  <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
  <span class="hljs-attr">theme</span>: <span class="hljs-string">"light"</span>,
  <span class="hljs-attr">notifications</span>: [],
  <span class="hljs-attr">cart</span>: {
    <span class="hljs-attr">items</span>: [],
    <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,
  },
  <span class="hljs-attr">ui</span>: {
    <span class="hljs-attr">sidebarOpen</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">modalStack</span>: [],
  },
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">appReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-comment">// User actions</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"USER_LOGIN"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">user</span>: action.payload.user,
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"USER_LOGOUT"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
        <span class="hljs-attr">cart</span>: { <span class="hljs-attr">items</span>: [], <span class="hljs-attr">total</span>: <span class="hljs-number">0</span> }, <span class="hljs-comment">// Clear cart on logout</span>
      };

    <span class="hljs-comment">// Theme actions</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"TOGGLE_THEME"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">theme</span>: state.theme === <span class="hljs-string">"light"</span> ? <span class="hljs-string">"dark"</span> : <span class="hljs-string">"light"</span>,
      };

    <span class="hljs-comment">// Notification actions</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_NOTIFICATION"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">notifications</span>: [
          ...state.notifications,
          {
            <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
            ...action.payload,
          },
        ],
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"REMOVE_NOTIFICATION"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">notifications</span>: state.notifications.filter(
          <span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> notification.id !== action.payload.id
        ),
      };

    <span class="hljs-comment">// Cart actions</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_TO_CART"</span>: {
      <span class="hljs-keyword">const</span> { product } = action.payload;
      <span class="hljs-keyword">const</span> existingItem = state.cart.items.find(
        <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === product.id
      );

      <span class="hljs-keyword">let</span> newItems;
      <span class="hljs-keyword">if</span> (existingItem) {
        newItems = state.cart.items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id === product.id
            ? { ...item, <span class="hljs-attr">quantity</span>: item.quantity + <span class="hljs-number">1</span> }
            : item
        );
      } <span class="hljs-keyword">else</span> {
        newItems = [...state.cart.items, { ...product, <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span> }];
      }

      <span class="hljs-keyword">const</span> newTotal = newItems.reduce(
        <span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.price * item.quantity,
        <span class="hljs-number">0</span>
      );

      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">cart</span>: {
          <span class="hljs-attr">items</span>: newItems,
          <span class="hljs-attr">total</span>: newTotal,
        },
      };
    }

    <span class="hljs-comment">// UI actions</span>
    <span class="hljs-keyword">case</span> <span class="hljs-string">"TOGGLE_SIDEBAR"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">ui</span>: {
          ...state.ui,
          <span class="hljs-attr">sidebarOpen</span>: !state.ui.sidebarOpen,
        },
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"OPEN_MODAL"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">ui</span>: {
          ...state.ui,
          <span class="hljs-attr">modalStack</span>: [...state.ui.modalStack, action.payload.modal],
        },
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"CLOSE_MODAL"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">ui</span>: {
          ...state.ui,
          <span class="hljs-attr">modalStack</span>: state.ui.modalStack.slice(<span class="hljs-number">0</span>, <span class="hljs-number">-1</span>),
        },
      };

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AppProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(appReducer, initialAppState);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AppStateContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{state}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AppDispatchContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{dispatch}</span>&gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">AppDispatchContext.Provider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">AppStateContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// 🎯 Custom hooks for consuming state and dispatch</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAppState</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(AppStateContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useAppState must be used within an AppProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAppDispatch</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(AppDispatchContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useAppDispatch must be used within an AppProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// 🎯 Specialized hooks for specific state slices</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useUser</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { user } = useAppState();
  <span class="hljs-keyword">const</span> dispatch = useAppDispatch();

  <span class="hljs-keyword">const</span> login = useCallback(
    <span class="hljs-function">(<span class="hljs-params">userData</span>) =&gt;</span> {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"USER_LOGIN"</span>, <span class="hljs-attr">payload</span>: { <span class="hljs-attr">user</span>: userData } });
    },
    [dispatch]
  );

  <span class="hljs-keyword">const</span> logout = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"USER_LOGOUT"</span> });
  }, [dispatch]);

  <span class="hljs-keyword">return</span> {
    user,
    <span class="hljs-attr">isAuthenticated</span>: !!user,
    login,
    logout,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useTheme</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { theme } = useAppState();
  <span class="hljs-keyword">const</span> dispatch = useAppDispatch();

  <span class="hljs-keyword">const</span> toggleTheme = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"TOGGLE_THEME"</span> });
  }, [dispatch]);

  <span class="hljs-keyword">return</span> {
    theme,
    <span class="hljs-attr">isDark</span>: theme === <span class="hljs-string">"dark"</span>,
    toggleTheme,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useNotifications</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { notifications } = useAppState();
  <span class="hljs-keyword">const</span> dispatch = useAppDispatch();

  <span class="hljs-keyword">const</span> addNotification = useCallback(
    <span class="hljs-function">(<span class="hljs-params">notification</span>) =&gt;</span> {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_NOTIFICATION"</span>, <span class="hljs-attr">payload</span>: notification });
    },
    [dispatch]
  );

  <span class="hljs-keyword">const</span> removeNotification = useCallback(
    <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"REMOVE_NOTIFICATION"</span>, <span class="hljs-attr">payload</span>: { id } });
    },
    [dispatch]
  );

  <span class="hljs-keyword">return</span> {
    notifications,
    addNotification,
    removeNotification,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { cart } = useAppState();
  <span class="hljs-keyword">const</span> dispatch = useAppDispatch();

  <span class="hljs-keyword">const</span> addToCart = useCallback(
    <span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> {
      dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_TO_CART"</span>, <span class="hljs-attr">payload</span>: { product } });
    },
    [dispatch]
  );

  <span class="hljs-keyword">return</span> {
    ...cart,
    addToCart,
    <span class="hljs-attr">itemCount</span>: cart.items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.quantity, <span class="hljs-number">0</span>),
  };
}
</div></code></pre>
<h2 id="%E2%9A%A0%EF%B8%8F-common-mistakes-and-anti-patterns">⚠️ Common Mistakes and Anti-Patterns</h2>
<h3 id="mistake-1-mutating-state">Mistake 1: Mutating State</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Mutating state directly</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">badReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_ITEM"</span>:
      state.items.push(action.payload); <span class="hljs-comment">// Mutation!</span>
      <span class="hljs-keyword">return</span> state;

    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_ITEM"</span>:
      <span class="hljs-keyword">const</span> item = state.items.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === action.payload.id);
      item.name = action.payload.name; <span class="hljs-comment">// Mutation!</span>
      <span class="hljs-keyword">return</span> state;

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-comment">// ✅ Good: Returning new state objects</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goodReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_ITEM"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: [...state.items, action.payload],
      };

    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_ITEM"</span>:
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: state.items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id === action.payload.id
            ? { ...item, <span class="hljs-attr">name</span>: action.payload.name }
            : item
        ),
      };

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</div></code></pre>
<h3 id="mistake-2-complex-logic-in-components">Mistake 2: Complex Logic in Components</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Complex state logic in component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadTodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(todoReducer, initialState);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    <span class="hljs-comment">// Complex logic in component</span>
    <span class="hljs-keyword">if</span> (text.trim() === <span class="hljs-string">""</span>) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> newTodo = {
      <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
      <span class="hljs-attr">text</span>: text.trim(),
      <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      <span class="hljs-attr">priority</span>: text.includes(<span class="hljs-string">"!"</span>) ? <span class="hljs-string">"high"</span> : <span class="hljs-string">"normal"</span>,
    };

    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_TODO"</span>, <span class="hljs-attr">payload</span>: newTodo });
  };

  <span class="hljs-comment">// More complex logic...</span>
}

<span class="hljs-comment">// ✅ Good: Logic in reducer or custom hooks</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goodTodoReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_TODO"</span>: {
      <span class="hljs-keyword">const</span> { text } = action.payload;

      <span class="hljs-comment">// Validation and processing in reducer</span>
      <span class="hljs-keyword">if</span> (!text || text.trim() === <span class="hljs-string">""</span>) {
        <span class="hljs-keyword">return</span> state;
      }

      <span class="hljs-keyword">const</span> newTodo = {
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
        <span class="hljs-attr">text</span>: text.trim(),
        <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
        <span class="hljs-attr">priority</span>: text.includes(<span class="hljs-string">"!"</span>) ? <span class="hljs-string">"high"</span> : <span class="hljs-string">"normal"</span>,
      };

      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: [...state.todos, newTodo],
      };
    }

    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodTodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(goodTodoReducer, initialState);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function">(<span class="hljs-params">text</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_TODO"</span>, <span class="hljs-attr">payload</span>: { text } });
  };

  <span class="hljs-comment">// Clean component logic</span>
}
</div></code></pre>
<h3 id="mistake-3-not-using-action-types-constants">Mistake 3: Not Using Action Types Constants</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad: Magic strings</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">badComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialState);

  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"INCREMENT_COUNTER"</span> }); <span class="hljs-comment">// Typo-prone</span>
  };
}

<span class="hljs-comment">// ✅ Good: Action type constants</span>
<span class="hljs-keyword">const</span> ACTION_TYPES = {
  <span class="hljs-attr">INCREMENT_COUNTER</span>: <span class="hljs-string">"INCREMENT_COUNTER"</span>,
  <span class="hljs-attr">DECREMENT_COUNTER</span>: <span class="hljs-string">"DECREMENT_COUNTER"</span>,
  <span class="hljs-attr">RESET_COUNTER</span>: <span class="hljs-string">"RESET_COUNTER"</span>,
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goodReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> ACTION_TYPES.INCREMENT_COUNTER:
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: state.count + <span class="hljs-number">1</span> };

    <span class="hljs-keyword">case</span> ACTION_TYPES.DECREMENT_COUNTER:
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: state.count - <span class="hljs-number">1</span> };

    <span class="hljs-keyword">case</span> ACTION_TYPES.RESET_COUNTER:
      <span class="hljs-keyword">return</span> { <span class="hljs-attr">count</span>: <span class="hljs-number">0</span> };

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goodComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(goodReducer, initialState);

  <span class="hljs-keyword">const</span> handleClick = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: ACTION_TYPES.INCREMENT_COUNTER }); <span class="hljs-comment">// Type-safe</span>
  };
}
</div></code></pre>
<h2 id="%F0%9F%8F%8B%EF%B8%8F%E2%80%8D%E2%99%82%EF%B8%8F-mini-challenges">🏋️‍♂️ Mini-Challenges</h2>
<h3 id="challenge-1-advanced-todo-app">Challenge 1: Advanced Todo App</h3>
<p>Build a todo app with categories, due dates, priorities, and search functionality using <code>useReducer</code>.</p>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> initialTodoState = {
  <span class="hljs-attr">todos</span>: [],
  <span class="hljs-attr">categories</span>: [<span class="hljs-string">"Personal"</span>, <span class="hljs-string">"Work"</span>, <span class="hljs-string">"Shopping"</span>],
  <span class="hljs-attr">filter</span>: {
    <span class="hljs-attr">category</span>: <span class="hljs-string">"all"</span>,
    <span class="hljs-attr">priority</span>: <span class="hljs-string">"all"</span>,
    <span class="hljs-attr">status</span>: <span class="hljs-string">"all"</span>,
    <span class="hljs-attr">search</span>: <span class="hljs-string">""</span>,
  },
  <span class="hljs-attr">sort</span>: {
    <span class="hljs-attr">field</span>: <span class="hljs-string">"createdAt"</span>,
    <span class="hljs-attr">direction</span>: <span class="hljs-string">"desc"</span>,
  },
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">todoReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_TODO"</span>: {
      <span class="hljs-keyword">const</span> { text, category, priority, dueDate } = action.payload;

      <span class="hljs-keyword">const</span> newTodo = {
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
        <span class="hljs-attr">text</span>: text.trim(),
        <span class="hljs-attr">category</span>: category || <span class="hljs-string">"Personal"</span>,
        <span class="hljs-attr">priority</span>: priority || <span class="hljs-string">"medium"</span>,
        <span class="hljs-attr">dueDate</span>: dueDate || <span class="hljs-literal">null</span>,
        <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
        <span class="hljs-attr">completedAt</span>: <span class="hljs-literal">null</span>,
      };

      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: [...state.todos, newTodo],
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"TOGGLE_TODO"</span>: {
      <span class="hljs-keyword">const</span> { id } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: state.todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
          todo.id === id
            ? {
                ...todo,
                <span class="hljs-attr">completed</span>: !todo.completed,
                <span class="hljs-attr">completedAt</span>: !todo.completed ? <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString() : <span class="hljs-literal">null</span>,
              }
            : todo
        ),
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_TODO"</span>: {
      <span class="hljs-keyword">const</span> { id, updates } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: state.todos.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
          todo.id === id ? { ...todo, ...updates } : todo
        ),
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"DELETE_TODO"</span>: {
      <span class="hljs-keyword">const</span> { id } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">todos</span>: state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.id !== id),
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SET_FILTER"</span>: {
      <span class="hljs-keyword">const</span> { filterType, value } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">filter</span>: {
          ...state.filter,
          [filterType]: value,
        },
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SET_SORT"</span>: {
      <span class="hljs-keyword">const</span> { field, direction } = action.payload;
      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">sort</span>: { field, direction },
      };
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_CATEGORY"</span>: {
      <span class="hljs-keyword">const</span> { category } = action.payload;
      <span class="hljs-keyword">if</span> (!state.categories.includes(category)) {
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">categories</span>: [...state.categories, category],
        };
      }
      <span class="hljs-keyword">return</span> state;
    }

    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useTodos</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(todoReducer, initialTodoState);

  <span class="hljs-comment">// Filtered and sorted todos</span>
  <span class="hljs-keyword">const</span> filteredTodos = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> filtered = state.todos;

    <span class="hljs-comment">// Filter by category</span>
    <span class="hljs-keyword">if</span> (state.filter.category !== <span class="hljs-string">"all"</span>) {
      filtered = filtered.filter(
        <span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.category === state.filter.category
      );
    }

    <span class="hljs-comment">// Filter by priority</span>
    <span class="hljs-keyword">if</span> (state.filter.priority !== <span class="hljs-string">"all"</span>) {
      filtered = filtered.filter(
        <span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.priority === state.filter.priority
      );
    }

    <span class="hljs-comment">// Filter by status</span>
    <span class="hljs-keyword">if</span> (state.filter.status !== <span class="hljs-string">"all"</span>) {
      filtered = filtered.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
        state.filter.status === <span class="hljs-string">"completed"</span> ? todo.completed : !todo.completed
      );
    }

    <span class="hljs-comment">// Filter by search</span>
    <span class="hljs-keyword">if</span> (state.filter.search) {
      filtered = filtered.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
        todo.text.toLowerCase().includes(state.filter.search.toLowerCase())
      );
    }

    <span class="hljs-comment">// Sort</span>
    filtered.sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> { field, direction } = state.sort;
      <span class="hljs-keyword">let</span> aValue = a[field];
      <span class="hljs-keyword">let</span> bValue = b[field];

      <span class="hljs-keyword">if</span> (field === <span class="hljs-string">"priority"</span>) {
        <span class="hljs-keyword">const</span> priorityOrder = { <span class="hljs-attr">low</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">medium</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">high</span>: <span class="hljs-number">3</span> };
        aValue = priorityOrder[aValue];
        bValue = priorityOrder[bValue];
      }

      <span class="hljs-keyword">if</span> (direction === <span class="hljs-string">"asc"</span>) {
        <span class="hljs-keyword">return</span> aValue &gt; bValue ? <span class="hljs-number">1</span> : <span class="hljs-number">-1</span>;
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> aValue &lt; bValue ? <span class="hljs-number">1</span> : <span class="hljs-number">-1</span>;
      }
    });

    <span class="hljs-keyword">return</span> filtered;
  }, [state.todos, state.filter, state.sort]);

  <span class="hljs-comment">// Actions</span>
  <span class="hljs-keyword">const</span> addTodo = useCallback(<span class="hljs-function">(<span class="hljs-params">todoData</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_TODO"</span>, <span class="hljs-attr">payload</span>: todoData });
  }, []);

  <span class="hljs-keyword">const</span> toggleTodo = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"TOGGLE_TODO"</span>, <span class="hljs-attr">payload</span>: { id } });
  }, []);

  <span class="hljs-keyword">const</span> updateTodo = useCallback(<span class="hljs-function">(<span class="hljs-params">id, updates</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"UPDATE_TODO"</span>, <span class="hljs-attr">payload</span>: { id, updates } });
  }, []);

  <span class="hljs-keyword">const</span> deleteTodo = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"DELETE_TODO"</span>, <span class="hljs-attr">payload</span>: { id } });
  }, []);

  <span class="hljs-keyword">const</span> setFilter = useCallback(<span class="hljs-function">(<span class="hljs-params">filterType, value</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SET_FILTER"</span>, <span class="hljs-attr">payload</span>: { filterType, value } });
  }, []);

  <span class="hljs-keyword">const</span> setSort = useCallback(<span class="hljs-function">(<span class="hljs-params">field, direction</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SET_SORT"</span>, <span class="hljs-attr">payload</span>: { field, direction } });
  }, []);

  <span class="hljs-keyword">const</span> addCategory = useCallback(<span class="hljs-function">(<span class="hljs-params">category</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_CATEGORY"</span>, <span class="hljs-attr">payload</span>: { category } });
  }, []);

  <span class="hljs-comment">// Statistics</span>
  <span class="hljs-keyword">const</span> stats = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> total = state.todos.length;
    <span class="hljs-keyword">const</span> completed = state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.completed).length;
    <span class="hljs-keyword">const</span> overdue = state.todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (!todo.dueDate || todo.completed) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(todo.dueDate) &lt; <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
    }).length;

    <span class="hljs-keyword">return</span> {
      total,
      completed,
      <span class="hljs-attr">pending</span>: total - completed,
      overdue,
      <span class="hljs-attr">completionRate</span>: total &gt; <span class="hljs-number">0</span> ? <span class="hljs-built_in">Math</span>.round((completed / total) * <span class="hljs-number">100</span>) : <span class="hljs-number">0</span>,
    };
  }, [state.todos]);

  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">todos</span>: filteredTodos,
    <span class="hljs-attr">allTodos</span>: state.todos,
    <span class="hljs-attr">categories</span>: state.categories,
    <span class="hljs-attr">filter</span>: state.filter,
    <span class="hljs-attr">sort</span>: state.sort,
    stats,
    addTodo,
    toggleTodo,
    updateTodo,
    deleteTodo,
    setFilter,
    setSort,
    addCategory,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdvancedTodoApp</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> {
    todos,
    categories,
    filter,
    sort,
    stats,
    addTodo,
    toggleTodo,
    updateTodo,
    deleteTodo,
    setFilter,
    setSort,
    addCategory,
  } = useTodos();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"advanced-todo-app"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoStats</span> <span class="hljs-attr">stats</span>=<span class="hljs-string">{stats}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoFilters</span>
        <span class="hljs-attr">filter</span>=<span class="hljs-string">{filter}</span>
        <span class="hljs-attr">categories</span>=<span class="hljs-string">{categories}</span>
        <span class="hljs-attr">onFilterChange</span>=<span class="hljs-string">{setFilter}</span>
        <span class="hljs-attr">onSortChange</span>=<span class="hljs-string">{setSort}</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoForm</span>
        <span class="hljs-attr">categories</span>=<span class="hljs-string">{categories}</span>
        <span class="hljs-attr">onAddTodo</span>=<span class="hljs-string">{addTodo}</span>
        <span class="hljs-attr">onAddCategory</span>=<span class="hljs-string">{addCategory}</span>
      /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoList</span>
        <span class="hljs-attr">todos</span>=<span class="hljs-string">{todos}</span>
        <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{toggleTodo}</span>
        <span class="hljs-attr">onUpdate</span>=<span class="hljs-string">{updateTodo}</span>
        <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{deleteTodo}</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h3 id="challenge-2-shopping-cart-with-discounts">Challenge 2: Shopping Cart with Discounts</h3>
<p>Create a shopping cart system with multiple discount types, tax calculation, and shipping options.</p>
<details>
<summary>💡 Solution</summary>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> initialCartState = {
  <span class="hljs-attr">items</span>: [],
  <span class="hljs-attr">discounts</span>: {
    <span class="hljs-attr">coupon</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">bulk</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">loyalty</span>: <span class="hljs-literal">null</span>,
  },
  <span class="hljs-attr">shipping</span>: {
    <span class="hljs-attr">method</span>: <span class="hljs-string">"standard"</span>,
    <span class="hljs-attr">cost</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">estimatedDays</span>: <span class="hljs-number">5</span>,
  },
  <span class="hljs-attr">tax</span>: {
    <span class="hljs-attr">rate</span>: <span class="hljs-number">0.08</span>,
    <span class="hljs-attr">amount</span>: <span class="hljs-number">0</span>,
  },
  <span class="hljs-attr">totals</span>: {
    <span class="hljs-attr">subtotal</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">discountAmount</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">taxAmount</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">shippingCost</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,
  },
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cartReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"ADD_ITEM"</span>: {
      <span class="hljs-keyword">const</span> { product, quantity = <span class="hljs-number">1</span> } = action.payload;
      <span class="hljs-keyword">const</span> existingItem = state.items.find(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === product.id);

      <span class="hljs-keyword">let</span> newItems;
      <span class="hljs-keyword">if</span> (existingItem) {
        newItems = state.items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
          item.id === product.id
            ? { ...item, <span class="hljs-attr">quantity</span>: item.quantity + quantity }
            : item
        );
      } <span class="hljs-keyword">else</span> {
        newItems = [...state.items, { ...product, quantity }];
      }

      <span class="hljs-keyword">return</span> calculateTotals({ ...state, <span class="hljs-attr">items</span>: newItems });
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_QUANTITY"</span>: {
      <span class="hljs-keyword">const</span> { id, quantity } = action.payload;

      <span class="hljs-keyword">if</span> (quantity &lt;= <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">return</span> cartReducer(state, { <span class="hljs-attr">type</span>: <span class="hljs-string">"REMOVE_ITEM"</span>, <span class="hljs-attr">payload</span>: { id } });
      }

      <span class="hljs-keyword">const</span> newItems = state.items.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span>
        item.id === id ? { ...item, quantity } : item
      );

      <span class="hljs-keyword">return</span> calculateTotals({ ...state, <span class="hljs-attr">items</span>: newItems });
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"REMOVE_ITEM"</span>: {
      <span class="hljs-keyword">const</span> { id } = action.payload;
      <span class="hljs-keyword">const</span> newItems = state.items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id !== id);
      <span class="hljs-keyword">return</span> calculateTotals({ ...state, <span class="hljs-attr">items</span>: newItems });
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"APPLY_COUPON"</span>: {
      <span class="hljs-keyword">const</span> { coupon } = action.payload;
      <span class="hljs-keyword">const</span> newState = {
        ...state,
        <span class="hljs-attr">discounts</span>: {
          ...state.discounts,
          coupon,
        },
      };
      <span class="hljs-keyword">return</span> calculateTotals(newState);
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"REMOVE_COUPON"</span>: {
      <span class="hljs-keyword">const</span> newState = {
        ...state,
        <span class="hljs-attr">discounts</span>: {
          ...state.discounts,
          <span class="hljs-attr">coupon</span>: <span class="hljs-literal">null</span>,
        },
      };
      <span class="hljs-keyword">return</span> calculateTotals(newState);
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"SET_SHIPPING"</span>: {
      <span class="hljs-keyword">const</span> { method, cost, estimatedDays } = action.payload;
      <span class="hljs-keyword">const</span> newState = {
        ...state,
        <span class="hljs-attr">shipping</span>: { method, cost, estimatedDays },
      };
      <span class="hljs-keyword">return</span> calculateTotals(newState);
    }

    <span class="hljs-keyword">case</span> <span class="hljs-string">"CLEAR_CART"</span>:
      <span class="hljs-keyword">return</span> initialCartState;

    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">calculateTotals</span>(<span class="hljs-params">state</span>) </span>{
  <span class="hljs-keyword">const</span> subtotal = state.items.reduce(
    <span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.price * item.quantity,
    <span class="hljs-number">0</span>
  );

  <span class="hljs-comment">// Calculate discounts</span>
  <span class="hljs-keyword">let</span> discountAmount = <span class="hljs-number">0</span>;

  <span class="hljs-comment">// Coupon discount</span>
  <span class="hljs-keyword">if</span> (state.discounts.coupon) {
    <span class="hljs-keyword">const</span> coupon = state.discounts.coupon;
    <span class="hljs-keyword">if</span> (coupon.type === <span class="hljs-string">"percentage"</span>) {
      discountAmount += subtotal * (coupon.value / <span class="hljs-number">100</span>);
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (coupon.type === <span class="hljs-string">"fixed"</span>) {
      discountAmount += <span class="hljs-built_in">Math</span>.min(coupon.value, subtotal);
    }
  }

  <span class="hljs-comment">// Bulk discount (10% off if subtotal &gt; $100)</span>
  <span class="hljs-keyword">if</span> (subtotal &gt; <span class="hljs-number">100</span>) {
    <span class="hljs-keyword">const</span> bulkDiscount = subtotal * <span class="hljs-number">0.1</span>;
    discountAmount += bulkDiscount;
    state.discounts.bulk = {
      <span class="hljs-attr">type</span>: <span class="hljs-string">"bulk"</span>,
      <span class="hljs-attr">description</span>: <span class="hljs-string">"10% off orders over $100"</span>,
      <span class="hljs-attr">amount</span>: bulkDiscount,
    };
  } <span class="hljs-keyword">else</span> {
    state.discounts.bulk = <span class="hljs-literal">null</span>;
  }

  <span class="hljs-comment">// Loyalty discount (5% off for returning customers)</span>
  <span class="hljs-comment">// This would typically come from user data</span>
  <span class="hljs-keyword">const</span> isLoyalCustomer = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Placeholder</span>
  <span class="hljs-keyword">if</span> (isLoyalCustomer &amp;&amp; subtotal &gt; <span class="hljs-number">50</span>) {
    <span class="hljs-keyword">const</span> loyaltyDiscount = subtotal * <span class="hljs-number">0.05</span>;
    discountAmount += loyaltyDiscount;
    state.discounts.loyalty = {
      <span class="hljs-attr">type</span>: <span class="hljs-string">"loyalty"</span>,
      <span class="hljs-attr">description</span>: <span class="hljs-string">"5% loyalty discount"</span>,
      <span class="hljs-attr">amount</span>: loyaltyDiscount,
    };
  } <span class="hljs-keyword">else</span> {
    state.discounts.loyalty = <span class="hljs-literal">null</span>;
  }

  <span class="hljs-keyword">const</span> discountedSubtotal = <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, subtotal - discountAmount);
  <span class="hljs-keyword">const</span> taxAmount = discountedSubtotal * state.tax.rate;
  <span class="hljs-keyword">const</span> total = discountedSubtotal + taxAmount + state.shipping.cost;

  <span class="hljs-keyword">return</span> {
    ...state,
    <span class="hljs-attr">totals</span>: {
      subtotal,
      discountAmount,
      taxAmount,
      <span class="hljs-attr">shippingCost</span>: state.shipping.cost,
      total,
    },
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useShoppingCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(cartReducer, initialCartState);

  <span class="hljs-keyword">const</span> addItem = useCallback(<span class="hljs-function">(<span class="hljs-params">product, quantity = <span class="hljs-number">1</span></span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_ITEM"</span>, <span class="hljs-attr">payload</span>: { product, quantity } });
  }, []);

  <span class="hljs-keyword">const</span> updateQuantity = useCallback(<span class="hljs-function">(<span class="hljs-params">id, quantity</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"UPDATE_QUANTITY"</span>, <span class="hljs-attr">payload</span>: { id, quantity } });
  }, []);

  <span class="hljs-keyword">const</span> removeItem = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"REMOVE_ITEM"</span>, <span class="hljs-attr">payload</span>: { id } });
  }, []);

  <span class="hljs-keyword">const</span> applyCoupon = useCallback(<span class="hljs-function">(<span class="hljs-params">coupon</span>) =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"APPLY_COUPON"</span>, <span class="hljs-attr">payload</span>: { coupon } });
  }, []);

  <span class="hljs-keyword">const</span> removeCoupon = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"REMOVE_COUPON"</span> });
  }, []);

  <span class="hljs-keyword">const</span> setShipping = useCallback(<span class="hljs-function">(<span class="hljs-params">method, cost, estimatedDays</span>) =&gt;</span> {
    dispatch({
      <span class="hljs-attr">type</span>: <span class="hljs-string">"SET_SHIPPING"</span>,
      <span class="hljs-attr">payload</span>: { method, cost, estimatedDays },
    });
  }, []);

  <span class="hljs-keyword">const</span> clearCart = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"CLEAR_CART"</span> });
  }, []);

  <span class="hljs-keyword">const</span> itemCount = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> state.items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.quantity, <span class="hljs-number">0</span>);
  }, [state.items]);

  <span class="hljs-keyword">return</span> {
    ...state,
    itemCount,
    addItem,
    updateQuantity,
    removeItem,
    applyCoupon,
    removeCoupon,
    setShipping,
    clearCart,
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ShoppingCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> {
    items,
    discounts,
    shipping,
    totals,
    itemCount,
    addItem,
    updateQuantity,
    removeItem,
    applyCoupon,
    removeCoupon,
    setShipping,
  } = useShoppingCart();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"shopping-cart"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Shopping Cart ({itemCount} items)<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-items"</span>&gt;</span>
        {items.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">CartItem</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>
            <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span>
            <span class="hljs-attr">onUpdateQuantity</span>=<span class="hljs-string">{updateQuantity}</span>
            <span class="hljs-attr">onRemove</span>=<span class="hljs-string">{removeItem}</span>
          /&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">CouponSection</span>
        <span class="hljs-attr">coupon</span>=<span class="hljs-string">{discounts.coupon}</span>
        <span class="hljs-attr">onApplyCoupon</span>=<span class="hljs-string">{applyCoupon}</span>
        <span class="hljs-attr">onRemoveCoupon</span>=<span class="hljs-string">{removeCoupon}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">ShippingOptions</span> <span class="hljs-attr">shipping</span>=<span class="hljs-string">{shipping}</span> <span class="hljs-attr">onSetShipping</span>=<span class="hljs-string">{setShipping}</span> /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">CartSummary</span> <span class="hljs-attr">totals</span>=<span class="hljs-string">{totals}</span> <span class="hljs-attr">discounts</span>=<span class="hljs-string">{discounts}</span> <span class="hljs-attr">shipping</span>=<span class="hljs-string">{shipping}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
</details>
<h2 id="%F0%9F%8E%AF-when-and-why-to-use-usereducer">🎯 When and Why to Use useReducer</h2>
<h3 id="%E2%9C%85-use-usereducer-when">✅ Use useReducer When:</h3>
<ol>
<li><strong>Complex State Logic</strong>: Multiple related state values that change together</li>
<li><strong>State Transitions</strong>: Next state depends on previous state</li>
<li><strong>Predictable Updates</strong>: Need consistent, testable state changes</li>
<li><strong>Multiple Actions</strong>: Different ways to update the same state</li>
<li><strong>State Validation</strong>: Need to validate state changes</li>
<li><strong>Undo/Redo</strong>: Need to track state history</li>
<li><strong>Global State</strong>: Combined with Context for app-wide state</li>
</ol>
<h3 id="%E2%9D%8C-avoid-usereducer-when">❌ Avoid useReducer When:</h3>
<ol>
<li><strong>Simple State</strong>: Single primitive values (string, number, boolean)</li>
<li><strong>Independent State</strong>: State values that don't relate to each other</li>
<li><strong>Frequent Updates</strong>: High-frequency state changes (animations, mouse tracking)</li>
<li><strong>Server State</strong>: Use data fetching libraries instead</li>
<li><strong>Form State</strong>: Consider form libraries for complex forms</li>
</ol>
<h3 id="%F0%9F%A4%94-decision-framework">🤔 Decision Framework</h3>
<pre class="hljs"><code><div>Do you have multiple related state values?
├─ No → Use useState
└─ Yes
   ├─ Do state updates depend on previous state?
   │  ├─ No → Consider multiple useState
   │  └─ Yes → useReducer is good
   └─ Do you need predictable state transitions?
      ├─ No → useState might be simpler
      └─ Yes → useReducer is perfect
</div></code></pre>
<h2 id="%F0%9F%9A%80-performance-optimization">🚀 Performance Optimization</h2>
<h3 id="memoizing-dispatch">Memoizing Dispatch</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ dispatch is automatically stable</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialState);

  <span class="hljs-comment">// dispatch never changes, so this is safe</span>
  <span class="hljs-keyword">const</span> memoizedCallback = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SOME_ACTION"</span> });
  }, [dispatch]); <span class="hljs-comment">// dispatch can be omitted from deps</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ChildComponent</span> <span class="hljs-attr">onAction</span>=<span class="hljs-string">{memoizedCallback}</span> /&gt;</span></span>;
}
</div></code></pre>
<h3 id="optimizing-reducer-performance">Optimizing Reducer Performance</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Use early returns for performance</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">optimizedReducer</span>(<span class="hljs-params">state, action</span>) </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">"UPDATE_ITEM"</span>: {
      <span class="hljs-keyword">const</span> { id, updates } = action.payload;

      <span class="hljs-comment">// Early return if item doesn't exist</span>
      <span class="hljs-keyword">const</span> itemIndex = state.items.findIndex(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === id);
      <span class="hljs-keyword">if</span> (itemIndex === <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">return</span> state;
      }

      <span class="hljs-comment">// Early return if no actual changes</span>
      <span class="hljs-keyword">const</span> currentItem = state.items[itemIndex];
      <span class="hljs-keyword">const</span> hasChanges = <span class="hljs-built_in">Object</span>.keys(updates).some(
        <span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> currentItem[key] !== updates[key]
      );
      <span class="hljs-keyword">if</span> (!hasChanges) {
        <span class="hljs-keyword">return</span> state;
      }

      <span class="hljs-comment">// Only update if necessary</span>
      <span class="hljs-keyword">const</span> newItems = [...state.items];
      newItems[itemIndex] = { ...currentItem, ...updates };

      <span class="hljs-keyword">return</span> {
        ...state,
        <span class="hljs-attr">items</span>: newItems,
      };
    }

    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</div></code></pre>
<h3 id="lazy-initialization">Lazy Initialization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Expensive initial state calculation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">init</span>(<span class="hljs-params">initialCount</span>) </span>{
  <span class="hljs-comment">// Expensive computation</span>
  <span class="hljs-keyword">const</span> expensiveValue = computeExpensiveValue(initialCount);
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">count</span>: initialCount,
    expensiveValue,
    <span class="hljs-attr">history</span>: [],
  };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params">{ initialCount }</span>) </span>{
  <span class="hljs-comment">// init function only runs once</span>
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(reducer, initialCount, init);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      Count: {state.count}
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch({ type: "increment" })}&gt;+<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-questions">Common Questions</h3>
<p><strong>Q: When would you use useReducer instead of useState?</strong></p>
<p>A: useReducer is better when:</p>
<ul>
<li>Managing complex state with multiple sub-values</li>
<li>State updates depend on previous state</li>
<li>Need predictable state transitions</li>
<li>Multiple components need to trigger the same state changes</li>
<li>Building state machines or complex workflows</li>
</ul>
<p><strong>Q: How does useReducer compare to Redux?</strong></p>
<p>A: Similarities:</p>
<ul>
<li>Both use reducer pattern</li>
<li>Predictable state updates</li>
<li>Action-based state changes</li>
</ul>
<p>Differences:</p>
<ul>
<li>useReducer is local to component tree</li>
<li>Redux has global state and middleware</li>
<li>Redux has time-travel debugging</li>
<li>useReducer is simpler for component-level state</li>
</ul>
<p><strong>Q: Can you combine useReducer with Context?</strong></p>
<p>A: Yes! This is a powerful pattern for global state management:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">const</span> StateContext = createContext();
<span class="hljs-keyword">const</span> DispatchContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AppProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [state, dispatch] = useReducer(appReducer, initialState);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">StateContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{state}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">DispatchContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{dispatch}</span>&gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">DispatchContext.Provider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">StateContext.Provider</span>&gt;</span></span>
  );
}
</div></code></pre>
<p><strong>Q: How do you test components that use useReducer?</strong></p>
<p>A: Test the reducer function separately, then test component behavior:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Test reducer</span>
describe(<span class="hljs-string">"todoReducer"</span>, () =&gt; {
  it(<span class="hljs-string">"should add a todo"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> initialState = { <span class="hljs-attr">todos</span>: [] };
    <span class="hljs-keyword">const</span> action = { <span class="hljs-attr">type</span>: <span class="hljs-string">"ADD_TODO"</span>, <span class="hljs-attr">payload</span>: { <span class="hljs-attr">text</span>: <span class="hljs-string">"Test"</span> } };
    <span class="hljs-keyword">const</span> newState = todoReducer(initialState, action);

    expect(newState.todos).toHaveLength(<span class="hljs-number">1</span>);
    expect(newState.todos[<span class="hljs-number">0</span>].text).toBe(<span class="hljs-string">"Test"</span>);
  });
});

<span class="hljs-comment">// Test component</span>
test(<span class="hljs-string">"adds todo when form is submitted"</span>, () =&gt; {
  render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

  fireEvent.change(screen.getByPlaceholderText(<span class="hljs-string">"Add todo"</span>), {
    <span class="hljs-attr">target</span>: { <span class="hljs-attr">value</span>: <span class="hljs-string">"New todo"</span> },
  });
  fireEvent.click(screen.getByText(<span class="hljs-string">"Add"</span>));

  expect(screen.getByText(<span class="hljs-string">"New todo"</span>)).toBeInTheDocument();
});
</div></code></pre>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<p>❌ <strong>Mutating state in reducer</strong>
❌ <strong>Complex logic in components instead of reducer</strong>
❌ <strong>Not handling all action types</strong>
❌ <strong>Missing default case in reducer</strong>
❌ <strong>Using useReducer for simple state</strong>
❌ <strong>Not memoizing expensive calculations</strong></p>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>useReducer is for complex state</strong> - Use when useState becomes unwieldy</li>
<li><strong>Reducers must be pure</strong> - No side effects, always return new state</li>
<li><strong>Actions describe what happened</strong> - Use descriptive action types</li>
<li><strong>Combine with Context for global state</strong> - Powerful alternative to Redux</li>
<li><strong>Test reducers separately</strong> - Pure functions are easy to test</li>
<li><strong>Use action creators</strong> - Improve maintainability and type safety</li>
<li><strong>Consider performance</strong> - Early returns and memoization help</li>
</ol>
<h2 id="%F0%9F%8F%86-best-practices">🏆 Best Practices</h2>
<ol>
<li><strong>Keep reducers pure</strong> - No side effects or mutations</li>
<li><strong>Use action type constants</strong> - Prevent typos and improve maintainability</li>
<li><strong>Structure actions consistently</strong> - Use <code>{ type, payload }</code> pattern</li>
<li><strong>Handle all cases</strong> - Always include default case</li>
<li><strong>Split large reducers</strong> - Use reducer composition for complex state</li>
<li><strong>Document state shape</strong> - Clear interfaces help team collaboration</li>
<li><strong>Use TypeScript</strong> - Better developer experience and fewer bugs</li>
</ol>
<h2 id="%F0%9F%94%A7-production-tips">🔧 Production Tips</h2>
<ul>
<li><strong>Monitor reducer performance</strong> with React DevTools Profiler</li>
<li><strong>Use immer</strong> for complex immutable updates</li>
<li><strong>Implement middleware pattern</strong> for logging and debugging</li>
<li><strong>Consider reducer composition</strong> for large applications</li>
<li><strong>Use action creators</strong> for complex action logic</li>
<li><strong>Implement optimistic updates</strong> for better UX</li>
<li><strong>Add error boundaries</strong> around components using reducers</li>
</ul>
<hr>
<p><strong>Next up</strong>: We'll explore custom hooks and learn how to create reusable stateful logic! 🚀</p>
<h1 id="13-custom-hooks-reusable-logic-%F0%9F%8E%A3">13. Custom Hooks: Reusable Logic 🎣</h1>
<blockquote>
<p>&quot;Custom hooks are where React's composition model truly shines. They let you extract component logic into reusable functions.&quot; - React Team</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>What custom hooks are and why they're powerful</li>
<li>How to extract stateful logic into reusable hooks</li>
<li>Common patterns for building custom hooks</li>
<li>Best practices for hook composition</li>
<li>Testing strategies for custom hooks</li>
<li>Performance considerations</li>
</ul>
<h2 id="%F0%9F%94%8D-what-are-custom-hooks">🔍 What Are Custom Hooks?</h2>
<p>Custom hooks are JavaScript functions that:</p>
<ol>
<li><strong>Start with &quot;use&quot;</strong> (naming convention)</li>
<li><strong>Can call other hooks</strong> (built-in or custom)</li>
<li><strong>Extract stateful logic</strong> from components</li>
<li><strong>Enable logic reuse</strong> across components</li>
<li><strong>Follow the rules of hooks</strong></li>
</ol>
<h3 id="basic-example">Basic Example</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Simple custom hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCounter</span>(<span class="hljs-params">initialValue = <span class="hljs-number">0</span></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(initialValue);

  <span class="hljs-keyword">const</span> increment = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">const</span> decrement = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev - <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">const</span> reset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(initialValue);
  }, [initialValue]);

  <span class="hljs-keyword">return</span> {
    count,
    increment,
    decrement,
    reset,
  };
}

<span class="hljs-comment">// Usage in component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Counter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { count, increment, decrement, reset } = useCounter(<span class="hljs-number">10</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{increment}</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{decrement}</span>&gt;</span>-<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{reset}</span>&gt;</span>Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8F%97%EF%B8%8F-common-custom-hook-patterns">🏗️ Common Custom Hook Patterns</h2>
<h3 id="1-state-management-hooks">1. State Management Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Boolean state hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useToggle</span>(<span class="hljs-params">initialValue = false</span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(initialValue);

  <span class="hljs-keyword">const</span> toggle = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setValue(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> !prev);
  }, []);

  <span class="hljs-keyword">const</span> setTrue = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setValue(<span class="hljs-literal">true</span>);
  }, []);

  <span class="hljs-keyword">const</span> setFalse = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setValue(<span class="hljs-literal">false</span>);
  }, []);

  <span class="hljs-keyword">return</span> [value, { toggle, setTrue, setFalse }];
}

<span class="hljs-comment">// ✅ Array state hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useArray</span>(<span class="hljs-params">initialArray = []</span>) </span>{
  <span class="hljs-keyword">const</span> [array, setArray] = useState(initialArray);

  <span class="hljs-keyword">const</span> push = useCallback(<span class="hljs-function">(<span class="hljs-params">element</span>) =&gt;</span> {
    setArray(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, element]);
  }, []);

  <span class="hljs-keyword">const</span> remove = useCallback(<span class="hljs-function">(<span class="hljs-params">index</span>) =&gt;</span> {
    setArray(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">_, i</span>) =&gt;</span> i !== index));
  }, []);

  <span class="hljs-keyword">const</span> update = useCallback(<span class="hljs-function">(<span class="hljs-params">index, newElement</span>) =&gt;</span> {
    setArray(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">item, i</span>) =&gt;</span> (i === index ? newElement : item))
    );
  }, []);

  <span class="hljs-keyword">const</span> clear = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setArray([]);
  }, []);

  <span class="hljs-keyword">return</span> {
    array,
    <span class="hljs-attr">set</span>: setArray,
    push,
    remove,
    update,
    clear,
  };
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">array</span>: todos, push, remove, update } = useArray([]);
  <span class="hljs-keyword">const</span> [newTodo, setNewTodo] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (newTodo.trim()) {
      push({ <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(), <span class="hljs-attr">text</span>: newTodo, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> });
      setNewTodo(<span class="hljs-string">""</span>);
    }
  };

  <span class="hljs-keyword">const</span> toggleTodo = <span class="hljs-function">(<span class="hljs-params">index</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> todo = todos[index];
    update(index, { ...todo, <span class="hljs-attr">completed</span>: !todo.completed });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{newTodo}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setNewTodo(e.target.value)}
        onKeyPress={(e) =&gt; e.key === "Enter" &amp;&amp; addTodo()}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addTodo}</span>&gt;</span>Add<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {todos.map((todo, index) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">span</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
              <span class="hljs-attr">textDecoration:</span> <span class="hljs-attr">todo.completed</span> ? "<span class="hljs-attr">line-through</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">none</span>",
            }}
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleTodo(index)}
          &gt;
            {todo.text}
          <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> remove(index)}&gt;Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-data-fetching-hooks">2. Data Fetching Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Generic fetch hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useFetch</span>(<span class="hljs-params">url, options = {}</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> isCancelled = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        setLoading(<span class="hljs-literal">true</span>);
        setError(<span class="hljs-literal">null</span>);

        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, options);

        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
        }

        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();

        <span class="hljs-keyword">if</span> (!isCancelled) {
          setData(result);
        }
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-keyword">if</span> (!isCancelled) {
          setError(err.message);
        }
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (!isCancelled) {
          setLoading(<span class="hljs-literal">false</span>);
        }
      }
    };

    fetchData();

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      isCancelled = <span class="hljs-literal">true</span>;
    };
  }, [url, <span class="hljs-built_in">JSON</span>.stringify(options)]);

  <span class="hljs-keyword">const</span> refetch = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setLoading(<span class="hljs-literal">true</span>);
    setError(<span class="hljs-literal">null</span>);
    <span class="hljs-comment">// Trigger useEffect by updating a dependency</span>
  }, []);

  <span class="hljs-keyword">return</span> { data, loading, error, refetch };
}

<span class="hljs-comment">// ✅ Specific API hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useUsers</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { data, loading, error, refetch } = useFetch(<span class="hljs-string">"/api/users"</span>);

  <span class="hljs-keyword">const</span> users = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> data || [], [data]);

  <span class="hljs-keyword">return</span> {
    users,
    loading,
    error,
    refetch,
  };
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { users, loading, error, refetch } = useUsers();

  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading users...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{refetch}</span>&gt;</span>Refresh<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      {users.map((user) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="3-local-storage-hooks">3. Local Storage Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Local storage hook with sync</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useLocalStorage</span>(<span class="hljs-params">key, initialValue</span>) </span>{
  <span class="hljs-comment">// Get initial value from localStorage or use provided initial value</span>
  <span class="hljs-keyword">const</span> [storedValue, setStoredValue] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> item = <span class="hljs-built_in">window</span>.localStorage.getItem(key);
      <span class="hljs-keyword">return</span> item ? <span class="hljs-built_in">JSON</span>.parse(item) : initialValue;
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Error reading localStorage key "<span class="hljs-subst">${key}</span>":`</span>, error);
      <span class="hljs-keyword">return</span> initialValue;
    }
  });

  <span class="hljs-comment">// Return a wrapped version of useState's setter function that persists the new value to localStorage</span>
  <span class="hljs-keyword">const</span> setValue = useCallback(
    <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Allow value to be a function so we have the same API as useState</span>
        <span class="hljs-keyword">const</span> valueToStore =
          value <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Function</span> ? value(storedValue) : value;

        setStoredValue(valueToStore);
        <span class="hljs-built_in">window</span>.localStorage.setItem(key, <span class="hljs-built_in">JSON</span>.stringify(valueToStore));
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">`Error setting localStorage key "<span class="hljs-subst">${key}</span>":`</span>, error);
      }
    },
    [key, storedValue]
  );

  <span class="hljs-comment">// Listen for changes to this key in other tabs/windows</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleStorageChange = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.key === key &amp;&amp; e.newValue !== <span class="hljs-literal">null</span>) {
        <span class="hljs-keyword">try</span> {
          setStoredValue(<span class="hljs-built_in">JSON</span>.parse(e.newValue));
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-built_in">console</span>.error(
            <span class="hljs-string">`Error parsing localStorage value for key "<span class="hljs-subst">${key}</span>":`</span>,
            error
          );
        }
      }
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"storage"</span>, handleStorageChange);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"storage"</span>, handleStorageChange);
  }, [key]);

  <span class="hljs-keyword">return</span> [storedValue, setValue];
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Settings</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [theme, setTheme] = useLocalStorage(<span class="hljs-string">"theme"</span>, <span class="hljs-string">"light"</span>);
  <span class="hljs-keyword">const</span> [language, setLanguage] = useLocalStorage(<span class="hljs-string">"language"</span>, <span class="hljs-string">"en"</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{theme}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setTheme(e.target.value)}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"light"</span>&gt;</span>Light<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"dark"</span>&gt;</span>Dark<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{language}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setLanguage(e.target.value)}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"en"</span>&gt;</span>English<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"es"</span>&gt;</span>Spanish<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"fr"</span>&gt;</span>French<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="4-event-listener-hooks">4. Event Listener Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Generic event listener hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useEventListener</span>(<span class="hljs-params">eventName, handler, element = window</span>) </span>{
  <span class="hljs-comment">// Create a ref that stores handler</span>
  <span class="hljs-keyword">const</span> savedHandler = useRef();

  <span class="hljs-comment">// Update ref.current value if handler changes</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    savedHandler.current = handler;
  }, [handler]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Make sure element supports addEventListener</span>
    <span class="hljs-keyword">const</span> isSupported = element &amp;&amp; element.addEventListener;
    <span class="hljs-keyword">if</span> (!isSupported) <span class="hljs-keyword">return</span>;

    <span class="hljs-comment">// Create event listener that calls handler function stored in ref</span>
    <span class="hljs-keyword">const</span> eventListener = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> savedHandler.current(event);

    element.addEventListener(eventName, eventListener);

    <span class="hljs-comment">// Remove event listener on cleanup</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      element.removeEventListener(eventName, eventListener);
    };
  }, [eventName, element]);
}

<span class="hljs-comment">// ✅ Specific keyboard hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useKeyPress</span>(<span class="hljs-params">targetKey</span>) </span>{
  <span class="hljs-keyword">const</span> [keyPressed, setKeyPressed] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> downHandler = useCallback(
    <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (event.key === targetKey) {
        setKeyPressed(<span class="hljs-literal">true</span>);
      }
    },
    [targetKey]
  );

  <span class="hljs-keyword">const</span> upHandler = useCallback(
    <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (event.key === targetKey) {
        setKeyPressed(<span class="hljs-literal">false</span>);
      }
    },
    [targetKey]
  );

  useEventListener(<span class="hljs-string">"keydown"</span>, downHandler);
  useEventListener(<span class="hljs-string">"keyup"</span>, upHandler);

  <span class="hljs-keyword">return</span> keyPressed;
}

<span class="hljs-comment">// ✅ Window size hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useWindowSize</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [windowSize, setWindowSize] = useState({
    <span class="hljs-attr">width</span>: <span class="hljs-literal">undefined</span>,
    <span class="hljs-attr">height</span>: <span class="hljs-literal">undefined</span>,
  });

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleResize</span>(<span class="hljs-params"></span>) </span>{
      setWindowSize({
        <span class="hljs-attr">width</span>: <span class="hljs-built_in">window</span>.innerWidth,
        <span class="hljs-attr">height</span>: <span class="hljs-built_in">window</span>.innerHeight,
      });
    }

    <span class="hljs-comment">// Set initial size</span>
    handleResize();

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"resize"</span>, handleResize);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"resize"</span>, handleResize);
  }, []);

  <span class="hljs-keyword">return</span> windowSize;
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ResponsiveComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { width } = useWindowSize();
  <span class="hljs-keyword">const</span> escapePressed = useKeyPress(<span class="hljs-string">"Escape"</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (escapePressed) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Escape was pressed!"</span>);
    }
  }, [escapePressed]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Window width: {width}px<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Screen size: {width <span class="hljs-tag">&lt; <span class="hljs-attr">768</span> ? "<span class="hljs-attr">Mobile</span>" <span class="hljs-attr">:</span> "<span class="hljs-attr">Desktop</span>"}&lt;/<span class="hljs-attr">p</span>&gt;</span>
      {escapePressed &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Escape is being pressed!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-hook-composition">🔄 Hook Composition</h2>
<h3 id="combining-multiple-hooks">Combining Multiple Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Complex hook that combines multiple concerns</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useShoppingCart</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Use multiple custom hooks</span>
  <span class="hljs-keyword">const</span> { <span class="hljs-attr">array</span>: items, push, remove, update, clear } = useArray([]);
  <span class="hljs-keyword">const</span> [cartTotal, setCartTotal] = useLocalStorage(<span class="hljs-string">"cartTotal"</span>, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [isOpen, { <span class="hljs-attr">toggle</span>: toggleCart, <span class="hljs-attr">setFalse</span>: closeCart }] =
    useToggle(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// Calculate total whenever items change</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> total = items.reduce(
      <span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.price * item.quantity,
      <span class="hljs-number">0</span>
    );
    setCartTotal(total);
  }, [items, setCartTotal]);

  <span class="hljs-comment">// Add item to cart</span>
  <span class="hljs-keyword">const</span> addItem = useCallback(
    <span class="hljs-function">(<span class="hljs-params">product</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> existingIndex = items.findIndex(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === product.id);

      <span class="hljs-keyword">if</span> (existingIndex &gt;= <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// Update quantity if item exists</span>
        <span class="hljs-keyword">const</span> existingItem = items[existingIndex];
        update(existingIndex, {
          ...existingItem,
          <span class="hljs-attr">quantity</span>: existingItem.quantity + <span class="hljs-number">1</span>,
        });
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// Add new item</span>
        push({ ...product, <span class="hljs-attr">quantity</span>: <span class="hljs-number">1</span> });
      }
    },
    [items, push, update]
  );

  <span class="hljs-comment">// Remove item from cart</span>
  <span class="hljs-keyword">const</span> removeItem = useCallback(
    <span class="hljs-function">(<span class="hljs-params">productId</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> index = items.findIndex(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === productId);
      <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {
        remove(index);
      }
    },
    [items, remove]
  );

  <span class="hljs-comment">// Update item quantity</span>
  <span class="hljs-keyword">const</span> updateQuantity = useCallback(
    <span class="hljs-function">(<span class="hljs-params">productId, newQuantity</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (newQuantity &lt;= <span class="hljs-number">0</span>) {
        removeItem(productId);
        <span class="hljs-keyword">return</span>;
      }

      <span class="hljs-keyword">const</span> index = items.findIndex(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.id === productId);
      <span class="hljs-keyword">if</span> (index &gt;= <span class="hljs-number">0</span>) {
        update(index, { ...items[index], <span class="hljs-attr">quantity</span>: newQuantity });
      }
    },
    [items, update, removeItem]
  );

  <span class="hljs-keyword">return</span> {
    items,
    <span class="hljs-attr">total</span>: cartTotal,
    <span class="hljs-attr">itemCount</span>: items.length,
    isOpen,
    addItem,
    removeItem,
    updateQuantity,
    <span class="hljs-attr">clearCart</span>: clear,
    toggleCart,
    closeCart,
  };
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> cart = useShoppingCart();

  <span class="hljs-keyword">const</span> sampleProduct = {
    <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">"React Handbook"</span>,
    <span class="hljs-attr">price</span>: <span class="hljs-number">29.99</span>,
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> cart.addItem(sampleProduct)}&gt;Add to Cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{cart.toggleCart}</span>&gt;</span>
        Cart ({cart.itemCount}) - ${cart.total.toFixed(2)}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {cart.isOpen &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"cart-dropdown"</span>&gt;</span>
          {cart.items.map((item) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
                <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
                <span class="hljs-attr">value</span>=<span class="hljs-string">{item.quantity}</span>
                <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
                  cart.updateQuantity(item.id, parseInt(e.target.value))
                }
              /&gt;
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> cart.removeItem(item.id)}&gt;Remove<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{cart.clearCart}</span>&gt;</span>Clear Cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-mini-challenge-build-a-form-hook">🎯 Mini-Challenge: Build a Form Hook</h2>
<h3 id="challenge-1-useform-hook">Challenge 1: useForm Hook</h3>
<p>Create a custom hook that manages form state, validation, and submission:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Your task: Implement this hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useForm</span>(<span class="hljs-params">initialValues, validationRules</span>) </span>{
  <span class="hljs-comment">// Should return:</span>
  <span class="hljs-comment">// - values: current form values</span>
  <span class="hljs-comment">// - errors: validation errors</span>
  <span class="hljs-comment">// - touched: which fields have been touched</span>
  <span class="hljs-comment">// - isValid: whether form is valid</span>
  <span class="hljs-comment">// - isSubmitting: submission state</span>
  <span class="hljs-comment">// - handleChange: function to update field values</span>
  <span class="hljs-comment">// - handleBlur: function to mark fields as touched</span>
  <span class="hljs-comment">// - handleSubmit: function to handle form submission</span>
  <span class="hljs-comment">// - reset: function to reset form</span>
}

<span class="hljs-comment">// Usage should work like this:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ContactForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> {
    values,
    errors,
    touched,
    isValid,
    isSubmitting,
    handleChange,
    handleBlur,
    handleSubmit,
    reset,
  } = useForm(
    { <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">""</span> },
    {
      <span class="hljs-attr">name</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span>
        value.length &lt; <span class="hljs-number">2</span> ? <span class="hljs-string">"Name must be at least 2 characters"</span> : <span class="hljs-string">""</span>,
      <span class="hljs-attr">email</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> (!<span class="hljs-regexp">/\S+@\S+\.\S+/</span>.test(value) ? <span class="hljs-string">"Invalid email"</span> : <span class="hljs-string">""</span>),
      <span class="hljs-attr">message</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span>
        value.length &lt; <span class="hljs-number">10</span> ? <span class="hljs-string">"Message must be at least 10 characters"</span> : <span class="hljs-string">""</span>,
    }
  );

  <span class="hljs-keyword">const</span> onSubmit = <span class="hljs-keyword">async</span> (formData) =&gt; {
    <span class="hljs-comment">// Simulate API call</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, <span class="hljs-number">1000</span>));
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted:"</span>, formData);
    reset();
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit(onSubmit)}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{values.name}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Name"</span>
      /&gt;</span>
      {touched.name &amp;&amp; errors.name &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{errors.name}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{values.email}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Email"</span>
      /&gt;</span>
      {touched.email &amp;&amp; errors.email &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{errors.email}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
        <span class="hljs-attr">name</span>=<span class="hljs-string">"message"</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{values.message}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
        <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Message"</span>
      /&gt;</span>
      {touched.message &amp;&amp; errors.message &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{errors.message}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{!isValid</span> || <span class="hljs-attr">isSubmitting</span>}&gt;</span>
        {isSubmitting ? "Submitting..." : "Submit"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{reset}</span>&gt;</span>
        Reset
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="solution">Solution:</h3>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useForm</span>(<span class="hljs-params">initialValues, validationRules = {}</span>) </span>{
  <span class="hljs-keyword">const</span> [values, setValues] = useState(initialValues);
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
  <span class="hljs-keyword">const</span> [touched, setTouched] = useState({});
  <span class="hljs-keyword">const</span> [isSubmitting, setIsSubmitting] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// Validate a single field</span>
  <span class="hljs-keyword">const</span> validateField = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name, value</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> rule = validationRules[name];
      <span class="hljs-keyword">return</span> rule ? rule(value) : <span class="hljs-string">""</span>;
    },
    [validationRules]
  );

  <span class="hljs-comment">// Validate all fields</span>
  <span class="hljs-keyword">const</span> validateForm = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newErrors = {};

    <span class="hljs-built_in">Object</span>.keys(values).forEach(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> error = validateField(name, values[name]);
      <span class="hljs-keyword">if</span> (error) {
        newErrors[name] = error;
      }
    });

    setErrors(newErrors);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(newErrors).length === <span class="hljs-number">0</span>;
  }, [values, validateField]);

  <span class="hljs-comment">// Check if form is valid</span>
  <span class="hljs-keyword">const</span> isValid = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(values).every(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> error = validateField(name, values[name]);
      <span class="hljs-keyword">return</span> !error;
    });
  }, [values, validateField]);

  <span class="hljs-comment">// Handle input change</span>
  <span class="hljs-keyword">const</span> handleChange = useCallback(
    <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> { name, value } = event.target;

      setValues(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: value }));

      <span class="hljs-comment">// Validate field if it's been touched</span>
      <span class="hljs-keyword">if</span> (touched[name]) {
        <span class="hljs-keyword">const</span> error = validateField(name, value);
        setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: error }));
      }
    },
    [touched, validateField]
  );

  <span class="hljs-comment">// Handle input blur</span>
  <span class="hljs-keyword">const</span> handleBlur = useCallback(
    <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> { name } = event.target;

      setTouched(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: <span class="hljs-literal">true</span> }));

      <span class="hljs-comment">// Validate field on blur</span>
      <span class="hljs-keyword">const</span> error = validateField(name, values[name]);
      setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: error }));
    },
    [values, validateField]
  );

  <span class="hljs-comment">// Handle form submission</span>
  <span class="hljs-keyword">const</span> handleSubmit = useCallback(
    <span class="hljs-function">(<span class="hljs-params">onSubmit</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-keyword">async</span> (event) =&gt; {
        event.preventDefault();

        <span class="hljs-comment">// Mark all fields as touched</span>
        <span class="hljs-keyword">const</span> allTouched = <span class="hljs-built_in">Object</span>.keys(values).reduce(<span class="hljs-function">(<span class="hljs-params">acc, key</span>) =&gt;</span> {
          acc[key] = <span class="hljs-literal">true</span>;
          <span class="hljs-keyword">return</span> acc;
        }, {});
        setTouched(allTouched);

        <span class="hljs-comment">// Validate form</span>
        <span class="hljs-keyword">if</span> (!validateForm()) {
          <span class="hljs-keyword">return</span>;
        }

        setIsSubmitting(<span class="hljs-literal">true</span>);

        <span class="hljs-keyword">try</span> {
          <span class="hljs-keyword">await</span> onSubmit(values);
        } <span class="hljs-keyword">catch</span> (error) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Form submission error:"</span>, error);
        } <span class="hljs-keyword">finally</span> {
          setIsSubmitting(<span class="hljs-literal">false</span>);
        }
      };
    },
    [values, validateForm]
  );

  <span class="hljs-comment">// Reset form</span>
  <span class="hljs-keyword">const</span> reset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setValues(initialValues);
    setErrors({});
    setTouched({});
    setIsSubmitting(<span class="hljs-literal">false</span>);
  }, [initialValues]);

  <span class="hljs-keyword">return</span> {
    values,
    errors,
    touched,
    isValid,
    isSubmitting,
    handleChange,
    handleBlur,
    handleSubmit,
    reset,
  };
}
</div></code></pre>
<h2 id="%E2%9D%8C-common-mistakes">❌ Common Mistakes</h2>
<h3 id="1-breaking-rules-of-hooks">1. Breaking Rules of Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Calling hooks conditionally</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadHook</span>(<span class="hljs-params">shouldUseState</span>) </span>{
  <span class="hljs-keyword">if</span> (shouldUseState) {
    <span class="hljs-keyword">const</span> [state, setState] = useState(<span class="hljs-number">0</span>); <span class="hljs-comment">// This breaks rules!</span>
  }
  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
}

<span class="hljs-comment">// ✅ Always call hooks at top level</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodHook</span>(<span class="hljs-params">shouldUseState</span>) </span>{
  <span class="hljs-keyword">const</span> [state, setState] = useState(shouldUseState ? <span class="hljs-number">0</span> : <span class="hljs-literal">null</span>);

  <span class="hljs-keyword">if</span> (!shouldUseState) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">state</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">setState</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {} };
  }

  <span class="hljs-keyword">return</span> { state, setState };
}
</div></code></pre>
<h3 id="2-not-memoizing-callbacks">2. Not Memoizing Callbacks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Creating new functions on every render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCounter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// These functions are recreated on every render!</span>
  <span class="hljs-keyword">const</span> increment = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  <span class="hljs-keyword">const</span> decrement = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev - <span class="hljs-number">1</span>);

  <span class="hljs-keyword">return</span> { count, increment, decrement };
}

<span class="hljs-comment">// ✅ Memoize callbacks</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCounter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> increment = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">const</span> decrement = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev - <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">return</span> { count, increment, decrement };
}
</div></code></pre>
<h3 id="3-missing-dependencies">3. Missing Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Missing dependencies in useEffect</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useFetch</span>(<span class="hljs-params">url</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetch(url)
      .then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.json())
      .then(setData);
  }, []); <span class="hljs-comment">// Missing 'url' dependency!</span>

  <span class="hljs-keyword">return</span> data;
}

<span class="hljs-comment">// ✅ Include all dependencies</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useFetch</span>(<span class="hljs-params">url</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> isCancelled = <span class="hljs-literal">false</span>;

    fetch(url)
      .then(<span class="hljs-function">(<span class="hljs-params">res</span>) =&gt;</span> res.json())
      .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (!isCancelled) {
          setData(data);
        }
      });

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      isCancelled = <span class="hljs-literal">true</span>;
    };
  }, [url]); <span class="hljs-comment">// Include 'url' dependency</span>

  <span class="hljs-keyword">return</span> data;
}
</div></code></pre>
<h3 id="4-not-handling-cleanup">4. Not Handling Cleanup</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Memory leak - no cleanup</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useInterval</span>(<span class="hljs-params">callback, delay</span>) </span>{
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> id = setInterval(callback, delay);
    <span class="hljs-comment">// Missing cleanup!</span>
  }, [callback, delay]);
}

<span class="hljs-comment">// ✅ Proper cleanup</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useInterval</span>(<span class="hljs-params">callback, delay</span>) </span>{
  <span class="hljs-keyword">const</span> savedCallback = useRef();

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    savedCallback.current = callback;
  }, [callback]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">tick</span>(<span class="hljs-params"></span>) </span>{
      savedCallback.current();
    }

    <span class="hljs-keyword">if</span> (delay !== <span class="hljs-literal">null</span>) {
      <span class="hljs-keyword">const</span> id = setInterval(tick, delay);
      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearInterval(id); <span class="hljs-comment">// Cleanup!</span>
    }
  }, [delay]);
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-testing-custom-hooks">🧪 Testing Custom Hooks</h2>
<h3 id="using-react-testing-library">Using React Testing Library</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { renderHook, act } <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/react"</span>;
<span class="hljs-keyword">import</span> { useCounter } <span class="hljs-keyword">from</span> <span class="hljs-string">"./useCounter"</span>;

describe(<span class="hljs-string">"useCounter"</span>, () =&gt; {
  it(<span class="hljs-string">"should initialize with default value"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter());

    expect(result.current.count).toBe(<span class="hljs-number">0</span>);
  });

  it(<span class="hljs-string">"should initialize with custom value"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter(<span class="hljs-number">10</span>));

    expect(result.current.count).toBe(<span class="hljs-number">10</span>);
  });

  it(<span class="hljs-string">"should increment count"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter());

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.increment();
    });

    expect(result.current.count).toBe(<span class="hljs-number">1</span>);
  });

  it(<span class="hljs-string">"should decrement count"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter(<span class="hljs-number">5</span>));

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.decrement();
    });

    expect(result.current.count).toBe(<span class="hljs-number">4</span>);
  });

  it(<span class="hljs-string">"should reset to initial value"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter(<span class="hljs-number">10</span>));

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.increment();
      result.current.increment();
    });

    expect(result.current.count).toBe(<span class="hljs-number">12</span>);

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.reset();
    });

    expect(result.current.count).toBe(<span class="hljs-number">10</span>);
  });
});
</div></code></pre>
<h3 id="testing-hooks-with-dependencies">Testing Hooks with Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { renderHook } <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/react"</span>;
<span class="hljs-keyword">import</span> { useFetch } <span class="hljs-keyword">from</span> <span class="hljs-string">"./useFetch"</span>;

<span class="hljs-comment">// Mock fetch</span>
global.fetch = jest.fn();

describe(<span class="hljs-string">"useFetch"</span>, () =&gt; {
  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetch.mockClear();
  });

  it(<span class="hljs-string">"should fetch data successfully"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> mockData = { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Test"</span> };
    fetch.mockResolvedValueOnce({
      <span class="hljs-attr">ok</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">json</span>: <span class="hljs-keyword">async</span> () =&gt; mockData,
    });

    <span class="hljs-keyword">const</span> { result, waitForNextUpdate } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
      useFetch(<span class="hljs-string">"/api/test"</span>)
    );

    expect(result.current.loading).toBe(<span class="hljs-literal">true</span>);
    expect(result.current.data).toBe(<span class="hljs-literal">null</span>);

    <span class="hljs-keyword">await</span> waitForNextUpdate();

    expect(result.current.loading).toBe(<span class="hljs-literal">false</span>);
    expect(result.current.data).toEqual(mockData);
    expect(result.current.error).toBe(<span class="hljs-literal">null</span>);
  });

  it(<span class="hljs-string">"should handle fetch errors"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    fetch.mockRejectedValueOnce(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Network error"</span>));

    <span class="hljs-keyword">const</span> { result, waitForNextUpdate } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
      useFetch(<span class="hljs-string">"/api/test"</span>)
    );

    <span class="hljs-keyword">await</span> waitForNextUpdate();

    expect(result.current.loading).toBe(<span class="hljs-literal">false</span>);
    expect(result.current.data).toBe(<span class="hljs-literal">null</span>);
    expect(result.current.error).toBe(<span class="hljs-string">"Network error"</span>);
  });
});
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when-and-why-to-use-custom-hooks">🎯 When and Why to Use Custom Hooks</h2>
<h3 id="%E2%9C%85-use-custom-hooks-when">✅ Use Custom Hooks When:</h3>
<ol>
<li><strong>Reusing Stateful Logic</strong>: Same logic needed in multiple components</li>
<li><strong>Complex State Management</strong>: Multiple related state values</li>
<li><strong>Side Effect Patterns</strong>: Common useEffect patterns</li>
<li><strong>API Integration</strong>: Consistent data fetching patterns</li>
<li><strong>Event Handling</strong>: Reusable event listener logic</li>
<li><strong>Form Management</strong>: Common form state and validation</li>
<li><strong>Local Storage</strong>: Persistent state management</li>
</ol>
<h3 id="%E2%9D%8C-avoid-custom-hooks-when">❌ Avoid Custom Hooks When:</h3>
<ol>
<li><strong>Simple State</strong>: Single useState is sufficient</li>
<li><strong>Component-Specific Logic</strong>: Logic only used in one place</li>
<li><strong>No State or Effects</strong>: Pure utility functions don't need hooks</li>
<li><strong>Over-Abstraction</strong>: Making simple things complex</li>
</ol>
<h3 id="%F0%9F%A4%94-decision-framework">🤔 Decision Framework</h3>
<pre class="hljs"><code><div>Do you have stateful logic?
├─ No → Use regular functions
└─ Yes
   ├─ Is it used in multiple components?
   │  ├─ No → Keep in component (for now)
   │  └─ Yes → Custom hook is good
   └─ Is the logic complex?
      ├─ No → Consider if abstraction adds value
      └─ Yes → Custom hook helps organization
</div></code></pre>
<h2 id="%F0%9F%9A%80-performance-considerations">🚀 Performance Considerations</h2>
<h3 id="memoization-in-custom-hooks">Memoization in Custom Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Properly memoized custom hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useExpensiveCalculation</span>(<span class="hljs-params">data, options</span>) </span>{
  <span class="hljs-comment">// Memoize expensive calculation</span>
  <span class="hljs-keyword">const</span> result = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> performExpensiveCalculation(data, options);
  }, [data, options]);

  <span class="hljs-comment">// Memoize callbacks</span>
  <span class="hljs-keyword">const</span> recalculate = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Force recalculation</span>
  }, []);

  <span class="hljs-comment">// Memoize returned object to prevent unnecessary re-renders</span>
  <span class="hljs-keyword">return</span> useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      result,
      recalculate,
    }),
    [result, recalculate]
  );
}
</div></code></pre>
<h3 id="avoiding-unnecessary-re-renders">Avoiding Unnecessary Re-renders</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ This will cause re-renders even when values don't change</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useBadHook</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// New object on every render!</span>
  <span class="hljs-keyword">return</span> {
    count,
    <span class="hljs-attr">increment</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>),
  };
}

<span class="hljs-comment">// ✅ Stable references</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useGoodHook</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> increment = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-comment">// Memoize the returned object</span>
  <span class="hljs-keyword">return</span> useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      count,
      increment,
    }),
    [count, increment]
  );
}
</div></code></pre>
<hr>
<p><strong>Next up</strong>: We'll explore React.memo and optimization techniques to make your apps lightning fast! ⚡</p>
<h1 id="14-reactmemo--optimization-%F0%9F%9A%80">14. React.memo &amp; Optimization 🚀</h1>
<blockquote>
<p>&quot;Premature optimization is the root of all evil, but knowing when and how to optimize is the mark of a skilled developer.&quot; - Adapted from Donald Knuth</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>What React.memo is and how it works</li>
<li>When and why to use React.memo</li>
<li>How to optimize component re-renders</li>
<li>Performance measurement techniques</li>
<li>Common optimization patterns and anti-patterns</li>
<li>The relationship between memo, useMemo, and useCallback</li>
</ul>
<h2 id="%F0%9F%94%8D-what-is-reactmemo">🔍 What is React.memo?</h2>
<p>React.memo is a higher-order component that memoizes the result of a component. It only re-renders when its props change, similar to <code>PureComponent</code> for class components.</p>
<h3 id="basic-example">Basic Example</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Basic React.memo usage</span>
<span class="hljs-keyword">const</span> ExpensiveComponent = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveComponent</span>(<span class="hljs-params">{
  name,
  age,
}</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"ExpensiveComponent rendered"</span>);

  <span class="hljs-comment">// Simulate expensive calculation</span>
  <span class="hljs-keyword">const</span> expensiveValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> result = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1000000</span>; i++) {
      result += i;
    }
    <span class="hljs-keyword">return</span> result;
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>
        {name} (Age: {age})
      <span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Expensive calculation result: {expensiveValue}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Parent component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [user] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* This won't re-render when count changes */}
      <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveComponent</span> <span class="hljs-attr">name</span>=<span class="hljs-string">{user.name}</span> <span class="hljs-attr">age</span>=<span class="hljs-string">{user.age}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%A7-how-reactmemo-works">🔧 How React.memo Works</h2>
<h3 id="shallow-comparison">Shallow Comparison</h3>
<p>React.memo performs a shallow comparison of props by default:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ These will NOT trigger re-render (shallow equal)</span>
<span class="hljs-keyword">const</span> props1 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-keyword">const</span> props2 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> };
<span class="hljs-comment">// React.memo will prevent re-render</span>

<span class="hljs-comment">// ❌ These WILL trigger re-render (not shallow equal)</span>
<span class="hljs-keyword">const</span> props3 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">user</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> } };
<span class="hljs-keyword">const</span> props4 = { <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">user</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span> } };
<span class="hljs-comment">// Different object references, so re-render happens</span>
</div></code></pre>
<h3 id="custom-comparison-function">Custom Comparison Function</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Custom comparison for complex props</span>
<span class="hljs-keyword">const</span> UserCard = React.memo(
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserCard</span>(<span class="hljs-params">{ user, settings }</span>) </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Theme: {settings.theme}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  },
  (prevProps, nextProps) =&gt; {
    <span class="hljs-comment">// Return true if props are equal (skip re-render)</span>
    <span class="hljs-comment">// Return false if props are different (re-render)</span>

    <span class="hljs-keyword">return</span> (
      prevProps.user.id === nextProps.user.id &amp;&amp;
      prevProps.user.name === nextProps.user.name &amp;&amp;
      prevProps.settings.theme === nextProps.settings.theme
    );
  }
);

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> [user] = useState({ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> });
  <span class="hljs-keyword">const</span> [settings] = useState({ <span class="hljs-attr">theme</span>: <span class="hljs-string">"dark"</span>, <span class="hljs-attr">notifications</span>: <span class="hljs-literal">true</span> });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;Count: {count}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      {/* Won't re-render when count changes, even though user/settings are objects */}
      <span class="hljs-tag">&lt;<span class="hljs-name">UserCard</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">settings</span>=<span class="hljs-string">{settings}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when-to-use-reactmemo">🎯 When to Use React.memo</h2>
<h3 id="%E2%9C%85-good-use-cases">✅ Good Use Cases</h3>
<ol>
<li><strong>Expensive Rendering</strong>: Components with heavy calculations or complex UI</li>
<li><strong>Stable Props</strong>: Props that don't change often</li>
<li><strong>Large Lists</strong>: List items that render frequently</li>
<li><strong>Pure Components</strong>: Components that only depend on props</li>
<li><strong>Leaf Components</strong>: Components at the end of the component tree</li>
</ol>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Good candidate for React.memo</span>
<span class="hljs-keyword">const</span> ProductCard = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProductCard</span>(<span class="hljs-params">{ product }</span>) </span>{
  <span class="hljs-comment">// Expensive image processing</span>
  <span class="hljs-keyword">const</span> processedImage = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> processImage(product.image);
  }, [product.image]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"product-card"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{processedImage}</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{product.name}</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{product.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>${product.price}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Usage in a list</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProductList</span>(<span class="hljs-params">{ products, searchTerm }</span>) </span>{
  <span class="hljs-keyword">const</span> [sortOrder, setSortOrder] = useState(<span class="hljs-string">"name"</span>);

  <span class="hljs-keyword">const</span> filteredProducts = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> products
      .filter(<span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> p.name.toLowerCase().includes(searchTerm.toLowerCase()))
      .sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> a[sortOrder].localeCompare(b[sortOrder]));
  }, [products, searchTerm, sortOrder]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{sortOrder}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSortOrder(e.target.value)}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"name"</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"price"</span>&gt;</span>Price<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

      {/* Each ProductCard will only re-render if its product prop changes */}
      {filteredProducts.map((product) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ProductCard</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{product.id}</span> <span class="hljs-attr">product</span>=<span class="hljs-string">{product}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="%E2%9D%8C-when-not-to-use-reactmemo">❌ When NOT to Use React.memo</h3>
<ol>
<li><strong>Props Change Frequently</strong>: If props change on every render</li>
<li><strong>Simple Components</strong>: Very lightweight components</li>
<li><strong>Always Re-rendering Parent</strong>: If parent always re-renders anyway</li>
<li><strong>Complex Comparison</strong>: When custom comparison is more expensive than re-rendering</li>
</ol>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Bad candidate for React.memo</span>
<span class="hljs-keyword">const</span> SimpleButton = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SimpleButton</span>(<span class="hljs-params">{ onClick, children }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
});
<span class="hljs-comment">// This is too simple to benefit from memoization</span>

<span class="hljs-comment">// ❌ Props change every render</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {/* onClick is a new function every render, so memo won't help */}
      <span class="hljs-tag">&lt;<span class="hljs-name">SimpleButton</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setCount(count + 1)}&gt;
        Count: {count}
      <span class="hljs-tag">&lt;/<span class="hljs-name">SimpleButton</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-reactmemo--usecallback--usememo">🔄 React.memo + useCallback + useMemo</h2>
<h3 id="the-holy-trinity-of-optimization">The Holy Trinity of Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Properly optimized component hierarchy</span>
<span class="hljs-keyword">const</span> TodoItem = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoItem</span>(<span class="hljs-params">{ todo, onToggle, onDelete }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`TodoItem <span class="hljs-subst">${todo.id}</span> rendered`</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">todo-item</span> ${<span class="hljs-attr">todo.completed</span> ? "<span class="hljs-attr">completed</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
        <span class="hljs-attr">checked</span>=<span class="hljs-string">{todo.completed}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> onToggle(todo.id)}
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onDelete(todo.id)}&gt;Delete<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-keyword">const</span> TodoList = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoList</span>(<span class="hljs-params">{ todos, onToggle, onDelete }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"TodoList rendered"</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-list"</span>&gt;</span>
      {todos.map((todo) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">TodoItem</span>
          <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span>
          <span class="hljs-attr">todo</span>=<span class="hljs-string">{todo}</span>
          <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{onToggle}</span>
          <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{onDelete}</span>
        /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([
    { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Learn React"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Build an app"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span> },
  ]);
  <span class="hljs-keyword">const</span> [newTodo, setNewTodo] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// ✅ Memoized callbacks prevent unnecessary re-renders</span>
  <span class="hljs-keyword">const</span> handleToggle = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
        todo.id === id ? { ...todo, <span class="hljs-attr">completed</span>: !todo.completed } : todo
      )
    );
  }, []);

  <span class="hljs-keyword">const</span> handleDelete = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.id !== id));
  }, []);

  <span class="hljs-keyword">const</span> handleAdd = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (newTodo.trim()) {
      setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [
        ...prev,
        {
          <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
          <span class="hljs-attr">text</span>: newTodo,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
        },
      ]);
      setNewTodo(<span class="hljs-string">""</span>);
    }
  }, [newTodo]);

  <span class="hljs-comment">// ✅ Memoized filtered todos</span>
  <span class="hljs-keyword">const</span> incompleteTodos = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> !todo.completed);
  }, [todos]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{newTodo}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setNewTodo(e.target.value)}
          placeholder="Add new todo"
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleAdd}</span>&gt;</span>Add<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Incomplete Todos ({incompleteTodos.length})<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoList</span>
        <span class="hljs-attr">todos</span>=<span class="hljs-string">{incompleteTodos}</span>
        <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{handleToggle}</span>
        <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{handleDelete}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>All Todos<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">TodoList</span> <span class="hljs-attr">todos</span>=<span class="hljs-string">{todos}</span> <span class="hljs-attr">onToggle</span>=<span class="hljs-string">{handleToggle}</span> <span class="hljs-attr">onDelete</span>=<span class="hljs-string">{handleDelete}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%93%8A-performance-measurement">📊 Performance Measurement</h2>
<h3 id="using-react-devtools-profiler">Using React DevTools Profiler</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Component with performance monitoring</span>
<span class="hljs-keyword">const</span> PerformanceDemo = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PerformanceDemo</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-keyword">const</span> startTime = performance.now();

  <span class="hljs-comment">// Expensive calculation</span>
  <span class="hljs-keyword">const</span> processedData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Processing data..."</span>);
    <span class="hljs-keyword">return</span> data.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
      ...item,
      <span class="hljs-attr">processed</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-built_in">Date</span>.now(),
    }));
  }, [data]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> endTime = performance.now();
    <span class="hljs-built_in">console</span>.log(
      <span class="hljs-string">`PerformanceDemo render took <span class="hljs-subst">${endTime - startTime}</span> milliseconds`</span>
    );
  });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Processed Data ({processedData.length} items)<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {processedData.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});
</div></code></pre>
<h3 id="custom-performance-hook">Custom Performance Hook</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Hook to measure render performance</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useRenderTime</span>(<span class="hljs-params">componentName</span>) </span>{
  <span class="hljs-keyword">const</span> renderStartTime = useRef();

  <span class="hljs-comment">// Mark start of render</span>
  renderStartTime.current = performance.now();

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> renderEndTime = performance.now();
    <span class="hljs-keyword">const</span> renderTime = renderEndTime - renderStartTime.current;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${componentName}</span> render time: <span class="hljs-subst">${renderTime.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
  });
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-keyword">const</span> MyComponent = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyComponent</span>(<span class="hljs-params">{ data }</span>) </span>{
  useRenderTime(<span class="hljs-string">"MyComponent"</span>);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{/* Component content */}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
});
</div></code></pre>
<h2 id="%F0%9F%8E%AF-mini-challenge-optimize-a-data-dashboard">🎯 Mini-Challenge: Optimize a Data Dashboard</h2>
<h3 id="challenge-build-an-optimized-dashboard">Challenge: Build an Optimized Dashboard</h3>
<p>Create a dashboard that efficiently renders large amounts of data:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// Your task: Optimize this dashboard for performance</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataDashboard</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);
  <span class="hljs-keyword">const</span> [filter, setFilter] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [sortBy, setSortBy] = useState(<span class="hljs-string">"name"</span>);
  <span class="hljs-keyword">const</span> [refreshCount, setRefreshCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// Simulate data fetching</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-comment">// Simulate API call</span>
      <span class="hljs-keyword">const</span> newData = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, (_, i) =&gt; ({
        <span class="hljs-attr">id</span>: i,
        <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>,
        <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>][i % <span class="hljs-number">3</span>],
        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-built_in">Date</span>.now() - <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">86400000</span>),
      }));
      setData(newData);
    };

    fetchData();
  }, [refreshCount]);

  <span class="hljs-comment">// Filter and sort data</span>
  <span class="hljs-keyword">const</span> processedData = data
    .filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.name.toLowerCase().includes(filter.toLowerCase()))
    .sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (sortBy === <span class="hljs-string">"name"</span>) <span class="hljs-keyword">return</span> a.name.localeCompare(b.name);
      <span class="hljs-keyword">if</span> (sortBy === <span class="hljs-string">"value"</span>) <span class="hljs-keyword">return</span> b.value - a.value;
      <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Filter items..."</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{filter}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setFilter(e.target.value)}
        /&gt;

        <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{sortBy}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setSortBy(e.target.value)}&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"name"</span>&gt;</span>Sort by Name<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"value"</span>&gt;</span>Sort by Value<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setRefreshCount((c) =&gt; c + 1)}&gt;
          Refresh Data
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Total Items: {data.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Filtered Items: {processedData.length}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          Average Value:{" "}
          {(
            processedData.reduce((sum, item) =&gt; sum + item.value, 0) /
            processedData.length
          ).toFixed(2)}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-grid"</span>&gt;</span>
        {processedData.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-item"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Value: {item.value.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Category: {item.category}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>{item.timestamp.toLocaleDateString()}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="solution-optimized-dashboard">Solution: Optimized Dashboard</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Optimized data item component</span>
<span class="hljs-keyword">const</span> DataItem = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataItem</span>(<span class="hljs-params">{ item }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-item"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Value: {item.value.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Category: {item.category}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>{item.timestamp.toLocaleDateString()}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// ✅ Optimized stats component</span>
<span class="hljs-keyword">const</span> DataStats = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataStats</span>(<span class="hljs-params">{
  totalItems,
  filteredItems,
  averageValue,
}</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Total Items: {totalItems}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Filtered Items: {filteredItems}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Average Value: {averageValue}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// ✅ Optimized controls component</span>
<span class="hljs-keyword">const</span> DataControls = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataControls</span>(<span class="hljs-params">{
  filter,
  onFilterChange,
  sortBy,
  onSortChange,
  onRefresh,
}</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"controls"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
        <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Filter items..."</span>
        <span class="hljs-attr">value</span>=<span class="hljs-string">{filter}</span>
        <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onFilterChange}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">select</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{sortBy}</span> <span class="hljs-attr">onChange</span>=<span class="hljs-string">{onSortChange}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"name"</span>&gt;</span>Sort by Name<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"value"</span>&gt;</span>Sort by Value<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onRefresh}</span>&gt;</span>Refresh Data<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// ✅ Optimized main dashboard</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataDashboard</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);
  <span class="hljs-keyword">const</span> [filter, setFilter] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [sortBy, setSortBy] = useState(<span class="hljs-string">"name"</span>);
  <span class="hljs-keyword">const</span> [refreshCount, setRefreshCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// Simulate data fetching</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> newData = <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">1000</span> }, (_, i) =&gt; ({
        <span class="hljs-attr">id</span>: i,
        <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">100</span>,
        <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>][i % <span class="hljs-number">3</span>],
        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-built_in">Date</span>.now() - <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">86400000</span>),
      }));
      setData(newData);
    };

    fetchData();
  }, [refreshCount]);

  <span class="hljs-comment">// ✅ Memoized data processing</span>
  <span class="hljs-keyword">const</span> processedData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> data
      .filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.name.toLowerCase().includes(filter.toLowerCase()))
      .sort(<span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (sortBy === <span class="hljs-string">"name"</span>) <span class="hljs-keyword">return</span> a.name.localeCompare(b.name);
        <span class="hljs-keyword">if</span> (sortBy === <span class="hljs-string">"value"</span>) <span class="hljs-keyword">return</span> b.value - a.value;
        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
      });
  }, [data, filter, sortBy]);

  <span class="hljs-comment">// ✅ Memoized statistics</span>
  <span class="hljs-keyword">const</span> stats = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> averageValue =
      processedData.length &gt; <span class="hljs-number">0</span>
        ? (
            processedData.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.value, <span class="hljs-number">0</span>) /
            processedData.length
          ).toFixed(<span class="hljs-number">2</span>)
        : <span class="hljs-string">"0.00"</span>;

    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">totalItems</span>: data.length,
      <span class="hljs-attr">filteredItems</span>: processedData.length,
      averageValue,
    };
  }, [data.length, processedData]);

  <span class="hljs-comment">// ✅ Memoized event handlers</span>
  <span class="hljs-keyword">const</span> handleFilterChange = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    setFilter(e.target.value);
  }, []);

  <span class="hljs-keyword">const</span> handleSortChange = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    setSortBy(e.target.value);
  }, []);

  <span class="hljs-keyword">const</span> handleRefresh = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setRefreshCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">DataControls</span>
        <span class="hljs-attr">filter</span>=<span class="hljs-string">{filter}</span>
        <span class="hljs-attr">onFilterChange</span>=<span class="hljs-string">{handleFilterChange}</span>
        <span class="hljs-attr">sortBy</span>=<span class="hljs-string">{sortBy}</span>
        <span class="hljs-attr">onSortChange</span>=<span class="hljs-string">{handleSortChange}</span>
        <span class="hljs-attr">onRefresh</span>=<span class="hljs-string">{handleRefresh}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">DataStats</span>
        <span class="hljs-attr">totalItems</span>=<span class="hljs-string">{stats.totalItems}</span>
        <span class="hljs-attr">filteredItems</span>=<span class="hljs-string">{stats.filteredItems}</span>
        <span class="hljs-attr">averageValue</span>=<span class="hljs-string">{stats.averageValue}</span>
      /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-grid"</span>&gt;</span>
        {processedData.map((item) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">DataItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span> /&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%E2%9D%8C-common-optimization-mistakes">❌ Common Optimization Mistakes</h2>
<h3 id="1-over-memoization">1. Over-Memoization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Unnecessary memoization</span>
<span class="hljs-keyword">const</span> SimpleText = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SimpleText</span>(<span class="hljs-params">{ text }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span>; <span class="hljs-comment">// Too simple to benefit from memo</span>
});

<span class="hljs-comment">// ❌ Memoizing everything</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-comment">// These change every render anyway!</span>
  <span class="hljs-keyword">const</span> memoizedCount = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> count, [count]);
  <span class="hljs-keyword">const</span> memoizedIncrement = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> setCount(count + <span class="hljs-number">1</span>), [count]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>{memoizedCount}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{memoizedIncrement}</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-incorrect-dependencies">2. Incorrect Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Missing dependencies</span>
<span class="hljs-keyword">const</span> BadComponent = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadComponent</span>(<span class="hljs-params">{ items, multiplier }</span>) </span>{
  <span class="hljs-keyword">const</span> expensiveValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.value * multiplier, <span class="hljs-number">0</span>);
  }, [items]); <span class="hljs-comment">// Missing 'multiplier' dependency!</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{expensiveValue}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
});

<span class="hljs-comment">// ✅ Correct dependencies</span>
<span class="hljs-keyword">const</span> GoodComponent = React.memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodComponent</span>(<span class="hljs-params">{ items, multiplier }</span>) </span>{
  <span class="hljs-keyword">const</span> expensiveValue = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.value * multiplier, <span class="hljs-number">0</span>);
  }, [items, multiplier]); <span class="hljs-comment">// All dependencies included</span>

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{expensiveValue}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
});
</div></code></pre>
<h3 id="3-comparing-functions-in-memo">3. Comparing Functions in memo</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Functions will always be different</span>
<span class="hljs-keyword">const</span> BadComponent = React.memo(
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadComponent</span>(<span class="hljs-params">{ onClick }</span>) </span>{
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
  },
  (prevProps, nextProps) =&gt; {
    <span class="hljs-comment">// This will always return false because functions are recreated</span>
    <span class="hljs-keyword">return</span> prevProps.onClick === nextProps.onClick;
  }
);

<span class="hljs-comment">// ✅ Use useCallback in parent instead</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Parent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> handleClick = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">c</span>) =&gt;</span> c + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">BadComponent</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> /&gt;</span></span>;
}
</div></code></pre>
<h2 id="%F0%9F%8E%A4-interview-insights">🎤 Interview Insights</h2>
<h3 id="common-questions">Common Questions</h3>
<p><strong>Q: When should you use React.memo?</strong></p>
<p>A: Use React.memo when:</p>
<ul>
<li>Component renders frequently with the same props</li>
<li>Component has expensive rendering logic</li>
<li>Component is a leaf node in the component tree</li>
<li>Props are stable and don't change often</li>
</ul>
<p><strong>Q: What's the difference between React.memo, useMemo, and useCallback?</strong></p>
<p>A:</p>
<ul>
<li><strong>React.memo</strong>: Memoizes entire component based on props</li>
<li><strong>useMemo</strong>: Memoizes computed values within a component</li>
<li><strong>useCallback</strong>: Memoizes function references</li>
</ul>
<p><strong>Q: How do you measure if React.memo is helping performance?</strong></p>
<p>A: Use:</p>
<ul>
<li>React DevTools Profiler</li>
<li>Console.log in components to track renders</li>
<li>Performance.now() to measure render times</li>
<li>React's built-in performance monitoring</li>
</ul>
<p><strong>Q: Can React.memo cause memory leaks?</strong></p>
<p>A: React.memo itself doesn't cause memory leaks, but:</p>
<ul>
<li>Memoized components hold references to props</li>
<li>Custom comparison functions might hold references</li>
<li>Always clean up subscriptions and timers</li>
</ul>
<h3 id="code-review-red-flags">Code Review Red Flags</h3>
<p>❌ <strong>Memoizing every component without measurement</strong>
❌ <strong>Complex custom comparison functions</strong>
❌ <strong>Missing dependencies in useMemo/useCallback</strong>
❌ <strong>Memoizing props that change every render</strong>
❌ <strong>Not using React DevTools to verify optimizations</strong>
❌ <strong>Optimizing before identifying performance bottlenecks</strong></p>
<h2 id="%F0%9F%8E%AF-key-takeaways">🎯 Key Takeaways</h2>
<ol>
<li><strong>Measure first, optimize second</strong> - Use React DevTools Profiler</li>
<li><strong>React.memo prevents re-renders</strong> - Only when props haven't changed</li>
<li><strong>Shallow comparison by default</strong> - Deep objects need custom comparison</li>
<li><strong>Combine with useCallback/useMemo</strong> - For stable prop references</li>
<li><strong>Don't over-optimize</strong> - Simple components don't need memoization</li>
<li><strong>Profile your optimizations</strong> - Verify they actually help</li>
<li><strong>Consider the whole tree</strong> - Optimize parent components first</li>
</ol>
<h2 id="%F0%9F%8F%86-best-practices">🏆 Best Practices</h2>
<ol>
<li><strong>Start with React DevTools</strong> - Identify actual performance bottlenecks</li>
<li><strong>Optimize from top down</strong> - Parent optimizations often help more</li>
<li><strong>Use memo for expensive components</strong> - Complex calculations or large lists</li>
<li><strong>Memoize stable callbacks</strong> - Use useCallback for event handlers</li>
<li><strong>Avoid premature optimization</strong> - Don't memo everything by default</li>
<li><strong>Test your optimizations</strong> - Measure before and after</li>
<li><strong>Consider code splitting</strong> - Sometimes better than memoization</li>
</ol>
<h2 id="%F0%9F%94%A7-production-tips">🔧 Production Tips</h2>
<ul>
<li><strong>Use React.memo for list items</strong> - Especially in large lists</li>
<li><strong>Memoize context values</strong> - Prevent unnecessary provider re-renders</li>
<li><strong>Consider virtualization</strong> - For very large lists (react-window)</li>
<li><strong>Profile in production mode</strong> - Development mode has extra overhead</li>
<li><strong>Monitor bundle size</strong> - Memoization adds code</li>
<li><strong>Use React Concurrent features</strong> - Suspense and transitions</li>
<li><strong>Implement error boundaries</strong> - Around memoized components</li>
</ul>
<hr>
<p><strong>Next up</strong>: We'll explore advanced patterns like render props, compound components, and more! 🎨</p>
<h1 id="15-advanced-patterns-%F0%9F%8E%A8">15. Advanced Patterns 🎨</h1>
<blockquote>
<p>&quot;Good architecture is not about the framework you choose, but about the patterns you apply.&quot; - Clean Architecture Principles</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>Render Props pattern and its use cases</li>
<li>Compound Components pattern</li>
<li>Higher-Order Components (HOCs)</li>
<li>Provider pattern with Context</li>
<li>State Reducer pattern</li>
<li>Controlled vs Uncontrolled component patterns</li>
<li>When and why to use each pattern</li>
</ul>
<h2 id="%F0%9F%8E%AD-render-props-pattern">🎭 Render Props Pattern</h2>
<p>Render Props is a technique for sharing code between components using a prop whose value is a function.</p>
<h3 id="basic-render-props">Basic Render Props</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Mouse tracker with render props</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MouseTracker</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  state = { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> };

  handleMouseMove = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
    <span class="hljs-keyword">this</span>.setState({
      <span class="hljs-attr">x</span>: event.clientX,
      <span class="hljs-attr">y</span>: event.clientY,
    });
  };

  render() {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> "<span class="hljs-attr">100vh</span>" }} <span class="hljs-attr">onMouseMove</span>=<span class="hljs-string">{this.handleMouseMove}</span>&gt;</span>
        {/* Call the render prop function with current state */}
        {this.props.render(this.state)}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Mouse Tracker Demo<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">MouseTracker</span>
        <span class="hljs-attr">render</span>=<span class="hljs-string">{({</span> <span class="hljs-attr">x</span>, <span class="hljs-attr">y</span> }) =&gt;</span> (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>
              Mouse position: ({x}, {y})
            <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
              <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
                <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
                <span class="hljs-attr">left:</span> <span class="hljs-attr">x</span> <span class="hljs-attr">-</span> <span class="hljs-attr">10</span>,
                <span class="hljs-attr">top:</span> <span class="hljs-attr">y</span> <span class="hljs-attr">-</span> <span class="hljs-attr">10</span>,
                <span class="hljs-attr">width:</span> <span class="hljs-attr">20</span>,
                <span class="hljs-attr">height:</span> <span class="hljs-attr">20</span>,
                <span class="hljs-attr">backgroundColor:</span> "<span class="hljs-attr">red</span>",
                <span class="hljs-attr">borderRadius:</span> "<span class="hljs-attr">50</span>%",
                <span class="hljs-attr">pointerEvents:</span> "<span class="hljs-attr">none</span>",
              }}
            /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
      /&gt;
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="modern-render-props-with-hooks">Modern Render Props with Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Hook-based render props</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useMouse</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [position, setPosition] = useState({ <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> });

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleMouseMove = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      setPosition({ <span class="hljs-attr">x</span>: event.clientX, <span class="hljs-attr">y</span>: event.clientY });
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"mousemove"</span>, handleMouseMove);
  }, []);

  <span class="hljs-keyword">return</span> position;
}

<span class="hljs-comment">// Render props component using the hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MouseProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> mousePosition = useMouse();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {typeof children === "function" ? children(mousePosition) : children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">MouseProvider</span>&gt;</span>
      {({ x, y }) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>
            Mouse at: ({x}, {y})
          <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">MouseCursor</span> <span class="hljs-attr">x</span>=<span class="hljs-string">{x}</span> <span class="hljs-attr">y</span>=<span class="hljs-string">{y}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">MouseProvider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MouseCursor</span>(<span class="hljs-params">{ x, y }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">position:</span> "<span class="hljs-attr">fixed</span>",
        <span class="hljs-attr">left:</span> <span class="hljs-attr">x</span> <span class="hljs-attr">-</span> <span class="hljs-attr">10</span>,
        <span class="hljs-attr">top:</span> <span class="hljs-attr">y</span> <span class="hljs-attr">-</span> <span class="hljs-attr">10</span>,
        <span class="hljs-attr">width:</span> <span class="hljs-attr">20</span>,
        <span class="hljs-attr">height:</span> <span class="hljs-attr">20</span>,
        <span class="hljs-attr">backgroundColor:</span> "<span class="hljs-attr">blue</span>",
        <span class="hljs-attr">borderRadius:</span> "<span class="hljs-attr">50</span>%",
        <span class="hljs-attr">pointerEvents:</span> "<span class="hljs-attr">none</span>",
        <span class="hljs-attr">zIndex:</span> <span class="hljs-attr">9999</span>,
      }}
    /&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="data-fetching-with-render-props">Data Fetching with Render Props</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Generic data fetcher</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataFetcher</span>(<span class="hljs-params">{ url, children }</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> isCancelled = <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        setLoading(<span class="hljs-literal">true</span>);
        setError(<span class="hljs-literal">null</span>);

        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url);
        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP error! status: <span class="hljs-subst">${response.status}</span>`</span>);
        }

        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();

        <span class="hljs-keyword">if</span> (!isCancelled) {
          setData(result);
        }
      } <span class="hljs-keyword">catch</span> (err) {
        <span class="hljs-keyword">if</span> (!isCancelled) {
          setError(err.message);
        }
      } <span class="hljs-keyword">finally</span> {
        <span class="hljs-keyword">if</span> (!isCancelled) {
          setLoading(<span class="hljs-literal">false</span>);
        }
      }
    };

    fetchData();

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      isCancelled = <span class="hljs-literal">true</span>;
    };
  }, [url]);

  <span class="hljs-keyword">return</span> children({ data, loading, error });
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ userId }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DataFetcher</span> <span class="hljs-attr">url</span>=<span class="hljs-string">{</span>`/<span class="hljs-attr">api</span>/<span class="hljs-attr">users</span>/${<span class="hljs-attr">userId</span>}`}&gt;</span>
      {({ data: user, loading, error }) =&gt; {
        if (loading) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading user...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
        if (error) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
        if (!user) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>User not found<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;

        return (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Email: {user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Role: {user.role}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        );
      }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">DataFetcher</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PostsList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">DataFetcher</span> <span class="hljs-attr">url</span>=<span class="hljs-string">"/api/posts"</span>&gt;</span>
      {({ data: posts, loading, error }) =&gt; {
        if (loading) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading posts...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;
        if (error) return <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>;

        return (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Posts<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            {posts?.map((post) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{post.id}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{post.title}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{post.excerpt}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        );
      }}
    <span class="hljs-tag">&lt;/<span class="hljs-name">DataFetcher</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%A9-compound-components-pattern">🧩 Compound Components Pattern</h2>
<p>Compound components work together to form a complete UI. Think of HTML elements like <code>&lt;select&gt;</code> and <code>&lt;option&gt;</code>.</p>
<h3 id="basic-compound-components">Basic Compound Components</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Accordion compound component</span>
<span class="hljs-keyword">const</span> AccordionContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Accordion</span>(<span class="hljs-params">{ children, allowMultiple = false }</span>) </span>{
  <span class="hljs-keyword">const</span> [openItems, setOpenItems] = useState(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());

  <span class="hljs-keyword">const</span> toggleItem = useCallback(
    <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
      setOpenItems(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> newSet = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>(prev);

        <span class="hljs-keyword">if</span> (newSet.has(id)) {
          newSet.delete(id);
        } <span class="hljs-keyword">else</span> {
          <span class="hljs-keyword">if</span> (!allowMultiple) {
            newSet.clear();
          }
          newSet.add(id);
        }

        <span class="hljs-keyword">return</span> newSet;
      });
    },
    [allowMultiple]
  );

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      openItems,
      toggleItem,
    }),
    [openItems, toggleItem]
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AccordionContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"accordion"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">AccordionContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AccordionItem</span>(<span class="hljs-params">{ id, children }</span>) </span>{
  <span class="hljs-keyword">const</span> { openItems, toggleItem } = useContext(AccordionContext);
  <span class="hljs-keyword">const</span> isOpen = openItems.has(id);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">accordion-item</span> ${<span class="hljs-attr">isOpen</span> ? "<span class="hljs-attr">open</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
      {React.Children.map(children, (child) =&gt; {
        if (React.isValidElement(child)) {
          return React.cloneElement(child, { id, isOpen });
        }
        return child;
      })}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AccordionHeader</span>(<span class="hljs-params">{ id, isOpen, children }</span>) </span>{
  <span class="hljs-keyword">const</span> { toggleItem } = useContext(AccordionContext);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">"accordion-header"</span>
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleItem(id)}
      aria-expanded={isOpen}
    &gt;
      {children}
      <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">accordion-icon</span> ${<span class="hljs-attr">isOpen</span> ? "<span class="hljs-attr">rotated</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>▼<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AccordionContent</span>(<span class="hljs-params">{ isOpen, children }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">accordion-content</span> ${<span class="hljs-attr">isOpen</span> ? "<span class="hljs-attr">open</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"accordion-content-inner"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Attach sub-components to main component</span>
Accordion.Item = AccordionItem;
Accordion.Header = AccordionHeader;
Accordion.Content = AccordionContent;

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>FAQ<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Accordion</span> <span class="hljs-attr">allowMultiple</span>=<span class="hljs-string">{false}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Item</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"item1"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Header</span>&gt;</span>What is React?<span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Header</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Content</span>&gt;</span>
            React is a JavaScript library for building user interfaces. It was
            created by Facebook and is now maintained by Meta.
          <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Content</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Item</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Item</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"item2"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Header</span>&gt;</span>What are React Hooks?<span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Header</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Content</span>&gt;</span>
            Hooks are functions that let you use state and other React features
            in functional components. They were introduced in React 16.8.
          <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Content</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Item</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Item</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"item3"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Header</span>&gt;</span>What is JSX?<span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Header</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Accordion.Content</span>&gt;</span>
            JSX is a syntax extension for JavaScript that looks similar to XML
            or HTML. It allows you to write HTML-like code in your JavaScript
            files.
          <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Content</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion.Item</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Accordion</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-compound-components-with-flexible-api">Advanced Compound Components with Flexible API</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Flexible Modal compound component</span>
<span class="hljs-keyword">const</span> ModalContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Modal</span>(<span class="hljs-params">{ children, isOpen, onClose }</span>) </span>{
  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      isOpen,
      onClose,
    }),
    [isOpen, onClose]
  );

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleEscape = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (e.key === <span class="hljs-string">"Escape"</span> &amp;&amp; isOpen) {
        onClose();
      }
    };

    <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">"keydown"</span>, handleEscape);
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">"keydown"</span>, handleEscape);
  }, [isOpen, onClose]);

  <span class="hljs-keyword">if</span> (!isOpen) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ModalContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-overlay"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClose}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-content"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{(e)</span> =&gt;</span> e.stopPropagation()}&gt;
          {children}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ModalContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ModalHeader</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> { onClose } = useContext(ModalContext);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-header"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-close"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClose}</span>&gt;</span>
        ×
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ModalBody</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-body"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ModalFooter</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"modal-footer"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-comment">// Attach sub-components</span>
Modal.Header = ModalHeader;
Modal.Body = ModalBody;
Modal.Footer = ModalFooter;

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [isModalOpen, setIsModalOpen] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsModalOpen(true)}&gt;Open Modal<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Modal</span> <span class="hljs-attr">isOpen</span>=<span class="hljs-string">{isModalOpen}</span> <span class="hljs-attr">onClose</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsModalOpen(false)}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">Modal.Header</span>&gt;</span>Confirm Action<span class="hljs-tag">&lt;/<span class="hljs-name">Modal.Header</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Modal.Body</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Are you sure you want to delete this item?<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This action cannot be undone.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Modal.Body</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Modal.Footer</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsModalOpen(false)}&gt;Cancel<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">"danger"</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> {
              // Perform delete action
              console.log("Item deleted");
              setIsModalOpen(false);
            }}
          &gt;
            Delete
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Modal.Footer</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-higher-order-components-hocs">🎯 Higher-Order Components (HOCs)</h2>
<p>HOCs are functions that take a component and return a new component with additional functionality.</p>
<h3 id="basic-hoc-example">Basic HOC Example</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ withLoading HOC</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withLoading</span>(<span class="hljs-params">WrappedComponent</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WithLoadingComponent</span>(<span class="hljs-params">props</span>) </span>{
    <span class="hljs-keyword">if</span> (props.isLoading) {
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"loading-spinner"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"spinner"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      );
    }

    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...props</span>} /&gt;</span></span>;
  };
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserProfile</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>{user.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Email: {user.email}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> UserProfileWithLoading = withLoading(UserProfile);

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [isLoading, setIsLoading] = useState(<span class="hljs-literal">true</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Simulate API call</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setUser({ <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> });
      setIsLoading(<span class="hljs-literal">false</span>);
    }, <span class="hljs-number">2000</span>);
  }, []);

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserProfileWithLoading</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> <span class="hljs-attr">isLoading</span>=<span class="hljs-string">{isLoading}</span> /&gt;</span></span>;
}
</div></code></pre>
<h3 id="advanced-hoc-with-configuration">Advanced HOC with Configuration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ withAuth HOC with configuration</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">withAuth</span>(<span class="hljs-params">WrappedComponent, options = {}</span>) </span>{
  <span class="hljs-keyword">const</span> {
    redirectTo = <span class="hljs-string">"/login"</span>,
    requiredRoles = [],
    <span class="hljs-attr">fallbackComponent</span>: FallbackComponent,
  } = options;

  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">WithAuthComponent</span>(<span class="hljs-params">props</span>) </span>{
    <span class="hljs-keyword">const</span> { user, isAuthenticated } = useAuth(); <span class="hljs-comment">// Custom hook</span>

    <span class="hljs-comment">// Not authenticated</span>
    <span class="hljs-keyword">if</span> (!isAuthenticated) {
      <span class="hljs-keyword">if</span> (FallbackComponent) {
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FallbackComponent</span> /&gt;</span></span>;
      }

      <span class="hljs-comment">// In a real app, you'd use React Router</span>
      <span class="hljs-built_in">window</span>.location.href = redirectTo;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }

    <span class="hljs-comment">// Check roles if required</span>
    <span class="hljs-keyword">if</span> (requiredRoles.length &gt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">const</span> hasRequiredRole = requiredRoles.some(<span class="hljs-function">(<span class="hljs-params">role</span>) =&gt;</span>
        user.roles?.includes(role)
      );

      <span class="hljs-keyword">if</span> (!hasRequiredRole) {
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"access-denied"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Access Denied<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>You don't have permission to view this page.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
        );
      }
    }

    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...props</span>} <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span></span>;
  };
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AdminPanel</span>(<span class="hljs-params">{ user }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Admin Panel<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Welcome, {user.name}!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Manage Users<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>View Analytics<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LoginPrompt</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Please log in<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>&gt;</span>Login<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> ProtectedAdminPanel = withAuth(AdminPanel, {
  <span class="hljs-attr">requiredRoles</span>: [<span class="hljs-string">"admin"</span>],
  <span class="hljs-attr">fallbackComponent</span>: LoginPrompt,
});
</div></code></pre>
<h2 id="%F0%9F%8F%AA-provider-pattern">🏪 Provider Pattern</h2>
<p>The Provider pattern uses React Context to share data across the component tree.</p>
<h3 id="theme-provider-example">Theme Provider Example</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Theme provider with multiple themes</span>
<span class="hljs-keyword">const</span> ThemeContext = createContext();

<span class="hljs-keyword">const</span> themes = {
  <span class="hljs-attr">light</span>: {
    <span class="hljs-attr">background</span>: <span class="hljs-string">"#ffffff"</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-string">"#000000"</span>,
    <span class="hljs-attr">primary</span>: <span class="hljs-string">"#007bff"</span>,
    <span class="hljs-attr">secondary</span>: <span class="hljs-string">"#6c757d"</span>,
  },
  <span class="hljs-attr">dark</span>: {
    <span class="hljs-attr">background</span>: <span class="hljs-string">"#121212"</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-string">"#ffffff"</span>,
    <span class="hljs-attr">primary</span>: <span class="hljs-string">"#bb86fc"</span>,
    <span class="hljs-attr">secondary</span>: <span class="hljs-string">"#03dac6"</span>,
  },
  <span class="hljs-attr">blue</span>: {
    <span class="hljs-attr">background</span>: <span class="hljs-string">"#e3f2fd"</span>,
    <span class="hljs-attr">text</span>: <span class="hljs-string">"#0d47a1"</span>,
    <span class="hljs-attr">primary</span>: <span class="hljs-string">"#1976d2"</span>,
    <span class="hljs-attr">secondary</span>: <span class="hljs-string">"#42a5f5"</span>,
  },
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThemeProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [currentTheme, setCurrentTheme] = useState(<span class="hljs-string">"light"</span>);

  <span class="hljs-keyword">const</span> theme = themes[currentTheme];

  <span class="hljs-keyword">const</span> toggleTheme = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCurrentTheme(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> themeNames = <span class="hljs-built_in">Object</span>.keys(themes);
      <span class="hljs-keyword">const</span> currentIndex = themeNames.indexOf(prev);
      <span class="hljs-keyword">const</span> nextIndex = (currentIndex + <span class="hljs-number">1</span>) % themeNames.length;
      <span class="hljs-keyword">return</span> themeNames[nextIndex];
    });
  }, []);

  <span class="hljs-keyword">const</span> setTheme = useCallback(<span class="hljs-function">(<span class="hljs-params">themeName</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (themes[themeName]) {
      setCurrentTheme(themeName);
    }
  }, []);

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      theme,
      currentTheme,
      toggleTheme,
      setTheme,
      <span class="hljs-attr">availableThemes</span>: <span class="hljs-built_in">Object</span>.keys(themes),
    }),
    [theme, currentTheme, toggleTheme, setTheme]
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">theme.background</span>,
          <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.text</span>,
          <span class="hljs-attr">minHeight:</span> "<span class="hljs-attr">100vh</span>",
          <span class="hljs-attr">transition:</span> "<span class="hljs-attr">all</span> <span class="hljs-attr">0.3s</span> <span class="hljs-attr">ease</span>",
        }}
      &gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Custom hook for using theme</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useTheme</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(ThemeContext);

  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useTheme must be used within a ThemeProvider"</span>);
  }

  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// Components using the theme</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Header</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { theme, toggleTheme, currentTheme } = useTheme();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">padding:</span> "<span class="hljs-attr">1rem</span>",
        <span class="hljs-attr">borderBottom:</span> `<span class="hljs-attr">2px</span> <span class="hljs-attr">solid</span> ${<span class="hljs-attr">theme.primary</span>}`,
        <span class="hljs-attr">display:</span> "<span class="hljs-attr">flex</span>",
        <span class="hljs-attr">justifyContent:</span> "<span class="hljs-attr">space-between</span>",
        <span class="hljs-attr">alignItems:</span> "<span class="hljs-attr">center</span>",
      }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.primary</span> }}&gt;</span>My App<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
        <span class="hljs-attr">onClick</span>=<span class="hljs-string">{toggleTheme}</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
          <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">theme.primary</span>,
          <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.background</span>,
          <span class="hljs-attr">border:</span> "<span class="hljs-attr">none</span>",
          <span class="hljs-attr">padding:</span> "<span class="hljs-attr">0.5rem</span> <span class="hljs-attr">1rem</span>",
          <span class="hljs-attr">borderRadius:</span> "<span class="hljs-attr">4px</span>",
          <span class="hljs-attr">cursor:</span> "<span class="hljs-attr">pointer</span>",
        }}
      &gt;</span>
        Theme: {currentTheme}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Card</span>(<span class="hljs-params">{ title, children }</span>) </span>{
  <span class="hljs-keyword">const</span> { theme } = useTheme();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
        <span class="hljs-attr">border:</span> `<span class="hljs-attr">1px</span> <span class="hljs-attr">solid</span> ${<span class="hljs-attr">theme.secondary</span>}`,
        <span class="hljs-attr">borderRadius:</span> "<span class="hljs-attr">8px</span>",
        <span class="hljs-attr">padding:</span> "<span class="hljs-attr">1rem</span>",
        <span class="hljs-attr">margin:</span> "<span class="hljs-attr">1rem</span>",
        <span class="hljs-attr">backgroundColor:</span> <span class="hljs-attr">theme.background</span>,
        <span class="hljs-attr">boxShadow:</span> `<span class="hljs-attr">0</span> <span class="hljs-attr">2px</span> <span class="hljs-attr">4px</span> ${<span class="hljs-attr">theme.secondary</span>}<span class="hljs-attr">30</span>`,
      }}
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">color:</span> <span class="hljs-attr">theme.primary</span>, <span class="hljs-attr">marginTop:</span> <span class="hljs-attr">0</span> }}&gt;</span>{title}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// App using the provider</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> "<span class="hljs-attr">1rem</span>" }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Card</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Welcome"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>This is a themed application!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Click the theme button to cycle through different themes.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">Card</span> <span class="hljs-attr">title</span>=<span class="hljs-string">"Features"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Multiple theme support<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Smooth transitions<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Context-based state management<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-state-reducer-pattern">🔄 State Reducer Pattern</h2>
<p>The State Reducer pattern gives users control over how state updates work.</p>
<h3 id="flexible-counter-with-state-reducer">Flexible Counter with State Reducer</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Counter with customizable state reducer</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCounter</span>(<span class="hljs-params">{
  initialValue = <span class="hljs-number">0</span>,
  min = -Infinity,
  max = Infinity,
  step = <span class="hljs-number">1</span>,
  reducer = (state, action</span>) =&gt; <span class="hljs-title">state</span>, // <span class="hljs-title">Default</span>: <span class="hljs-title">no</span>-<span class="hljs-title">op</span> <span class="hljs-title">reducer</span>
} = </span>{}) {
  <span class="hljs-comment">// Internal reducer that handles the core logic</span>
  <span class="hljs-keyword">const</span> internalReducer = useCallback(
    <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
      <span class="hljs-keyword">switch</span> (action.type) {
        <span class="hljs-keyword">case</span> <span class="hljs-string">"INCREMENT"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.min(max, state + step);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"DECREMENT"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(min, state - step);
        <span class="hljs-keyword">case</span> <span class="hljs-string">"SET"</span>:
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.max(min, <span class="hljs-built_in">Math</span>.min(max, action.payload));
        <span class="hljs-keyword">case</span> <span class="hljs-string">"RESET"</span>:
          <span class="hljs-keyword">return</span> initialValue;
        <span class="hljs-keyword">default</span>:
          <span class="hljs-keyword">return</span> state;
      }
    },
    [min, max, step, initialValue]
  );

  <span class="hljs-comment">// Combined reducer: user reducer gets first chance to handle actions</span>
  <span class="hljs-keyword">const</span> combinedReducer = useCallback(
    <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
      <span class="hljs-comment">// Let user reducer handle the action first</span>
      <span class="hljs-keyword">const</span> userResult = reducer(state, action);

      <span class="hljs-comment">// If user reducer returned the same state, use internal reducer</span>
      <span class="hljs-keyword">if</span> (userResult === state) {
        <span class="hljs-keyword">return</span> internalReducer(state, action);
      }

      <span class="hljs-comment">// User reducer modified state, respect their decision</span>
      <span class="hljs-keyword">return</span> userResult;
    },
    [reducer, internalReducer]
  );

  <span class="hljs-keyword">const</span> [count, dispatch] = useReducer(combinedReducer, initialValue);

  <span class="hljs-keyword">const</span> increment = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"INCREMENT"</span> });
  }, []);

  <span class="hljs-keyword">const</span> decrement = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"DECREMENT"</span> });
  }, []);

  <span class="hljs-keyword">const</span> <span class="hljs-keyword">set</span> = useCallback((value) =&gt; {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"SET"</span>, <span class="hljs-attr">payload</span>: value });
  }, []);

  <span class="hljs-keyword">const</span> reset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    dispatch({ <span class="hljs-attr">type</span>: <span class="hljs-string">"RESET"</span> });
  }, []);

  <span class="hljs-keyword">return</span> {
    count,
    increment,
    decrement,
    <span class="hljs-keyword">set</span>,
    reset,
    dispatch, // Allow direct dispatch for custom actions
  };
}

// Usage examples
function BasicCounter() {
  <span class="hljs-keyword">const</span> counter = useCounter({ <span class="hljs-attr">initialValue</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">max</span>: <span class="hljs-number">100</span> });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Basic Counter: {counter.count}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{counter.decrement}</span>&gt;</span>-<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{counter.increment}</span>&gt;</span>+<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{counter.reset}</span>&gt;</span>Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CustomCounter</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// Custom reducer that adds logging and prevents odd numbers</span>
  <span class="hljs-keyword">const</span> customReducer = useCallback(<span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Counter action:"</span>, action.type, <span class="hljs-string">"Current state:"</span>, state);

    <span class="hljs-comment">// Prevent setting odd numbers</span>
    <span class="hljs-keyword">if</span> (action.type === <span class="hljs-string">"SET"</span> &amp;&amp; action.payload % <span class="hljs-number">2</span> !== <span class="hljs-number">0</span>) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Odd numbers not allowed!"</span>);
      <span class="hljs-keyword">return</span> state; <span class="hljs-comment">// Don't change state</span>
    }

    <span class="hljs-comment">// Let the default reducer handle other cases</span>
    <span class="hljs-keyword">return</span> state;
  }, []);

  <span class="hljs-keyword">const</span> counter = useCounter({
    <span class="hljs-attr">initialValue</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">step</span>: <span class="hljs-number">2</span>,
    <span class="hljs-attr">reducer</span>: customReducer,
  });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Custom Counter (Even Numbers Only): {counter.count}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{counter.decrement}</span>&gt;</span>-2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{counter.increment}</span>&gt;</span>+2<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> counter.set(7)}&gt;Set to 7 (will fail)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> counter.set(8)}&gt;Set to 8 (will work)<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{counter.reset}</span>&gt;</span>Reset<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">BasicCounter</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">hr</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">CustomCounter</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-mini-challenge-build-a-flexible-form-component">🎯 Mini-Challenge: Build a Flexible Form Component</h2>
<h3 id="challenge-create-a-compound-form-component">Challenge: Create a Compound Form Component</h3>
<p>Build a form system using compound components that supports:</p>
<ul>
<li>Field validation</li>
<li>Custom field types</li>
<li>Form-level state management</li>
<li>Flexible layout</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your task: Implement this form system</span>
<span class="hljs-comment">// Usage should work like this:</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ContactForm</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Form submitted:"</span>, data);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Form.Field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">required</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Label</span>&gt;</span>Full Name<span class="hljs-tag">&lt;/<span class="hljs-name">Form.Label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Input</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Enter your name"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Error</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Field</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Form.Field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">required</span> <span class="hljs-attr">validate</span>=<span class="hljs-string">{validateEmail}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Label</span>&gt;</span>Email Address<span class="hljs-tag">&lt;/<span class="hljs-name">Form.Label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Enter your email"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Error</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Field</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Form.Field</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"message"</span> <span class="hljs-attr">required</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Label</span>&gt;</span>Message<span class="hljs-tag">&lt;/<span class="hljs-name">Form.Label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Textarea</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">{4}</span> <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Enter your message"</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Error</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Field</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Form.Actions</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Reset</span>&gt;</span>Clear<span class="hljs-tag">&lt;/<span class="hljs-name">Form.Reset</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Submit</span>&gt;</span>Send Message<span class="hljs-tag">&lt;/<span class="hljs-name">Form.Submit</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Actions</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validateEmail</span>(<span class="hljs-params">value</span>) </span>{
  <span class="hljs-keyword">const</span> emailRegex = <span class="hljs-regexp">/^[^\s@]+@[^\s@]+\.[^\s@]+$/</span>;
  <span class="hljs-keyword">return</span> emailRegex.test(value) ? <span class="hljs-string">""</span> : <span class="hljs-string">"Please enter a valid email address"</span>;
}
</div></code></pre>
<h3 id="solution-compound-form-component">Solution: Compound Form Component</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Form context and provider</span>
<span class="hljs-keyword">const</span> FormContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Form</span>(<span class="hljs-params">{ children, onSubmit, initialValues = {} }</span>) </span>{
  <span class="hljs-keyword">const</span> [values, setValues] = useState(initialValues);
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});
  <span class="hljs-keyword">const</span> [touched, setTouched] = useState({});

  <span class="hljs-keyword">const</span> setValue = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name, value</span>) =&gt;</span> {
      setValues(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: value }));

      <span class="hljs-comment">// Clear error when user starts typing</span>
      <span class="hljs-keyword">if</span> (errors[name]) {
        setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: <span class="hljs-string">""</span> }));
      }
    },
    [errors]
  );

  <span class="hljs-keyword">const</span> setError = useCallback(<span class="hljs-function">(<span class="hljs-params">name, error</span>) =&gt;</span> {
    setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: error }));
  }, []);

  <span class="hljs-keyword">const</span> setTouched = useCallback(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
    setTouched(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, [name]: <span class="hljs-literal">true</span> }));
  }, []);

  <span class="hljs-keyword">const</span> validateField = useCallback(
    <span class="hljs-function">(<span class="hljs-params">name, value, validator</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (validator) {
        <span class="hljs-keyword">const</span> error = validator(value);
        setError(name, error);
        <span class="hljs-keyword">return</span> !error;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    },
    [setError]
  );

  <span class="hljs-keyword">const</span> reset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setValues(initialValues);
    setErrors({});
    setTouched({});
  }, [initialValues]);

  <span class="hljs-keyword">const</span> handleSubmit = useCallback(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      e.preventDefault();

      <span class="hljs-comment">// Validate all fields</span>
      <span class="hljs-keyword">const</span> formData = <span class="hljs-keyword">new</span> FormData(e.target);
      <span class="hljs-keyword">const</span> fieldValidations = [];

      <span class="hljs-comment">// Get all field validators from form elements</span>
      <span class="hljs-keyword">const</span> fields = e.target.querySelectorAll(<span class="hljs-string">"[data-field-name]"</span>);
      fields.forEach(<span class="hljs-function">(<span class="hljs-params">field</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> name = field.dataset.fieldName;
        <span class="hljs-keyword">const</span> validator = field.dataset.validator;
        <span class="hljs-keyword">const</span> required = field.hasAttribute(<span class="hljs-string">"required"</span>);
        <span class="hljs-keyword">const</span> value = values[name] || <span class="hljs-string">""</span>;

        <span class="hljs-keyword">if</span> (required &amp;&amp; !value.trim()) {
          setError(name, <span class="hljs-string">"This field is required"</span>);
          fieldValidations.push(<span class="hljs-literal">false</span>);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (validator &amp;&amp; <span class="hljs-built_in">window</span>[validator]) {
          <span class="hljs-keyword">const</span> isValid = validateField(name, value, <span class="hljs-built_in">window</span>[validator]);
          fieldValidations.push(isValid);
        } <span class="hljs-keyword">else</span> {
          fieldValidations.push(<span class="hljs-literal">true</span>);
        }

        setTouched(name);
      });

      <span class="hljs-comment">// Submit if all validations pass</span>
      <span class="hljs-keyword">if</span> (fieldValidations.every(<span class="hljs-built_in">Boolean</span>)) {
        onSubmit(values);
      }
    },
    [values, validateField, setError, setTouched, onSubmit]
  );

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      values,
      errors,
      touched,
      setValue,
      setError,
      setTouched,
      validateField,
      reset,
    }),
    [
      values,
      errors,
      touched,
      setValue,
      setError,
      setTouched,
      validateField,
      reset,
    ]
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FormContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">FormContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Field wrapper component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormField</span>(<span class="hljs-params">{ name, required, validate, children }</span>) </span>{
  <span class="hljs-keyword">const</span> { values, errors, touched } = useContext(FormContext);

  <span class="hljs-keyword">const</span> fieldValue = values[name] || <span class="hljs-string">""</span>;
  <span class="hljs-keyword">const</span> fieldError = errors[name];
  <span class="hljs-keyword">const</span> fieldTouched = touched[name];
  <span class="hljs-keyword">const</span> showError = fieldTouched &amp;&amp; fieldError;

  <span class="hljs-keyword">const</span> fieldContext = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      name,
      <span class="hljs-attr">value</span>: fieldValue,
      <span class="hljs-attr">error</span>: fieldError,
      <span class="hljs-attr">touched</span>: fieldTouched,
      showError,
      required,
      validate,
    }),
    [name, fieldValue, fieldError, fieldTouched, showError, required, validate]
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FieldContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{fieldContext}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">form-field</span> ${<span class="hljs-attr">showError</span> ? "<span class="hljs-attr">has-error</span>" <span class="hljs-attr">:</span> ""}`}&gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">FieldContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> FieldContext = createContext();

<span class="hljs-comment">// Form input components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormLabel</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> { name, required } = useContext(FieldContext);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">{name}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-label"</span>&gt;</span>
      {children}
      {required &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"required"</span>&gt;</span>*<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormInput</span>(<span class="hljs-params">{ type = <span class="hljs-string">"text"</span>, ...props }</span>) </span>{
  <span class="hljs-keyword">const</span> { name, value, required, validate } = useContext(FieldContext);
  <span class="hljs-keyword">const</span> { setValue, setTouched, validateField } = useContext(FormContext);

  <span class="hljs-keyword">const</span> handleChange = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    setValue(name, e.target.value);
  };

  <span class="hljs-keyword">const</span> handleBlur = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTouched(name);
    <span class="hljs-keyword">if</span> (validate) {
      validateField(name, value, validate);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">input</span>
      <span class="hljs-attr">id</span>=<span class="hljs-string">{name}</span>
      <span class="hljs-attr">name</span>=<span class="hljs-string">{name}</span>
      <span class="hljs-attr">type</span>=<span class="hljs-string">{type}</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
      <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
      <span class="hljs-attr">required</span>=<span class="hljs-string">{required}</span>
      <span class="hljs-attr">data-field-name</span>=<span class="hljs-string">{name}</span>
      <span class="hljs-attr">data-validator</span>=<span class="hljs-string">{validate?.name}</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">"form-input"</span>
      {<span class="hljs-attr">...props</span>}
    /&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormTextarea</span>(<span class="hljs-params">{ ...props }</span>) </span>{
  <span class="hljs-keyword">const</span> { name, value, required, validate } = useContext(FieldContext);
  <span class="hljs-keyword">const</span> { setValue, setTouched, validateField } = useContext(FormContext);

  <span class="hljs-keyword">const</span> handleChange = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    setValue(name, e.target.value);
  };

  <span class="hljs-keyword">const</span> handleBlur = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTouched(name);
    <span class="hljs-keyword">if</span> (validate) {
      validateField(name, value, validate);
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">textarea</span>
      <span class="hljs-attr">id</span>=<span class="hljs-string">{name}</span>
      <span class="hljs-attr">name</span>=<span class="hljs-string">{name}</span>
      <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>
      <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleChange}</span>
      <span class="hljs-attr">onBlur</span>=<span class="hljs-string">{handleBlur}</span>
      <span class="hljs-attr">required</span>=<span class="hljs-string">{required}</span>
      <span class="hljs-attr">data-field-name</span>=<span class="hljs-string">{name}</span>
      <span class="hljs-attr">data-validator</span>=<span class="hljs-string">{validate?.name}</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">"form-textarea"</span>
      {<span class="hljs-attr">...props</span>}
    /&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormError</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { showError, error } = useContext(FieldContext);

  <span class="hljs-keyword">if</span> (!showError) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-error"</span>&gt;</span>{error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormActions</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-actions"</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormSubmit</span>(<span class="hljs-params">{ children, ...props }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-submit"</span> {<span class="hljs-attr">...props</span>}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FormReset</span>(<span class="hljs-params">{ children, ...props }</span>) </span>{
  <span class="hljs-keyword">const</span> { reset } = useContext(FormContext);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{reset}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-reset"</span> {<span class="hljs-attr">...props</span>}&gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Attach sub-components</span>
Form.Field = FormField;
Form.Label = FormLabel;
Form.Input = FormInput;
Form.Textarea = FormTextarea;
Form.Error = FormError;
Form.Actions = FormActions;
Form.Submit = FormSubmit;
Form.Reset = FormReset;
</div></code></pre>
<h2 id="%F0%9F%8E%AF-when-to-use-each-pattern">🎯 When to Use Each Pattern</h2>
<h3 id="pattern-selection-guide">Pattern Selection Guide</h3>
<table>
<thead>
<tr>
<th>Pattern</th>
<th>Use When</th>
<th>Avoid When</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Render Props</strong></td>
<td>Sharing stateful logic, flexible rendering</td>
<td>Simple prop passing</td>
</tr>
<tr>
<td><strong>Compound Components</strong></td>
<td>Related components that work together</td>
<td>Unrelated components</td>
</tr>
<tr>
<td><strong>HOCs</strong></td>
<td>Cross-cutting concerns, legacy code</td>
<td>Modern React (prefer hooks)</td>
</tr>
<tr>
<td><strong>Provider</strong></td>
<td>Global state, theme, auth</td>
<td>Local component state</td>
</tr>
<tr>
<td><strong>State Reducer</strong></td>
<td>Complex state logic, user customization</td>
<td>Simple state updates</td>
</tr>
</tbody>
</table>
<h3 id="decision-framework">Decision Framework</h3>
<pre class="hljs"><code><div>What are you trying to achieve?

├─ Share stateful logic between components
│  ├─ Need flexible rendering → Render Props
│  └─ Logic only → Custom Hook
│
├─ Create reusable component API
│  ├─ Components work together → Compound Components
│  └─ Single component → Regular props
│
├─ Add functionality to existing components
│  ├─ Modern React → Custom Hook + Component
│  └─ Legacy/Class components → HOC
│
├─ Share data across component tree
│  ├─ Global state → Provider Pattern
│  └─ Local state → Props/State lifting
│
└─ Complex state management
   ├─ User needs control → State Reducer
   └─ Internal only → useReducer
</div></code></pre>
<hr>
<p><strong>Next up</strong>: We'll explore error boundaries and learn how to handle errors gracefully in React! 🛡️</p>
<h1 id="16-error-boundaries--error-handling-%F0%9F%9B%A1%EF%B8%8F">16. Error Boundaries &amp; Error Handling 🛡️</h1>
<blockquote>
<p>&quot;Errors are not failures, they're learning opportunities. In React, Error Boundaries help us learn gracefully.&quot; - React Philosophy</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>What Error Boundaries are and how they work</li>
<li>How to create and implement Error Boundaries</li>
<li>Different error handling strategies in React</li>
<li>Best practices for error reporting and recovery</li>
<li>How to handle async errors and promise rejections</li>
<li>Testing error scenarios</li>
<li>Production error monitoring</li>
</ul>
<h2 id="%F0%9F%94%8D-what-are-error-boundaries">🔍 What are Error Boundaries?</h2>
<p>Error Boundaries are React components that catch JavaScript errors anywhere in their child component tree, log those errors, and display a fallback UI instead of the component tree that crashed.</p>
<h3 id="key-characteristics">Key Characteristics</h3>
<ul>
<li><strong>Catch errors during rendering</strong></li>
<li><strong>Catch errors in lifecycle methods</strong></li>
<li><strong>Catch errors in constructors</strong></li>
<li><strong>Display fallback UI</strong></li>
<li><strong>Log error information</strong></li>
<li><strong>Only work in class components</strong> (for now)</li>
</ul>
<h3 id="what-error-boundaries-dont-catch">What Error Boundaries DON'T Catch</h3>
<ul>
<li>Event handlers</li>
<li>Asynchronous code (setTimeout, promises)</li>
<li>Errors during server-side rendering</li>
<li>Errors thrown in the error boundary itself</li>
</ul>
<h2 id="%F0%9F%8F%97%EF%B8%8F-creating-error-boundaries">🏗️ Creating Error Boundaries</h2>
<h3 id="basic-error-boundary">Basic Error Boundary</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Basic Error Boundary class component</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">errorInfo</span>: <span class="hljs-literal">null</span> };
  }

  <span class="hljs-keyword">static</span> getDerivedStateFromError(error) {
    <span class="hljs-comment">// Update state so the next render will show the fallback UI</span>
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span> };
  }

  componentDidCatch(error, errorInfo) {
    <span class="hljs-comment">// Log the error to an error reporting service</span>
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error Boundary caught an error:"</span>, error, errorInfo);

    <span class="hljs-keyword">this</span>.setState({
      <span class="hljs-attr">error</span>: error,
      <span class="hljs-attr">errorInfo</span>: errorInfo,
    });

    <span class="hljs-comment">// You can also log the error to an error reporting service here</span>
    <span class="hljs-comment">// logErrorToService(error, errorInfo);</span>
  }

  render() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.state.hasError) {
      <span class="hljs-comment">// Fallback UI</span>
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-boundary"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>🚨 Something went wrong!<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>We're sorry, but something unexpected happened.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

          {/* Show error details in development */}
          {process.env.NODE_ENV === "development" &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">details</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">whiteSpace:</span> "<span class="hljs-attr">pre-wrap</span>" }}&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">summary</span>&gt;</span>Error Details (Development Only)<span class="hljs-tag">&lt;/<span class="hljs-name">summary</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Error:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>{" "}
                {this.state.error &amp;&amp; this.state.error.toString()}
              <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Stack Trace:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{this.state.errorInfo.componentStack}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">details</span>&gt;</span>
          )}

          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span>
              this.setState({ hasError: false, error: null, errorInfo: null })
            }
          &gt;
            Try Again
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      );
    }

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.props.children;
  }
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">MainContent</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="advanced-error-boundary-with-hooks-support">Advanced Error Boundary with Hooks Support</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Advanced Error Boundary with more features</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AdvancedErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = {
      <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">errorInfo</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">eventId</span>: <span class="hljs-literal">null</span>,
    };
  }

  <span class="hljs-keyword">static</span> getDerivedStateFromError(error) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span> };
  }

  componentDidCatch(error, errorInfo) {
    <span class="hljs-keyword">const</span> { onError, enableLogging = <span class="hljs-literal">true</span> } = <span class="hljs-keyword">this</span>.props;

    <span class="hljs-comment">// Generate unique error ID</span>
    <span class="hljs-keyword">const</span> eventId = <span class="hljs-string">`error_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random()
      .toString(<span class="hljs-number">36</span>)
      .substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;

    <span class="hljs-keyword">this</span>.setState({
      error,
      errorInfo,
      eventId,
    });

    <span class="hljs-comment">// Custom error handler</span>
    <span class="hljs-keyword">if</span> (onError) {
      onError(error, errorInfo, eventId);
    }

    <span class="hljs-comment">// Log to console in development</span>
    <span class="hljs-keyword">if</span> (enableLogging &amp;&amp; process.env.NODE_ENV === <span class="hljs-string">"development"</span>) {
      <span class="hljs-built_in">console</span>.group(<span class="hljs-string">"🚨 Error Boundary Caught Error"</span>);
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error);
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error Info:"</span>, errorInfo);
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Event ID:"</span>, eventId);
      <span class="hljs-built_in">console</span>.groupEnd();
    }

    <span class="hljs-comment">// Log to external service in production</span>
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"production"</span>) {
      <span class="hljs-keyword">this</span>.logErrorToService(error, errorInfo, eventId);
    }
  }

  logErrorToService = <span class="hljs-function">(<span class="hljs-params">error, errorInfo, eventId</span>) =&gt;</span> {
    <span class="hljs-comment">// Example: Send to error monitoring service</span>
    <span class="hljs-keyword">const</span> errorData = {
      <span class="hljs-attr">message</span>: error.message,
      <span class="hljs-attr">stack</span>: error.stack,
      <span class="hljs-attr">componentStack</span>: errorInfo.componentStack,
      eventId,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      <span class="hljs-attr">userAgent</span>: navigator.userAgent,
      <span class="hljs-attr">url</span>: <span class="hljs-built_in">window</span>.location.href,
    };

    <span class="hljs-comment">// Send to your error monitoring service</span>
    <span class="hljs-comment">// fetch('/api/errors', {</span>
    <span class="hljs-comment">//   method: 'POST',</span>
    <span class="hljs-comment">//   headers: { 'Content-Type': 'application/json' },</span>
    <span class="hljs-comment">//   body: JSON.stringify(errorData)</span>
    <span class="hljs-comment">// });</span>

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Would send to error service:"</span>, errorData);
  };

  handleRetry = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">this</span>.setState({
      <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">errorInfo</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">eventId</span>: <span class="hljs-literal">null</span>,
    });
  };

  handleReload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">window</span>.location.reload();
  };

  render() {
    <span class="hljs-keyword">const</span> { <span class="hljs-attr">fallback</span>: Fallback, children } = <span class="hljs-keyword">this</span>.props;
    <span class="hljs-keyword">const</span> { hasError, error, errorInfo, eventId } = <span class="hljs-keyword">this</span>.state;

    <span class="hljs-keyword">if</span> (hasError) {
      <span class="hljs-comment">// Use custom fallback component if provided</span>
      <span class="hljs-keyword">if</span> (Fallback) {
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Fallback</span>
            <span class="hljs-attr">error</span>=<span class="hljs-string">{error}</span>
            <span class="hljs-attr">errorInfo</span>=<span class="hljs-string">{errorInfo}</span>
            <span class="hljs-attr">eventId</span>=<span class="hljs-string">{eventId}</span>
            <span class="hljs-attr">onRetry</span>=<span class="hljs-string">{this.handleRetry}</span>
            <span class="hljs-attr">onReload</span>=<span class="hljs-string">{this.handleReload}</span>
          /&gt;</span></span>
        );
      }

      <span class="hljs-comment">// Default fallback UI</span>
      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-boundary-container"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-boundary-content"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-icon"</span>&gt;</span>🚨<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Oops! Something went wrong<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>We're sorry, but an unexpected error occurred.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

            {eventId &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-id"</span>&gt;</span>
                Error ID: <span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>{eventId}<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            )}

            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-actions"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"btn btn-primary"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleRetry}</span>&gt;</span>
                Try Again
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

              <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"btn btn-secondary"</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{this.handleReload}</span>&gt;</span>
                Reload Page
              <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

            {/* Development error details */}
            {process.env.NODE_ENV === "development" &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">details</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-details"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">summary</span>&gt;</span>🔍 Error Details (Development)<span class="hljs-tag">&lt;/<span class="hljs-name">summary</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-content"</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Error Message:<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{error?.toString()}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>

                  <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Component Stack:<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{errorInfo?.componentStack}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>

                  <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Error Stack:<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{error?.stack}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">details</span>&gt;</span>
            )}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      );
    }

    <span class="hljs-keyword">return</span> children;
  }
}

<span class="hljs-comment">// Custom fallback component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">CustomErrorFallback</span>(<span class="hljs-params">{ error, errorInfo, eventId, onRetry, onReload }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"custom-error-fallback"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>🎭 Custom Error Handler<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Something unexpected happened in our application.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      {eventId &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-reference"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Reference ID:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {eventId}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-actions"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onRetry}</span>&gt;</span>🔄 Try Again<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onReload}</span>&gt;</span>🔃 Reload Page<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> window.history.back()}&gt;⬅️ Go Back<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage with custom fallback</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> handleError = <span class="hljs-function">(<span class="hljs-params">error, errorInfo, eventId</span>) =&gt;</span> {
    <span class="hljs-comment">// Custom error handling logic</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Custom error handler called:"</span>, { error, errorInfo, eventId });

    <span class="hljs-comment">// Send to analytics</span>
    <span class="hljs-comment">// analytics.track('Error Occurred', { eventId, errorMessage: error.message });</span>
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">AdvancedErrorBoundary</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{CustomErrorFallback}</span> <span class="hljs-attr">onError</span>=<span class="hljs-string">{handleError}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/profile"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Profile</span> /&gt;</span>} /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/settings"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Settings</span> /&gt;</span>} /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">AdvancedErrorBoundary</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%A3-error-boundary-hook-custom-implementation">🎣 Error Boundary Hook (Custom Implementation)</h2>
<p>Since Error Boundaries only work with class components, here's a custom hook approach:</p>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Custom hook for error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useErrorHandler</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> resetError = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setError(<span class="hljs-literal">null</span>);
  }, []);

  <span class="hljs-keyword">const</span> captureError = useCallback(<span class="hljs-function">(<span class="hljs-params">error, errorInfo = {}</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error captured by useErrorHandler:"</span>, error);

    setError({
      <span class="hljs-attr">message</span>: error.message,
      <span class="hljs-attr">stack</span>: error.stack,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      ...errorInfo,
    });

    <span class="hljs-comment">// Log to external service</span>
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"production"</span>) {
      <span class="hljs-comment">// logErrorToService(error, errorInfo);</span>
    }
  }, []);

  <span class="hljs-comment">// Automatically capture unhandled promise rejections</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleUnhandledRejection = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      captureError(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(event.reason), {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"unhandledRejection"</span>,
        <span class="hljs-attr">reason</span>: event.reason,
      });
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unhandledrejection"</span>, handleUnhandledRejection);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.removeEventListener(
        <span class="hljs-string">"unhandledrejection"</span>,
        handleUnhandledRejection
      );
    };
  }, [captureError]);

  <span class="hljs-keyword">return</span> {
    error,
    captureError,
    resetError,
    <span class="hljs-attr">hasError</span>: !!error,
  };
}

<span class="hljs-comment">// Error boundary component using the hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ErrorBoundaryWithHook</span>(<span class="hljs-params">{ children, fallback: Fallback }</span>) </span>{
  <span class="hljs-keyword">const</span> { error, resetError, hasError } = useErrorHandler();

  <span class="hljs-keyword">if</span> (hasError) {
    <span class="hljs-keyword">if</span> (Fallback) {
      <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Fallback</span> <span class="hljs-attr">error</span>=<span class="hljs-string">{error}</span> <span class="hljs-attr">onRetry</span>=<span class="hljs-string">{resetError}</span> /&gt;</span></span>;
    }

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-boundary"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Something went wrong<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{resetError}</span>&gt;</span>Try Again<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> children;
}

<span class="hljs-comment">// Usage in functional components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { captureError } = useErrorHandler();

  <span class="hljs-keyword">const</span> handleAsyncOperation = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> riskyAsyncOperation();
      <span class="hljs-comment">// Handle success</span>
    } <span class="hljs-keyword">catch</span> (error) {
      captureError(error, { <span class="hljs-attr">context</span>: <span class="hljs-string">"async operation"</span> });
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleAsyncOperation}</span>&gt;</span>Perform Risky Operation<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%94%84-handling-different-types-of-errors">🔄 Handling Different Types of Errors</h2>
<h3 id="1-async-errors-and-promise-rejections">1. Async Errors and Promise Rejections</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Async error handling component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AsyncErrorHandler</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [asyncError, setAsyncError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Handle unhandled promise rejections</span>
    <span class="hljs-keyword">const</span> handleUnhandledRejection = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Unhandled promise rejection:"</span>, event.reason);
      setAsyncError({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"unhandledRejection"</span>,
        <span class="hljs-attr">message</span>: event.reason?.message || <span class="hljs-string">"Unhandled promise rejection"</span>,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      });

      <span class="hljs-comment">// Prevent the default browser behavior</span>
      event.preventDefault();
    };

    <span class="hljs-comment">// Handle general JavaScript errors</span>
    <span class="hljs-keyword">const</span> handleError = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"JavaScript error:"</span>, event.error);
      setAsyncError({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"javascriptError"</span>,
        <span class="hljs-attr">message</span>: event.error?.message || <span class="hljs-string">"JavaScript error"</span>,
        <span class="hljs-attr">filename</span>: event.filename,
        <span class="hljs-attr">lineno</span>: event.lineno,
        <span class="hljs-attr">colno</span>: event.colno,
        <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      });
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unhandledrejection"</span>, handleUnhandledRejection);
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"error"</span>, handleError);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.removeEventListener(
        <span class="hljs-string">"unhandledrejection"</span>,
        handleUnhandledRejection
      );
      <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"error"</span>, handleError);
    };
  }, []);

  <span class="hljs-keyword">if</span> (asyncError) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"async-error"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>🚨 Async Error Detected<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Type:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {asyncError.type}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Message:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {asyncError.message}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Time:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {asyncError.timestamp}
        <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setAsyncError(null)}&gt;Dismiss<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> window.location.reload()}&gt;Reload Page<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> children;
}
</div></code></pre>
<h3 id="2-network-error-handling">2. Network Error Handling</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Network error handling hook</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useNetworkErrorHandler</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [networkError, setNetworkError] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [isOnline, setIsOnline] = useState(navigator.onLine);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleOnline = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setIsOnline(<span class="hljs-literal">true</span>);
      setNetworkError(<span class="hljs-literal">null</span>);
    };

    <span class="hljs-keyword">const</span> handleOffline = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setIsOnline(<span class="hljs-literal">false</span>);
      setNetworkError({
        <span class="hljs-attr">type</span>: <span class="hljs-string">"offline"</span>,
        <span class="hljs-attr">message</span>:
          <span class="hljs-string">"You are currently offline. Please check your internet connection."</span>,
      });
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"online"</span>, handleOnline);
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"offline"</span>, handleOffline);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"online"</span>, handleOnline);
      <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"offline"</span>, handleOffline);
    };
  }, []);

  <span class="hljs-keyword">const</span> handleNetworkError = useCallback(<span class="hljs-function">(<span class="hljs-params">error, context = {}</span>) =&gt;</span> {
    <span class="hljs-keyword">let</span> errorMessage = <span class="hljs-string">"Network error occurred"</span>;
    <span class="hljs-keyword">let</span> errorType = <span class="hljs-string">"network"</span>;

    <span class="hljs-keyword">if</span> (error.name === <span class="hljs-string">"TypeError"</span> &amp;&amp; error.message.includes(<span class="hljs-string">"fetch"</span>)) {
      errorMessage = <span class="hljs-string">"Failed to connect to server"</span>;
      errorType = <span class="hljs-string">"connection"</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (error.status) {
      errorMessage = <span class="hljs-string">`Server error: <span class="hljs-subst">${error.status}</span> <span class="hljs-subst">${error.statusText}</span>`</span>;
      errorType = <span class="hljs-string">"server"</span>;
    }

    setNetworkError({
      <span class="hljs-attr">type</span>: errorType,
      <span class="hljs-attr">message</span>: errorMessage,
      <span class="hljs-attr">status</span>: error.status,
      context,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
    });
  }, []);

  <span class="hljs-keyword">const</span> clearNetworkError = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setNetworkError(<span class="hljs-literal">null</span>);
  }, []);

  <span class="hljs-keyword">return</span> {
    networkError,
    isOnline,
    handleNetworkError,
    clearNetworkError,
  };
}

<span class="hljs-comment">// Network-aware fetch wrapper</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useNetworkFetch</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { handleNetworkError, isOnline } = useNetworkErrorHandler();

  <span class="hljs-keyword">const</span> networkFetch = useCallback(
    <span class="hljs-keyword">async</span> (url, options = {}) =&gt; {
      <span class="hljs-keyword">if</span> (!isOnline) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"No internet connection"</span>);
      }

      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, {
          ...options,
          <span class="hljs-attr">signal</span>: AbortSignal.timeout(<span class="hljs-number">10000</span>), <span class="hljs-comment">// 10 second timeout</span>
        });

        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">const</span> error = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
            <span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>
          );
          error.status = response.status;
          error.statusText = response.statusText;
          <span class="hljs-keyword">throw</span> error;
        }

        <span class="hljs-keyword">return</span> response;
      } <span class="hljs-keyword">catch</span> (error) {
        handleNetworkError(error, { url, options });
        <span class="hljs-keyword">throw</span> error;
      }
    },
    [isOnline, handleNetworkError]
  );

  <span class="hljs-keyword">return</span> networkFetch;
}

<span class="hljs-comment">// Usage</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> networkFetch = useNetworkFetch();
  <span class="hljs-keyword">const</span> { networkError, clearNetworkError } = useNetworkErrorHandler();

  <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
    setLoading(<span class="hljs-literal">true</span>);
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> networkFetch(<span class="hljs-string">"/api/data"</span>);
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
      setData(result);
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to fetch data:"</span>, error);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  };

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetchData();
  }, []);

  <span class="hljs-keyword">if</span> (networkError) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"network-error"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>🌐 Network Error<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{networkError.message}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-actions"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{fetchData}</span>&gt;</span>Retry<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearNetworkError}</span>&gt;</span>Dismiss<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Data<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(data, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-mini-challenge-build-a-comprehensive-error-system">🎯 Mini-Challenge: Build a Comprehensive Error System</h2>
<h3 id="challenge-create-an-error-management-system">Challenge: Create an Error Management System</h3>
<p>Build a complete error handling system that includes:</p>
<ul>
<li>Error boundaries for different app sections</li>
<li>Async error handling</li>
<li>Error reporting and logging</li>
<li>User-friendly error recovery</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your task: Implement this error management system</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"header"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{MainErrorFallback}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">main</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sidebar"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">Sidebar</span> /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>

            <span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"content"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/profile"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Profile</span> /&gt;</span>} /&gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/settings"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Settings</span> /&gt;</span>} /&gt;
              <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"footer"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">ErrorNotifications</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorProvider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Components that might throw errors</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BuggyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [shouldThrow, setShouldThrow] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">if</span> (shouldThrow) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Intentional error for testing!"</span>);
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Buggy Component<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShouldThrow(true)}&gt;Throw Error<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AsyncBuggyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> handleAsyncError = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-comment">// This should be caught by async error handlers</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
      setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Async error!"</span>)), <span class="hljs-number">1000</span>);
    });
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Async Buggy Component<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleAsyncError}</span>&gt;</span>Trigger Async Error<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="solution-comprehensive-error-management-system">Solution: Comprehensive Error Management System</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Error context for global error management</span>
<span class="hljs-keyword">const</span> ErrorContext = createContext();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ErrorProvider</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState([]);
  <span class="hljs-keyword">const</span> [errorStats, setErrorStats] = useState({
    <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">byType</span>: {},
    <span class="hljs-attr">byComponent</span>: {},
  });

  <span class="hljs-keyword">const</span> addError = useCallback(<span class="hljs-function">(<span class="hljs-params">error, context = {}</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> errorId = <span class="hljs-string">`error_<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>_<span class="hljs-subst">${<span class="hljs-built_in">Math</span>.random()
      .toString(<span class="hljs-number">36</span>)
      .substr(<span class="hljs-number">2</span>, <span class="hljs-number">9</span>)}</span>`</span>;

    <span class="hljs-keyword">const</span> errorEntry = {
      <span class="hljs-attr">id</span>: errorId,
      <span class="hljs-attr">message</span>: error.message,
      <span class="hljs-attr">stack</span>: error.stack,
      <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      context,
      <span class="hljs-attr">dismissed</span>: <span class="hljs-literal">false</span>,
    };

    setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [errorEntry, ...prev].slice(<span class="hljs-number">0</span>, <span class="hljs-number">50</span>)); <span class="hljs-comment">// Keep last 50 errors</span>

    <span class="hljs-comment">// Update statistics</span>
    setErrorStats(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      <span class="hljs-attr">total</span>: prev.total + <span class="hljs-number">1</span>,
      <span class="hljs-attr">byType</span>: {
        ...prev.byType,
        [context.type || <span class="hljs-string">"unknown"</span>]:
          (prev.byType[context.type || <span class="hljs-string">"unknown"</span>] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>,
      },
      <span class="hljs-attr">byComponent</span>: {
        ...prev.byComponent,
        [context.component || <span class="hljs-string">"unknown"</span>]:
          (prev.byComponent[context.component || <span class="hljs-string">"unknown"</span>] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>,
      },
    }));

    <span class="hljs-comment">// Log to external service in production</span>
    <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"production"</span>) {
      logErrorToService(errorEntry);
    }

    <span class="hljs-keyword">return</span> errorId;
  }, []);

  <span class="hljs-keyword">const</span> dismissError = useCallback(<span class="hljs-function">(<span class="hljs-params">errorId</span>) =&gt;</span> {
    setErrors(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span>
        error.id === errorId ? { ...error, <span class="hljs-attr">dismissed</span>: <span class="hljs-literal">true</span> } : error
      )
    );
  }, []);

  <span class="hljs-keyword">const</span> clearErrors = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setErrors([]);
  }, []);

  <span class="hljs-keyword">const</span> logErrorToService = useCallback(<span class="hljs-function">(<span class="hljs-params">errorEntry</span>) =&gt;</span> {
    <span class="hljs-comment">// Mock error logging service</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"📊 Logging error to service:"</span>, errorEntry);

    <span class="hljs-comment">// In real app, send to your error monitoring service</span>
    <span class="hljs-comment">// fetch('/api/errors', {</span>
    <span class="hljs-comment">//   method: 'POST',</span>
    <span class="hljs-comment">//   headers: { 'Content-Type': 'application/json' },</span>
    <span class="hljs-comment">//   body: JSON.stringify(errorEntry)</span>
    <span class="hljs-comment">// });</span>
  }, []);

  <span class="hljs-keyword">const</span> value = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({
      <span class="hljs-attr">errors</span>: errors.filter(<span class="hljs-function">(<span class="hljs-params">error</span>) =&gt;</span> !error.dismissed),
      <span class="hljs-attr">allErrors</span>: errors,
      errorStats,
      addError,
      dismissError,
      clearErrors,
    }),
    [errors, errorStats, addError, dismissError, clearErrors]
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorContext.Provider</span> <span class="hljs-attr">value</span>=<span class="hljs-string">{value}</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">ErrorContext.Provider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Custom hook to use error context</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useErrorContext</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> context = useContext(ErrorContext);
  <span class="hljs-keyword">if</span> (!context) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"useErrorContext must be used within ErrorProvider"</span>);
  }
  <span class="hljs-keyword">return</span> context;
}

<span class="hljs-comment">// Enhanced Error Boundary with context integration</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContextualErrorBoundary</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span> </span>{
  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.state = { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> };
  }

  <span class="hljs-keyword">static</span> getDerivedStateFromError(error) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">hasError</span>: <span class="hljs-literal">true</span>, error };
  }

  componentDidCatch(error, errorInfo) {
    <span class="hljs-keyword">const</span> { name, onError } = <span class="hljs-keyword">this</span>.props;

    <span class="hljs-comment">// Add error to global context</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.context?.addError) {
      <span class="hljs-keyword">this</span>.context.addError(error, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"boundary"</span>,
        <span class="hljs-attr">component</span>: name,
        <span class="hljs-attr">componentStack</span>: errorInfo.componentStack,
      });
    }

    <span class="hljs-comment">// Call custom error handler</span>
    <span class="hljs-keyword">if</span> (onError) {
      onError(error, errorInfo);
    }
  }

  render() {
    <span class="hljs-keyword">const</span> { hasError, error } = <span class="hljs-keyword">this</span>.state;
    <span class="hljs-keyword">const</span> { children, <span class="hljs-attr">fallback</span>: Fallback, name } = <span class="hljs-keyword">this</span>.props;

    <span class="hljs-keyword">if</span> (hasError) {
      <span class="hljs-keyword">if</span> (Fallback) {
        <span class="hljs-keyword">return</span> (
          <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Fallback</span>
            <span class="hljs-attr">error</span>=<span class="hljs-string">{error}</span>
            <span class="hljs-attr">componentName</span>=<span class="hljs-string">{name}</span>
            <span class="hljs-attr">onRetry</span>=<span class="hljs-string">{()</span> =&gt;</span> this.setState({ hasError: false, error: null })}
          /&gt;</span>
        );
      }

      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-boundary-fallback"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>⚠️ Error in {name}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Something went wrong in this section.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> this.setState({ hasError: false, error: null })}
          &gt;
            Try Again
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
      );
    }

    <span class="hljs-keyword">return</span> children;
  }
}

ContextualErrorBoundary.contextType = ErrorContext;

<span class="hljs-comment">// Error notification component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ErrorNotifications</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { errors, dismissError } = useErrorContext();

  <span class="hljs-keyword">if</span> (errors.length === <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-notifications"</span>&gt;</span>
      {errors.slice(0, 3).map((error) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{error.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-notification"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-content"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Error:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {error.message}
            {error.context.component &amp;&amp; (
              <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-context"</span>&gt;</span>
                Component: {error.context.component}
              <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            )}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">"error-dismiss"</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dismissError(error.id)}
          &gt;
            ×
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Error statistics component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ErrorStats</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { errorStats, allErrors } = useErrorContext();

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-stats"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>📊 Error Statistics<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-item"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Total Errors:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {errorStats.total}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>By Type:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        {Object.entries(errorStats.byType).map(([type, count]) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{type}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-item"</span>&gt;</span>
            {type}: {count}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>By Component:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        {Object.entries(errorStats.byComponent).map(([component, count]) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{component}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-item"</span>&gt;</span>
            {component}: {count}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-section"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>Recent Errors:<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        {allErrors.slice(0, 5).map((error) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{error.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"recent-error"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>{new Date(error.timestamp).toLocaleString()}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Custom fallback components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MainErrorFallback</span>(<span class="hljs-params">{ error, componentName, onRetry }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"main-error-fallback"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>🚨 Main Content Error<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>The main content area encountered an error.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-details"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Component:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {componentName}
        <span class="hljs-tag">&lt;<span class="hljs-name">br</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Error:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {error?.message}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-actions"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onRetry}</span>&gt;</span>🔄 Retry<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> (window.location.href = "/")}&gt;🏠 Go Home<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Async error handler component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AsyncErrorHandler</span>(<span class="hljs-params">{ children }</span>) </span>{
  <span class="hljs-keyword">const</span> { addError } = useErrorContext();

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handleUnhandledRejection = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      addError(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(event.reason), {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"unhandledRejection"</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-string">"global"</span>,
      });
      event.preventDefault();
    };

    <span class="hljs-keyword">const</span> handleError = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> {
      addError(event.error, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"javascript"</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-string">"global"</span>,
        <span class="hljs-attr">filename</span>: event.filename,
        <span class="hljs-attr">lineno</span>: event.lineno,
      });
    };

    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"unhandledrejection"</span>, handleUnhandledRejection);
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"error"</span>, handleError);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-built_in">window</span>.removeEventListener(
        <span class="hljs-string">"unhandledrejection"</span>,
        handleUnhandledRejection
      );
      <span class="hljs-built_in">window</span>.removeEventListener(<span class="hljs-string">"error"</span>, handleError);
    };
  }, [addError]);

  <span class="hljs-keyword">return</span> children;
}

<span class="hljs-comment">// Main app with comprehensive error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorProvider</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">AsyncErrorHandler</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"app"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ContextualErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"header"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ContextualErrorBoundary</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">ContextualErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{MainErrorFallback}</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"main-content"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">ContextualErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"sidebar"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Sidebar</span> /&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">ContextualErrorBoundary</span>&gt;</span>

              <span class="hljs-tag">&lt;<span class="hljs-name">ContextualErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"content"</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"content"</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">BuggyComponent</span> /&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">AsyncBuggyComponent</span> /&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">ErrorStats</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">ContextualErrorBoundary</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ContextualErrorBoundary</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">ContextualErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"footer"</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ContextualErrorBoundary</span>&gt;</span>

          <span class="hljs-tag">&lt;<span class="hljs-name">ErrorNotifications</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">AsyncErrorHandler</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorProvider</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Test components</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Header</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>📱 My App Header<span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Sidebar</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">aside</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Sidebar<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/"</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/profile"</span>&gt;</span>Profile<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">aside</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Footer</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span>© 2024 My App<span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BuggyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [shouldThrow, setShouldThrow] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">if</span> (shouldThrow) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Intentional boundary error for testing!"</span>);
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"buggy-component"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>🐛 Boundary Error Test<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShouldThrow(true)}&gt;Throw Boundary Error<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AsyncBuggyComponent</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { addError } = useErrorContext();

  <span class="hljs-keyword">const</span> handleAsyncError = <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">_, reject</span>) =&gt;</span> {
        setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> reject(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Intentional async error!"</span>)), <span class="hljs-number">1000</span>);
      });
    } <span class="hljs-keyword">catch</span> (error) {
      addError(error, {
        <span class="hljs-attr">type</span>: <span class="hljs-string">"async"</span>,
        <span class="hljs-attr">component</span>: <span class="hljs-string">"AsyncBuggyComponent"</span>,
      });
    }
  };

  <span class="hljs-keyword">const</span> handleUnhandledAsyncError = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// This will be caught by the global handler</span>
    setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Unhandled async error!"</span>);
    }, <span class="hljs-number">1000</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"async-buggy-component"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>⚡ Async Error Test<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleAsyncError}</span>&gt;</span>Handled Async Error<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleUnhandledAsyncError}</span>&gt;</span>Unhandled Async Error<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%AA-testing-error-scenarios">🧪 Testing Error Scenarios</h2>
<h3 id="testing-error-boundaries">Testing Error Boundaries</h3>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> { render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/react"</span>;
<span class="hljs-keyword">import</span> userEvent <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/user-event"</span>;

<span class="hljs-comment">// Mock console.error to avoid noise in tests</span>
<span class="hljs-keyword">const</span> originalError = <span class="hljs-built_in">console</span>.error;
beforeAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.error = jest.fn();
});

afterAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-built_in">console</span>.error = originalError;
});

<span class="hljs-comment">// Test component that throws on command</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ThrowError</span>(<span class="hljs-params">{ shouldThrow }</span>) </span>{
  <span class="hljs-keyword">if</span> (shouldThrow) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Test error"</span>);
  }
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>No error<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

describe(<span class="hljs-string">"ErrorBoundary"</span>, () =&gt; {
  it(<span class="hljs-string">"should catch and display error"</span>, () =&gt; {
    render(
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ThrowError</span> <span class="hljs-attr">shouldThrow</span>=<span class="hljs-string">{true}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
    );

    expect(screen.getByText(<span class="hljs-regexp">/something went wrong/i</span>)).toBeInTheDocument();
  });

  it(<span class="hljs-string">"should render children when no error"</span>, () =&gt; {
    render(
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ThrowError</span> <span class="hljs-attr">shouldThrow</span>=<span class="hljs-string">{false}</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
    );

    expect(screen.getByText(<span class="hljs-string">"No error"</span>)).toBeInTheDocument();
  });

  it(<span class="hljs-string">"should allow retry after error"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TestComponent</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">const</span> [shouldThrow, setShouldThrow] = useState(<span class="hljs-literal">true</span>);

      <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShouldThrow(false)}&gt;Fix Error<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ThrowError</span> <span class="hljs-attr">shouldThrow</span>=<span class="hljs-string">{shouldThrow}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
      );
    }

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TestComponent</span> /&gt;</span></span>);

    <span class="hljs-comment">// Error should be displayed</span>
    expect(screen.getByText(<span class="hljs-regexp">/something went wrong/i</span>)).toBeInTheDocument();

    <span class="hljs-comment">// Click retry</span>
    <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Try Again"</span>));

    <span class="hljs-comment">// Should show the component again</span>
    expect(screen.getByText(<span class="hljs-string">"No error"</span>)).toBeInTheDocument();
  });
});
</div></code></pre>
<h2 id="%F0%9F%8E%AF-best-practices">🎯 Best Practices</h2>
<h3 id="1-error-boundary-placement">1. Error Boundary Placement</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Strategic error boundary placement</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"app"</span>&gt;</span>
      {" "}
      {/* Top-level boundary */}
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"main"</span>&gt;</span>
        {" "}
        {/* Section-level boundary */}
        <span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Route</span>
              <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span>
              <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
                &lt;<span class="hljs-attr">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"home"</span>&gt;</span>
                  {" "}
                  {/* Page-level boundary */}
                  <span class="hljs-tag">&lt;<span class="hljs-name">Home</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>
              }
            /&gt;

            <span class="hljs-tag">&lt;<span class="hljs-name">Route</span>
              <span class="hljs-attr">path</span>=<span class="hljs-string">"/profile"</span>
              <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>
                &lt;<span class="hljs-attr">ErrorBoundary</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"profile"</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">Profile</span> /&gt;</span>
                <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>
              }
            /&gt;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ErrorBoundary</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-error-logging-and-monitoring">2. Error Logging and Monitoring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Production error logging</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">logErrorToService</span>(<span class="hljs-params">error, errorInfo, context = {}</span>) </span>{
  <span class="hljs-keyword">const</span> errorData = {
    <span class="hljs-attr">message</span>: error.message,
    <span class="hljs-attr">stack</span>: error.stack,
    <span class="hljs-attr">componentStack</span>: errorInfo?.componentStack,
    <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
    <span class="hljs-attr">url</span>: <span class="hljs-built_in">window</span>.location.href,
    <span class="hljs-attr">userAgent</span>: navigator.userAgent,
    <span class="hljs-attr">userId</span>: getCurrentUserId(), <span class="hljs-comment">// If available</span>
    <span class="hljs-attr">sessionId</span>: getSessionId(), <span class="hljs-comment">// If available</span>
    <span class="hljs-attr">buildVersion</span>: process.env.REACT_APP_VERSION,
    ...context,
  };

  <span class="hljs-comment">// Send to error monitoring service (Sentry, LogRocket, etc.)</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.Sentry) {
    <span class="hljs-built_in">window</span>.Sentry.captureException(error, {
      <span class="hljs-attr">extra</span>: errorData,
    });
  }

  <span class="hljs-comment">// Send to custom analytics</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.analytics) {
    <span class="hljs-built_in">window</span>.analytics.track(<span class="hljs-string">"Error Occurred"</span>, errorData);
  }

  <span class="hljs-comment">// Send to custom error endpoint</span>
  fetch(<span class="hljs-string">"/api/errors"</span>, {
    <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
    <span class="hljs-attr">headers</span>: { <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span> },
    <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(errorData),
  }).catch(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to log error:"</span>, err);
  });
}
</div></code></pre>
<h3 id="3-user-friendly-error-messages">3. User-Friendly Error Messages</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Context-aware error messages</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getErrorMessage</span>(<span class="hljs-params">error, context</span>) </span>{
  <span class="hljs-keyword">const</span> errorMessages = {
    <span class="hljs-attr">ChunkLoadError</span>:
      <span class="hljs-string">"The application has been updated. Please refresh the page."</span>,
    <span class="hljs-attr">NetworkError</span>: <span class="hljs-string">"Please check your internet connection and try again."</span>,
    <span class="hljs-attr">AuthenticationError</span>: <span class="hljs-string">"Your session has expired. Please log in again."</span>,
    <span class="hljs-attr">ValidationError</span>: <span class="hljs-string">"Please check your input and try again."</span>,
    <span class="hljs-attr">PermissionError</span>: <span class="hljs-string">"You don't have permission to perform this action."</span>,
    <span class="hljs-attr">default</span>: <span class="hljs-string">"Something unexpected happened. Please try again."</span>,
  };

  <span class="hljs-comment">// Determine error type</span>
  <span class="hljs-keyword">if</span> (error.name === <span class="hljs-string">"ChunkLoadError"</span>) <span class="hljs-keyword">return</span> errorMessages.ChunkLoadError;
  <span class="hljs-keyword">if</span> (error.message.includes(<span class="hljs-string">"fetch"</span>)) <span class="hljs-keyword">return</span> errorMessages.NetworkError;
  <span class="hljs-keyword">if</span> (error.status === <span class="hljs-number">401</span>) <span class="hljs-keyword">return</span> errorMessages.AuthenticationError;
  <span class="hljs-keyword">if</span> (error.status === <span class="hljs-number">403</span>) <span class="hljs-keyword">return</span> errorMessages.PermissionError;
  <span class="hljs-keyword">if</span> (context.type === <span class="hljs-string">"validation"</span>) <span class="hljs-keyword">return</span> errorMessages.ValidationError;

  <span class="hljs-keyword">return</span> errorMessages.default;
}
</div></code></pre>
<hr>
<p><strong>Next up</strong>: We'll explore testing strategies and learn how to write comprehensive tests for React applications! 🧪</p>
<h1 id="17-testing-react-applications-%F0%9F%A7%AA">17. Testing React Applications 🧪</h1>
<blockquote>
<p>&quot;Testing is not about finding bugs, it's about building confidence in your code.&quot; - Kent C. Dodds</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>Different types of testing in React (Unit, Integration, E2E)</li>
<li>Setting up and using React Testing Library</li>
<li>Testing components, hooks, and user interactions</li>
<li>Mocking dependencies and external services</li>
<li>Testing async operations and error scenarios</li>
<li>Best practices for maintainable tests</li>
<li>Performance testing and accessibility testing</li>
</ul>
<h2 id="%F0%9F%94%8D-types-of-testing">🔍 Types of Testing</h2>
<h3 id="testing-pyramid">Testing Pyramid</h3>
<pre class="hljs"><code><div>        /\     E2E Tests
       /  \    (Few, Slow, Expensive)
      /____\
     /      \  Integration Tests
    /        \ (Some, Medium Speed)
   /__________\
  /            \ Unit Tests
 /              \ (Many, Fast, Cheap)
/________________\
</div></code></pre>
<h3 id="1-unit-tests">1. Unit Tests</h3>
<ul>
<li>Test individual components in isolation</li>
<li>Fast and focused</li>
<li>Easy to debug</li>
<li>High code coverage</li>
</ul>
<h3 id="2-integration-tests">2. Integration Tests</h3>
<ul>
<li>Test component interactions</li>
<li>Test with real dependencies</li>
<li>More realistic scenarios</li>
<li>Catch integration issues</li>
</ul>
<h3 id="3-end-to-end-e2e-tests">3. End-to-End (E2E) Tests</h3>
<ul>
<li>Test complete user workflows</li>
<li>Test in real browser environment</li>
<li>Catch system-level issues</li>
<li>Slower but comprehensive</li>
</ul>
<h2 id="%F0%9F%9B%A0%EF%B8%8F-setting-up-testing-environment">🛠️ Setting Up Testing Environment</h2>
<h3 id="react-testing-library-setup">React Testing Library Setup</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Install testing dependencies</span>
npm install --save-dev @testing-library/react @testing-library/jest-dom @testing-library/user-event

<span class="hljs-comment"># For custom render utilities</span>
npm install --save-dev @testing-library/react-hooks
</div></code></pre>
<h3 id="test-setup-file">Test Setup File</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/setupTests.js</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">"@testing-library/jest-dom"</span>;

<span class="hljs-comment">// Mock IntersectionObserver</span>
global.IntersectionObserver = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IntersectionObserver</span> </span>{
  <span class="hljs-keyword">constructor</span>() {}
  observe() {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
  disconnect() {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
  unobserve() {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
};

<span class="hljs-comment">// Mock ResizeObserver</span>
global.ResizeObserver = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ResizeObserver</span> </span>{
  <span class="hljs-keyword">constructor</span>() {}
  observe() {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
  disconnect() {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
  unobserve() {
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
  }
};

<span class="hljs-comment">// Mock matchMedia</span>
<span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-built_in">window</span>, <span class="hljs-string">"matchMedia"</span>, {
  <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">value</span>: jest.fn().mockImplementation(<span class="hljs-function">(<span class="hljs-params">query</span>) =&gt;</span> ({
    <span class="hljs-attr">matches</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">media</span>: query,
    <span class="hljs-attr">onchange</span>: <span class="hljs-literal">null</span>,
    <span class="hljs-attr">addListener</span>: jest.fn(),
    <span class="hljs-attr">removeListener</span>: jest.fn(),
    <span class="hljs-attr">addEventListener</span>: jest.fn(),
    <span class="hljs-attr">removeEventListener</span>: jest.fn(),
    <span class="hljs-attr">dispatchEvent</span>: jest.fn(),
  })),
});

<span class="hljs-comment">// Mock localStorage</span>
<span class="hljs-keyword">const</span> localStorageMock = {
  <span class="hljs-attr">getItem</span>: jest.fn(),
  <span class="hljs-attr">setItem</span>: jest.fn(),
  <span class="hljs-attr">removeItem</span>: jest.fn(),
  <span class="hljs-attr">clear</span>: jest.fn(),
};
global.localStorage = localStorageMock;
</div></code></pre>
<h3 id="custom-render-utility">Custom Render Utility</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/test-utils.js</span>
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { render } <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/react"</span>;
<span class="hljs-keyword">import</span> { BrowserRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router-dom"</span>;
<span class="hljs-keyword">import</span> { QueryClient, QueryClientProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-query"</span>;
<span class="hljs-keyword">import</span> { ThemeProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">"./contexts/ThemeContext"</span>;
<span class="hljs-keyword">import</span> { AuthProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">"./contexts/AuthContext"</span>;

<span class="hljs-comment">// Create a custom render function that includes providers</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">customRender</span>(<span class="hljs-params">ui, options = {}</span>) </span>{
  <span class="hljs-keyword">const</span> {
    initialEntries = [<span class="hljs-string">"/"</span>],
    queryClient = <span class="hljs-keyword">new</span> QueryClient({
      <span class="hljs-attr">defaultOptions</span>: {
        <span class="hljs-attr">queries</span>: { <span class="hljs-attr">retry</span>: <span class="hljs-literal">false</span> },
        <span class="hljs-attr">mutations</span>: { <span class="hljs-attr">retry</span>: <span class="hljs-literal">false</span> },
      },
    }),
    ...renderOptions
  } = options;

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Wrapper</span>(<span class="hljs-params">{ children }</span>) </span>{
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">QueryClientProvider</span> <span class="hljs-attr">client</span>=<span class="hljs-string">{queryClient}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">BrowserRouter</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">ThemeProvider</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">AuthProvider</span>&gt;</span>{children}<span class="hljs-tag">&lt;/<span class="hljs-name">AuthProvider</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">ThemeProvider</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">BrowserRouter</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">QueryClientProvider</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> {
    ...render(ui, { <span class="hljs-attr">wrapper</span>: Wrapper, ...renderOptions }),
    queryClient,
  };
}

<span class="hljs-comment">// Re-export everything</span>
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/react"</span>;
<span class="hljs-keyword">export</span> { customRender <span class="hljs-keyword">as</span> render };
<span class="hljs-keyword">export</span> { <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> userEvent } <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/user-event"</span>;
</div></code></pre>
<h2 id="%F0%9F%A7%A9-testing-components">🧩 Testing Components</h2>
<h3 id="basic-component-testing">Basic Component Testing</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Button.jsx</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Button</span>(<span class="hljs-params">{ children, onClick, disabled = false, variant = <span class="hljs-string">"primary"</span> }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span>
      <span class="hljs-attr">onClick</span>=<span class="hljs-string">{onClick}</span>
      <span class="hljs-attr">disabled</span>=<span class="hljs-string">{disabled}</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">btn</span> <span class="hljs-attr">btn-</span>${<span class="hljs-attr">variant</span>}`}
      <span class="hljs-attr">data-testid</span>=<span class="hljs-string">"button"</span>
    &gt;</span>
      {children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Button;
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// Button.test.jsx</span>
<span class="hljs-keyword">import</span> { render, screen } <span class="hljs-keyword">from</span> <span class="hljs-string">"../test-utils"</span>;
<span class="hljs-keyword">import</span> userEvent <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/user-event"</span>;
<span class="hljs-keyword">import</span> Button <span class="hljs-keyword">from</span> <span class="hljs-string">"./Button"</span>;

describe(<span class="hljs-string">"Button Component"</span>, () =&gt; {
  it(<span class="hljs-string">"renders with correct text"</span>, () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>);

    expect(
      screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">"Click me"</span> })
    ).toBeInTheDocument();
  });

  it(<span class="hljs-string">"calls onClick when clicked"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();
    <span class="hljs-keyword">const</span> handleClick = jest.fn();

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>);

    <span class="hljs-keyword">await</span> user.click(screen.getByRole(<span class="hljs-string">"button"</span>));

    expect(handleClick).toHaveBeenCalledTimes(<span class="hljs-number">1</span>);
  });

  it(<span class="hljs-string">"is disabled when disabled prop is true"</span>, () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">disabled</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>);

    expect(screen.getByRole(<span class="hljs-string">"button"</span>)).toBeDisabled();
  });

  it(<span class="hljs-string">"applies correct CSS class for variant"</span>, () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">variant</span>=<span class="hljs-string">"secondary"</span>&gt;</span>Click me<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>);

    expect(screen.getByRole(<span class="hljs-string">"button"</span>)).toHaveClass(<span class="hljs-string">"btn-secondary"</span>);
  });

  it(<span class="hljs-string">"does not call onClick when disabled"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();
    <span class="hljs-keyword">const</span> handleClick = jest.fn();

    render(
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleClick}</span> <span class="hljs-attr">disabled</span>&gt;</span>
        Click me
      <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span></span>
    );

    <span class="hljs-keyword">await</span> user.click(screen.getByRole(<span class="hljs-string">"button"</span>));

    expect(handleClick).not.toHaveBeenCalled();
  });
});
</div></code></pre>
<h3 id="testing-forms-and-user-input">Testing Forms and User Input</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// LoginForm.jsx</span>
<span class="hljs-keyword">import</span> { useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LoginForm</span>(<span class="hljs-params">{ onSubmit, isLoading = false }</span>) </span>{
  <span class="hljs-keyword">const</span> [email, setEmail] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [password, setPassword] = useState(<span class="hljs-string">""</span>);
  <span class="hljs-keyword">const</span> [errors, setErrors] = useState({});

  <span class="hljs-keyword">const</span> validateForm = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> newErrors = {};

    <span class="hljs-keyword">if</span> (!email) {
      newErrors.email = <span class="hljs-string">"Email is required"</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-regexp">/\S+@\S+\.\S+/</span>.test(email)) {
      newErrors.email = <span class="hljs-string">"Email is invalid"</span>;
    }

    <span class="hljs-keyword">if</span> (!password) {
      newErrors.password = <span class="hljs-string">"Password is required"</span>;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (password.length &lt; <span class="hljs-number">6</span>) {
      newErrors.password = <span class="hljs-string">"Password must be at least 6 characters"</span>;
    }

    setErrors(newErrors);
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Object</span>.keys(newErrors).length === <span class="hljs-number">0</span>;
  };

  <span class="hljs-keyword">const</span> handleSubmit = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    e.preventDefault();

    <span class="hljs-keyword">if</span> (validateForm()) {
      onSubmit({ email, password });
    }
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{handleSubmit}</span> <span class="hljs-attr">noValidate</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"email"</span>&gt;</span>Email<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"email"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{email}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setEmail(e.target.value)}
          aria-invalid={errors.email ? "true" : "false"}
          aria-describedby={errors.email ? "email-error" : undefined}
        /&gt;
        {errors.email &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"email-error"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"alert"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>
            {errors.email}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"form-group"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">label</span> <span class="hljs-attr">htmlFor</span>=<span class="hljs-string">"password"</span>&gt;</span>Password<span class="hljs-tag">&lt;/<span class="hljs-name">label</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">id</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"password"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{password}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setPassword(e.target.value)}
          aria-invalid={errors.password ? "true" : "false"}
          aria-describedby={errors.password ? "password-error" : undefined}
        /&gt;
        {errors.password &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"password-error"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"alert"</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error"</span>&gt;</span>
            {errors.password}
          <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isLoading}</span>&gt;</span>
        {isLoading ? "Logging in..." : "Login"}
      <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> LoginForm;
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// LoginForm.test.jsx</span>
<span class="hljs-keyword">import</span> { render, screen, waitFor } <span class="hljs-keyword">from</span> <span class="hljs-string">"../test-utils"</span>;
<span class="hljs-keyword">import</span> userEvent <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/user-event"</span>;
<span class="hljs-keyword">import</span> LoginForm <span class="hljs-keyword">from</span> <span class="hljs-string">"./LoginForm"</span>;

describe(<span class="hljs-string">"LoginForm"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> mockOnSubmit = jest.fn();

  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    mockOnSubmit.mockClear();
  });

  it(<span class="hljs-string">"renders form fields"</span>, () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{mockOnSubmit}</span> /&gt;</span></span>);

    expect(screen.getByLabelText(<span class="hljs-regexp">/email/i</span>)).toBeInTheDocument();
    expect(screen.getByLabelText(<span class="hljs-regexp">/password/i</span>)).toBeInTheDocument();
    expect(screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/login/i</span> })).toBeInTheDocument();
  });

  it(<span class="hljs-string">"submits form with valid data"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{mockOnSubmit}</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> user.type(screen.getByLabelText(<span class="hljs-regexp">/email/i</span>), <span class="hljs-string">"test@example.com"</span>);
    <span class="hljs-keyword">await</span> user.type(screen.getByLabelText(<span class="hljs-regexp">/password/i</span>), <span class="hljs-string">"password123"</span>);
    <span class="hljs-keyword">await</span> user.click(screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/login/i</span> }));

    expect(mockOnSubmit).toHaveBeenCalledWith({
      <span class="hljs-attr">email</span>: <span class="hljs-string">"test@example.com"</span>,
      <span class="hljs-attr">password</span>: <span class="hljs-string">"password123"</span>,
    });
  });

  it(<span class="hljs-string">"shows validation errors for empty fields"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{mockOnSubmit}</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> user.click(screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/login/i</span> }));

    expect(
      screen.getByRole(<span class="hljs-string">"alert"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/email is required/i</span> })
    ).toBeInTheDocument();
    expect(
      screen.getByRole(<span class="hljs-string">"alert"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/password is required/i</span> })
    ).toBeInTheDocument();
    expect(mockOnSubmit).not.toHaveBeenCalled();
  });

  it(<span class="hljs-string">"shows validation error for invalid email"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{mockOnSubmit}</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> user.type(screen.getByLabelText(<span class="hljs-regexp">/email/i</span>), <span class="hljs-string">"invalid-email"</span>);
    <span class="hljs-keyword">await</span> user.type(screen.getByLabelText(<span class="hljs-regexp">/password/i</span>), <span class="hljs-string">"password123"</span>);
    <span class="hljs-keyword">await</span> user.click(screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/login/i</span> }));

    expect(
      screen.getByRole(<span class="hljs-string">"alert"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/email is invalid/i</span> })
    ).toBeInTheDocument();
    expect(mockOnSubmit).not.toHaveBeenCalled();
  });

  it(<span class="hljs-string">"shows validation error for short password"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{mockOnSubmit}</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> user.type(screen.getByLabelText(<span class="hljs-regexp">/email/i</span>), <span class="hljs-string">"test@example.com"</span>);
    <span class="hljs-keyword">await</span> user.type(screen.getByLabelText(<span class="hljs-regexp">/password/i</span>), <span class="hljs-string">"123"</span>);
    <span class="hljs-keyword">await</span> user.click(screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/login/i</span> }));

    expect(
      screen.getByRole(<span class="hljs-string">"alert"</span>, {
        <span class="hljs-attr">name</span>: <span class="hljs-regexp">/password must be at least 6 characters/i</span>,
      })
    ).toBeInTheDocument();
    expect(mockOnSubmit).not.toHaveBeenCalled();
  });

  it(<span class="hljs-string">"disables submit button when loading"</span>, () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{mockOnSubmit}</span> <span class="hljs-attr">isLoading</span>=<span class="hljs-string">{true}</span> /&gt;</span></span>);

    expect(screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/logging in/i</span> })).toBeDisabled();
  });

  it(<span class="hljs-string">"clears errors when user starts typing"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LoginForm</span> <span class="hljs-attr">onSubmit</span>=<span class="hljs-string">{mockOnSubmit}</span> /&gt;</span></span>);

    <span class="hljs-comment">// Trigger validation errors</span>
    <span class="hljs-keyword">await</span> user.click(screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/login/i</span> }));
    expect(
      screen.getByRole(<span class="hljs-string">"alert"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/email is required/i</span> })
    ).toBeInTheDocument();

    <span class="hljs-comment">// Start typing to clear error</span>
    <span class="hljs-keyword">await</span> user.type(screen.getByLabelText(<span class="hljs-regexp">/email/i</span>), <span class="hljs-string">"test@example.com"</span>);

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(
        screen.queryByRole(<span class="hljs-string">"alert"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/email is required/i</span> })
      ).not.toBeInTheDocument();
    });
  });
});
</div></code></pre>
<h2 id="%F0%9F%AA%9D-testing-custom-hooks">🪝 Testing Custom Hooks</h2>
<h3 id="testing-hooks-with-renderhook">Testing Hooks with renderHook</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// useCounter.js</span>
<span class="hljs-keyword">import</span> { useState, useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useCounter</span>(<span class="hljs-params">initialValue = <span class="hljs-number">0</span></span>) </span>{
  <span class="hljs-keyword">const</span> [count, setCount] = useState(initialValue);

  <span class="hljs-keyword">const</span> increment = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">const</span> decrement = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev - <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">const</span> reset = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setCount(initialValue);
  }, [initialValue]);

  <span class="hljs-keyword">const</span> setValue = useCallback(<span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> {
    setCount(value);
  }, []);

  <span class="hljs-keyword">return</span> {
    count,
    increment,
    decrement,
    reset,
    setValue,
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useCounter;
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// useCounter.test.js</span>
<span class="hljs-keyword">import</span> { renderHook, act } <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/react"</span>;
<span class="hljs-keyword">import</span> useCounter <span class="hljs-keyword">from</span> <span class="hljs-string">"./useCounter"</span>;

describe(<span class="hljs-string">"useCounter"</span>, () =&gt; {
  it(<span class="hljs-string">"initializes with default value"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter());

    expect(result.current.count).toBe(<span class="hljs-number">0</span>);
  });

  it(<span class="hljs-string">"initializes with custom value"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter(<span class="hljs-number">10</span>));

    expect(result.current.count).toBe(<span class="hljs-number">10</span>);
  });

  it(<span class="hljs-string">"increments count"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter());

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.increment();
    });

    expect(result.current.count).toBe(<span class="hljs-number">1</span>);
  });

  it(<span class="hljs-string">"decrements count"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter(<span class="hljs-number">5</span>));

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.decrement();
    });

    expect(result.current.count).toBe(<span class="hljs-number">4</span>);
  });

  it(<span class="hljs-string">"resets to initial value"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter(<span class="hljs-number">10</span>));

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.increment();
      result.current.increment();
    });

    expect(result.current.count).toBe(<span class="hljs-number">12</span>);

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.reset();
    });

    expect(result.current.count).toBe(<span class="hljs-number">10</span>);
  });

  it(<span class="hljs-string">"sets specific value"</span>, () =&gt; {
    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter());

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.setValue(<span class="hljs-number">42</span>);
    });

    expect(result.current.count).toBe(<span class="hljs-number">42</span>);
  });

  it(<span class="hljs-string">"updates reset when initial value changes"</span>, () =&gt; {
    <span class="hljs-keyword">let</span> initialValue = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">const</span> { result, rerender } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useCounter(initialValue));

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.increment();
    });

    expect(result.current.count).toBe(<span class="hljs-number">1</span>);

    <span class="hljs-comment">// Change initial value and rerender</span>
    initialValue = <span class="hljs-number">10</span>;
    rerender();

    act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      result.current.reset();
    });

    expect(result.current.count).toBe(<span class="hljs-number">10</span>);
  });
});
</div></code></pre>
<h3 id="testing-async-hooks">Testing Async Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// useApi.js</span>
<span class="hljs-keyword">import</span> { useState, useEffect, useCallback } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useApi</span>(<span class="hljs-params">url, options = {}</span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> fetchData = useCallback(<span class="hljs-keyword">async</span> () =&gt; {
    setLoading(<span class="hljs-literal">true</span>);
    setError(<span class="hljs-literal">null</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(url, options);

      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`HTTP <span class="hljs-subst">${response.status}</span>: <span class="hljs-subst">${response.statusText}</span>`</span>);
      }

      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
      setData(result);
    } <span class="hljs-keyword">catch</span> (err) {
      setError(err.message);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  }, [url, options]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (url) {
      fetchData();
    }
  }, [fetchData, url]);

  <span class="hljs-keyword">const</span> refetch = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetchData();
  }, [fetchData]);

  <span class="hljs-keyword">return</span> {
    data,
    loading,
    error,
    refetch,
  };
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> useApi;
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// useApi.test.js</span>
<span class="hljs-keyword">import</span> { renderHook, waitFor } <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/react"</span>;
<span class="hljs-keyword">import</span> useApi <span class="hljs-keyword">from</span> <span class="hljs-string">"./useApi"</span>;

<span class="hljs-comment">// Mock fetch</span>
global.fetch = jest.fn();

describe(<span class="hljs-string">"useApi"</span>, () =&gt; {
  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    fetch.mockClear();
  });

  it(<span class="hljs-string">"fetches data successfully"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> mockData = { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Test"</span> };

    fetch.mockResolvedValueOnce({
      <span class="hljs-attr">ok</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">json</span>: <span class="hljs-keyword">async</span> () =&gt; mockData,
    });

    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useApi(<span class="hljs-string">"/api/test"</span>));

    expect(result.current.loading).toBe(<span class="hljs-literal">true</span>);
    expect(result.current.data).toBe(<span class="hljs-literal">null</span>);
    expect(result.current.error).toBe(<span class="hljs-literal">null</span>);

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(result.current.loading).toBe(<span class="hljs-literal">false</span>);
    });

    expect(result.current.data).toEqual(mockData);
    expect(result.current.error).toBe(<span class="hljs-literal">null</span>);
    expect(fetch).toHaveBeenCalledWith(<span class="hljs-string">"/api/test"</span>, {});
  });

  it(<span class="hljs-string">"handles fetch error"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    fetch.mockRejectedValueOnce(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Network error"</span>));

    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useApi(<span class="hljs-string">"/api/test"</span>));

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(result.current.loading).toBe(<span class="hljs-literal">false</span>);
    });

    expect(result.current.data).toBe(<span class="hljs-literal">null</span>);
    expect(result.current.error).toBe(<span class="hljs-string">"Network error"</span>);
  });

  it(<span class="hljs-string">"handles HTTP error status"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    fetch.mockResolvedValueOnce({
      <span class="hljs-attr">ok</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">status</span>: <span class="hljs-number">404</span>,
      <span class="hljs-attr">statusText</span>: <span class="hljs-string">"Not Found"</span>,
    });

    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useApi(<span class="hljs-string">"/api/test"</span>));

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(result.current.loading).toBe(<span class="hljs-literal">false</span>);
    });

    expect(result.current.data).toBe(<span class="hljs-literal">null</span>);
    expect(result.current.error).toBe(<span class="hljs-string">"HTTP 404: Not Found"</span>);
  });

  it(<span class="hljs-string">"refetches data when refetch is called"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> mockData = { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Test"</span> };

    fetch.mockResolvedValue({
      <span class="hljs-attr">ok</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">json</span>: <span class="hljs-keyword">async</span> () =&gt; mockData,
    });

    <span class="hljs-keyword">const</span> { result } = renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useApi(<span class="hljs-string">"/api/test"</span>));

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(result.current.loading).toBe(<span class="hljs-literal">false</span>);
    });

    expect(fetch).toHaveBeenCalledTimes(<span class="hljs-number">1</span>);

    <span class="hljs-comment">// Call refetch</span>
    result.current.refetch();

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(fetch).toHaveBeenCalledTimes(<span class="hljs-number">2</span>);
    });
  });

  it(<span class="hljs-string">"does not fetch when url is null"</span>, () =&gt; {
    renderHook(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> useApi(<span class="hljs-literal">null</span>));

    expect(fetch).not.toHaveBeenCalled();
  });
});
</div></code></pre>
<h2 id="%F0%9F%8E%AD-mocking-dependencies">🎭 Mocking Dependencies</h2>
<h3 id="mocking-external-libraries">Mocking External Libraries</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Mock axios</span>
jest.mock(<span class="hljs-string">'axios'</span>);
<span class="hljs-keyword">const</span> mockedAxios = axios <span class="hljs-keyword">as</span> jest.Mocked&lt;<span class="hljs-keyword">typeof</span> axios&gt;;

<span class="hljs-comment">// Mock React Router</span>
jest.mock(<span class="hljs-string">'react-router-dom'</span>, () =&gt; ({
  ...jest.requireActual(<span class="hljs-string">'react-router-dom'</span>),
  <span class="hljs-attr">useNavigate</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> jest.fn(),
  <span class="hljs-attr">useParams</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> ({ <span class="hljs-attr">id</span>: <span class="hljs-string">'123'</span> }),
}));

<span class="hljs-comment">// Mock date-fns</span>
jest.mock(<span class="hljs-string">'date-fns'</span>, () =&gt; ({
  <span class="hljs-attr">format</span>: jest.fn(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-string">'2024-01-01'</span>),
  <span class="hljs-attr">isValid</span>: jest.fn(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-literal">true</span>),
}));
</div></code></pre>
<h3 id="mocking-custom-hooks">Mocking Custom Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// Mock custom hook</span>
jest.mock(<span class="hljs-string">'../hooks/useAuth'</span>);
<span class="hljs-keyword">const</span> mockUseAuth = useAuth <span class="hljs-keyword">as</span> jest.MockedFunction&lt;<span class="hljs-keyword">typeof</span> useAuth&gt;;

describe(<span class="hljs-string">'ProtectedComponent'</span>, () =&gt; {
  it(<span class="hljs-string">'renders when user is authenticated'</span>, () =&gt; {
    mockUseAuth.mockReturnValue({
      <span class="hljs-attr">user</span>: { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'John'</span> },
      <span class="hljs-attr">isAuthenticated</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">login</span>: jest.fn(),
      <span class="hljs-attr">logout</span>: jest.fn(),
    });

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ProtectedComponent</span> /&gt;</span></span>);

    expect(screen.getByText(<span class="hljs-string">'Welcome, John!'</span>)).toBeInTheDocument();
  });

  it(<span class="hljs-string">'shows login prompt when user is not authenticated'</span>, () =&gt; {
    mockUseAuth.mockReturnValue({
      <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">isAuthenticated</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">login</span>: jest.fn(),
      <span class="hljs-attr">logout</span>: jest.fn(),
    });

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">ProtectedComponent</span> /&gt;</span></span>);

    expect(screen.getByText(<span class="hljs-string">'Please log in'</span>)).toBeInTheDocument();
  });
});
</div></code></pre>
<h3 id="mocking-api-calls-with-msw">Mocking API Calls with MSW</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/mocks/handlers.js</span>
<span class="hljs-keyword">import</span> { rest } <span class="hljs-keyword">from</span> <span class="hljs-string">"msw"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> handlers = [
  <span class="hljs-comment">// Mock GET request</span>
  rest.get(<span class="hljs-string">"/api/users"</span>, (req, res, ctx) =&gt; {
    <span class="hljs-keyword">return</span> res(
      ctx.status(<span class="hljs-number">200</span>),
      ctx.json([
        { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> },
        { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"Jane Smith"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"jane@example.com"</span> },
      ])
    );
  }),

  <span class="hljs-comment">// Mock POST request</span>
  rest.post(<span class="hljs-string">"/api/users"</span>, (req, res, ctx) =&gt; {
    <span class="hljs-keyword">return</span> res(ctx.status(<span class="hljs-number">201</span>), ctx.json({ <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, ...req.body }));
  }),

  <span class="hljs-comment">// Mock error response</span>
  rest.get(<span class="hljs-string">"/api/error"</span>, (req, res, ctx) =&gt; {
    <span class="hljs-keyword">return</span> res(ctx.status(<span class="hljs-number">500</span>), ctx.json({ <span class="hljs-attr">message</span>: <span class="hljs-string">"Internal server error"</span> }));
  }),
];
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// src/mocks/server.js</span>
<span class="hljs-keyword">import</span> { setupServer } <span class="hljs-keyword">from</span> <span class="hljs-string">"msw/node"</span>;
<span class="hljs-keyword">import</span> { handlers } <span class="hljs-keyword">from</span> <span class="hljs-string">"./handlers"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> server = setupServer(...handlers);
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// src/setupTests.js</span>
<span class="hljs-keyword">import</span> { server } <span class="hljs-keyword">from</span> <span class="hljs-string">"./mocks/server"</span>;

<span class="hljs-comment">// Enable API mocking before tests</span>
beforeAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> server.listen());

<span class="hljs-comment">// Reset any request handlers that are declared as a part of our tests</span>
afterEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> server.resetHandlers());

<span class="hljs-comment">// Clean up after the tests are finished</span>
afterAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> server.close());
</div></code></pre>
<h2 id="%F0%9F%94%84-testing-async-operations">🔄 Testing Async Operations</h2>
<h3 id="testing-components-with-async-data">Testing Components with Async Data</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// UserList.jsx</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [users, setUsers] = useState([]);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">true</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> fetchUsers = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/users"</span>);
        <span class="hljs-keyword">if</span> (!response.ok) {
          <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed to fetch users"</span>);
        }
        <span class="hljs-keyword">const</span> data = <span class="hljs-keyword">await</span> response.json();
        setUsers(data);
      } <span class="hljs-keyword">catch</span> (err) {
        setError(err.message);
      } <span class="hljs-keyword">finally</span> {
        setLoading(<span class="hljs-literal">false</span>);
      }
    };

    fetchUsers();
  }, []);

  <span class="hljs-keyword">if</span> (loading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading users...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Users<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {users.map((user) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>
            {user.name} - {user.email}
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> UserList;
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// UserList.test.jsx</span>
<span class="hljs-keyword">import</span> { render, screen, waitFor } <span class="hljs-keyword">from</span> <span class="hljs-string">"../test-utils"</span>;
<span class="hljs-keyword">import</span> { server } <span class="hljs-keyword">from</span> <span class="hljs-string">"../mocks/server"</span>;
<span class="hljs-keyword">import</span> { rest } <span class="hljs-keyword">from</span> <span class="hljs-string">"msw"</span>;
<span class="hljs-keyword">import</span> UserList <span class="hljs-keyword">from</span> <span class="hljs-string">"./UserList"</span>;

describe(<span class="hljs-string">"UserList"</span>, () =&gt; {
  it(<span class="hljs-string">"displays loading state initially"</span>, () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserList</span> /&gt;</span></span>);

    expect(screen.getByText(<span class="hljs-string">"Loading users..."</span>)).toBeInTheDocument();
  });

  it(<span class="hljs-string">"displays users after successful fetch"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserList</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(screen.getByText(<span class="hljs-string">"Users"</span>)).toBeInTheDocument();
    });

    expect(screen.getByText(<span class="hljs-string">"John Doe - john@example.com"</span>)).toBeInTheDocument();
    expect(
      screen.getByText(<span class="hljs-string">"Jane Smith - jane@example.com"</span>)
    ).toBeInTheDocument();
  });

  it(<span class="hljs-string">"displays error message when fetch fails"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-comment">// Override the default handler for this test</span>
    server.use(
      rest.get(<span class="hljs-string">"/api/users"</span>, (req, res, ctx) =&gt; {
        <span class="hljs-keyword">return</span> res(ctx.status(<span class="hljs-number">500</span>), ctx.json({ <span class="hljs-attr">message</span>: <span class="hljs-string">"Server error"</span> }));
      })
    );

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserList</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(
        screen.getByText(<span class="hljs-string">"Error: Failed to fetch users"</span>)
      ).toBeInTheDocument();
    });
  });

  it(<span class="hljs-string">"does not show loading state after data is loaded"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserList</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(screen.queryByText(<span class="hljs-string">"Loading users..."</span>)).not.toBeInTheDocument();
    });
  });
});
</div></code></pre>
<h3 id="testing-with-react-query">Testing with React Query</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// UserListWithQuery.jsx</span>
<span class="hljs-keyword">import</span> { useQuery } <span class="hljs-keyword">from</span> <span class="hljs-string">"@tanstack/react-query"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">UserListWithQuery</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> {
    <span class="hljs-attr">data</span>: users,
    isLoading,
    error,
    refetch,
  } = useQuery({
    <span class="hljs-attr">queryKey</span>: [<span class="hljs-string">"users"</span>],
    <span class="hljs-attr">queryFn</span>: <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/users"</span>);
      <span class="hljs-keyword">if</span> (!response.ok) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Failed to fetch users"</span>);
      }
      <span class="hljs-keyword">return</span> response.json();
    },
  });

  <span class="hljs-keyword">if</span> (isLoading) <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading users...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Error: {error.message}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> refetch()}&gt;Retry<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Users<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> refetch()}&gt;Refresh<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
        {users?.map((user) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{user.id}</span>&gt;</span>
            {user.name} - {user.email}
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> UserListWithQuery;
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// UserListWithQuery.test.jsx</span>
<span class="hljs-keyword">import</span> { render, screen, waitFor } <span class="hljs-keyword">from</span> <span class="hljs-string">"../test-utils"</span>;
<span class="hljs-keyword">import</span> { server } <span class="hljs-keyword">from</span> <span class="hljs-string">"../mocks/server"</span>;
<span class="hljs-keyword">import</span> { rest } <span class="hljs-keyword">from</span> <span class="hljs-string">"msw"</span>;
<span class="hljs-keyword">import</span> userEvent <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/user-event"</span>;
<span class="hljs-keyword">import</span> UserListWithQuery <span class="hljs-keyword">from</span> <span class="hljs-string">"./UserListWithQuery"</span>;

describe(<span class="hljs-string">"UserListWithQuery"</span>, () =&gt; {
  it(<span class="hljs-string">"displays users and allows refresh"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserListWithQuery</span> /&gt;</span></span>);

    <span class="hljs-comment">// Wait for initial load</span>
    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(screen.getByText(<span class="hljs-string">"Users"</span>)).toBeInTheDocument();
    });

    expect(screen.getByText(<span class="hljs-string">"John Doe - john@example.com"</span>)).toBeInTheDocument();

    <span class="hljs-comment">// Test refresh functionality</span>
    <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Refresh"</span>));

    <span class="hljs-comment">// Should still show users after refresh</span>
    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(
        screen.getByText(<span class="hljs-string">"John Doe - john@example.com"</span>)
      ).toBeInTheDocument();
    });
  });

  it(<span class="hljs-string">"shows retry button on error"</span>, <span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> user = userEvent.setup();

    <span class="hljs-comment">// Mock error response</span>
    server.use(
      rest.get(<span class="hljs-string">"/api/users"</span>, (req, res, ctx) =&gt; {
        <span class="hljs-keyword">return</span> res(ctx.status(<span class="hljs-number">500</span>), ctx.json({ <span class="hljs-attr">message</span>: <span class="hljs-string">"Server error"</span> }));
      })
    );

    render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">UserListWithQuery</span> /&gt;</span></span>);

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(screen.getByText(<span class="hljs-regexp">/Error:/</span>)).toBeInTheDocument();
    });

    expect(screen.getByText(<span class="hljs-string">"Retry"</span>)).toBeInTheDocument();

    <span class="hljs-comment">// Reset to successful response</span>
    server.use(
      rest.get(<span class="hljs-string">"/api/users"</span>, (req, res, ctx) =&gt; {
        <span class="hljs-keyword">return</span> res(
          ctx.status(<span class="hljs-number">200</span>),
          ctx.json([{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">"John Doe"</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">"john@example.com"</span> }])
        );
      })
    );

    <span class="hljs-comment">// Click retry</span>
    <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Retry"</span>));

    <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      expect(
        screen.getByText(<span class="hljs-string">"John Doe - john@example.com"</span>)
      ).toBeInTheDocument();
    });
  });
});
</div></code></pre>
<h2 id="%F0%9F%8E%AF-mini-challenge-build-a-comprehensive-test-suite">🎯 Mini-Challenge: Build a Comprehensive Test Suite</h2>
<h3 id="challenge-test-a-todo-application">Challenge: Test a Todo Application</h3>
<p>Create comprehensive tests for a todo application with the following features:</p>
<ul>
<li>Add new todos</li>
<li>Mark todos as complete</li>
<li>Delete todos</li>
<li>Filter todos (all, active, completed)</li>
<li>Persist todos to localStorage</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// TodoApp.jsx - Your task: Write comprehensive tests for this component</span>
<span class="hljs-keyword">import</span> { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TodoApp</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [todos, setTodos] = useState([]);
  <span class="hljs-keyword">const</span> [filter, setFilter] = useState(<span class="hljs-string">"all"</span>);
  <span class="hljs-keyword">const</span> [newTodo, setNewTodo] = useState(<span class="hljs-string">""</span>);

  <span class="hljs-comment">// Load todos from localStorage on mount</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> savedTodos = localStorage.getItem(<span class="hljs-string">"todos"</span>);
    <span class="hljs-keyword">if</span> (savedTodos) {
      setTodos(<span class="hljs-built_in">JSON</span>.parse(savedTodos));
    }
  }, []);

  <span class="hljs-comment">// Save todos to localStorage whenever todos change</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    localStorage.setItem(<span class="hljs-string">"todos"</span>, <span class="hljs-built_in">JSON</span>.stringify(todos));
  }, [todos]);

  <span class="hljs-keyword">const</span> addTodo = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (newTodo.trim()) {
      <span class="hljs-keyword">const</span> todo = {
        <span class="hljs-attr">id</span>: <span class="hljs-built_in">Date</span>.now(),
        <span class="hljs-attr">text</span>: newTodo.trim(),
        <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">createdAt</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
      };
      setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> [...prev, todo]);
      setNewTodo(<span class="hljs-string">""</span>);
    }
  };

  <span class="hljs-keyword">const</span> toggleTodo = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span>
      prev.map(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span>
        todo.id === id ? { ...todo, <span class="hljs-attr">completed</span>: !todo.completed } : todo
      )
    );
  };

  <span class="hljs-keyword">const</span> deleteTodo = <span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.id !== id));
  };

  <span class="hljs-keyword">const</span> clearCompleted = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setTodos(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> !todo.completed));
  };

  <span class="hljs-keyword">const</span> filteredTodos = todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (filter === <span class="hljs-string">"active"</span>) <span class="hljs-keyword">return</span> !todo.completed;
    <span class="hljs-keyword">if</span> (filter === <span class="hljs-string">"completed"</span>) <span class="hljs-keyword">return</span> todo.completed;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });

  <span class="hljs-keyword">const</span> activeCount = todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> !todo.completed).length;
  <span class="hljs-keyword">const</span> completedCount = todos.filter(<span class="hljs-function">(<span class="hljs-params">todo</span>) =&gt;</span> todo.completed).length;

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-app"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Todo App<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"add-todo"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{newTodo}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span> setNewTodo(e.target.value)}
          onKeyPress={(e) =&gt; e.key === "Enter" &amp;&amp; addTodo()}
          placeholder="What needs to be done?"
          aria-label="New todo"
        /&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{addTodo}</span>&gt;</span>Add<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filters"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{filter</span> === <span class="hljs-string">"all"</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFilter("all")}
        &gt;
          All ({todos.length})
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{filter</span> === <span class="hljs-string">"active"</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFilter("active")}
        &gt;
          Active ({activeCount})
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{filter</span> === <span class="hljs-string">"completed"</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setFilter("completed")}
        &gt;
          Completed ({completedCount})
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-list"</span>&gt;</span>
        {filteredTodos.map((todo) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{todo.id}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{todo.completed</span> ? "<span class="hljs-attr">completed</span>" <span class="hljs-attr">:</span> ""}&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
              <span class="hljs-attr">type</span>=<span class="hljs-string">"checkbox"</span>
              <span class="hljs-attr">checked</span>=<span class="hljs-string">{todo.completed}</span>
              <span class="hljs-attr">onChange</span>=<span class="hljs-string">{()</span> =&gt;</span> toggleTodo(todo.id)}
              aria-label={`Mark "${todo.text}" as ${
                todo.completed ? "incomplete" : "complete"
              }`}
            /&gt;
            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"todo-text"</span>&gt;</span>{todo.text}<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
              <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> deleteTodo(todo.id)}
              aria-label={`Delete "${todo.text}"`}
            &gt;
              Delete
            <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>

      {completedCount &gt; 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{clearCompleted}</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"clear-completed"</span>&gt;</span>
          Clear Completed ({completedCount})
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      )}

      {todos.length === 0 &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"empty-state"</span>&gt;</span>No todos yet. Add one above!<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> TodoApp;
</div></code></pre>
<h3 id="solution-comprehensive-todo-app-tests">Solution: Comprehensive Todo App Tests</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// TodoApp.test.jsx</span>
<span class="hljs-keyword">import</span> { render, screen, waitFor } <span class="hljs-keyword">from</span> <span class="hljs-string">"../test-utils"</span>;
<span class="hljs-keyword">import</span> userEvent <span class="hljs-keyword">from</span> <span class="hljs-string">"@testing-library/user-event"</span>;
<span class="hljs-keyword">import</span> TodoApp <span class="hljs-keyword">from</span> <span class="hljs-string">"./TodoApp"</span>;

<span class="hljs-comment">// Mock localStorage</span>
<span class="hljs-keyword">const</span> localStorageMock = {
  <span class="hljs-attr">getItem</span>: jest.fn(),
  <span class="hljs-attr">setItem</span>: jest.fn(),
  <span class="hljs-attr">removeItem</span>: jest.fn(),
  <span class="hljs-attr">clear</span>: jest.fn(),
};
global.localStorage = localStorageMock;

describe(<span class="hljs-string">"TodoApp"</span>, () =&gt; {
  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    localStorageMock.getItem.mockClear();
    localStorageMock.setItem.mockClear();
    localStorageMock.removeItem.mockClear();
    localStorageMock.clear.mockClear();
  });

  describe(<span class="hljs-string">"Initial Render"</span>, () =&gt; {
    it(<span class="hljs-string">"renders the todo app with empty state"</span>, () =&gt; {
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      expect(screen.getByText(<span class="hljs-string">"Todo App"</span>)).toBeInTheDocument();
      expect(
        screen.getByPlaceholderText(<span class="hljs-string">"What needs to be done?"</span>)
      ).toBeInTheDocument();
      expect(
        screen.getByText(<span class="hljs-string">"No todos yet. Add one above!"</span>)
      ).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"All (0)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active (0)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed (0)"</span>)).toBeInTheDocument();
    });

    it(<span class="hljs-string">"loads todos from localStorage on mount"</span>, () =&gt; {
      <span class="hljs-keyword">const</span> savedTodos = [
        { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Test todo"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-01"</span> },
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Completed todo"</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-02"</span>,
        },
      ];

      localStorageMock.getItem.mockReturnValue(<span class="hljs-built_in">JSON</span>.stringify(savedTodos));

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      expect(screen.getByText(<span class="hljs-string">"Test todo"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed todo"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"All (2)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active (1)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed (1)"</span>)).toBeInTheDocument();
    });
  });

  describe(<span class="hljs-string">"Adding Todos"</span>, () =&gt; {
    it(<span class="hljs-string">"adds a new todo when clicking Add button"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> input = screen.getByPlaceholderText(<span class="hljs-string">"What needs to be done?"</span>);
      <span class="hljs-keyword">const</span> addButton = screen.getByText(<span class="hljs-string">"Add"</span>);

      <span class="hljs-keyword">await</span> user.type(input, <span class="hljs-string">"New todo item"</span>);
      <span class="hljs-keyword">await</span> user.click(addButton);

      expect(screen.getByText(<span class="hljs-string">"New todo item"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"All (1)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active (1)"</span>)).toBeInTheDocument();
      expect(input).toHaveValue(<span class="hljs-string">""</span>);
    });

    it(<span class="hljs-string">"adds a new todo when pressing Enter"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> input = screen.getByPlaceholderText(<span class="hljs-string">"What needs to be done?"</span>);

      <span class="hljs-keyword">await</span> user.type(input, <span class="hljs-string">"New todo item{enter}"</span>);

      expect(screen.getByText(<span class="hljs-string">"New todo item"</span>)).toBeInTheDocument();
      expect(input).toHaveValue(<span class="hljs-string">""</span>);
    });

    it(<span class="hljs-string">"does not add empty todos"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> addButton = screen.getByText(<span class="hljs-string">"Add"</span>);

      <span class="hljs-keyword">await</span> user.click(addButton);

      expect(
        screen.getByText(<span class="hljs-string">"No todos yet. Add one above!"</span>)
      ).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"All (0)"</span>)).toBeInTheDocument();
    });

    it(<span class="hljs-string">"trims whitespace from todo text"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> input = screen.getByPlaceholderText(<span class="hljs-string">"What needs to be done?"</span>);

      <span class="hljs-keyword">await</span> user.type(input, <span class="hljs-string">"  Trimmed todo  "</span>);
      <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Add"</span>));

      expect(screen.getByText(<span class="hljs-string">"Trimmed todo"</span>)).toBeInTheDocument();
    });
  });

  describe(<span class="hljs-string">"Todo Interactions"</span>, () =&gt; {
    beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> savedTodos = [
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Active todo"</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-01"</span>,
        },
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Completed todo"</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-02"</span>,
        },
      ];
      localStorageMock.getItem.mockReturnValue(<span class="hljs-built_in">JSON</span>.stringify(savedTodos));
    });

    it(<span class="hljs-string">"toggles todo completion status"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> activeCheckbox = screen.getByLabelText(
        <span class="hljs-string">'Mark "Active todo" as complete'</span>
      );
      <span class="hljs-keyword">const</span> completedCheckbox = screen.getByLabelText(
        <span class="hljs-string">'Mark "Completed todo" as incomplete'</span>
      );

      expect(activeCheckbox).not.toBeChecked();
      expect(completedCheckbox).toBeChecked();

      <span class="hljs-keyword">await</span> user.click(activeCheckbox);

      expect(activeCheckbox).toBeChecked();
      expect(screen.getByText(<span class="hljs-string">"Active (0)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed (2)"</span>)).toBeInTheDocument();

      <span class="hljs-keyword">await</span> user.click(completedCheckbox);

      expect(completedCheckbox).not.toBeChecked();
      expect(screen.getByText(<span class="hljs-string">"Active (1)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed (1)"</span>)).toBeInTheDocument();
    });

    it(<span class="hljs-string">"deletes todos"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> deleteButton = screen.getByLabelText(<span class="hljs-string">'Delete "Active todo"'</span>);

      <span class="hljs-keyword">await</span> user.click(deleteButton);

      expect(screen.queryByText(<span class="hljs-string">"Active todo"</span>)).not.toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed todo"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"All (1)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active (0)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed (1)"</span>)).toBeInTheDocument();
    });

    it(<span class="hljs-string">"clears completed todos"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> clearButton = screen.getByText(<span class="hljs-string">"Clear Completed (1)"</span>);

      <span class="hljs-keyword">await</span> user.click(clearButton);

      expect(screen.queryByText(<span class="hljs-string">"Completed todo"</span>)).not.toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active todo"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"All (1)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active (1)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed (0)"</span>)).toBeInTheDocument();
      expect(screen.queryByText(<span class="hljs-string">"Clear Completed"</span>)).not.toBeInTheDocument();
    });
  });

  describe(<span class="hljs-string">"Filtering"</span>, () =&gt; {
    beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> savedTodos = [
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Active todo 1"</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-01"</span>,
        },
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Active todo 2"</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-02"</span>,
        },
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">3</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Completed todo 1"</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-03"</span>,
        },
        {
          <span class="hljs-attr">id</span>: <span class="hljs-number">4</span>,
          <span class="hljs-attr">text</span>: <span class="hljs-string">"Completed todo 2"</span>,
          <span class="hljs-attr">completed</span>: <span class="hljs-literal">true</span>,
          <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-04"</span>,
        },
      ];
      localStorageMock.getItem.mockReturnValue(<span class="hljs-built_in">JSON</span>.stringify(savedTodos));
    });

    it(<span class="hljs-string">"shows all todos by default"</span>, () =&gt; {
      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      expect(screen.getByText(<span class="hljs-string">"Active todo 1"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active todo 2"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed todo 1"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed todo 2"</span>)).toBeInTheDocument();

      <span class="hljs-keyword">const</span> allButton = screen.getByText(<span class="hljs-string">"All (4)"</span>);
      expect(allButton).toHaveClass(<span class="hljs-string">"active"</span>);
    });

    it(<span class="hljs-string">"filters to show only active todos"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Active (2)"</span>));

      expect(screen.getByText(<span class="hljs-string">"Active todo 1"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active todo 2"</span>)).toBeInTheDocument();
      expect(screen.queryByText(<span class="hljs-string">"Completed todo 1"</span>)).not.toBeInTheDocument();
      expect(screen.queryByText(<span class="hljs-string">"Completed todo 2"</span>)).not.toBeInTheDocument();

      <span class="hljs-keyword">const</span> activeButton = screen.getByText(<span class="hljs-string">"Active (2)"</span>);
      expect(activeButton).toHaveClass(<span class="hljs-string">"active"</span>);
    });

    it(<span class="hljs-string">"filters to show only completed todos"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Completed (2)"</span>));

      expect(screen.queryByText(<span class="hljs-string">"Active todo 1"</span>)).not.toBeInTheDocument();
      expect(screen.queryByText(<span class="hljs-string">"Active todo 2"</span>)).not.toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed todo 1"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed todo 2"</span>)).toBeInTheDocument();

      <span class="hljs-keyword">const</span> completedButton = screen.getByText(<span class="hljs-string">"Completed (2)"</span>);
      expect(completedButton).toHaveClass(<span class="hljs-string">"active"</span>);
    });

    it(<span class="hljs-string">"updates filter counts when todos change"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-comment">// Toggle an active todo to completed</span>
      <span class="hljs-keyword">await</span> user.click(
        screen.getByLabelText(<span class="hljs-string">'Mark "Active todo 1" as complete'</span>)
      );

      expect(screen.getByText(<span class="hljs-string">"All (4)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Active (1)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Completed (3)"</span>)).toBeInTheDocument();
    });
  });

  describe(<span class="hljs-string">"LocalStorage Integration"</span>, () =&gt; {
    it(<span class="hljs-string">"saves todos to localStorage when todos change"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> input = screen.getByPlaceholderText(<span class="hljs-string">"What needs to be done?"</span>);

      <span class="hljs-keyword">await</span> user.type(input, <span class="hljs-string">"New todo"</span>);
      <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Add"</span>));

      <span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        expect(localStorageMock.setItem).toHaveBeenCalledWith(
          <span class="hljs-string">"todos"</span>,
          expect.stringContaining(<span class="hljs-string">"New todo"</span>)
        );
      });
    });

    it(<span class="hljs-string">"handles invalid localStorage data gracefully"</span>, () =&gt; {
      localStorageMock.getItem.mockReturnValue(<span class="hljs-string">"invalid json"</span>);

      <span class="hljs-comment">// Should not throw an error</span>
      expect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>)).not.toThrow();

      expect(
        screen.getByText(<span class="hljs-string">"No todos yet. Add one above!"</span>)
      ).toBeInTheDocument();
    });
  });

  describe(<span class="hljs-string">"Accessibility"</span>, () =&gt; {
    beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> savedTodos = [
        { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">text</span>: <span class="hljs-string">"Test todo"</span>, <span class="hljs-attr">completed</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">createdAt</span>: <span class="hljs-string">"2024-01-01"</span> },
      ];
      localStorageMock.getItem.mockReturnValue(<span class="hljs-built_in">JSON</span>.stringify(savedTodos));
    });

    it(<span class="hljs-string">"has proper ARIA labels for form controls"</span>, () =&gt; {
      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      expect(screen.getByLabelText(<span class="hljs-string">"New todo"</span>)).toBeInTheDocument();
      expect(
        screen.getByLabelText(<span class="hljs-string">'Mark "Test todo" as complete'</span>)
      ).toBeInTheDocument();
      expect(screen.getByLabelText(<span class="hljs-string">'Delete "Test todo"'</span>)).toBeInTheDocument();
    });

    it(<span class="hljs-string">"supports keyboard navigation"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> input = screen.getByLabelText(<span class="hljs-string">"New todo"</span>);

      <span class="hljs-comment">// Focus should start on input</span>
      <span class="hljs-keyword">await</span> user.tab();
      expect(input).toHaveFocus();

      <span class="hljs-comment">// Tab to Add button</span>
      <span class="hljs-keyword">await</span> user.tab();
      expect(screen.getByText(<span class="hljs-string">"Add"</span>)).toHaveFocus();

      <span class="hljs-comment">// Tab to filter buttons</span>
      <span class="hljs-keyword">await</span> user.tab();
      expect(screen.getByText(<span class="hljs-string">"All (1)"</span>)).toHaveFocus();
    });
  });

  describe(<span class="hljs-string">"Edge Cases"</span>, () =&gt; {
    it(<span class="hljs-string">"handles very long todo text"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      <span class="hljs-keyword">const</span> longText = <span class="hljs-string">"A"</span>.repeat(<span class="hljs-number">1000</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> input = screen.getByPlaceholderText(<span class="hljs-string">"What needs to be done?"</span>);

      <span class="hljs-keyword">await</span> user.type(input, longText);
      <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Add"</span>));

      expect(screen.getByText(longText)).toBeInTheDocument();
    });

    it(<span class="hljs-string">"handles rapid todo additions"</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> user = userEvent.setup();
      localStorageMock.getItem.mockReturnValue(<span class="hljs-literal">null</span>);

      render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TodoApp</span> /&gt;</span></span>);

      <span class="hljs-keyword">const</span> input = screen.getByPlaceholderText(<span class="hljs-string">"What needs to be done?"</span>);

      <span class="hljs-comment">// Add multiple todos quickly</span>
      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">5</span>; i++) {
        <span class="hljs-keyword">await</span> user.type(input, <span class="hljs-string">`Todo <span class="hljs-subst">${i}</span>`</span>);
        <span class="hljs-keyword">await</span> user.click(screen.getByText(<span class="hljs-string">"Add"</span>));
      }

      expect(screen.getByText(<span class="hljs-string">"All (5)"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Todo 1"</span>)).toBeInTheDocument();
      expect(screen.getByText(<span class="hljs-string">"Todo 5"</span>)).toBeInTheDocument();
    });
  });
});
</div></code></pre>
<h2 id="%F0%9F%8E%AF-best-practices-for-testing">🎯 Best Practices for Testing</h2>
<h3 id="1-test-structure-and-organization">1. Test Structure and Organization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Good test structure</span>
describe(<span class="hljs-string">"ComponentName"</span>, () =&gt; {
  <span class="hljs-comment">// Setup and teardown</span>
  beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Reset mocks, clear localStorage, etc.</span>
  });

  describe(<span class="hljs-string">"Rendering"</span>, () =&gt; {
    it(<span class="hljs-string">"renders with default props"</span>, () =&gt; {});
    it(<span class="hljs-string">"renders with custom props"</span>, () =&gt; {});
  });

  describe(<span class="hljs-string">"User Interactions"</span>, () =&gt; {
    it(<span class="hljs-string">"handles click events"</span>, () =&gt; {});
    it(<span class="hljs-string">"handles form submission"</span>, () =&gt; {});
  });

  describe(<span class="hljs-string">"Edge Cases"</span>, () =&gt; {
    it(<span class="hljs-string">"handles error states"</span>, () =&gt; {});
    it(<span class="hljs-string">"handles loading states"</span>, () =&gt; {});
  });
});
</div></code></pre>
<h3 id="2-query-priority">2. Query Priority</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Query priority (in order of preference)</span>

<span class="hljs-comment">// 1. Accessible to everyone (screen readers, etc.)</span>
screen.getByRole(<span class="hljs-string">"button"</span>, { <span class="hljs-attr">name</span>: <span class="hljs-regexp">/submit/i</span> });
screen.getByLabelText(<span class="hljs-regexp">/email/i</span>);
screen.getByPlaceholderText(<span class="hljs-regexp">/search/i</span>);
screen.getByText(<span class="hljs-regexp">/hello world/i</span>);

<span class="hljs-comment">// 2. Semantic queries</span>
screen.getByAltText(<span class="hljs-regexp">/profile picture/i</span>);
screen.getByTitle(<span class="hljs-regexp">/close/i</span>);

<span class="hljs-comment">// 3. Test IDs (last resort)</span>
screen.getByTestId(<span class="hljs-string">"submit-button"</span>);
</div></code></pre>
<h3 id="3-async-testing-patterns">3. Async Testing Patterns</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Async testing best practices</span>

<span class="hljs-comment">// Use waitFor for async operations</span>
<span class="hljs-keyword">await</span> waitFor(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  expect(screen.getByText(<span class="hljs-string">"Data loaded"</span>)).toBeInTheDocument();
});

<span class="hljs-comment">// Use findBy for elements that will appear</span>
<span class="hljs-keyword">const</span> element = <span class="hljs-keyword">await</span> screen.findByText(<span class="hljs-string">"Async content"</span>);

<span class="hljs-comment">// Use act for state updates</span>
act(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  result.current.updateState();
});

<span class="hljs-comment">// Set reasonable timeouts</span>
<span class="hljs-keyword">await</span> waitFor(
  <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> expect(screen.getByText(<span class="hljs-string">"Slow content"</span>)).toBeInTheDocument(),
  { <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span> }
);
</div></code></pre>
<h3 id="4-mock-management">4. Mock Management</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Mock management best practices</span>

<span class="hljs-comment">// Clear mocks between tests</span>
beforeEach(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  jest.clearAllMocks();
});

<span class="hljs-comment">// Use specific mocks for specific tests</span>
it(<span class="hljs-string">"handles API error"</span>, () =&gt; {
  mockApiCall.mockRejectedValueOnce(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"API Error"</span>));
  <span class="hljs-comment">// Test error handling</span>
});

<span class="hljs-comment">// Restore original implementations</span>
afterAll(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  jest.restoreAllMocks();
});
</div></code></pre>
<hr>
<p><strong>Next up</strong>: We'll explore performance optimization techniques and learn how to build fast, efficient React applications! ⚡</p>
<h1 id="18-performance-optimization-%E2%9A%A1">18. Performance Optimization ⚡</h1>
<blockquote>
<p>&quot;Premature optimization is the root of all evil. But when the time comes, optimize like your users' experience depends on it.&quot; - Performance Philosophy</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>How to identify performance bottlenecks in React apps</li>
<li>Core optimization techniques and when to use them</li>
<li>Bundle optimization and code splitting strategies</li>
<li>Image and asset optimization</li>
<li>Memory leak prevention and cleanup</li>
<li>Performance monitoring and measurement tools</li>
<li>Real-world optimization patterns and case studies</li>
</ul>
<h2 id="%F0%9F%94%8D-understanding-react-performance">🔍 Understanding React Performance</h2>
<h3 id="the-react-rendering-process">The React Rendering Process</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// React's rendering phases</span>
<span class="hljs-number">1.</span> Trigger (state change, props change, parent re-render)
<span class="hljs-number">2.</span> Render (create virtual DOM, run components)
<span class="hljs-number">3.</span> Commit (update real DOM, run effects)
<span class="hljs-number">4.</span> Browser Paint (layout, paint, composite)
</div></code></pre>
<h3 id="common-performance-issues">Common Performance Issues</h3>
<ol>
<li><strong>Unnecessary Re-renders</strong></li>
<li><strong>Large Bundle Sizes</strong></li>
<li><strong>Inefficient State Updates</strong></li>
<li><strong>Memory Leaks</strong></li>
<li><strong>Blocking Operations</strong></li>
<li><strong>Poor Image/Asset Loading</strong></li>
</ol>
<h2 id="%F0%9F%9B%A0%EF%B8%8F-performance-measurement-tools">🛠️ Performance Measurement Tools</h2>
<h3 id="react-devtools-profiler">React DevTools Profiler</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Using React DevTools Profiler</span>
<span class="hljs-comment">// 1. Install React DevTools browser extension</span>
<span class="hljs-comment">// 2. Open DevTools → Profiler tab</span>
<span class="hljs-comment">// 3. Click record, interact with app, stop recording</span>
<span class="hljs-comment">// 4. Analyze flame graph and ranked chart</span>

<span class="hljs-comment">// Profiler API for programmatic measurement</span>
<span class="hljs-keyword">import</span> { Profiler } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">onRenderCallback</span>(<span class="hljs-params">
  id,
  phase,
  actualDuration,
  baseDuration,
  startTime,
  commitTime
</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Profiler:"</span>, {
    id, <span class="hljs-comment">// Component tree identifier</span>
    phase, <span class="hljs-comment">// "mount" or "update"</span>
    actualDuration, <span class="hljs-comment">// Time spent rendering</span>
    baseDuration, <span class="hljs-comment">// Estimated time without memoization</span>
    startTime, <span class="hljs-comment">// When React began rendering</span>
    commitTime, <span class="hljs-comment">// When React committed the update</span>
  });

  <span class="hljs-comment">// Send to analytics in production</span>
  <span class="hljs-keyword">if</span> (process.env.NODE_ENV === <span class="hljs-string">"production"</span>) {
    analytics.track(<span class="hljs-string">"Component Render"</span>, {
      <span class="hljs-attr">componentId</span>: id,
      <span class="hljs-attr">renderTime</span>: actualDuration,
      phase,
    });
  }
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Profiler</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"App"</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">{onRenderCallback}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Header</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Main</span> /&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Footer</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Profiler</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="custom-performance-hooks">Custom Performance Hooks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Custom hooks for performance monitoring</span>
<span class="hljs-keyword">import</span> { useEffect, useRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-comment">// Hook to measure component render time</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useRenderTime</span>(<span class="hljs-params">componentName</span>) </span>{
  <span class="hljs-keyword">const</span> renderStart = useRef(performance.now());

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> renderEnd = performance.now();
    <span class="hljs-keyword">const</span> renderTime = renderEnd - renderStart.current;

    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${componentName}</span> render time: <span class="hljs-subst">${renderTime.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);

    <span class="hljs-comment">// Reset for next render</span>
    renderStart.current = performance.now();
  });
}

<span class="hljs-comment">// Hook to track re-render count</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useRenderCount</span>(<span class="hljs-params">componentName</span>) </span>{
  <span class="hljs-keyword">const</span> renderCount = useRef(<span class="hljs-number">0</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    renderCount.current += <span class="hljs-number">1</span>;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">${componentName}</span> rendered <span class="hljs-subst">${renderCount.current}</span> times`</span>);
  });

  <span class="hljs-keyword">return</span> renderCount.current;
}

<span class="hljs-comment">// Hook to detect unnecessary re-renders</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useWhyDidYouUpdate</span>(<span class="hljs-params">name, props</span>) </span>{
  <span class="hljs-keyword">const</span> previousProps = useRef();

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (previousProps.current) {
      <span class="hljs-keyword">const</span> allKeys = <span class="hljs-built_in">Object</span>.keys({ ...previousProps.current, ...props });
      <span class="hljs-keyword">const</span> changedProps = {};

      allKeys.forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (previousProps.current[key] !== props[key]) {
          changedProps[key] = {
            <span class="hljs-attr">from</span>: previousProps.current[key],
            <span class="hljs-attr">to</span>: props[key],
          };
        }
      });

      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Object</span>.keys(changedProps).length) {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"[why-did-you-update]"</span>, name, changedProps);
      }
    }

    previousProps.current = props;
  });
}

<span class="hljs-comment">// Usage example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExpensiveComponent</span>(<span class="hljs-params">{ data, config, onUpdate }</span>) </span>{
  useRenderTime(<span class="hljs-string">"ExpensiveComponent"</span>);
  <span class="hljs-keyword">const</span> renderCount = useRenderCount(<span class="hljs-string">"ExpensiveComponent"</span>);
  useWhyDidYouUpdate(<span class="hljs-string">"ExpensiveComponent"</span>, { data, config, onUpdate });

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Expensive Component (Render #{renderCount})<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      {/* Component content */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="performance-monitoring-component">Performance Monitoring Component</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Comprehensive performance monitoring</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PerformanceMonitor</span>(<span class="hljs-params">{ children, threshold = <span class="hljs-number">16</span> }</span>) </span>{
  <span class="hljs-keyword">const</span> [metrics, setMetrics] = useState({
    <span class="hljs-attr">fps</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">memoryUsage</span>: <span class="hljs-number">0</span>,
    <span class="hljs-attr">slowRenders</span>: <span class="hljs-number">0</span>
  });

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">let</span> frameCount = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">let</span> lastTime = performance.now();
    <span class="hljs-keyword">let</span> animationId;

    <span class="hljs-keyword">const</span> measureFPS = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      frameCount++;
      <span class="hljs-keyword">const</span> currentTime = performance.now();

      <span class="hljs-keyword">if</span> (currentTime &gt;= lastTime + <span class="hljs-number">1000</span>) {
        <span class="hljs-keyword">const</span> fps = <span class="hljs-built_in">Math</span>.round((frameCount * <span class="hljs-number">1000</span>) / (currentTime - lastTime));

        setMetrics(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> ({
          ...prev,
          fps,
          <span class="hljs-attr">memoryUsage</span>: (performance <span class="hljs-keyword">as</span> any).memory?.usedJSHeapSize || <span class="hljs-number">0</span>
        }));

        frameCount = <span class="hljs-number">0</span>;
        lastTime = currentTime;
      }

      animationId = requestAnimationFrame(measureFPS);
    };

    measureFPS();

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">if</span> (animationId) {
        cancelAnimationFrame(animationId);
      }
    };
  }, []);

  <span class="hljs-keyword">const</span> onRender = useCallback(<span class="hljs-function">(<span class="hljs-params">id, phase, actualDuration</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (actualDuration &gt; threshold) {
      setMetrics(<span class="hljs-function"><span class="hljs-params">prev</span> =&gt;</span> ({
        ...prev,
        <span class="hljs-attr">slowRenders</span>: prev.slowRenders + <span class="hljs-number">1</span>
      }));

      <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`Slow render detected: <span class="hljs-subst">${id}</span> took <span class="hljs-subst">${actualDuration.toFixed(<span class="hljs-number">2</span>)}</span>ms`</span>);
    }
  }, [threshold]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Profiler</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"PerformanceMonitor"</span> <span class="hljs-attr">onRender</span>=<span class="hljs-string">{onRender}</span>&gt;</span>
        {children}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Profiler</span>&gt;</span>

      {process.env.NODE_ENV === 'development' &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"performance-monitor"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>FPS: {metrics.fps}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Memory: {(metrics.memoryUsage / 1024 / 1024).toFixed(2)} MB<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Slow Renders: {metrics.slowRenders}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%9A%80-core-optimization-techniques">🚀 Core Optimization Techniques</h2>
<h3 id="1-memoization-strategies">1. Memoization Strategies</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Strategic use of React.memo</span>
<span class="hljs-keyword">const</span> ExpensiveListItem = React.memo(
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ListItem</span>(<span class="hljs-params">{ item, onUpdate }</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Rendering ListItem:"</span>, item.id);

    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"list-item"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>{item.title}<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.description}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> onUpdate(item.id)}&gt;Update<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  },
  (prevProps, nextProps) =&gt; {
    <span class="hljs-comment">// Custom comparison function</span>
    <span class="hljs-keyword">return</span> (
      prevProps.item.id === nextProps.item.id &amp;&amp;
      prevProps.item.title === nextProps.item.title &amp;&amp;
      prevProps.item.description === nextProps.item.description &amp;&amp;
      prevProps.onUpdate === nextProps.onUpdate
    );
  }
);

<span class="hljs-comment">// ✅ Optimized parent component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedList</span>(<span class="hljs-params">{ items }</span>) </span>{
  <span class="hljs-keyword">const</span> [selectedId, setSelectedId] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// Memoize callback to prevent unnecessary re-renders</span>
  <span class="hljs-keyword">const</span> handleUpdate = useCallback(<span class="hljs-function">(<span class="hljs-params">id</span>) =&gt;</span> {
    setSelectedId(id);
    <span class="hljs-comment">// Perform update logic</span>
  }, []);

  <span class="hljs-comment">// Memoize filtered items</span>
  <span class="hljs-keyword">const</span> visibleItems = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">return</span> items.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.visible);
  }, [items]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"optimized-list"</span>&gt;</span>
      {visibleItems.map((item) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">ExpensiveListItem</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span> <span class="hljs-attr">onUpdate</span>=<span class="hljs-string">{handleUpdate}</span> /&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="2-state-structure-optimization">2. State Structure Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ❌ Poor state structure - causes unnecessary re-renders</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BadExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [state, setState] = useState({
    <span class="hljs-attr">user</span>: { <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span> },
    <span class="hljs-attr">posts</span>: [],
    <span class="hljs-attr">comments</span>: [],
    <span class="hljs-attr">ui</span>: { <span class="hljs-attr">loading</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span> },
  });

  <span class="hljs-comment">// Any state change re-renders everything</span>
  <span class="hljs-keyword">const</span> updateLoading = <span class="hljs-function">(<span class="hljs-params">loading</span>) =&gt;</span> {
    setState(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({
      ...prev,
      <span class="hljs-attr">ui</span>: { ...prev.ui, loading },
    }));
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{state.user}</span> /&gt;</span> {/* Re-renders on loading change */}
      <span class="hljs-tag">&lt;<span class="hljs-name">PostList</span> <span class="hljs-attr">posts</span>=<span class="hljs-string">{state.posts}</span> /&gt;</span> {/* Re-renders on loading change */}
      <span class="hljs-tag">&lt;<span class="hljs-name">CommentList</span> <span class="hljs-attr">comments</span>=<span class="hljs-string">{state.comments}</span> /&gt;</span>{" "}
      {/* Re-renders on loading change */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Optimized state structure - isolated state changes</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GoodExample</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [user, setUser] = useState({ <span class="hljs-attr">name</span>: <span class="hljs-string">""</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">""</span> });
  <span class="hljs-keyword">const</span> [posts, setPosts] = useState([]);
  <span class="hljs-keyword">const</span> [comments, setComments] = useState([]);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">UserProfile</span> <span class="hljs-attr">user</span>=<span class="hljs-string">{user}</span> /&gt;</span> {/* Only re-renders when user changes */}
      <span class="hljs-tag">&lt;<span class="hljs-name">PostList</span> <span class="hljs-attr">posts</span>=<span class="hljs-string">{posts}</span> /&gt;</span> {/* Only re-renders when posts change */}
      <span class="hljs-tag">&lt;<span class="hljs-name">CommentList</span> <span class="hljs-attr">comments</span>=<span class="hljs-string">{comments}</span> /&gt;</span>{" "}
      {/* Only re-renders when comments change */}
      {loading &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">LoadingSpinner</span> /&gt;</span>} {/* Only re-renders when loading changes */}
      {error &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">ErrorMessage</span> <span class="hljs-attr">error</span>=<span class="hljs-string">{error}</span> /&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="3-component-splitting-and-lazy-loading">3. Component Splitting and Lazy Loading</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Code splitting with React.lazy</span>
<span class="hljs-keyword">const</span> LazyDashboard = React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./Dashboard"</span>));
<span class="hljs-keyword">const</span> LazyProfile = React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./Profile"</span>));
<span class="hljs-keyword">const</span> LazySettings = React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./Settings"</span>));

<span class="hljs-comment">// Custom hook for lazy loading with error handling</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useLazyComponent</span>(<span class="hljs-params">importFunc, fallback = null</span>) </span>{
  <span class="hljs-keyword">const</span> [Component, setComponent] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> [loading, setLoading] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-keyword">const</span> loadComponent = useCallback(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">if</span> (Component) <span class="hljs-keyword">return</span> Component;

    setLoading(<span class="hljs-literal">true</span>);
    setError(<span class="hljs-literal">null</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> <span class="hljs-built_in">module</span> = <span class="hljs-keyword">await</span> importFunc();
      <span class="hljs-keyword">const</span> LoadedComponent = <span class="hljs-built_in">module</span>.default || <span class="hljs-built_in">module</span>;
      setComponent(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> LoadedComponent);
      <span class="hljs-keyword">return</span> LoadedComponent;
    } <span class="hljs-keyword">catch</span> (err) {
      setError(err);
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to load component:"</span>, err);
    } <span class="hljs-keyword">finally</span> {
      setLoading(<span class="hljs-literal">false</span>);
    }
  }, [importFunc, Component]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    loadComponent();
  }, [loadComponent]);

  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> fallback || <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Failed to load component<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">if</span> (loading || !Component) {
    <span class="hljs-keyword">return</span> fallback || <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">return</span> Component;
}

<span class="hljs-comment">// Route-based code splitting</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Router</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">PageLoader</span> /&gt;</span>}&gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">Routes</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">Home</span> /&gt;</span>} /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/dashboard"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LazyDashboard</span> /&gt;</span>} /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/profile"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LazyProfile</span> /&gt;</span>} /&gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">"/settings"</span> <span class="hljs-attr">element</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LazySettings</span> /&gt;</span>} /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Routes</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Router</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Component-based lazy loading</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ConditionalFeature</span>(<span class="hljs-params">{ shouldLoad, children }</span>) </span>{
  <span class="hljs-keyword">const</span> [showFeature, setShowFeature] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-keyword">const</span> LazyFeature = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!shouldLoad) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">return</span> React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./ExpensiveFeature"</span>));
  }, [shouldLoad]);

  <span class="hljs-keyword">if</span> (!shouldLoad) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setShowFeature(true)}&gt;Load Feature<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>;
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">div</span>&gt;</span>Loading feature...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>}&gt;
      {showFeature &amp;&amp; LazyFeature &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">LazyFeature</span> /&gt;</span>}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="4-virtual-scrolling-for-large-lists">4. Virtual Scrolling for Large Lists</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Virtual scrolling implementation</span>
<span class="hljs-keyword">import</span> { useState, useEffect, useRef, useMemo } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">VirtualList</span>(<span class="hljs-params">{
  items,
  itemHeight,
  containerHeight,
  renderItem,
  overscan = <span class="hljs-number">5</span>,
}</span>) </span>{
  <span class="hljs-keyword">const</span> [scrollTop, setScrollTop] = useState(<span class="hljs-number">0</span>);
  <span class="hljs-keyword">const</span> scrollElementRef = useRef();

  <span class="hljs-keyword">const</span> { visibleItems, totalHeight, offsetY } = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> containerItemCount = <span class="hljs-built_in">Math</span>.ceil(containerHeight / itemHeight);
    <span class="hljs-keyword">const</span> startIndex = <span class="hljs-built_in">Math</span>.floor(scrollTop / itemHeight);
    <span class="hljs-keyword">const</span> endIndex = <span class="hljs-built_in">Math</span>.min(
      startIndex + containerItemCount + overscan,
      items.length
    );

    <span class="hljs-keyword">const</span> visibleItems = items.slice(
      <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, startIndex - overscan),
      endIndex
    );

    <span class="hljs-keyword">return</span> {
      visibleItems,
      <span class="hljs-attr">totalHeight</span>: items.length * itemHeight,
      <span class="hljs-attr">offsetY</span>: <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0</span>, startIndex - overscan) * itemHeight,
    };
  }, [items, itemHeight, scrollTop, containerHeight, overscan]);

  <span class="hljs-keyword">const</span> handleScroll = <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    setScrollTop(e.target.scrollTop);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">ref</span>=<span class="hljs-string">{scrollElementRef}</span>
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">containerHeight</span>, <span class="hljs-attr">overflow:</span> "<span class="hljs-attr">auto</span>" }}
      <span class="hljs-attr">onScroll</span>=<span class="hljs-string">{handleScroll}</span>
    &gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">totalHeight</span>, <span class="hljs-attr">position:</span> "<span class="hljs-attr">relative</span>" }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">transform:</span> `<span class="hljs-attr">translateY</span>(${<span class="hljs-attr">offsetY</span>}<span class="hljs-attr">px</span>)`,
            <span class="hljs-attr">position:</span> "<span class="hljs-attr">absolute</span>",
            <span class="hljs-attr">top:</span> <span class="hljs-attr">0</span>,
            <span class="hljs-attr">left:</span> <span class="hljs-attr">0</span>,
            <span class="hljs-attr">right:</span> <span class="hljs-attr">0</span>,
          }}
        &gt;</span>
          {visibleItems.map((item, index) =&gt; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id</span> || <span class="hljs-attr">index</span>} <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">height:</span> <span class="hljs-attr">itemHeight</span> }}&gt;</span>
              {renderItem(item, index)}
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
          ))}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Usage example</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LargeDataList</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data] = useState(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
    <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, (_, i) =&gt; ({
      <span class="hljs-attr">id</span>: i,
      <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
      <span class="hljs-attr">description</span>: <span class="hljs-string">`Description for item <span class="hljs-subst">${i}</span>`</span>,
    }))
  );

  <span class="hljs-keyword">const</span> renderItem = useCallback(
    <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"list-item"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h4</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">h4</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{item.description}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ),
    []
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">VirtualList</span>
      <span class="hljs-attr">items</span>=<span class="hljs-string">{data}</span>
      <span class="hljs-attr">itemHeight</span>=<span class="hljs-string">{80}</span>
      <span class="hljs-attr">containerHeight</span>=<span class="hljs-string">{400}</span>
      <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{renderItem}</span>
    /&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%93%A6-bundle-optimization">📦 Bundle Optimization</h2>
<h3 id="webpack-bundle-analysis">Webpack Bundle Analysis</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// webpack.config.js - Bundle analysis setup</span>
<span class="hljs-keyword">const</span> BundleAnalyzerPlugin =
  <span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack-bundle-analyzer"</span>).BundleAnalyzerPlugin;

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-comment">// ... other config</span>
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">// Analyze bundle in production</span>
    process.env.ANALYZE &amp;&amp;
      <span class="hljs-keyword">new</span> BundleAnalyzerPlugin({
        <span class="hljs-attr">analyzerMode</span>: <span class="hljs-string">"static"</span>,
        <span class="hljs-attr">openAnalyzer</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">reportFilename</span>: <span class="hljs-string">"bundle-report.html"</span>,
      }),
  ].filter(<span class="hljs-built_in">Boolean</span>),

  <span class="hljs-attr">optimization</span>: {
    <span class="hljs-attr">splitChunks</span>: {
      <span class="hljs-attr">chunks</span>: <span class="hljs-string">"all"</span>,
      <span class="hljs-attr">cacheGroups</span>: {
        <span class="hljs-attr">vendor</span>: {
          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,
          <span class="hljs-attr">name</span>: <span class="hljs-string">"vendors"</span>,
          <span class="hljs-attr">chunks</span>: <span class="hljs-string">"all"</span>,
        },
        <span class="hljs-attr">common</span>: {
          <span class="hljs-attr">name</span>: <span class="hljs-string">"common"</span>,
          <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,
          <span class="hljs-attr">chunks</span>: <span class="hljs-string">"all"</span>,
          <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>,
        },
      },
    },
  },
};
</div></code></pre>
<h3 id="tree-shaking-and-dead-code-elimination">Tree Shaking and Dead Code Elimination</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Tree-shaking friendly imports</span>
<span class="hljs-comment">// Instead of importing entire library</span>
<span class="hljs-keyword">import</span> _ <span class="hljs-keyword">from</span> <span class="hljs-string">"lodash"</span>; <span class="hljs-comment">// ❌ Imports entire lodash</span>

<span class="hljs-comment">// Import only what you need</span>
<span class="hljs-keyword">import</span> debounce <span class="hljs-keyword">from</span> <span class="hljs-string">"lodash/debounce"</span>; <span class="hljs-comment">// ✅ Tree-shakable</span>
<span class="hljs-keyword">import</span> { debounce } <span class="hljs-keyword">from</span> <span class="hljs-string">"lodash"</span>; <span class="hljs-comment">// ✅ Also tree-shakable with modern bundlers</span>

<span class="hljs-comment">// ✅ Conditional imports for development tools</span>
<span class="hljs-keyword">const</span> DevTools =
  process.env.NODE_ENV === <span class="hljs-string">"development"</span>
    ? React.lazy(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">"./DevTools"</span>))
    : <span class="hljs-literal">null</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">App</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">MainApp</span> /&gt;</span>
      {DevTools &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">Suspense</span> <span class="hljs-attr">fallback</span>=<span class="hljs-string">{null}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">DevTools</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Suspense</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Dynamic imports for feature flags</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">FeatureComponent</span>(<span class="hljs-params">{ featureEnabled }</span>) </span>{
  <span class="hljs-keyword">const</span> [FeatureModule, setFeatureModule] = useState(<span class="hljs-literal">null</span>);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (featureEnabled) {
      <span class="hljs-keyword">import</span>(<span class="hljs-string">"./AdvancedFeature"</span>).then(<span class="hljs-function">(<span class="hljs-params"><span class="hljs-built_in">module</span></span>) =&gt;</span> {
        setFeatureModule(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">module</span>.default);
      });
    }
  }, [featureEnabled]);

  <span class="hljs-keyword">if</span> (!featureEnabled || !FeatureModule) {
    <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">BasicFeature</span> /&gt;</span></span>;
  }

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">FeatureModule</span> /&gt;</span></span>;
}
</div></code></pre>
<h2 id="%F0%9F%96%BC%EF%B8%8F-image-and-asset-optimization">🖼️ Image and Asset Optimization</h2>
<h3 id="responsive-images-and-lazy-loading">Responsive Images and Lazy Loading</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Optimized image component</span>
<span class="hljs-keyword">import</span> { useState, useRef, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedImage</span>(<span class="hljs-params">{
  src,
  alt,
  width,
  height,
  className,
  lazy = true,
  placeholder = <span class="hljs-string">"blur"</span>,
}</span>) </span>{
  <span class="hljs-keyword">const</span> [isLoaded, setIsLoaded] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> [isInView, setIsInView] = useState(!lazy);
  <span class="hljs-keyword">const</span> [error, setError] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> imgRef = useRef();

  <span class="hljs-comment">// Intersection Observer for lazy loading</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (!lazy || isInView) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> observer = <span class="hljs-keyword">new</span> IntersectionObserver(
      <span class="hljs-function">(<span class="hljs-params">[entry]</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (entry.isIntersecting) {
          setIsInView(<span class="hljs-literal">true</span>);
          observer.disconnect();
        }
      },
      { <span class="hljs-attr">threshold</span>: <span class="hljs-number">0.1</span> }
    );

    <span class="hljs-keyword">if</span> (imgRef.current) {
      observer.observe(imgRef.current);
    }

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> observer.disconnect();
  }, [lazy, isInView]);

  <span class="hljs-keyword">const</span> handleLoad = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setIsLoaded(<span class="hljs-literal">true</span>);
  };

  <span class="hljs-keyword">const</span> handleError = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setError(<span class="hljs-literal">true</span>);
  };

  <span class="hljs-comment">// Generate responsive image sources</span>
  <span class="hljs-keyword">const</span> generateSrcSet = <span class="hljs-function">(<span class="hljs-params">baseSrc</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> sizes = [<span class="hljs-number">480</span>, <span class="hljs-number">768</span>, <span class="hljs-number">1024</span>, <span class="hljs-number">1280</span>, <span class="hljs-number">1920</span>];
    <span class="hljs-keyword">return</span> sizes.map(<span class="hljs-function">(<span class="hljs-params">size</span>) =&gt;</span> <span class="hljs-string">`<span class="hljs-subst">${baseSrc}</span>?w=<span class="hljs-subst">${size}</span> <span class="hljs-subst">${size}</span>w`</span>).join(<span class="hljs-string">", "</span>);
  };

  <span class="hljs-keyword">if</span> (error) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">image-error</span> ${<span class="hljs-attr">className</span>}`} <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width</span>, <span class="hljs-attr">height</span> }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>Failed to load image<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>
      <span class="hljs-attr">ref</span>=<span class="hljs-string">{imgRef}</span>
      <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">image-container</span> ${<span class="hljs-attr">className</span>}`}
      <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width</span>, <span class="hljs-attr">height</span> }}
    &gt;</span>
      {/* Placeholder */}
      {!isLoaded &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{</span>`<span class="hljs-attr">image-placeholder</span> ${<span class="hljs-attr">placeholder</span>}`}&gt;</span>
          {placeholder === "blur" &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"blur-placeholder"</span> /&gt;</span>}
          {placeholder === "skeleton" &amp;&amp; (
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"skeleton-placeholder"</span> /&gt;</span>
          )}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}

      {/* Actual image */}
      {isInView &amp;&amp; (
        <span class="hljs-tag">&lt;<span class="hljs-name">img</span>
          <span class="hljs-attr">src</span>=<span class="hljs-string">{src}</span>
          <span class="hljs-attr">srcSet</span>=<span class="hljs-string">{generateSrcSet(src)}</span>
          <span class="hljs-attr">sizes</span>=<span class="hljs-string">"(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw"</span>
          <span class="hljs-attr">alt</span>=<span class="hljs-string">{alt}</span>
          <span class="hljs-attr">width</span>=<span class="hljs-string">{width}</span>
          <span class="hljs-attr">height</span>=<span class="hljs-string">{height}</span>
          <span class="hljs-attr">onLoad</span>=<span class="hljs-string">{handleLoad}</span>
          <span class="hljs-attr">onError</span>=<span class="hljs-string">{handleError}</span>
          <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
            <span class="hljs-attr">opacity:</span> <span class="hljs-attr">isLoaded</span> ? <span class="hljs-attr">1</span> <span class="hljs-attr">:</span> <span class="hljs-attr">0</span>,
            <span class="hljs-attr">transition:</span> "<span class="hljs-attr">opacity</span> <span class="hljs-attr">0.3s</span> <span class="hljs-attr">ease</span>",
          }}
        /&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Image gallery with progressive loading</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ImageGallery</span>(<span class="hljs-params">{ images }</span>) </span>{
  <span class="hljs-keyword">const</span> [loadedCount, setLoadedCount] = useState(<span class="hljs-number">0</span>);

  <span class="hljs-keyword">const</span> handleImageLoad = useCallback(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setLoadedCount(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> prev + <span class="hljs-number">1</span>);
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"image-gallery"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"loading-progress"</span>&gt;</span>
        Loaded: {loadedCount} / {images.length}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"gallery-grid"</span>&gt;</span>
        {images.map((image, index) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">OptimizedImage</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{image.id}</span>
            <span class="hljs-attr">src</span>=<span class="hljs-string">{image.src}</span>
            <span class="hljs-attr">alt</span>=<span class="hljs-string">{image.alt}</span>
            <span class="hljs-attr">width</span>=<span class="hljs-string">{300}</span>
            <span class="hljs-attr">height</span>=<span class="hljs-string">{200}</span>
            <span class="hljs-attr">lazy</span>=<span class="hljs-string">{index</span> &gt;</span> 6} // Load first 6 immediately
            onLoad={handleImageLoad}
          /&gt;
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</div></code></pre>
<h3 id="asset-preloading-strategy">Asset Preloading Strategy</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Strategic asset preloading</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAssetPreloader</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [preloadedAssets, setPreloadedAssets] = useState(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>());

  <span class="hljs-keyword">const</span> preloadImage = useCallback(
    <span class="hljs-function">(<span class="hljs-params">src</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (preloadedAssets.has(src)) <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.resolve();

      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> img = <span class="hljs-keyword">new</span> Image();
        img.onload = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          setPreloadedAssets(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Set</span>([...prev, src]));
          resolve(img);
        };
        img.onerror = reject;
        img.src = src;
      });
    },
    [preloadedAssets]
  );

  <span class="hljs-keyword">const</span> preloadRoute = useCallback(
    <span class="hljs-keyword">async</span> (routePath) =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-comment">// Preload route component</span>
        <span class="hljs-keyword">const</span> routeModule = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">`./routes<span class="hljs-subst">${routePath}</span>`</span>);

        <span class="hljs-comment">// Preload route-specific assets</span>
        <span class="hljs-keyword">const</span> assets = routeModule.preloadAssets || [];
        <span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all(assets.map(preloadImage));

        <span class="hljs-keyword">return</span> routeModule;
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to preload route:"</span>, routePath, error);
      }
    },
    [preloadImage]
  );

  <span class="hljs-keyword">return</span> { preloadImage, preloadRoute, preloadedAssets };
}

<span class="hljs-comment">// ✅ Intelligent preloading based on user behavior</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NavigationWithPreloading</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> { preloadRoute } = useAssetPreloader();
  <span class="hljs-keyword">const</span> [hoveredRoute, setHoveredRoute] = useState(<span class="hljs-literal">null</span>);

  <span class="hljs-comment">// Preload on hover with debounce</span>
  <span class="hljs-keyword">const</span> debouncedPreload = useMemo(
    <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span>
      debounce(<span class="hljs-function">(<span class="hljs-params">route</span>) =&gt;</span> {
        <span class="hljs-keyword">if</span> (route) {
          preloadRoute(route);
        }
      }, <span class="hljs-number">300</span>),
    [preloadRoute]
  );

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    debouncedPreload(hoveredRoute);
  }, [hoveredRoute, debouncedPreload]);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">nav</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span>
        <span class="hljs-attr">to</span>=<span class="hljs-string">"/dashboard"</span>
        <span class="hljs-attr">onMouseEnter</span>=<span class="hljs-string">{()</span> =&gt;</span> setHoveredRoute("/dashboard")}
        onMouseLeave={() =&gt; setHoveredRoute(null)}
      &gt;
        Dashboard
      <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">Link</span>
        <span class="hljs-attr">to</span>=<span class="hljs-string">"/profile"</span>
        <span class="hljs-attr">onMouseEnter</span>=<span class="hljs-string">{()</span> =&gt;</span> setHoveredRoute("/profile")}
        onMouseLeave={() =&gt; setHoveredRoute(null)}
      &gt;
        Profile
      <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">nav</span>&gt;</span></span>
  );
}
</div></code></pre>
<h2 id="%F0%9F%A7%A0-memory-management">🧠 Memory Management</h2>
<h3 id="preventing-memory-leaks">Preventing Memory Leaks</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Proper cleanup patterns</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ComponentWithCleanup</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState(<span class="hljs-literal">null</span>);
  <span class="hljs-keyword">const</span> abortControllerRef = useRef();
  <span class="hljs-keyword">const</span> intervalRef = useRef();
  <span class="hljs-keyword">const</span> observerRef = useRef();

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// Create abort controller for fetch requests</span>
    abortControllerRef.current = <span class="hljs-keyword">new</span> AbortController();

    <span class="hljs-keyword">const</span> fetchData = <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">"/api/data"</span>, {
          <span class="hljs-attr">signal</span>: abortControllerRef.current.signal,
        });
        <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> response.json();
        setData(result);
      } <span class="hljs-keyword">catch</span> (error) {
        <span class="hljs-keyword">if</span> (error.name !== <span class="hljs-string">"AbortError"</span>) {
          <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Fetch error:"</span>, error);
        }
      }
    };

    fetchData();

    <span class="hljs-comment">// Set up interval</span>
    intervalRef.current = setInterval(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      fetchData();
    }, <span class="hljs-number">30000</span>);

    <span class="hljs-comment">// Set up intersection observer</span>
    observerRef.current = <span class="hljs-keyword">new</span> IntersectionObserver(<span class="hljs-function">(<span class="hljs-params">entries</span>) =&gt;</span> {
      <span class="hljs-comment">// Handle intersection</span>
    });

    <span class="hljs-keyword">const</span> element = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"target"</span>);
    <span class="hljs-keyword">if</span> (element) {
      observerRef.current.observe(element);
    }

    <span class="hljs-comment">// Cleanup function</span>
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-comment">// Abort ongoing requests</span>
      <span class="hljs-keyword">if</span> (abortControllerRef.current) {
        abortControllerRef.current.abort();
      }

      <span class="hljs-comment">// Clear interval</span>
      <span class="hljs-keyword">if</span> (intervalRef.current) {
        clearInterval(intervalRef.current);
      }

      <span class="hljs-comment">// Disconnect observer</span>
      <span class="hljs-keyword">if</span> (observerRef.current) {
        observerRef.current.disconnect();
      }
    };
  }, []);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {data ? (
        <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{JSON.stringify(data, null, 2)}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
      ) : (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      )}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// ✅ Memory-efficient event listeners</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useEventListener</span>(<span class="hljs-params">eventName, handler, element = window</span>) </span>{
  <span class="hljs-keyword">const</span> savedHandler = useRef();

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    savedHandler.current = handler;
  }, [handler]);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> isSupported = element &amp;&amp; element.addEventListener;
    <span class="hljs-keyword">if</span> (!isSupported) <span class="hljs-keyword">return</span>;

    <span class="hljs-keyword">const</span> eventListener = <span class="hljs-function">(<span class="hljs-params">event</span>) =&gt;</span> savedHandler.current(event);
    element.addEventListener(eventName, eventListener);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      element.removeEventListener(eventName, eventListener);
    };
  }, [eventName, element]);
}

<span class="hljs-comment">// ✅ Debounced state updates to prevent excessive re-renders</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDebouncedState</span>(<span class="hljs-params">initialValue, delay</span>) </span>{
  <span class="hljs-keyword">const</span> [value, setValue] = useState(initialValue);
  <span class="hljs-keyword">const</span> [debouncedValue, setDebouncedValue] = useState(initialValue);

  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> handler = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setDebouncedValue(value);
    }, delay);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      clearTimeout(handler);
    };
  }, [value, delay]);

  <span class="hljs-keyword">return</span> [debouncedValue, setValue];
}
</div></code></pre>
<h2 id="%F0%9F%8E%AF-mini-challenge-performance-optimization-dashboard">🎯 Mini-Challenge: Performance Optimization Dashboard</h2>
<h3 id="challenge-build-a-performance-optimized-data-dashboard">Challenge: Build a Performance-Optimized Data Dashboard</h3>
<p>Create a dashboard that efficiently handles:</p>
<ul>
<li>Large datasets (10,000+ items)</li>
<li>Real-time updates</li>
<li>Multiple chart types</li>
<li>Filtering and searching</li>
<li>Export functionality</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-comment">// Your task: Optimize this dashboard for performance</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">DataDashboard</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);
  <span class="hljs-keyword">const</span> [filters, setFilters] = useState({
    <span class="hljs-attr">category</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">dateRange</span>: { <span class="hljs-attr">start</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">end</span>: <span class="hljs-literal">null</span> },
    <span class="hljs-attr">searchTerm</span>: <span class="hljs-string">""</span>,
  });
  <span class="hljs-keyword">const</span> [chartType, setChartType] = useState(<span class="hljs-string">"line"</span>);
  <span class="hljs-keyword">const</span> [isExporting, setIsExporting] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// Generate large dataset</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">const</span> generateData = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">Array</span>.from({ <span class="hljs-attr">length</span>: <span class="hljs-number">10000</span> }, (_, i) =&gt; ({
        <span class="hljs-attr">id</span>: i,
        <span class="hljs-attr">category</span>: [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>, <span class="hljs-string">"D"</span>][<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">4</span>)],
        <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">1000</span>,
        <span class="hljs-attr">date</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2024</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span> + <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">365</span>)),
        <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
        <span class="hljs-attr">description</span>: <span class="hljs-string">`Description for item <span class="hljs-subst">${i}</span>`</span>,
        <span class="hljs-attr">tags</span>: [<span class="hljs-string">"tag1"</span>, <span class="hljs-string">"tag2"</span>, <span class="hljs-string">"tag3"</span>].slice(
          <span class="hljs-number">0</span>,
          <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>
        ),
      }));
    };

    setData(generateData());
  }, []);

  <span class="hljs-comment">// Filter data</span>
  <span class="hljs-keyword">const</span> filteredData = data.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (filters.category &amp;&amp; item.category !== filters.category) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (
      filters.searchTerm &amp;&amp;
      !item.name.toLowerCase().includes(filters.searchTerm.toLowerCase())
    )
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (filters.dateRange.start &amp;&amp; item.date &lt; filters.dateRange.start)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (filters.dateRange.end &amp;&amp; item.date &gt; filters.dateRange.end)
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  });

  <span class="hljs-comment">// Calculate statistics</span>
  <span class="hljs-keyword">const</span> stats = {
    <span class="hljs-attr">total</span>: filteredData.length,
    <span class="hljs-attr">average</span>:
      filteredData.reduce(<span class="hljs-function">(<span class="hljs-params">sum, item</span>) =&gt;</span> sum + item.value, <span class="hljs-number">0</span>) /
      filteredData.length,
    <span class="hljs-attr">categories</span>: filteredData.reduce(<span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> {
      acc[item.category] = (acc[item.category] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> acc;
    }, {}),
  };

  <span class="hljs-keyword">const</span> handleExport = <span class="hljs-keyword">async</span> () =&gt; {
    setIsExporting(<span class="hljs-literal">true</span>);
    <span class="hljs-comment">// Simulate export process</span>
    <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> setTimeout(resolve, <span class="hljs-number">2000</span>));
    setIsExporting(<span class="hljs-literal">false</span>);
  };

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dashboard"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">header</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Data Dashboard<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleExport}</span> <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isExporting}</span>&gt;</span>
          {isExporting ? "Exporting..." : "Export Data"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filters"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{filters.category}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
            setFilters((prev) =&gt; ({ ...prev, category: e.target.value }))
          }
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>All Categories<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"A"</span>&gt;</span>Category A<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"B"</span>&gt;</span>Category B<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"C"</span>&gt;</span>Category C<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"D"</span>&gt;</span>Category D<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Search..."</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{filters.searchTerm}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(e)</span> =&gt;</span>
            setFilters((prev) =&gt; ({ ...prev, searchTerm: e.target.value }))
          }
        /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Total: {stats.total}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Average: {stats.average.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
          Categories:{" "}
          {Object.entries(stats.categories)
            .map(([cat, count]) =&gt; `${cat}: ${count}`)
            .join(", ")}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-controls"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{chartType</span> === <span class="hljs-string">"line"</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setChartType("line")}
        &gt;
          Line Chart
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{chartType</span> === <span class="hljs-string">"bar"</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setChartType("bar")}
        &gt;
          Bar Chart
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">{chartType</span> === <span class="hljs-string">"pie"</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setChartType("pie")}
        &gt;
          Pie Chart
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart"</span>&gt;</span>
        {chartType === "line" &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">LineChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{filteredData}</span> /&gt;</span>}
        {chartType === "bar" &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">BarChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{filteredData}</span> /&gt;</span>}
        {chartType === "pie" &amp;&amp; <span class="hljs-tag">&lt;<span class="hljs-name">PieChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{filteredData}</span> /&gt;</span>}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-table"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ID<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Category<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Value<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Date<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span>
            {filteredData.map((item) =&gt; (
              <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.id}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.category}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.value.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.date.toLocaleDateString()}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
            ))}
          <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Chart components (simplified)</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LineChart</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Line Chart with {data.length} points<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BarChart</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Bar Chart with {data.length} bars<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PieChart</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Pie Chart with {data.length} slices<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
</div></code></pre>
<h3 id="solution-optimized-performance-dashboard">Solution: Optimized Performance Dashboard</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// ✅ Optimized dashboard with performance techniques</span>
<span class="hljs-keyword">import</span> { useState, useEffect, useMemo, useCallback, memo } <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> { useDebouncedState, useVirtualList } <span class="hljs-keyword">from</span> <span class="hljs-string">"./hooks"</span>;

<span class="hljs-comment">// Memoized chart components</span>
<span class="hljs-keyword">const</span> LineChart = memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LineChart</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Rendering LineChart with"</span>, data.length, <span class="hljs-string">"points"</span>);

  <span class="hljs-comment">// Only re-render if data reference changes</span>
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart line-chart"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Line Chart<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{data.length} data points<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      {/* Actual chart implementation would go here */}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-keyword">const</span> BarChart = memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">BarChart</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Rendering BarChart with"</span>, data.length, <span class="hljs-string">"bars"</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart bar-chart"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Bar Chart<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{data.length} data points<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-keyword">const</span> PieChart = memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">PieChart</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Rendering PieChart with"</span>, data.length, <span class="hljs-string">"slices"</span>);

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart pie-chart"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>Pie Chart<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{data.length} data points<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Memoized table row component</span>
<span class="hljs-keyword">const</span> TableRow = memo(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">TableRow</span>(<span class="hljs-params">{ item }</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.id}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.name}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.category}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.value.toFixed(2)}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{item.date.toLocaleDateString()}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span></span>
  );
});

<span class="hljs-comment">// Virtualized table component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">VirtualizedTable</span>(<span class="hljs-params">{ data }</span>) </span>{
  <span class="hljs-keyword">const</span> renderRow = useCallback(
    <span class="hljs-function">(<span class="hljs-params">item, index</span>) =&gt;</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">TableRow</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{item.id}</span> <span class="hljs-attr">item</span>=<span class="hljs-string">{item}</span> /&gt;</span></span>,
    []
  );

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"data-table"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>ID<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Name<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Category<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Value<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Date<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">VirtualList</span>
        <span class="hljs-attr">items</span>=<span class="hljs-string">{data}</span>
        <span class="hljs-attr">itemHeight</span>=<span class="hljs-string">{40}</span>
        <span class="hljs-attr">containerHeight</span>=<span class="hljs-string">{400}</span>
        <span class="hljs-attr">renderItem</span>=<span class="hljs-string">{renderRow}</span>
      /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-comment">// Custom hook for data filtering with memoization</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDataFilter</span>(<span class="hljs-params">data, filters</span>) </span>{
  <span class="hljs-keyword">return</span> useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Filtering data..."</span>, { <span class="hljs-attr">dataLength</span>: data.length, filters });

    <span class="hljs-keyword">return</span> data.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (filters.category &amp;&amp; item.category !== filters.category) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (
        filters.searchTerm &amp;&amp;
        !item.name.toLowerCase().includes(filters.searchTerm.toLowerCase())
      )
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (filters.dateRange.start &amp;&amp; item.date &lt; filters.dateRange.start)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">if</span> (filters.dateRange.end &amp;&amp; item.date &gt; filters.dateRange.end)
        <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    });
  }, [data, filters]);
}

<span class="hljs-comment">// Custom hook for statistics calculation</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useDataStats</span>(<span class="hljs-params">data</span>) </span>{
  <span class="hljs-keyword">return</span> useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Calculating stats for"</span>, data.length, <span class="hljs-string">"items"</span>);

    <span class="hljs-keyword">if</span> (data.length === <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">return</span> {
        <span class="hljs-attr">total</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">average</span>: <span class="hljs-number">0</span>,
        <span class="hljs-attr">categories</span>: {},
      };
    }

    <span class="hljs-keyword">const</span> total = data.length;
    <span class="hljs-keyword">const</span> sum = data.reduce(<span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> acc + item.value, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">const</span> average = sum / total;

    <span class="hljs-keyword">const</span> categories = data.reduce(<span class="hljs-function">(<span class="hljs-params">acc, item</span>) =&gt;</span> {
      acc[item.category] = (acc[item.category] || <span class="hljs-number">0</span>) + <span class="hljs-number">1</span>;
      <span class="hljs-keyword">return</span> acc;
    }, {});

    <span class="hljs-keyword">return</span> { total, average, categories };
  }, [data]);
}

<span class="hljs-comment">// Main optimized dashboard component</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">OptimizedDataDashboard</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-comment">// State management</span>
  <span class="hljs-keyword">const</span> [data, setData] = useState([]);
  <span class="hljs-keyword">const</span> [filters, setFilters] = useState({
    <span class="hljs-attr">category</span>: <span class="hljs-string">""</span>,
    <span class="hljs-attr">dateRange</span>: { <span class="hljs-attr">start</span>: <span class="hljs-literal">null</span>, <span class="hljs-attr">end</span>: <span class="hljs-literal">null</span> },
    <span class="hljs-attr">searchTerm</span>: <span class="hljs-string">""</span>,
  });
  <span class="hljs-keyword">const</span> [chartType, setChartType] = useState(<span class="hljs-string">"line"</span>);
  <span class="hljs-keyword">const</span> [isExporting, setIsExporting] = useState(<span class="hljs-literal">false</span>);

  <span class="hljs-comment">// Debounced search to prevent excessive filtering</span>
  <span class="hljs-keyword">const</span> [debouncedSearchTerm, setDebouncedSearchTerm] = useDebouncedState(
    <span class="hljs-string">""</span>,
    <span class="hljs-number">300</span>
  );

  <span class="hljs-comment">// Update filters when debounced search changes</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setFilters(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, <span class="hljs-attr">searchTerm</span>: debouncedSearchTerm }));
  }, [debouncedSearchTerm]);

  <span class="hljs-comment">// Generate data once on mount</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Generating initial data..."</span>);

    <span class="hljs-keyword">const</span> generateData = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      <span class="hljs-keyword">const</span> categories = [<span class="hljs-string">"A"</span>, <span class="hljs-string">"B"</span>, <span class="hljs-string">"C"</span>, <span class="hljs-string">"D"</span>];
      <span class="hljs-keyword">const</span> data = [];

      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10000</span>; i++) {
        data.push({
          <span class="hljs-attr">id</span>: i,
          <span class="hljs-attr">category</span>: categories[<span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * categories.length)],
          <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">1000</span>,
          <span class="hljs-attr">date</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">2024</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span> + <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">365</span>)),
          <span class="hljs-attr">name</span>: <span class="hljs-string">`Item <span class="hljs-subst">${i}</span>`</span>,
          <span class="hljs-attr">description</span>: <span class="hljs-string">`Description for item <span class="hljs-subst">${i}</span>`</span>,
          <span class="hljs-attr">tags</span>: [<span class="hljs-string">"tag1"</span>, <span class="hljs-string">"tag2"</span>, <span class="hljs-string">"tag3"</span>].slice(
            <span class="hljs-number">0</span>,
            <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>
          ),
        });
      }

      <span class="hljs-keyword">return</span> data;
    };

    <span class="hljs-comment">// Simulate async data loading</span>
    <span class="hljs-keyword">const</span> timer = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
      setData(generateData());
    }, <span class="hljs-number">100</span>);

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearTimeout(timer);
  }, []);

  <span class="hljs-comment">// Memoized filtered data</span>
  <span class="hljs-keyword">const</span> filteredData = useDataFilter(data, filters);

  <span class="hljs-comment">// Memoized statistics</span>
  <span class="hljs-keyword">const</span> stats = useDataStats(filteredData);

  <span class="hljs-comment">// Memoized chart data (sample for performance)</span>
  <span class="hljs-keyword">const</span> chartData = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-comment">// For charts, we might want to sample the data for better performance</span>
    <span class="hljs-keyword">const</span> maxChartPoints = <span class="hljs-number">1000</span>;
    <span class="hljs-keyword">if</span> (filteredData.length &lt;= maxChartPoints) {
      <span class="hljs-keyword">return</span> filteredData;
    }

    <span class="hljs-comment">// Sample data for chart performance</span>
    <span class="hljs-keyword">const</span> step = <span class="hljs-built_in">Math</span>.floor(filteredData.length / maxChartPoints);
    <span class="hljs-keyword">return</span> filteredData.filter(<span class="hljs-function">(<span class="hljs-params">_, index</span>) =&gt;</span> index % step === <span class="hljs-number">0</span>);
  }, [filteredData]);

  <span class="hljs-comment">// Memoized event handlers</span>
  <span class="hljs-keyword">const</span> handleCategoryChange = useCallback(<span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
    setFilters(<span class="hljs-function">(<span class="hljs-params">prev</span>) =&gt;</span> ({ ...prev, <span class="hljs-attr">category</span>: e.target.value }));
  }, []);

  <span class="hljs-keyword">const</span> handleSearchChange = useCallback(
    <span class="hljs-function">(<span class="hljs-params">e</span>) =&gt;</span> {
      setDebouncedSearchTerm(e.target.value);
    },
    [setDebouncedSearchTerm]
  );

  <span class="hljs-keyword">const</span> handleChartTypeChange = useCallback(<span class="hljs-function">(<span class="hljs-params">type</span>) =&gt;</span> {
    setChartType(type);
  }, []);

  <span class="hljs-keyword">const</span> handleExport = useCallback(<span class="hljs-keyword">async</span> () =&gt; {
    setIsExporting(<span class="hljs-literal">true</span>);

    <span class="hljs-keyword">try</span> {
      <span class="hljs-comment">// Simulate export process with Web Workers for heavy processing</span>
      <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> {
        <span class="hljs-keyword">const</span> worker = <span class="hljs-keyword">new</span> Worker(
          <span class="hljs-keyword">new</span> URL(<span class="hljs-string">"./exportWorker.js"</span>, <span class="hljs-keyword">import</span>.meta.url)
        );
        worker.postMessage({ <span class="hljs-attr">data</span>: filteredData });
        worker.onmessage = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
          worker.terminate();
          resolve();
        };
      });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Export failed:"</span>, error);
    } <span class="hljs-keyword">finally</span> {
      setIsExporting(<span class="hljs-literal">false</span>);
    }
  }, [filteredData]);

  <span class="hljs-comment">// Memoized chart component</span>
  <span class="hljs-keyword">const</span> ChartComponent = useMemo(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">switch</span> (chartType) {
      <span class="hljs-keyword">case</span> <span class="hljs-string">"line"</span>:
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">LineChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{chartData}</span> /&gt;</span></span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"bar"</span>:
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">BarChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{chartData}</span> /&gt;</span></span>;
      <span class="hljs-keyword">case</span> <span class="hljs-string">"pie"</span>:
        <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">PieChart</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{chartData}</span> /&gt;</span></span>;
      <span class="hljs-keyword">default</span>:
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }
  }, [chartType, chartData]);

  <span class="hljs-keyword">if</span> (data.length === <span class="hljs-number">0</span>) {
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dashboard loading"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Loading Dashboard...<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"loading-spinner"</span>&gt;</span>⏳<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  }

  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dashboard optimized"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"dashboard-header"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Optimized Data Dashboard<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
          <span class="hljs-attr">onClick</span>=<span class="hljs-string">{handleExport}</span>
          <span class="hljs-attr">disabled</span>=<span class="hljs-string">{isExporting}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"export-button"</span>
        &gt;</span>
          {isExporting ? "⏳ Exporting..." : "📊 Export Data"}
        <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"filters"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">select</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{filters.category}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleCategoryChange}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"category-filter"</span>
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">""</span>&gt;</span>All Categories<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"A"</span>&gt;</span>Category A<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"B"</span>&gt;</span>Category B<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"C"</span>&gt;</span>Category C<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">option</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"D"</span>&gt;</span>Category D<span class="hljs-tag">&lt;/<span class="hljs-name">option</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">select</span>&gt;</span>

        <span class="hljs-tag">&lt;<span class="hljs-name">input</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span>
          <span class="hljs-attr">placeholder</span>=<span class="hljs-string">"Search items..."</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{handleSearchChange}</span>
          <span class="hljs-attr">className</span>=<span class="hljs-string">"search-input"</span>
        /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stats"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-item"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Total:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {stats.total.toLocaleString()}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-item"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Average:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span> {stats.average.toFixed(2)}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"stat-item"</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">strong</span>&gt;</span>Categories:<span class="hljs-tag">&lt;/<span class="hljs-name">strong</span>&gt;</span>{" "}
          {Object.entries(stats.categories)
            .map(([cat, count]) =&gt; `${cat}: ${count}`)
            .join(", ")}
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-controls"</span>&gt;</span>
        {["line", "bar", "pie"].map((type) =&gt; (
          <span class="hljs-tag">&lt;<span class="hljs-name">button</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{type}</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">{chartType</span> === <span class="hljs-string">type</span> ? "<span class="hljs-attr">active</span>" <span class="hljs-attr">:</span> ""}
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> handleChartTypeChange(type)}
          &gt;
            {type.charAt(0).toUpperCase() + type.slice(1)} Chart
          <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        ))}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-container"</span>&gt;</span>
        {ChartComponent}
        {chartData.length !== filteredData.length &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"chart-note"</span>&gt;</span>
            📊 Showing {chartData.length} of {filteredData.length} points for
            performance
          <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>

      <span class="hljs-tag">&lt;<span class="hljs-name">VirtualizedTable</span> <span class="hljs-attr">data</span>=<span class="hljs-string">{filteredData}</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> OptimizedDataDashboard;
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// exportWorker.js - Web Worker for heavy export processing</span>
self.onmessage = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
  <span class="hljs-keyword">const</span> { data } = e.data;

  <span class="hljs-comment">// Simulate heavy processing</span>
  <span class="hljs-keyword">const</span> processedData = data.map(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> ({
    ...item,
    <span class="hljs-attr">processed</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">exportTimestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
  }));

  <span class="hljs-comment">// Simulate export delay</span>
  setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    self.postMessage({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">count</span>: processedData.length });
  }, <span class="hljs-number">1500</span>);
};
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-performance-takeaways">🎯 Key Performance Takeaways</h2>
<h3 id="1-measurement-first">1. Measurement First</h3>
<ul>
<li>Always measure before optimizing</li>
<li>Use React DevTools Profiler</li>
<li>Monitor real user metrics</li>
<li>Set performance budgets</li>
</ul>
<h3 id="2-optimization-hierarchy">2. Optimization Hierarchy</h3>
<ol>
<li><strong>Prevent unnecessary work</strong> (memoization, virtualization)</li>
<li><strong>Reduce work complexity</strong> (efficient algorithms, data structures)</li>
<li><strong>Defer work</strong> (lazy loading, code splitting)</li>
<li><strong>Parallelize work</strong> (Web Workers, concurrent features)</li>
</ol>
<h3 id="3-common-optimization-patterns">3. Common Optimization Patterns</h3>
<ul>
<li>Memoize expensive calculations with <code>useMemo</code></li>
<li>Memoize callbacks with <code>useCallback</code></li>
<li>Use <code>React.memo</code> for component memoization</li>
<li>Implement virtual scrolling for large lists</li>
<li>Split code at route boundaries</li>
<li>Optimize images and assets</li>
<li>Clean up resources properly</li>
</ul>
<h3 id="4-performance-monitoring">4. Performance Monitoring</h3>
<ul>
<li>Set up continuous performance monitoring</li>
<li>Track Core Web Vitals</li>
<li>Monitor bundle sizes</li>
<li>Use performance budgets in CI/CD</li>
</ul>
<hr>
<p><strong>Next up</strong>: We'll explore deployment strategies and learn how to ship React applications to production! 🚀</p>
<h1 id="19-deployment--production-%F0%9F%9A%80">19. Deployment &amp; Production 🚀</h1>
<blockquote>
<p>&quot;Shipping is a feature. A feature that needs to be built, tested, and maintained like any other.&quot; - Production Philosophy</p>
</blockquote>
<h2 id="%F0%9F%8E%AF-learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you'll understand:</p>
<ul>
<li>Production build optimization and configuration</li>
<li>Deployment strategies and platforms</li>
<li>Environment management and configuration</li>
<li>CI/CD pipelines for React applications</li>
<li>Monitoring and error tracking in production</li>
<li>Performance optimization for production</li>
<li>Security best practices</li>
<li>Scaling and maintenance strategies</li>
</ul>
<h2 id="%F0%9F%8F%97%EF%B8%8F-production-build-preparation">🏗️ Production Build Preparation</h2>
<h3 id="build-optimization">Build Optimization</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// package.json - Production scripts</span>
{
  <span class="hljs-string">"scripts"</span>: {
    <span class="hljs-string">"build"</span>: <span class="hljs-string">"react-scripts build"</span>,
    <span class="hljs-string">"build:analyze"</span>: <span class="hljs-string">"npm run build &amp;&amp; npx serve -s build"</span>,
    <span class="hljs-string">"build:profile"</span>: <span class="hljs-string">"react-scripts build --profile"</span>,
    <span class="hljs-string">"build:stats"</span>: <span class="hljs-string">"react-scripts build &amp;&amp; npx webpack-bundle-analyzer build/static/js/*.js"</span>,
    <span class="hljs-string">"preview"</span>: <span class="hljs-string">"npx serve -s build -l 3000"</span>,
    <span class="hljs-string">"test:e2e"</span>: <span class="hljs-string">"cypress run"</span>,
    <span class="hljs-string">"test:e2e:ci"</span>: <span class="hljs-string">"start-server-and-test preview http://localhost:3000 test:e2e"</span>
  },
  <span class="hljs-string">"homepage"</span>: <span class="hljs-string">"https://myapp.com"</span>
}
</div></code></pre>
<h3 id="environment-configuration">Environment Configuration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// .env.production</span>
REACT_APP_API_URL=https:<span class="hljs-comment">//api.myapp.com</span>
REACT_APP_ENVIRONMENT=production
REACT_APP_VERSION=$npm_package_version
REACT_APP_SENTRY_DSN=https:<span class="hljs-comment">//your-sentry-dsn</span>
REACT_APP_ANALYTICS_ID=GA-XXXXXXXXX
GENERATE_SOURCEMAP=<span class="hljs-literal">false</span>

<span class="hljs-comment">// .env.staging</span>
REACT_APP_API_URL=https:<span class="hljs-comment">//staging-api.myapp.com</span>
REACT_APP_ENVIRONMENT=staging
REACT_APP_VERSION=$npm_package_version
REACT_APP_SENTRY_DSN=https:<span class="hljs-comment">//your-staging-sentry-dsn</span>
GENERATE_SOURCEMAP=<span class="hljs-literal">true</span>

<span class="hljs-comment">// .env.development</span>
REACT_APP_API_URL=http:<span class="hljs-comment">//localhost:8000</span>
REACT_APP_ENVIRONMENT=development
REACT_APP_VERSION=dev
GENERATE_SOURCEMAP=<span class="hljs-literal">true</span>
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment">// config/environment.js</span>
<span class="hljs-keyword">const</span> config = {
  <span class="hljs-attr">development</span>: {
    <span class="hljs-attr">apiUrl</span>: process.env.REACT_APP_API_URL || <span class="hljs-string">"http://localhost:8000"</span>,
    <span class="hljs-attr">enableDevTools</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">logLevel</span>: <span class="hljs-string">"debug"</span>,
    <span class="hljs-attr">enableMocking</span>: <span class="hljs-literal">true</span>,
  },
  <span class="hljs-attr">staging</span>: {
    <span class="hljs-attr">apiUrl</span>: process.env.REACT_APP_API_URL,
    <span class="hljs-attr">enableDevTools</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">logLevel</span>: <span class="hljs-string">"info"</span>,
    <span class="hljs-attr">enableMocking</span>: <span class="hljs-literal">false</span>,
  },
  <span class="hljs-attr">production</span>: {
    <span class="hljs-attr">apiUrl</span>: process.env.REACT_APP_API_URL,
    <span class="hljs-attr">enableDevTools</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">logLevel</span>: <span class="hljs-string">"error"</span>,
    <span class="hljs-attr">enableMocking</span>: <span class="hljs-literal">false</span>,
  },
};

<span class="hljs-keyword">const</span> environment = process.env.REACT_APP_ENVIRONMENT || <span class="hljs-string">"development"</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  ...config[environment],
  environment,
  <span class="hljs-attr">version</span>: process.env.REACT_APP_VERSION || <span class="hljs-string">"unknown"</span>,
};
</div></code></pre>
<h3 id="advanced-webpack-configuration">Advanced Webpack Configuration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// craco.config.js - Custom webpack config with CRACO</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">"path"</span>);
<span class="hljs-keyword">const</span> { BundleAnalyzerPlugin } = <span class="hljs-built_in">require</span>(<span class="hljs-string">"webpack-bundle-analyzer"</span>);
<span class="hljs-keyword">const</span> CompressionPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">"compression-webpack-plugin"</span>);

<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">webpack</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">"@"</span>: path.resolve(__dirname, <span class="hljs-string">"src"</span>),
      <span class="hljs-string">"@components"</span>: path.resolve(__dirname, <span class="hljs-string">"src/components"</span>),
      <span class="hljs-string">"@utils"</span>: path.resolve(__dirname, <span class="hljs-string">"src/utils"</span>),
      <span class="hljs-string">"@hooks"</span>: path.resolve(__dirname, <span class="hljs-string">"src/hooks"</span>),
    },
    <span class="hljs-attr">plugins</span>: {
      <span class="hljs-attr">add</span>: [
        <span class="hljs-comment">// Gzip compression</span>
        <span class="hljs-keyword">new</span> CompressionPlugin({
          <span class="hljs-attr">algorithm</span>: <span class="hljs-string">"gzip"</span>,
          <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(js|css|html|svg)$/</span>,
          <span class="hljs-attr">threshold</span>: <span class="hljs-number">8192</span>,
          <span class="hljs-attr">minRatio</span>: <span class="hljs-number">0.8</span>,
        }),

        <span class="hljs-comment">// Bundle analysis in production</span>
        ...(process.env.ANALYZE === <span class="hljs-string">"true"</span>
          ? [
              <span class="hljs-keyword">new</span> BundleAnalyzerPlugin({
                <span class="hljs-attr">analyzerMode</span>: <span class="hljs-string">"static"</span>,
                <span class="hljs-attr">openAnalyzer</span>: <span class="hljs-literal">false</span>,
                <span class="hljs-attr">reportFilename</span>: <span class="hljs-string">"bundle-report.html"</span>,
              }),
            ]
          : []),
      ],
    },
    <span class="hljs-attr">configure</span>: <span class="hljs-function">(<span class="hljs-params">webpackConfig, { env }</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (env === <span class="hljs-string">"production"</span>) {
        <span class="hljs-comment">// Optimize chunks</span>
        webpackConfig.optimization.splitChunks = {
          <span class="hljs-attr">chunks</span>: <span class="hljs-string">"all"</span>,
          <span class="hljs-attr">cacheGroups</span>: {
            <span class="hljs-attr">vendor</span>: {
              <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,
              <span class="hljs-attr">name</span>: <span class="hljs-string">"vendors"</span>,
              <span class="hljs-attr">chunks</span>: <span class="hljs-string">"all"</span>,
              <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>,
            },
            <span class="hljs-attr">common</span>: {
              <span class="hljs-attr">name</span>: <span class="hljs-string">"common"</span>,
              <span class="hljs-attr">minChunks</span>: <span class="hljs-number">2</span>,
              <span class="hljs-attr">chunks</span>: <span class="hljs-string">"all"</span>,
              <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>,
            },
          },
        };

        <span class="hljs-comment">// Remove console logs in production</span>
        webpackConfig.optimization.minimizer[<span class="hljs-number">0</span>].options.terserOptions.compress.drop_console = <span class="hljs-literal">true</span>;
      }

      <span class="hljs-keyword">return</span> webpackConfig;
    },
  },

  <span class="hljs-comment">// PWA configuration</span>
  <span class="hljs-attr">plugins</span>: [
    {
      <span class="hljs-attr">plugin</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">"craco-workbox"</span>),
      <span class="hljs-attr">options</span>: {
        <span class="hljs-attr">skipWaiting</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">clientsClaim</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">runtimeCaching</span>: [
          {
            <span class="hljs-attr">urlPattern</span>: <span class="hljs-regexp">/^https:\/\/api\.myapp\.com/</span>,
            <span class="hljs-attr">handler</span>: <span class="hljs-string">"NetworkFirst"</span>,
            <span class="hljs-attr">options</span>: {
              <span class="hljs-attr">cacheName</span>: <span class="hljs-string">"api-cache"</span>,
              <span class="hljs-attr">expiration</span>: {
                <span class="hljs-attr">maxEntries</span>: <span class="hljs-number">50</span>,
                <span class="hljs-attr">maxAgeSeconds</span>: <span class="hljs-number">300</span>, <span class="hljs-comment">// 5 minutes</span>
              },
            },
          },
          {
            <span class="hljs-attr">urlPattern</span>: <span class="hljs-regexp">/\.(?:png|jpg|jpeg|svg|gif)$/</span>,
            <span class="hljs-attr">handler</span>: <span class="hljs-string">"CacheFirst"</span>,
            <span class="hljs-attr">options</span>: {
              <span class="hljs-attr">cacheName</span>: <span class="hljs-string">"image-cache"</span>,
              <span class="hljs-attr">expiration</span>: {
                <span class="hljs-attr">maxEntries</span>: <span class="hljs-number">100</span>,
                <span class="hljs-attr">maxAgeSeconds</span>: <span class="hljs-number">86400</span>, <span class="hljs-comment">// 24 hours</span>
              },
            },
          },
        ],
      },
    },
  ],
};
</div></code></pre>
<h2 id="%F0%9F%8C%90-deployment-platforms">🌐 Deployment Platforms</h2>
<h3 id="vercel-deployment">Vercel Deployment</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// vercel.json</span>
{
  <span class="hljs-attr">"version"</span>: <span class="hljs-number">2</span>,
  <span class="hljs-attr">"builds"</span>: [
    {
      <span class="hljs-attr">"src"</span>: <span class="hljs-string">"package.json"</span>,
      <span class="hljs-attr">"use"</span>: <span class="hljs-string">"@vercel/static-build"</span>,
      <span class="hljs-attr">"config"</span>: {
        <span class="hljs-attr">"distDir"</span>: <span class="hljs-string">"build"</span>
      }
    }
  ],
  <span class="hljs-attr">"routes"</span>: [
    {
      <span class="hljs-attr">"src"</span>: <span class="hljs-string">"/static/(.*)"</span>,
      <span class="hljs-attr">"headers"</span>: {
        <span class="hljs-attr">"cache-control"</span>: <span class="hljs-string">"public, max-age=31536000, immutable"</span>
      }
    },
    {
      <span class="hljs-attr">"src"</span>: <span class="hljs-string">"/(.*\\.(js|css|ico|png|jpg|jpeg|svg|gif|woff|woff2)$)"</span>,
      <span class="hljs-attr">"headers"</span>: {
        <span class="hljs-attr">"cache-control"</span>: <span class="hljs-string">"public, max-age=31536000, immutable"</span>
      }
    },
    {
      <span class="hljs-attr">"src"</span>: <span class="hljs-string">"/(.*)"</span>,
      <span class="hljs-attr">"dest"</span>: <span class="hljs-string">"/index.html"</span>
    }
  ],
  <span class="hljs-attr">"headers"</span>: [
    {
      <span class="hljs-attr">"source"</span>: <span class="hljs-string">"/(.*)"</span>,
      <span class="hljs-attr">"headers"</span>: [
        {
          <span class="hljs-attr">"key"</span>: <span class="hljs-string">"X-Content-Type-Options"</span>,
          <span class="hljs-attr">"value"</span>: <span class="hljs-string">"nosniff"</span>
        },
        {
          <span class="hljs-attr">"key"</span>: <span class="hljs-string">"X-Frame-Options"</span>,
          <span class="hljs-attr">"value"</span>: <span class="hljs-string">"DENY"</span>
        },
        {
          <span class="hljs-attr">"key"</span>: <span class="hljs-string">"X-XSS-Protection"</span>,
          <span class="hljs-attr">"value"</span>: <span class="hljs-string">"1; mode=block"</span>
        },
        {
          <span class="hljs-attr">"key"</span>: <span class="hljs-string">"Referrer-Policy"</span>,
          <span class="hljs-attr">"value"</span>: <span class="hljs-string">"strict-origin-when-cross-origin"</span>
        }
      ]
    }
  ],
  <span class="hljs-attr">"env"</span>: {
    <span class="hljs-attr">"REACT_APP_ENVIRONMENT"</span>: <span class="hljs-string">"production"</span>
  }
}
</div></code></pre>
<h3 id="netlify-deployment">Netlify Deployment</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># netlify.toml</span>
<span class="hljs-section">[build]</span>
  publish = "build"
  command = "npm run build"

<span class="hljs-section">[build.environment]</span>
  REACT_APP_ENVIRONMENT = "production"
  NODE_VERSION = "18"

<span class="hljs-section">[[redirects]]</span>
  from = "/api/*"
  to = "https://api.myapp.com/:splat"
  status = 200
  force = true

<span class="hljs-section">[[redirects]]</span>
  from = "/*"
  to = "/index.html"
  status = 200

<span class="hljs-section">[[headers]]</span>
  for = "/*"
  <span class="hljs-section">[headers.values]</span>
    X-Frame-Options = "DENY"
    X-XSS-Protection = "1<span class="hljs-comment">; mode=block"</span>
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    Content-Security-Policy = "default-src 'self'<span class="hljs-comment">; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:;"</span>

<span class="hljs-section">[[headers]]</span>
  for = "/static/*"
  <span class="hljs-section">[headers.values]</span>
    Cache-Control = "public, max-age=31536000, immutable"
</div></code></pre>
<h3 id="aws-s3--cloudfront-deployment">AWS S3 + CloudFront Deployment</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># deploy-aws.yml (GitHub Actions)</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">AWS</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> <span class="hljs-string">[main]</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node.js</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-string">"18"</span>
          <span class="hljs-attr">cache:</span> <span class="hljs-string">"npm"</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">ci</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">tests</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">test</span> <span class="hljs-string">--</span> <span class="hljs-string">--coverage</span> <span class="hljs-string">--watchAll=false</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">application</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span>
        <span class="hljs-attr">env:</span>
          <span class="hljs-attr">REACT_APP_API_URL:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.REACT_APP_API_URL</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">REACT_APP_ENVIRONMENT:</span> <span class="hljs-string">production</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Configure</span> <span class="hljs-string">AWS</span> <span class="hljs-string">credentials</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">aws-actions/configure-aws-credentials@v2</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">aws-access-key-id:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_ACCESS_KEY_ID</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">aws-secret-access-key:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.AWS_SECRET_ACCESS_KEY</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">aws-region:</span> <span class="hljs-string">us-east-1</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">S3</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          aws s3 sync build/ s3://${{ secrets.S3_BUCKET }} --delete
          aws s3 cp build/index.html s3://${{ secrets.S3_BUCKET }}/index.html --cache-control "no-cache"
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Invalidate</span> <span class="hljs-string">CloudFront</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          aws cloudfront create-invalidation --distribution-id ${{ secrets.CLOUDFRONT_DISTRIBUTION_ID }} --paths "/*"
</span></div></code></pre>
<h3 id="docker-deployment">Docker Deployment</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Dockerfile</span>
<span class="hljs-comment"># Multi-stage build for optimized production image</span>
<span class="hljs-keyword">FROM</span> node:<span class="hljs-number">18</span>-alpine AS builder

<span class="hljs-keyword">WORKDIR</span><span class="bash"> /app</span>

<span class="hljs-comment"># Copy package files</span>
<span class="hljs-keyword">COPY</span><span class="bash"> package*.json ./</span>

<span class="hljs-comment"># Install dependencies</span>
<span class="hljs-keyword">RUN</span><span class="bash"> npm ci --only=production &amp;&amp; npm cache clean --force</span>

<span class="hljs-comment"># Copy source code</span>
<span class="hljs-keyword">COPY</span><span class="bash"> . .</span>

<span class="hljs-comment"># Build application</span>
<span class="hljs-keyword">RUN</span><span class="bash"> npm run build</span>

<span class="hljs-comment"># Production stage</span>
<span class="hljs-keyword">FROM</span> nginx:alpine AS production

<span class="hljs-comment"># Copy custom nginx config</span>
<span class="hljs-keyword">COPY</span><span class="bash"> nginx.conf /etc/nginx/nginx.conf</span>

<span class="hljs-comment"># Copy built application</span>
<span class="hljs-keyword">COPY</span><span class="bash"> --from=builder /app/build /usr/share/nginx/html</span>

<span class="hljs-comment"># Add health check</span>
<span class="hljs-keyword">HEALTHCHECK</span><span class="bash"> --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost/ || <span class="hljs-built_in">exit</span> 1</span>

<span class="hljs-keyword">EXPOSE</span> <span class="hljs-number">80</span>

<span class="hljs-keyword">CMD</span><span class="bash"> [<span class="hljs-string">"nginx"</span>, <span class="hljs-string">"-g"</span>, <span class="hljs-string">"daemon off;"</span>]</span>
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment"># nginx.conf</span>
<span class="hljs-section">events</span> {
    <span class="hljs-attribute">worker_connections</span> <span class="hljs-number">1024</span>;
}

<span class="hljs-section">http</span> {
    <span class="hljs-attribute">include</span>       /etc/nginx/mime.types;
    <span class="hljs-attribute">default_type</span>  application/octet-stream;

    <span class="hljs-comment"># Gzip compression</span>
    <span class="hljs-attribute">gzip</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_vary</span> <span class="hljs-literal">on</span>;
    <span class="hljs-attribute">gzip_min_length</span> <span class="hljs-number">1024</span>;
    <span class="hljs-attribute">gzip_types</span> text/plain text/css text/xml text/javascript application/javascript application/xml+rss application/json;

    <span class="hljs-comment"># Security headers</span>
    <span class="hljs-attribute">add_header</span> X-Frame-Options <span class="hljs-string">"DENY"</span> always;
    <span class="hljs-attribute">add_header</span> X-Content-Type-Options <span class="hljs-string">"nosniff"</span> always;
    <span class="hljs-attribute">add_header</span> X-XSS-Protection <span class="hljs-string">"1; mode=block"</span> always;
    <span class="hljs-attribute">add_header</span> Referrer-Policy <span class="hljs-string">"strict-origin-when-cross-origin"</span> always;

    <span class="hljs-section">server</span> {
        <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;
        <span class="hljs-attribute">server_name</span> localhost;
        <span class="hljs-attribute">root</span> /usr/share/nginx/html;
        <span class="hljs-attribute">index</span> index.html;

        <span class="hljs-comment"># Cache static assets</span>
        <span class="hljs-attribute">location</span> /static/ {
            <span class="hljs-attribute">expires</span> <span class="hljs-number">1y</span>;
            <span class="hljs-attribute">add_header</span> Cache-Control <span class="hljs-string">"public, immutable"</span>;
        }

        <span class="hljs-comment"># Handle client-side routing</span>
        <span class="hljs-attribute">location</span> / {
            <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.html;

            <span class="hljs-comment"># Don't cache the main HTML file</span>
            <span class="hljs-attribute">location</span> = /index.html {
                <span class="hljs-attribute">add_header</span> Cache-Control <span class="hljs-string">"no-cache, no-store, must-revalidate"</span>;
                <span class="hljs-attribute">add_header</span> Pragma <span class="hljs-string">"no-cache"</span>;
                <span class="hljs-attribute">add_header</span> Expires <span class="hljs-string">"0"</span>;
            }
        }

        <span class="hljs-comment"># Health check endpoint</span>
        <span class="hljs-attribute">location</span> /health {
            <span class="hljs-attribute">access_log</span> <span class="hljs-literal">off</span>;
            <span class="hljs-attribute">return</span> <span class="hljs-number">200</span> <span class="hljs-string">"healthy\n"</span>;
            <span class="hljs-attribute">add_header</span> Content-Type text/plain;
        }
    }
}
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-comment"># docker-compose.yml</span>
<span class="hljs-attr">version:</span> <span class="hljs-string">"3.8"</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">app:</span>
    <span class="hljs-attr">build:</span>
      <span class="hljs-attr">context:</span> <span class="hljs-string">.</span>
      <span class="hljs-attr">dockerfile:</span> <span class="hljs-string">Dockerfile</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"80:80"</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">NODE_ENV=production</span>
    <span class="hljs-attr">restart:</span> <span class="hljs-string">unless-stopped</span>

  <span class="hljs-comment"># Optional: Add monitoring</span>
  <span class="hljs-attr">prometheus:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">prom/prometheus</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">"9090:9090"</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">./prometheus.yml:/etc/prometheus/prometheus.yml</span>
</div></code></pre>
<h2 id="%F0%9F%94%84-cicd-pipeline">🔄 CI/CD Pipeline</h2>
<h3 id="github-actions-workflow">GitHub Actions Workflow</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># .github/workflows/ci-cd.yml</span>
<span class="hljs-attr">name:</span> <span class="hljs-string">CI/CD</span> <span class="hljs-string">Pipeline</span>

<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span> <span class="hljs-string">[main,</span> <span class="hljs-string">develop]</span>
  <span class="hljs-attr">pull_request:</span>
    <span class="hljs-attr">branches:</span> <span class="hljs-string">[main]</span>

<span class="hljs-attr">env:</span>
  <span class="hljs-attr">NODE_VERSION:</span> <span class="hljs-string">"18"</span>
  <span class="hljs-attr">CACHE_KEY:</span> <span class="hljs-string">node-modules</span>

<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">test:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">Test</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">code</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node.js</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-string">${{</span> <span class="hljs-string">env.NODE_VERSION</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">cache:</span> <span class="hljs-string">"npm"</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">ci</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">linting</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">lint</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">type</span> <span class="hljs-string">checking</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">type-check</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">unit</span> <span class="hljs-string">tests</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">test</span> <span class="hljs-string">--</span> <span class="hljs-string">--coverage</span> <span class="hljs-string">--watchAll=false</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">coverage</span> <span class="hljs-string">to</span> <span class="hljs-string">Codecov</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">codecov/codecov-action@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">file:</span> <span class="hljs-string">./coverage/lcov.info</span>
          <span class="hljs-attr">flags:</span> <span class="hljs-string">unittests</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">codecov-umbrella</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">E2E</span> <span class="hljs-string">tests</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          npm run build
          npm run test:e2e:ci
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">E2E</span> <span class="hljs-string">artifacts</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v3</span>
        <span class="hljs-attr">if:</span> <span class="hljs-string">failure()</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">cypress-screenshots</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">cypress/screenshots</span>

  <span class="hljs-attr">security:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">Security</span> <span class="hljs-string">Scan</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">code</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">security</span> <span class="hljs-string">audit</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">audit</span> <span class="hljs-string">--audit-level=high</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Run</span> <span class="hljs-string">Snyk</span> <span class="hljs-string">security</span> <span class="hljs-string">scan</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">snyk/actions/node@master</span>
        <span class="hljs-attr">env:</span>
          <span class="hljs-attr">SNYK_TOKEN:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SNYK_TOKEN</span> <span class="hljs-string">}}</span>

  <span class="hljs-attr">build:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">[test,</span> <span class="hljs-string">security]</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span> <span class="hljs-string">code</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v3</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node.js</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">node-version:</span> <span class="hljs-string">${{</span> <span class="hljs-string">env.NODE_VERSION</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">cache:</span> <span class="hljs-string">"npm"</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Install</span> <span class="hljs-string">dependencies</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">ci</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Build</span> <span class="hljs-string">application</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">npm</span> <span class="hljs-string">run</span> <span class="hljs-string">build</span>
        <span class="hljs-attr">env:</span>
          <span class="hljs-attr">REACT_APP_VERSION:</span> <span class="hljs-string">${{</span> <span class="hljs-string">github.sha</span> <span class="hljs-string">}}</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Upload</span> <span class="hljs-string">build</span> <span class="hljs-string">artifacts</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/upload-artifact@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">build-files</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">build/</span>
          <span class="hljs-attr">retention-days:</span> <span class="hljs-number">30</span>

  <span class="hljs-attr">deploy-staging:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Staging</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">build</span>
    <span class="hljs-attr">if:</span> <span class="hljs-string">github.ref</span> <span class="hljs-string">==</span> <span class="hljs-string">'refs/heads/develop'</span>
    <span class="hljs-attr">environment:</span> <span class="hljs-string">staging</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Download</span> <span class="hljs-string">build</span> <span class="hljs-string">artifacts</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/download-artifact@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">build-files</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">build/</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">staging</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          echo "Deploying to staging environment"
          # Add your staging deployment commands here
</span>
  <span class="hljs-attr">deploy-production:</span>
    <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">Production</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span>
    <span class="hljs-attr">needs:</span> <span class="hljs-string">build</span>
    <span class="hljs-attr">if:</span> <span class="hljs-string">github.ref</span> <span class="hljs-string">==</span> <span class="hljs-string">'refs/heads/main'</span>
    <span class="hljs-attr">environment:</span> <span class="hljs-string">production</span>

    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Download</span> <span class="hljs-string">build</span> <span class="hljs-string">artifacts</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/download-artifact@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">name:</span> <span class="hljs-string">build-files</span>
          <span class="hljs-attr">path:</span> <span class="hljs-string">build/</span>

      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span> <span class="hljs-string">to</span> <span class="hljs-string">production</span>
        <span class="hljs-attr">run:</span> <span class="hljs-string">|
          echo "Deploying to production environment"
          # Add your production deployment commands here
</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Notify</span> <span class="hljs-string">deployment</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">8398a7/action-slack@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">status:</span> <span class="hljs-string">${{</span> <span class="hljs-string">job.status</span> <span class="hljs-string">}}</span>
          <span class="hljs-attr">channel:</span> <span class="hljs-string">"#deployments"</span>
          <span class="hljs-attr">webhook_url:</span> <span class="hljs-string">${{</span> <span class="hljs-string">secrets.SLACK_WEBHOOK</span> <span class="hljs-string">}}</span>
        <span class="hljs-attr">if:</span> <span class="hljs-string">always()</span>
</div></code></pre>
<h2 id="%F0%9F%93%8A-production-monitoring">📊 Production Monitoring</h2>
<h3 id="error-tracking-with-sentry">Error Tracking with Sentry</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/utils/errorTracking.js</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> Sentry <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/react"</span>;
<span class="hljs-keyword">import</span> { BrowserTracing } <span class="hljs-keyword">from</span> <span class="hljs-string">"@sentry/tracing"</span>;
<span class="hljs-keyword">import</span> config <span class="hljs-keyword">from</span> <span class="hljs-string">"../config/environment"</span>;

<span class="hljs-comment">// Initialize Sentry</span>
<span class="hljs-keyword">if</span> (config.environment === <span class="hljs-string">"production"</span>) {
  Sentry.init({
    <span class="hljs-attr">dsn</span>: process.env.REACT_APP_SENTRY_DSN,
    <span class="hljs-attr">environment</span>: config.environment,
    <span class="hljs-attr">release</span>: config.version,
    <span class="hljs-attr">integrations</span>: [
      <span class="hljs-keyword">new</span> BrowserTracing({
        <span class="hljs-comment">// Set sampling rate for performance monitoring</span>
        <span class="hljs-attr">tracePropagationTargets</span>: [config.apiUrl],
      }),
    ],
    <span class="hljs-attr">tracesSampleRate</span>: <span class="hljs-number">0.1</span>, <span class="hljs-comment">// 10% of transactions</span>
    beforeSend(event, hint) {
      <span class="hljs-comment">// Filter out development errors</span>
      <span class="hljs-keyword">if</span> (config.environment === <span class="hljs-string">"development"</span>) {
        <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Sentry Event:"</span>, event, hint);
        <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
      }
      <span class="hljs-keyword">return</span> event;
    },
    beforeBreadcrumb(breadcrumb) {
      <span class="hljs-comment">// Filter sensitive data from breadcrumbs</span>
      <span class="hljs-keyword">if</span> (breadcrumb.category === <span class="hljs-string">"console"</span> &amp;&amp; breadcrumb.level === <span class="hljs-string">"error"</span>) {
        <span class="hljs-keyword">return</span> breadcrumb;
      }
      <span class="hljs-keyword">if</span> (breadcrumb.category === <span class="hljs-string">"navigation"</span>) {
        <span class="hljs-keyword">return</span> breadcrumb;
      }
      <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    },
  });
}

<span class="hljs-comment">// Error boundary with Sentry integration</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> SentryErrorBoundary = Sentry.withErrorBoundary(
  <span class="hljs-function">(<span class="hljs-params">{ children }</span>) =&gt;</span> children,
  {
    <span class="hljs-attr">fallback</span>: <span class="hljs-function">(<span class="hljs-params">{ error, resetError }</span>) =&gt;</span> (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"error-boundary"</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Something went wrong<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>We've been notified about this error.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{resetError}</span>&gt;</span>Try again<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
        {config.environment === "development" &amp;&amp; (
          <span class="hljs-tag">&lt;<span class="hljs-name">details</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">summary</span>&gt;</span>Error details<span class="hljs-tag">&lt;/<span class="hljs-name">summary</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span>{error.toString()}<span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">details</span>&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    ),
    <span class="hljs-attr">beforeCapture</span>: <span class="hljs-function">(<span class="hljs-params">scope, error, errorInfo</span>) =&gt;</span> {
      scope.setTag(<span class="hljs-string">"errorBoundary"</span>, <span class="hljs-literal">true</span>);
      scope.setContext(<span class="hljs-string">"errorInfo"</span>, errorInfo);
    },
  }
);

<span class="hljs-comment">// Custom error logging</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> logError = <span class="hljs-function">(<span class="hljs-params">error, context = {}</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (config.environment === <span class="hljs-string">"production"</span>) {
    Sentry.withScope(<span class="hljs-function">(<span class="hljs-params">scope</span>) =&gt;</span> {
      <span class="hljs-built_in">Object</span>.keys(context).forEach(<span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> {
        scope.setContext(key, context[key]);
      });
      Sentry.captureException(error);
    });
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Error:"</span>, error, context);
  }
};

<span class="hljs-comment">// Performance monitoring</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> startTransaction = <span class="hljs-function">(<span class="hljs-params">name, op = <span class="hljs-string">"navigation"</span></span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (config.environment === <span class="hljs-string">"production"</span>) {
    <span class="hljs-keyword">return</span> Sentry.startTransaction({ name, op });
  }
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">finish</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {},
    <span class="hljs-attr">setTag</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {},
    <span class="hljs-attr">setData</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {},
  };
};
</div></code></pre>
<h3 id="analytics-integration">Analytics Integration</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/utils/analytics.js</span>
<span class="hljs-keyword">import</span> config <span class="hljs-keyword">from</span> <span class="hljs-string">"../config/environment"</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Analytics</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.isEnabled = config.environment === <span class="hljs-string">"production"</span>;
    <span class="hljs-keyword">this</span>.queue = [];

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEnabled) {
      <span class="hljs-keyword">this</span>.initializeGA();
    }
  }

  initializeGA() {
    <span class="hljs-comment">// Google Analytics 4</span>
    <span class="hljs-keyword">const</span> script = <span class="hljs-built_in">document</span>.createElement(<span class="hljs-string">"script"</span>);
    script.async = <span class="hljs-literal">true</span>;
    script.src = <span class="hljs-string">`https://www.googletagmanager.com/gtag/js?id=<span class="hljs-subst">${process.env.REACT_APP_ANALYTICS_ID}</span>`</span>;
    <span class="hljs-built_in">document</span>.head.appendChild(script);

    <span class="hljs-built_in">window</span>.dataLayer = <span class="hljs-built_in">window</span>.dataLayer || [];
    <span class="hljs-built_in">window</span>.gtag = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      <span class="hljs-built_in">window</span>.dataLayer.push(<span class="hljs-built_in">arguments</span>);
    };

    <span class="hljs-built_in">window</span>.gtag(<span class="hljs-string">"js"</span>, <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>());
    <span class="hljs-built_in">window</span>.gtag(<span class="hljs-string">"config"</span>, process.env.REACT_APP_ANALYTICS_ID, {
      <span class="hljs-attr">page_title</span>: <span class="hljs-built_in">document</span>.title,
      <span class="hljs-attr">page_location</span>: <span class="hljs-built_in">window</span>.location.href,
    });
  }

  track(eventName, properties = {}) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEnabled) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Analytics (dev):"</span>, eventName, properties);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Google Analytics</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.gtag) {
      <span class="hljs-built_in">window</span>.gtag(<span class="hljs-string">"event"</span>, eventName, {
        <span class="hljs-attr">event_category</span>: properties.category || <span class="hljs-string">"General"</span>,
        <span class="hljs-attr">event_label</span>: properties.label,
        <span class="hljs-attr">value</span>: properties.value,
        ...properties,
      });
    }

    <span class="hljs-comment">// Custom analytics endpoint</span>
    <span class="hljs-keyword">this</span>.sendToCustomAnalytics(eventName, properties);
  }

  page(path, title) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEnabled) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Analytics Page (dev):"</span>, path, title);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.gtag) {
      <span class="hljs-built_in">window</span>.gtag(<span class="hljs-string">"config"</span>, process.env.REACT_APP_ANALYTICS_ID, {
        <span class="hljs-attr">page_path</span>: path,
        <span class="hljs-attr">page_title</span>: title,
      });
    }
  }

  identify(userId, traits = {}) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEnabled) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Analytics Identify (dev):"</span>, userId, traits);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.gtag) {
      <span class="hljs-built_in">window</span>.gtag(<span class="hljs-string">"config"</span>, process.env.REACT_APP_ANALYTICS_ID, {
        <span class="hljs-attr">user_id</span>: userId,
      });
    }
  }

  <span class="hljs-keyword">async</span> sendToCustomAnalytics(eventName, properties) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`<span class="hljs-subst">${config.apiUrl}</span>/analytics`</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({
          <span class="hljs-attr">event</span>: eventName,
          <span class="hljs-attr">properties</span>: {
            ...properties,
            <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
            <span class="hljs-attr">url</span>: <span class="hljs-built_in">window</span>.location.href,
            <span class="hljs-attr">userAgent</span>: navigator.userAgent,
            <span class="hljs-attr">version</span>: config.version,
          },
        }),
      });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to send analytics:"</span>, error);
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> Analytics();

<span class="hljs-comment">// React hook for analytics</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">useAnalytics</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> track = useCallback(<span class="hljs-function">(<span class="hljs-params">eventName, properties</span>) =&gt;</span> {
    analytics.track(eventName, properties);
  }, []);

  <span class="hljs-keyword">const</span> page = useCallback(<span class="hljs-function">(<span class="hljs-params">path, title</span>) =&gt;</span> {
    analytics.page(path, title);
  }, []);

  <span class="hljs-keyword">const</span> identify = useCallback(<span class="hljs-function">(<span class="hljs-params">userId, traits</span>) =&gt;</span> {
    analytics.identify(userId, traits);
  }, []);

  <span class="hljs-keyword">return</span> { track, page, identify };
}
</div></code></pre>
<h3 id="performance-monitoring">Performance Monitoring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/utils/performanceMonitoring.js</span>
<span class="hljs-keyword">import</span> config <span class="hljs-keyword">from</span> <span class="hljs-string">"../config/environment"</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerformanceMonitor</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.metrics = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.isEnabled = config.environment === <span class="hljs-string">"production"</span>;

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEnabled) {
      <span class="hljs-keyword">this</span>.initializeWebVitals();
      <span class="hljs-keyword">this</span>.setupPerformanceObserver();
    }
  }

  <span class="hljs-keyword">async</span> initializeWebVitals() {
    <span class="hljs-keyword">const</span> { getCLS, getFID, getFCP, getLCP, getTTFB } = <span class="hljs-keyword">await</span> <span class="hljs-keyword">import</span>(
      <span class="hljs-string">"web-vitals"</span>
    );

    getCLS(<span class="hljs-keyword">this</span>.sendMetric.bind(<span class="hljs-keyword">this</span>));
    getFID(<span class="hljs-keyword">this</span>.sendMetric.bind(<span class="hljs-keyword">this</span>));
    getFCP(<span class="hljs-keyword">this</span>.sendMetric.bind(<span class="hljs-keyword">this</span>));
    getLCP(<span class="hljs-keyword">this</span>.sendMetric.bind(<span class="hljs-keyword">this</span>));
    getTTFB(<span class="hljs-keyword">this</span>.sendMetric.bind(<span class="hljs-keyword">this</span>));
  }

  setupPerformanceObserver() {
    <span class="hljs-comment">// Long tasks observer</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-string">"PerformanceObserver"</span> <span class="hljs-keyword">in</span> <span class="hljs-built_in">window</span>) {
      <span class="hljs-keyword">const</span> longTaskObserver = <span class="hljs-keyword">new</span> PerformanceObserver(<span class="hljs-function">(<span class="hljs-params">list</span>) =&gt;</span> {
        list.getEntries().forEach(<span class="hljs-function">(<span class="hljs-params">entry</span>) =&gt;</span> {
          <span class="hljs-keyword">this</span>.sendMetric({
            <span class="hljs-attr">name</span>: <span class="hljs-string">"long-task"</span>,
            <span class="hljs-attr">value</span>: entry.duration,
            <span class="hljs-attr">id</span>: <span class="hljs-string">`long-task-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>,
          });
        });
      });

      <span class="hljs-keyword">try</span> {
        longTaskObserver.observe({ <span class="hljs-attr">entryTypes</span>: [<span class="hljs-string">"longtask"</span>] });
      } <span class="hljs-keyword">catch</span> (e) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Long task observer not supported"</span>);
      }
    }
  }

  sendMetric(metric) {
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEnabled) {
      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Performance Metric (dev):"</span>, metric);
      <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-comment">// Send to analytics</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">window</span>.gtag) {
      <span class="hljs-built_in">window</span>.gtag(<span class="hljs-string">"event"</span>, metric.name, {
        <span class="hljs-attr">event_category</span>: <span class="hljs-string">"Web Vitals"</span>,
        <span class="hljs-attr">value</span>: <span class="hljs-built_in">Math</span>.round(metric.value),
        <span class="hljs-attr">metric_id</span>: metric.id,
        <span class="hljs-attr">metric_value</span>: metric.value,
        <span class="hljs-attr">metric_delta</span>: metric.delta,
      });
    }

    <span class="hljs-comment">// Send to custom endpoint</span>
    <span class="hljs-keyword">this</span>.sendToCustomEndpoint(metric);
  }

  <span class="hljs-keyword">async</span> sendToCustomEndpoint(metric) {
    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`<span class="hljs-subst">${config.apiUrl}</span>/metrics`</span>, {
        <span class="hljs-attr">method</span>: <span class="hljs-string">"POST"</span>,
        <span class="hljs-attr">headers</span>: {
          <span class="hljs-string">"Content-Type"</span>: <span class="hljs-string">"application/json"</span>,
        },
        <span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify({
          ...metric,
          <span class="hljs-attr">timestamp</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>().toISOString(),
          <span class="hljs-attr">url</span>: <span class="hljs-built_in">window</span>.location.href,
          <span class="hljs-attr">userAgent</span>: navigator.userAgent,
          <span class="hljs-attr">version</span>: config.version,
        }),
      });
    } <span class="hljs-keyword">catch</span> (error) {
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">"Failed to send performance metric:"</span>, error);
    }
  }

  <span class="hljs-comment">// Custom performance measurements</span>
  mark(name) {
    <span class="hljs-keyword">if</span> (performance.mark) {
      performance.mark(name);
    }
  }

  measure(name, startMark, endMark) {
    <span class="hljs-keyword">if</span> (performance.measure) {
      performance.measure(name, startMark, endMark);

      <span class="hljs-keyword">const</span> measure = performance.getEntriesByName(name)[<span class="hljs-number">0</span>];
      <span class="hljs-keyword">if</span> (measure) {
        <span class="hljs-keyword">this</span>.sendMetric({
          <span class="hljs-attr">name</span>: <span class="hljs-string">`custom-<span class="hljs-subst">${name}</span>`</span>,
          <span class="hljs-attr">value</span>: measure.duration,
          <span class="hljs-attr">id</span>: <span class="hljs-string">`custom-<span class="hljs-subst">${name}</span>-<span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now()}</span>`</span>,
        });
      }
    }
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> PerformanceMonitor();

<span class="hljs-comment">// React hook for performance monitoring</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">usePerformanceMonitoring</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> mark = useCallback(<span class="hljs-function">(<span class="hljs-params">name</span>) =&gt;</span> {
    performanceMonitor.mark(name);
  }, []);

  <span class="hljs-keyword">const</span> measure = useCallback(<span class="hljs-function">(<span class="hljs-params">name, startMark, endMark</span>) =&gt;</span> {
    performanceMonitor.measure(name, startMark, endMark);
  }, []);

  <span class="hljs-keyword">return</span> { mark, measure };
}
</div></code></pre>
<h2 id="%F0%9F%94%92-security-best-practices">🔒 Security Best Practices</h2>
<h3 id="content-security-policy">Content Security Policy</h3>
<pre class="hljs"><code><div><span class="hljs-comment">&lt;!-- public/index.html --&gt;</span>
<span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1"</span> /&gt;</span>

    <span class="hljs-comment">&lt;!-- Security headers --&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span>
      <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"Content-Security-Policy"</span>
      <span class="hljs-attr">content</span>=<span class="hljs-string">"
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://www.google-analytics.com https://www.googletagmanager.com;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data: https: blob:;
    connect-src 'self' https://api.myapp.com https://www.google-analytics.com;
    frame-ancestors 'none';
    base-uri 'self';
    form-action 'self';
  "</span>
    /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-Content-Type-Options"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"nosniff"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-Frame-Options"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"DENY"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-XSS-Protection"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"1; mode=block"</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span>
      <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"Referrer-Policy"</span>
      <span class="hljs-attr">content</span>=<span class="hljs-string">"strict-origin-when-cross-origin"</span>
    /&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>My React App<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">noscript</span>&gt;</span>You need to enable JavaScript to run this app.<span class="hljs-tag">&lt;/<span class="hljs-name">noscript</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"root"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</div></code></pre>
<h3 id="environment-variable-security">Environment Variable Security</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/utils/security.js</span>

<span class="hljs-comment">// Sanitize environment variables</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> sanitizeEnvVars = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> allowedVars = [
    <span class="hljs-string">"REACT_APP_API_URL"</span>,
    <span class="hljs-string">"REACT_APP_ENVIRONMENT"</span>,
    <span class="hljs-string">"REACT_APP_VERSION"</span>,
  ];

  <span class="hljs-keyword">const</span> sanitized = {};

  allowedVars.forEach(<span class="hljs-function">(<span class="hljs-params">varName</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span> (process.env[varName]) {
      sanitized[varName] = process.env[varName];
    }
  });

  <span class="hljs-keyword">return</span> sanitized;
};

<span class="hljs-comment">// Validate API responses</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> validateApiResponse = <span class="hljs-function">(<span class="hljs-params">response, schema</span>) =&gt;</span> {
  <span class="hljs-comment">// Implement response validation logic</span>
  <span class="hljs-comment">// Use libraries like Joi or Yup for schema validation</span>
  <span class="hljs-keyword">return</span> response;
};

<span class="hljs-comment">// Sanitize user input</span>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> sanitizeInput = <span class="hljs-function">(<span class="hljs-params">input</span>) =&gt;</span> {
  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> input !== <span class="hljs-string">"string"</span>) <span class="hljs-keyword">return</span> input;

  <span class="hljs-keyword">return</span> input.replace(<span class="hljs-regexp">/[&lt;&gt;"'&amp;]/g</span>, (match) =&gt; {
    <span class="hljs-keyword">const</span> escapeMap = {
      <span class="hljs-string">"&lt;"</span>: <span class="hljs-string">"&amp;lt;"</span>,
      <span class="hljs-string">"&gt;"</span>: <span class="hljs-string">"&amp;gt;"</span>,
      <span class="hljs-string">'"'</span>: <span class="hljs-string">"&amp;quot;"</span>,
      <span class="hljs-string">"'"</span>: <span class="hljs-string">"&amp;#x27;"</span>,
      <span class="hljs-string">"&amp;"</span>: <span class="hljs-string">"&amp;amp;"</span>,
    };
    <span class="hljs-keyword">return</span> escapeMap[match];
  });
};

<span class="hljs-comment">// Rate limiting for API calls</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RateLimiter</span> </span>{
  <span class="hljs-keyword">constructor</span>(maxRequests = 100, windowMs = 60000) {
    <span class="hljs-keyword">this</span>.maxRequests = maxRequests;
    <span class="hljs-keyword">this</span>.windowMs = windowMs;
    <span class="hljs-keyword">this</span>.requests = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
  }

  isAllowed(key = <span class="hljs-string">"default"</span>) {
    <span class="hljs-keyword">const</span> now = <span class="hljs-built_in">Date</span>.now();
    <span class="hljs-keyword">const</span> windowStart = now - <span class="hljs-keyword">this</span>.windowMs;

    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.requests.has(key)) {
      <span class="hljs-keyword">this</span>.requests.set(key, []);
    }

    <span class="hljs-keyword">const</span> requests = <span class="hljs-keyword">this</span>.requests.get(key);

    <span class="hljs-comment">// Remove old requests</span>
    <span class="hljs-keyword">const</span> validRequests = requests.filter(<span class="hljs-function">(<span class="hljs-params">time</span>) =&gt;</span> time &gt; windowStart);

    <span class="hljs-keyword">if</span> (validRequests.length &gt;= <span class="hljs-keyword">this</span>.maxRequests) {
      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
    }

    validRequests.push(now);
    <span class="hljs-keyword">this</span>.requests.set(key, validRequests);

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> apiRateLimiter = <span class="hljs-keyword">new</span> RateLimiter();
</div></code></pre>
<h2 id="%F0%9F%8E%AF-production-checklist">🎯 Production Checklist</h2>
<h3 id="pre-deployment-checklist">Pre-Deployment Checklist</h3>
<pre class="hljs"><code><div><span class="hljs-section">## 🚀 Production Deployment Checklist</span>

<span class="hljs-section">### Code Quality</span>
<span class="hljs-bullet">
- </span>[ ] All tests passing (unit, integration, e2e)
<span class="hljs-bullet">- </span>[ ] Code coverage above threshold (80%+)
<span class="hljs-bullet">- </span>[ ] No console.log statements in production code
<span class="hljs-bullet">- </span>[ ] No TODO/FIXME comments for critical issues
<span class="hljs-bullet">- </span>[ ] Code reviewed and approved
<span class="hljs-bullet">- </span>[ ] TypeScript errors resolved
<span class="hljs-bullet">- </span>[ ] ESLint warnings addressed

<span class="hljs-section">### Performance</span>
<span class="hljs-bullet">
- </span>[ ] Bundle size analyzed and optimized
<span class="hljs-bullet">- </span>[ ] Images optimized and compressed
<span class="hljs-bullet">- </span>[ ] Lazy loading implemented for routes
<span class="hljs-bullet">- </span>[ ] Code splitting configured
<span class="hljs-bullet">- </span>[ ] Service worker configured (if PWA)
<span class="hljs-bullet">- </span>[ ] Caching strategies implemented

<span class="hljs-section">### Security</span>
<span class="hljs-bullet">
- </span>[ ] Environment variables properly configured
<span class="hljs-bullet">- </span>[ ] No sensitive data in client-side code
<span class="hljs-bullet">- </span>[ ] Content Security Policy configured
<span class="hljs-bullet">- </span>[ ] HTTPS enforced
<span class="hljs-bullet">- </span>[ ] Security headers configured
<span class="hljs-bullet">- </span>[ ] Dependencies audited for vulnerabilities

<span class="hljs-section">### Monitoring</span>
<span class="hljs-bullet">
- </span>[ ] Error tracking configured (Sentry)
<span class="hljs-bullet">- </span>[ ] Analytics configured (Google Analytics)
<span class="hljs-bullet">- </span>[ ] Performance monitoring setup
<span class="hljs-bullet">- </span>[ ] Health check endpoints working
<span class="hljs-bullet">- </span>[ ] Logging configured

<span class="hljs-section">### Infrastructure</span>
<span class="hljs-bullet">
- </span>[ ] Domain and SSL certificate configured
<span class="hljs-bullet">- </span>[ ] CDN configured for static assets
<span class="hljs-bullet">- </span>[ ] Backup and disaster recovery plan
<span class="hljs-bullet">- </span>[ ] Monitoring and alerting setup
<span class="hljs-bullet">- </span>[ ] Load balancing configured (if needed)

<span class="hljs-section">### Documentation</span>
<span class="hljs-bullet">
- </span>[ ] Deployment documentation updated
<span class="hljs-bullet">- </span>[ ] API documentation current
<span class="hljs-bullet">- </span>[ ] Environment setup documented
<span class="hljs-bullet">- </span>[ ] Troubleshooting guide available
</div></code></pre>
<h3 id="post-deployment-monitoring">Post-Deployment Monitoring</h3>
<pre class="hljs"><code><div><span class="hljs-comment">// src/utils/healthCheck.js</span>
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HealthChecker</span> </span>{
  <span class="hljs-keyword">constructor</span>() {
    <span class="hljs-keyword">this</span>.checks = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Map</span>();
    <span class="hljs-keyword">this</span>.interval = <span class="hljs-literal">null</span>;
  }

  addCheck(name, checkFunction, interval = <span class="hljs-number">30000</span>) {
    <span class="hljs-keyword">this</span>.checks.set(name, {
      <span class="hljs-attr">fn</span>: checkFunction,
      interval,
      <span class="hljs-attr">lastRun</span>: <span class="hljs-literal">null</span>,
      <span class="hljs-attr">status</span>: <span class="hljs-string">"unknown"</span>,
    });
  }

  <span class="hljs-keyword">async</span> runCheck(name) {
    <span class="hljs-keyword">const</span> check = <span class="hljs-keyword">this</span>.checks.get(name);
    <span class="hljs-keyword">if</span> (!check) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;

    <span class="hljs-keyword">try</span> {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> check.fn();
      check.status = <span class="hljs-string">"healthy"</span>;
      check.lastRun = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
      <span class="hljs-keyword">return</span> { name, <span class="hljs-attr">status</span>: <span class="hljs-string">"healthy"</span>, result };
    } <span class="hljs-keyword">catch</span> (error) {
      check.status = <span class="hljs-string">"unhealthy"</span>;
      check.lastRun = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>();
      <span class="hljs-keyword">return</span> { name, <span class="hljs-attr">status</span>: <span class="hljs-string">"unhealthy"</span>, <span class="hljs-attr">error</span>: error.message };
    }
  }

  <span class="hljs-keyword">async</span> runAllChecks() {
    <span class="hljs-keyword">const</span> results = [];

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> [name] <span class="hljs-keyword">of</span> <span class="hljs-keyword">this</span>.checks) {
      <span class="hljs-keyword">const</span> result = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.runCheck(name);
      results.push(result);
    }

    <span class="hljs-keyword">return</span> results;
  }

  startMonitoring() {
    <span class="hljs-keyword">this</span>.interval = setInterval(<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> results = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.runAllChecks();
      <span class="hljs-keyword">const</span> unhealthy = results.filter(<span class="hljs-function">(<span class="hljs-params">r</span>) =&gt;</span> r.status === <span class="hljs-string">"unhealthy"</span>);

      <span class="hljs-keyword">if</span> (unhealthy.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">"Health check failures:"</span>, unhealthy);
        <span class="hljs-comment">// Send alerts</span>
      }
    }, <span class="hljs-number">60000</span>); <span class="hljs-comment">// Check every minute</span>
  }

  stopMonitoring() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.interval) {
      clearInterval(<span class="hljs-keyword">this</span>.interval);
      <span class="hljs-keyword">this</span>.interval = <span class="hljs-literal">null</span>;
    }
  }
}

<span class="hljs-comment">// Setup health checks</span>
<span class="hljs-keyword">const</span> healthChecker = <span class="hljs-keyword">new</span> HealthChecker();

<span class="hljs-comment">// API health check</span>
healthChecker.addCheck(<span class="hljs-string">"api"</span>, <span class="hljs-keyword">async</span> () =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">`<span class="hljs-subst">${config.apiUrl}</span>/health`</span>);
  <span class="hljs-keyword">if</span> (!response.ok) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`API health check failed: <span class="hljs-subst">${response.status}</span>`</span>);
  }
  <span class="hljs-keyword">return</span> response.json();
});

<span class="hljs-comment">// Local storage check</span>
healthChecker.addCheck(<span class="hljs-string">"localStorage"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> testKey = <span class="hljs-string">"__test__"</span>;
  localStorage.setItem(testKey, <span class="hljs-string">"test"</span>);
  <span class="hljs-keyword">const</span> value = localStorage.getItem(testKey);
  localStorage.removeItem(testKey);

  <span class="hljs-keyword">if</span> (value !== <span class="hljs-string">"test"</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"localStorage not working"</span>);
  }

  <span class="hljs-keyword">return</span> { <span class="hljs-attr">available</span>: <span class="hljs-literal">true</span> };
});

<span class="hljs-comment">// Performance check</span>
healthChecker.addCheck(<span class="hljs-string">"performance"</span>, () =&gt; {
  <span class="hljs-keyword">const</span> navigation = performance.getEntriesByType(<span class="hljs-string">"navigation"</span>)[<span class="hljs-number">0</span>];
  <span class="hljs-keyword">const</span> loadTime = navigation.loadEventEnd - navigation.fetchStart;

  <span class="hljs-keyword">if</span> (loadTime &gt; <span class="hljs-number">5000</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Slow page load: <span class="hljs-subst">${loadTime}</span>ms`</span>);
  }

  <span class="hljs-keyword">return</span> { loadTime };
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> healthChecker;
</div></code></pre>
<h2 id="%F0%9F%8E%AF-key-production-takeaways">🎯 Key Production Takeaways</h2>
<h3 id="1-build-optimization">1. Build Optimization</h3>
<ul>
<li>Minimize bundle size with code splitting</li>
<li>Optimize assets (images, fonts, etc.)</li>
<li>Enable compression (gzip/brotli)</li>
<li>Configure caching strategies</li>
</ul>
<h3 id="2-deployment-strategy">2. Deployment Strategy</h3>
<ul>
<li>Use CI/CD pipelines for automated deployments</li>
<li>Implement blue-green or rolling deployments</li>
<li>Have rollback strategies in place</li>
<li>Test deployments in staging first</li>
</ul>
<h3 id="3-monitoring--observability">3. Monitoring &amp; Observability</h3>
<ul>
<li>Set up error tracking and alerting</li>
<li>Monitor performance metrics</li>
<li>Track user analytics</li>
<li>Implement health checks</li>
</ul>
<h3 id="4-security">4. Security</h3>
<ul>
<li>Configure security headers</li>
<li>Implement Content Security Policy</li>
<li>Audit dependencies regularly</li>
<li>Sanitize user inputs</li>
</ul>
<h3 id="5-maintenance">5. Maintenance</h3>
<ul>
<li>Keep dependencies updated</li>
<li>Monitor for security vulnerabilities</li>
<li>Regular performance audits</li>
<li>Backup and disaster recovery plans</li>
</ul>
<hr>
<p><strong>Congratulations!</strong> 🎉 You've completed the comprehensive React.js learning journey! You now have the knowledge and tools to build, test, optimize, and deploy production-ready React applications. Keep practicing, stay updated with the React ecosystem, and continue building amazing user experiences!</p>

</body>
</html>
